#region (C) Copyright
//-------------------------------------------------------------------------------
// Copyright (C) 2003-2006 Harland Financial Solutions - Phoenix Systems
// All rights reserved.
//-------------------------------------------------------------------------------
#endregion

#region Comments
//-------------------------------------------------------------------------------
// File Name: frmTlTrancode.cs
// NameSpace: Phoenix.Window.Client
//-------------------------------------------------------------------------------
//Date			Ver 	Init    	Change

//-------------------------------------------------------------------------------

#region Archived Comments
//??/??/??		1		RPoddar		#????? - Created.
//10/12/06		2		VDevadoss	#69248 - Hooked up the messenger window.
//10/27/06		3		VDevadoss	#69248 - Invoked the messenger window in a different way.
//11/07/06		4		VDevadoss	#69248 - Added a info box when accessing touche.
//11/15/06		5		Vreddy		#70593 - Ofac button is moved to MDI
//12/13/2006	6		mselvaga	#71112 - Removed sunken box around the balance fields, fixed field width.
//12/20/2006	7		vreddy		#71227 - F9 is now captured
//12/21/2006	8		vreddy		#71231 - I am adding a message and hiding and showing the grid so that user gets fooled.
//12/28/2006	9		Vreddy		#71230 - Now we are updating the whole form not just workspace.
//12/29/2006	10		Vreddy		#71110 - If Prime db not available do not try to fetch the notes data and disable notes icon
//01/02/07		11		vreddy		#71170 - Positive error noshas no error text
//01/02/2007	12		mselvaga	#71278 - Fixed default charge amount calc.
//01/11/2007	13		mselvaga	#71366 - Fixed the first row focus for view tran.
//01/15/2007	14		Vdevadoss	#71389 - Force the focus on the Cust Summ table after invoking the form.
//01/17/2007	15		mselvaga	#71415 - Signature card pop-up fixed. (Vreddy Added Some More)
//01/29/2007	16		mselvaga	#71625 - Cursor is not moving to the correct position when user has default TC configured and they select Last Acct to select the same account they just posted to
//01/29/2007	17		mselvaga	#71637 - Default Tran Code - Receive Phoenix Warning #315164 when entering a application type that the default tran code does not apply to
//01/29/2007	18		Vreddy		#71568 - CurrentBalance It was getting populated with Min Vale of decimal
//01/30/2007	19		mselvaga	#71639 - Offline - Receive Phoenix Error #208 - Invalid Object name udbawawa.gb_map_acct_rel when teller class is set to auto display signatures
//02/07/07		20		VDevadoss	#70728 - Added the code to handle Commitments.
//02/12/2007	21		mselvaga	#60648 - Foreign Wire Tran Changes added.
//02/22/2007	22		vreddy		#71907 - Notes container is not getting repopulated...
//03/06/2007	23		mselvaga	#71235 - Passbook tab is not resetting after resetting the passbook in history.  Any time a passbook account is in the window and user selects tab it should always refresh.
//03/07/2007	24		rpoddar		#71892 - Stop flickering of summary window.
//03/27/2007	25		rpoddar		#72074 - Added default button for message #317919
//04/02/2007	28		rpoddar		#71242 - Fix the no of lines
//04/04/2007	29		mselvaga	#71893 - Added strap split changes.
//05/04/2007	30		mselvaga	#72717 - Teller 2007 NSF Warning is appearing when there are no NSF items present on the account.
//May-24-07		31   	Muthu       #72780 VS2005 Migration
//06/06/2007    32      mselvaga    #72999 - Signature Information window does not pop up when user selects account or customer from Customer Summary and teller class is set to Display Sig Cards.
//06/28/07		33		Vreddy		#71437 - Removing the changes
//08/06/2007    34      mselvaga    #72916 - Add support for TCD.
//08/14/2007	35		njoshi		#72074 - The fix done on 03/27 for the same issue was modified hence restoring what was originally done for the issue
//09/21/2007    36      bbedi       #73911 - Charge Code Fix.
//10/02/2007    37      mselvaga    #72916 - Fixed ValidateAddTransaction for VLT/505 and 555 validation.
//10/23/2007    38      FOyebola    #74043 - Focus on the "Last Name" field of the search window.
//12/17/2007    39      FOyebola    #74043 - Call frmTBarSearch.HighLightTheSearchField to set focus on field in the search window.
//01/22/2008    40      mselvaga    #74509 - Received Invalid Account Type when posting a multiple transaction set.
//0124/2008     41      mselvaga    #74562 - Fixed the annoying invalid account combination message pop-up due to tab navigation.
//01/24/2008    42      JStainth    #74015 - Multiple Signature Notification
//01/25/2008    43      JStainth    #74014 - Auto close service when closing accounts
//02/26/2008    44      JStainth    #74778 - Check employee access for tfr accounts
//02/27/2008    45      rnammundi   #74024 - Stops on LOC's
//02/27/2008    46      LSimpson    #74269 - Added functionality to print multiple forms for float data.
//03/05/2008    47      mselvaga    #74665 - Made pbChkTCDStatus not depend on picTCD.
//03/10/2008    48      LSimpson    #75248 - Moved code region for 74269 below canPrint test.
//03/14/2008    49      JStainth    #75029 - Restriction action button is disabled in 24 by 7 mode.
//03/17/2008    50      mselvaga    #75379 - Modified SetQuickTranCodeField to look for both cmbTranCode.codeValue and quicktrancode to decide whether the Trancode change happened or not.
//03/20/3008    51      JStainth    #75349 - The titling of On-Us Disp and On-Us Sig actions should be standard across all windows
//04/02/2008    52      mselvaga    #75648 - Teller2007 - User is not receiving PW #360472 when entering an invalid account number on the On_Us line entry on the Input Transaction tab.
//04/03/2008    53      LSimpson    #75678 - Not all teller forms are printing - corrected issue.
//04/08/2008    54      mselvaga    #75741 - QA Release 2008 TCD - When transitioning to 24/7 and posting a TCD dispense, the dispense is not completed but the tran updates as if it has dispensed from the TCD.
//04/09/2008    55      mselvaga    #75743 - QA Release 2008 TCD - When TCD has no inventory loaded and post a tran with a TCD dispense, get TCD error but Phoenix handles the tran as if TCD dispensed.
//04/15/2008    56      LSimpson    #75874 - frmTlTranCode - Customer search not clearing after post.  Corrected in ActionAfterPost() method.
//04/17/2008    57      LSimpson    #74269 - Cosmetic changes for float.
//04/22/2008    58      bhughes     #76010 - Signature Window Problem.
//06/12/2008    59      iezikeanyi  #72214 - Modified code to ensure that TfrAcctType field gets focus when we tab from OnUsChks field
//06/20/2008    60      jstainth    #76048 - Search By Member
//07/14/2008    61      bnickson    #76430 - Gap 110 Hot Keying Between Modules
//07/30/2008    62      Deiland     #74368 - Clear out Account Number Field After Invalid Account Entered to prevent error loop causing user to have to exit
//07/21/2008    63      mselvaga    #76043 - Added loan prepay penalty charges changes added.
//9/12/2008     64      bnickson    #1097  - Hot Keying Between Modules - Hot Fix
//09/11/2008    65      LSimpson    #76057 - Modifications for real time recon.
//10/28/2008    66      iezikeanyi  #76429 - Modified code to save incoming Tfr/Acct No and perform cross ref swap
//11/21/2008    67      mselvaga    #76057 - Added more chk printing fixes.
//11/23/2008    68      JStainth    #76041 - Accout Nicknames
//12/12/2008    69      mselvaga    #2031  - Modified code to limit get account nickname details look-up and cache feature only for deploans DP, LN and EX.
//12/12/2008    70      JStainth    #2028  - Commented out code that was setting account type incorrectly
//                                  #2040  - Bug fixes for 76041 Account Nicknames
//                                  #1968  - Bug fixes for 76041 Account Nicknames
//01/08/2009    71      JStainth    #1965  - Bug fixes for 76041 Account Nicknames
//                                  #2183  - Bug fixes for 76041 Account Nicknames
//                                  #2030  - Bug fixes for 76041 Account Nicknames (increased field length in designer)
//01/08/2009    72      mselvaga    #2157  - Added fix for switch to rim issue.
//01/20/2009	73		njoshi		#77176 - After selecting a transaction from the view transaction tab, all fields are being cleared.
//01/20/2009    74      JStainth    #2241 - GL Accounts incorrectly showing nickname in last accts dlg.
//01/20/2009    75      JStainth    #1983 - Acct dialog not appearing when acctType = <none>
//01/29/2009	76		mselvaga	#76458 - Added credit card changes.
//01/29/2009	77		mselvaga	#76458 - Added XMAL window calls.
//02/03/2009    78      mselvaga    #76054 - Added discount pricing enh changes.
//02/11/2009    79      DGupta      #76052 - ODP NSF Changes.
//02/19/2009    80      mselvaga    #2677 - Fixed customer summary select action for ex account.
//02/25/2009    81      mselvaga    #2750 - Fixed last account collection for acct nickname display.
//02/27/2009    82      mselvaga    #2327 - Fixed the check print form printing issue.
//03/16/2009    83      mselvaga    #2926 - Fixed invalid account number combination.
//03/20/2009    84      mselvaga    #2902 - Fixed member account not clearing problem.
//03/24/2009    85      mselvaga    #2677 - Fixed the external account history action click error.
//03/18/2009    86      sdhamija    #76055
//03/03/2009    87      mselvaga    #76033 - Added hyland onbase integration changes.
//03/31/2009    88      bhughes     76458 - DUT 47, XAML window was not getting called.
//04/02/2009    89      JStainth    #76047 - Bond Purchase
//04/13/2009    90      LSimpson    #2462 - Fixed Relationship Management Summary search title display issue.
//04/14/2009    91      mselvaga    #76033 - Added fix for missing null validation for logical svc look-up.
//04/15/2009    92      mselvaga    #3401 - Fix for literal trancode related to savings bond only.
//04/26/2009    93      SDhamija    #3549, #3550 - to set dfAmt into the object so that correct charge amounts are calculated.
//04/26/2009    94      SDhamija    #3409 - When TC 913 or 922 is posted Phoenix Warning #311350 “Your teller drawer is low…..” is popping up 2 times.
//04/24/2009    95      mramalin    WI-3475 - Terminal Services Printing Enhancement
//05/03/2009    96      mselvaga    WI-3032 - SD Low-Cursor populates in Acct # instead of Acct type.
//05/04/2009    97      mselvaga    #3032 - replaced GlAccountSearch constant change.
//05/05/2009    98      SDhamija    #76043, #2159 - to recalculate the charge code for tx 300, 304
//05/08/2009    99      mselvaga    #76425 - Added New LOC Product changes.
//05/08/2009	99		NJoshi		#77540 - allow tc 176 to be backdated calculating the net amt again and also recalculate if penalty amt for tc is overwritten.
//05/14/2009	100		SDhamija	#3567 - When the 'Select Mbr' button is press on the 'Relationship Management Summery' Tab it does not take the user to the Input Transaction tab 10447 - frmTlTranCode
//05/14/2009    101     mselvaga    #76033 - Added more voucher changes.
//05/15/2009    102     vsharma     #1437 - Set the post access property printing balances
//05/21/2009    103     mselvaga    #3951 - Added journalPtid param to call DeleteVoucherImageFile().
//05/22/2009    104     BBedi       #4172 - Error in Posting
//05/26/2009    105     mselvaga    #4175 - Amount field is not refreshing when changing account number.
//05/27/2009    106     mselvaga    #4151 - Commented out unnessary code.
//05/28/2009    107     mselvaga    #3757 - Added the fix for GL account description problem.
//05/28/2009    108     JStainth    #2325 - Added display nicknames check
//06/01/2009    109     BBedi       #4306 - Savings Bond PDF
//06/01/2009    110     SDhamija    #4286, #4383 - Signature card not showing up for transaction account and on us item account.
//06/02/2009    111     SDhamija    #4150 - #76047 - when input transaction tab is refreshed we should clear out the array
//                                  #4157 - 76047 - Bond information is not retained with multiple transaction set
//06/03/2009    112     SDhamija    refix #4286, #4383, search for "refix #4286, #4383" to find changes.
//06/04/2009    113     rpoddar     #03882 - Controls appearance messed up for savings bond
//06/10/2009    114     mselvaga    WI 4439 - Added force populate logic for chk printer.
//06/11/2009    115     rpoddar     #04449  - Added loop for multiple bond items
//06/12/2009    116     rpoddar     #04620 - Disable bond popup for offline
//06/17/2009    117     rpoddar     #04677 - Actions not getting fixed on account change
//06/11/2009    118     rpoddar     #04449  - Multiple items not printing.
//06/19/2009    119     mselvaga    WI-4695 - Fixed invalid account validate cancel holding problem.
//06/22/2009    120     bhughes     #4252 - Disable pbDisplay and pbHistory on account summary when no accounts selected.
//06/23/2009    121     LSimpson    #4603 - Prevent duplicate notes from popping up.
//06/25/2009    122     rpoddar     #04790 - Mask the SSN
//06/26/2009    123     vsharma     #2288 - For CTR set the own_behalf_reason based on the user input.
//06/26/2009    124     mselvaga    WI#1157 - Added warning message for loan fee charge.
//07/01/2009    125     mselvaga    WI#4889 - SD - Low - Account pop ups appear repeatedly in Teller.
//07/07/2009    126     rpoddar     #04778 - print not working when cash out is not involved.
//07/08/2009    127     rpoddar     #04953 - Loan charges message not working properly
//07/09/2009    128     SDhamija    #4889 - Account pop ups appear repeatedly in Teller
//07/15/09      129     Bhughes     #5204, commented out code which moved cbWaive and cbDenom
//07/16/2009    130     mramalin    #5053 - If a form has [Voucher] tag, then it should be archived irrespective of
//                                  signature requirement.
//07/17/09      131     bhughes     4695 - Applied earlier 4695 fix by Selva to the dfTfrAcctNo validation.
//07/20/2009    132     mramalin    #5053 -Modified the [Voucher] tag handling.
//07/20/2009    133     LSimpson    #5002 - Modifications for window titles.
//07/27/2009    134     SDhamija    #5117 - added TellerNumber, BranchNumber, TellerName to ParameterService.
//08/13/2009    135     rpoddar     #05321 -  Use TranCode instead of TlTranCode which can be alphanumeric
//08/28/2009    136     SDhamija    #79156 - added message if there are pending transactions
//									added Customer name (to ArrayList LastAccts)to be displayed in last acct window
//09/11/2009	137		NJoshi		#5220_5726 - gl acct should be formatted as the teller is entering the acct.
//09/25/2009    138     mselvaga    #5700 - Balances are displayed when access has View access restricted in the account summary window that pops up after add next.
//09/25/2009    139     mselvaga    #5732 - Transaction did not post, received receipt.
//10/08/2009    140     mselvaga    WI#5959 - 2009 GA Live - when posting a transaction in teller  if the reference account is an invalid account number, the system empties the field.
// 06Nov2009	141		GDiNatale	#6615 - SetValue Framework change
//10/19/2009    141     mselvaga    WI#5959 - Added more fix for this work item.
//10/19/2009    142     LSimpson    #5959 - Corrected (-1) holdRimNo.
//12/09/2009    143     FOyebola    #79225
//12/28/2009    144     LSimpson    #6656 - Added code to handle workspace close.


//01/04/2010    145     mselvaga    WI#6747 - Teller double posting issue.
//11/19/2009    146     sdhamija    #79183 LOC
//01/15/2010    147     mselvaga    #6595 - Added next screen id from pbAchFut.
//01/26/2010    148     LSimpson    #79619 - Teller Tran Code Limit.
//02/17/2010    149     vdevadoss   #7860 - Hooked up the commitment display window.
//02/18/2010    150     LSimpson    #7986 - Added check for null drawer before check no conversion is performed.
//02/22/2010    151     SDighe      WI#7052/ 7053 - Phoenix Warning 318515 - the account type and number you have entered is not a correct combonation when posting a RIM tran code in teller.
//03/04/2010    152     LSimpson    #8129 - Added null parameter to PMessageBox.Show for form/workspace closing message.
//03/12/2010    153     LSimpson    #8107 - Corrected zero/-1 rimNo.
//03/15/2010    154     LSimpson    #8096 - Corrected issue with tlTranCode being nulled with SelectTran.
//03/15/2010    155     vsharma     #7054,7055 - Reset the var _holdRimNo as it is keeping the old value on Tab clicks causing TC900 to post to an old rim no.
//03/17/2010    156     LSimpson    #8290 - Added offline check before accessing dp_acct and dp_display since the tables are not available offline.
// 29Jan2010	157		GDiNatale	#79370
//03/31/2010    158     LSimpson    #8435 - Prevent multiple GL entries within acct type combo.
//04/06/2010   159     iezikeanyi   #6917 - Reset the mask so user could enter incoming account number for cross ref
//04/15/2010    160     LSimpson    #8502 - RegD Enable/Disable fixes.
//16Apr2010     161     dfutcher    #8497 - title bar name rewrite.
//19Apr2010     162     dfutcher    #8562  - see if services exist
//21Apr2010     163     rpoddar     #08656 - Fix the object null issue
//04/22/2010    164     LSimpson    #8639 - Default Search tab with AddNext when employee is set up for Show All Accounts (Ownership Accounts).
//22Apr2010     165     dfutcher    #8570 - check info window appearing more than once when Transaction Overrides.
//04/27/2010    166     sanwar      #79506 - Added new combo box channel id (Pin vs Sig)(2nd Merge)
//04/28/2010    167     mselvaga    Enh#79574 - Added cash recycler changes.
//04/28/2010    168     mselvaga    Enh#79574 - Call #225528 - Fixed cash drawer combo box value update problem.
//04/19/2010	169		rpoddar		#79510 	Shared Branch Changes
//04/15/2010	170     sdhamija	#79572 - fraud detection and prevention
//05/03/2010    171     mselvaga    Enh#79572 - Fixed fraud detection issues.
//05/11/2010    172     mselvaga    WI#8839 - Relationship Summary Management window does not remain Enabled after transaction POSTS in Teller.
//11May2010     173     dfutcher    8914 GL Accounts can be null. Don't list in Last Accts
//05/13/2010    174     mselvaga    #79574 - Added more fixes.
//12May2010     175     dfutcher    #8837, #8806 Money Orders, On Us data capture.
//05/14/2010    176     LSimpson    #8908 - Do not show cash message for non cash drawer.
//05/14/2010    177     mselvaga    #8839 - Added more fixes.
//05/14/2010    178     sdhamija	#8942
//05/14/2010    179     mselvaga    WI#8830 - UAT2 Wrong tab active when using Add Next
//05/17/2010    180     mselvaga    WI#8977 - DUT - "Clear All" on a TCR Deposit not returning money.
//05/17/2010    181     LSimpson    #8953 - TranAcct.TranCode was null when passing as parameter to window.
//05/18/2010    182     mselvaga    WI#8690 - Teller Regression Testing - 10447 – frmTlTranCode – issue ‘Clear All’ does not clear window title.
//05/19/2010    183     mselvaga    WI#8864 - UAT2 Buy/Sell Cash gives error
//05/20/2010    184     LSimpson    #xxxx - Corrected issues with GL account no fields not being set correctly.
// 20May2010	185		GDiNatale	#8910 - Check Info window doesn't come up for each "Add Next" check transaction ...
// 20May2010	186		dfutcher	#9080 resize USeDescription to fit Reg D
// 21May2010	187		sdhamija	#9077
//05/21/2010    188     mselvaga    WI#9079 - DUT - 79574 Cash Recycler  VLT transaction writes incorrect message.
//05/21/2010    189     sdhamija	#9102
//05/24/2010    190     LSimpson    #9109 - Commented code that was added with #9034 to set ApplType to GL.
//05/24/2010    191     SDhamija	#9099
//26may2010     192     dfutcher    #9136, #9034 - rework acct type combo. removed prior 9034 and 9109 fixes.
//05/26/2010    193     sdhamija	#9027
//05/27/2010    194     mselvaga    WI#8864 - Added more fix related to Buy/Sell.
//05/27/2010    195     sdhamija	#9138
//05/27/2010    196     LSimpson    #8562 - Added modifications for AddNext closing services.
//27may2010     197     dfutcher    #9034
//05/27/2010    198     mselvaga    WI#8977 - DUT - "Clear All" on a TCR Deposit not returning money.
//05/28/2010    199     LSimpson    #8953 - Core issue with switch to Rim functionality.
//06/01/2010    200     SDhamija	#9191
//06/04/2010    201     SDhamija	#9191
// 19May2010	202		GDiNatale	#79621
//06/04/2010    203     mselvaga    WI#9266 - DUT 79574 -9266  TC 505 (Cash Sell from Teller Drawer) Not working if Teller also has TCR connectivity.
//06/03/2010    204     LSimpson    #8868 - Added regD functionality for trancodes 152, 156 and 191.
// 08Jun2010	205		GDiNatale	#9299 - On-us TC combo not refreshing when selecting acct via rel. management screen
//06/08/10      206     rpoddar     #79510, 09218 - Default payee info for acquirer tran
//06/09/2010    207     mselvaga    WI#9309 - Added support for manual cash deposit handling.
//06/14/2010    208     sdhamija	WI#9320
//06/17/2010    209     rpoddar     #79510, #09376 - Sig. required for shared branch
//06/17/2010    210     mselvaga    WI#9433 -  On 10447 - frmTlTranCode When GL account number is entered or pasted in, on the tab out, the GL account is  not being validated
//06/18/2010    211     sdhamija	#9449
//06/18/2010    212     sdhamija	#9442
//06/18/2010    213     rpoddar/sanwar  #79506, #09318 - Channel Id conditional constraint population
//06/21/2010    214     LSimpson    #9291 - Modifications to correct channel combo overlaying check no datafield.
//06/22/2010    215     SDhamija	#9503
//06/23/2010    216     mselvaga    WI#9513 - UAT 3-Tabbing order not correct.
//23Jun2010     217     dfutcher    9348 - CurTran.TranAcct.Trancode cleared, killing check info window
//06/23/2010    218     LSimpson    #9544 - Show frmInstitutionCheckSearch with CallOtherForms to allow control during tempwin_closed. On close, set focus control for frmTBarSearch.
//06/23/2010    219     sdhamija	#9288
//06/24/2010    220     sdhamija	#9320 - moved isNonCustAllowed initialization from initcomplete to begininit.
//06/24/2010    235     rpoddar 	#79510, #09368 - Item endoresment change
//06/28/2010    236     mselvaga    WI#9594 - toggle icon is in middle of window when no cash in/out is used in transaction.
//06/29/2010    237     mselvaga    WI#9624 - Teller Journal is displaying both a Cash In and a TCR Cash In when TCR cash was reversed.
// 30Jun2010	238		GDiNatale	#9591, #9608
//07/01/2010    239     mselvaga    WI#9447 - UAT - 7.	VLS transaction is not correctly validating AD_GB_RSM_LIMITS.tcr_vault_sell_limit – need to change the order of the validation check.
//7jul2010      240     dftcher     9110 last acct name missing.
//07/07/2010    241     LSimpson    #9543 - cmbAcctType_Validating - Commented assignment of _tlTranSet.CurTran.TranAcct.ApplType for GL accounts.
//07/08/2010    242     SDhamija	#9691 - add next not working for non customer
//07/08/2010    243     LSimpson    #9723 - Added validation errors for Teller Check Printing.
//07/09/10      244     DGupta      #9705 - fixed Nickname dialog box when changing acct types.
//07/10/10      245     rpoddar     #79510, #09614- Shared Branch TCD / TCR Changes
//07/14/2010    246     SDhamija	#9775
//07/15/2010    247     SDhamija	#9568
//07/15/2010    247     mselvaga    WI#9425 - Multiple transaction doesn't require signature.
//07/20/2010    248     LSimpson    #9805 - If nickname not available, load cust class desc into lastaccts.
//07/20/2010    249     mselvaga    WI#9864 - Posting a VLT transaction returns PW #360188 - Failed to insert into tl_journal.
//07/20/2010    250     mselvaga    WI#9867 - VLS transaction should not dispense unless cancelled.
//07/21/2010    251     SDhamija	#9568
//07/21/2010    252     mselvaga    WI#9869 - TCD/TCR Dispense limit is not validated on Repost.
//07/21/2010    253     mselvaga    WI#9822 - Tool bar cash total and TCD/TCR Cash Dispensed totals are updated incorrectly.
//07/21/2010    254     mselvaga    WI#8609 - UAT 1-Relationship Summary Changes when selecting account.
//07/26/2010    256     mselvaga    WI#9985 - Ownership Accounts window prevents user from transitioning between rim and deposit/loan account numbers.
//07/29/2010    257     sdhamija	WI#9891
//07/30/2010    258     sdhamija	#10039 - if coming from other apps (CM etc), dont display pending transaction message.
//07/31/2010    259     mselvaga    WI#10003 - Receiving PW #360188 when entering GL account number on Input Transaction tab.
//08/02/2010    260     mselvaga    WI#10049 - Ownership Accounts window should not list all accounts when an acct type is specified.
//08/03/2010    261     sdhamija	WI#10039 -
//08/03/2010    262     mselvaga    WI#9984 - Cannot backtab on the Input Transaction tab in teller when the TC field is enabled.
//08/06/2010    263     LSimpson    #10129 - Added instantiation of _dpAcct and _dpDisplay before new selects are executed.
//08/13/2010    264     LSimpson    #10082 - Added check for non-cust for setting IsOnUsTCEnabled.
//08/27/2010    265     SDhamija	#9539 - non customer search.
//09/09/2010    266     SDhamija	#9539 - logic to enable disable pbEditNonCust moved from frmTBarSearch, to avoid cyclic references.
//09/10/2010    267     LSimpson    #10423 - Added logic to dynamically move dfCheckNo on the form if it intersects with another control.
//09/15/2010    266     LSimpson    #10481 - Regd modifications.
//09/16/2010    267     LSimpson    #10495 - Modifications to cache security settings for add next.
//20Sep2010     270     DFutcher    10504 - move InstCheck button delate to Init method.
//09/23/2010    272     mselvaga    WI#10489, 10488 - BETA-Cash Check tran not requiring ck number (WI 10032).
//09/24/2010	273	    mselvaga    WI#10477, 10476 - UAT 1-Relationship Summary Changes when selecting account (was WI 8609 prior to GA).
//09/24/2010    274     RBhavsar    #10532 - Populate acct related information when entered manually.
//09/30/2010    275     DEiland     WI#10527/#10528 - Change When dfCheckNo Is enabled based on having a form for the Tran_code having an SQR form.  (Disable when SQR, else Enable it)
//10/01/2010    276     DEiland     WI#10527/#10528 - Pulled out IsSqrFormExisting around error 13279 because IsCheckPrintAvailable will now handle it
//10/04/2010	277		NJoshi		wi#10741 - Added null check for wi #9539
//10/05/2010    278     mselvaga    WI#10744 - 10846 - teller toobar cash amout is reduced by double the cash out amount when cancelling trans.
//10/06/2010    279     rpoddar     #10883 - Signature Validation Changes
//10/18/2010    280     sdhamija	2010 #10783; 2011 #10784 - The 'Edit Non Mrb' button is enabled (in ALL tabs) for a rim that is a customer
//10/18/2010    281     sdhamija	2010 #10763; 2011 #10764 - In Teller module, no validation on Pressing Select
//10/21/2010    282     LSimpson    #80620 - Teller PopUps.
//09/23/2010    272     mselvaga    WI#10489, 10488 - BETA-Cash Check tran not requiring ck number (WI 10032).
//09/24/2010	273	    mselvaga    WI#10477, 10476 - UAT 1-Relationship Summary Changes when selecting account (was WI 8609 prior to GA).
//09/24/2010    274     RBhavsar    #10532 - Populate acct related information when entered manually.
//09/30/2010    275     DEiland     WI#10527/#10528 - Change When dfCheckNo Is enabled based on having a form for the Tran_code having an SQR form.  (Disable when SQR, else Enable it)
//10/01/2010    276     DEiland     WI#10527/#10528 - Pulled out IsSqrFormExisting around error 13279 because IsCheckPrintAvailable will now handle it
//10/04/2010	277		NJoshi		wi#10741 - Added null check for wi #9539
//10/05/2010    278     mselvaga    WI#10744 - 10846 - teller toobar cash amout is reduced by double the cash out amount when cancelling trans.
//10/06/2010    279     rpoddar     #10883 - Signature Validation Changes
//10/18/2010    280     sdhamija	2010 #10783; 2011 #10784 - The 'Edit Non Mrb' button is enabled (in ALL tabs) for a rim that is a customer
//10/18/2010    281     sdhamija	2010 #10763; 2011 #10764 - In Teller module, no validation on Pressing Select
//10/22/2010    282     sdhamija	2010 #10783; 2011 #10784 - The 'Edit Non Mrb' button is enabled (in ALL tabs) for a rim that is a customer
//10/25/2010    283     rpoddar     #79510, #10883-2 - Shared Branch Certification Issues Further Fix
//11/01/2010    284     FOyebola    #80621 - Reg D Debit TC189
//11/08/2010    285     LSimpson    #11280 - Corrected base issue with popups not always being added to FormExtension.
//11/09/2010	289		JRhyne		WI#11124 - replace "CurTran.AcctType" with "CurTran.TranAcct.AcctType"
//10/24/2010    290     SDighe      WI#11021 - Dupaco Conversion - Teller Security Issue - ability to bypass staff security
//10/29/2010	291		NJoshi		wi#11103a - pop up the  dlgShBranchTCDOptions window only when the tcd option is seleceted.
//11/2/2010		292		NJoshi		wi#11205 - CaOuTo shows double the amt for shared branch when all only the drawer is used for money.
//11/05/2010	293 -   SDighe - 	WI#11305 - ONUSTC It is requiring a check number/It is now defaulting to a 171 tran code
//11/08/2010	294		NJoshi		wi 11396 - Security issue in Ownership Accounts window
//11/23/2010    295     rpoddar     #79496 Ability to Tie a Specific GL in Teller
//12/01/2010	291		sdhamija	#9568
//12/03/2010    296     LSimpson    #11499 - Popup modifications.
//12/07/2010    297     SDhamija	#11709 - if fraud check is +ve, override window is displayed which is triggering dfAcctNo_PhoenixUIValidateEvent again.
//12/08/2010    298     SDighe      WI#11021a - Additional Fix for WI11021
//12/06/2010    299     SDighe      WI#11021c - Additional fix for WI#11021
//12/14/2010	300		NJoshi		wi 11396 - Banks and CUs navigate this window differently and security should work through all avenue.
//01/12/2011    301     mselvaga    #79314 - Added Remote supervisor override changes.
//01/21/2011    302     FOyebola    WI#12327
//01/25/2011	303		JRhyne		WI#12051 - add a message of the user deletes the penalty amount, and the system adds it back again.
//11/19/2010    303     LSimpson    #80615 - MT Voucher Printing.
//01/17/2011    304     LSimpson    #12420 - New sig coordinate variables.
//02/03/2011    305     LSimpson    #12629 - Set button focus after printing mailer.
//02/09/2011    306     mselvaga    #12551 - Field label is overlapping on Input Transaction tab in teller.
//02/17/2011    307     SDhamija	#80617 - Addl TCs
//02/17/2011    307     sanwar      #12217 - GA Bond Purchase button enabing.
//02/25/2011    308     SDighe      WI#11990 - When in Offline Teller it is trying to access Onbase and errors out on every transaction.
//02/16/2011    309     LSimpson    CR#12870 - Disable pbPrintMailer for noncust.
//02/18/2011    310     LSimpson    #12619 - Corrected base issues with waiving signature.
//02/23/2011    311     LSimpson    #12618 - Corrected base issues with sig pad member display.
//02/28/2011    309     vsharma     #12811 - Only set default onus tc when IsOnUsTCEnabled is true.
//03/02/2011    310     LSimpson    #13067 - Modifications to store _printCustName globally before MT and non-MT printing.
//03/04/2011    311     LSimpson    #13025 - Corrected issue with bond purchase list window coming up every time tran code is entered.
//03/04/2011    311     LSimpson    #13025 - Corrected issue with bond purchase list window coming up every time tran code is entered.
//03/08/2011    312     mselvaga    WI#13028 - DUT 79314 - Remote Override Decision Window (3036 - frmTlOverrideDecision) needs default values when coming from the Teller Journal.
//03/18/2011    313     mselvaga    #11655 - SB Transactions that involve the TCD - TCD Cash GL should be the offset not the Branch Cash GL.
//03/21/2011    314     mselvaga    #80618 - Enhance Items Capture window changes added.
//03/22/2011    315     jabreu      13021 - looking up account with no account number provided.
//03/22/2011    316     LSimpson    #12868 - Added onUsBar to onUsControlsOne so it will float with onus title1.
//03/25/2011    317     mselvaga    #13333 - On-Us action should be disabled in Offline mode.
//03/15/2011    318     LSimpson    #79502 - Enhanced Voucher Printing.
//04/11/2011    319     rpoddar     #79420 - Float Changes
//04/14/2011    320     RBhavsar    #13182/#13183 - Relationship Management Summary is switching to primary member
//04/25/2011    321     LSimpson    #13811 - Disabled PrintBalPrompt for offline.
//03/31/2011    322     LSimpson    #80649 - Added NOC History button.
//04/26/2011    323     LSimpson    #13713 - Set bAcctHasPostAccessOnly for transfer account.
//04/29/2011    324     LSimpson    #13914 - Added _ftrWidth.
//05/02/2011    325     SDhamija	#13912 - added code to calculate penalty amt for TC179
//05/04/2011    326     LSimpson    #13914 - Added _mtSigRequired.
//05/11/2011	327		JRhyne		WI#14075 - clear out noncustomer scenario when "clear all" is clicked
//05/20/2011    328     LSimpson    #14244 - Suppress offline balances for enhanced voucher.
//05/25/2011    329     LSimpson    #14251 - Added enable/disable for NOC History button.  Also replaced sql selects with calls to b/o method.
//05/25/2011    329     TTaylor     #13269 - Correct the problem with the incorrect nickname being displayed.
//06/10/2011    330     LSimpson    #14409 - Added null parameter for frmNocDetailList.
//06/14/2011    330     SDhamija	2010 #14185; 2011 #14186 (found while testing this WI)- non cust info not clearing up, when non cust checkbox is unchecked.
//06/24/2011    331     DEIland     WI#13780/#13781 - dfAcctNo allows GL posting so we must enforce GL Access restrictions if turned on
//07/01/2011    332     LSimpson    #14636 - Set NextScreenId for pbNOCHistory.
//07/08/2011    333     jabreu      13677 - Changed select account code to check for account key before processing in case it is empty from a prior validation (Confidential validation)
//07/19/20011   334     LSimpson    #14787 - Added missing definition for pbNOCHistory.
//07/12/2011    335     LSimpson    #14708 - Print 'Unavailable' for balances when offline.
//07/19/2011    334     LSimpson    #14787 - Added missing definition for pbNOCHistory.
//07/25/2011	335		NJoshi		#14286 -After posting a transfer for an employee, the Relationship Management tab is "active" and able to click on tab
//											 and see employee accounts and balances when the Search tab is not used.
//08/12/2011    336     fspath      #14650 - Fixed all colons to remove space from field name in label. Addded colon to the print option group labels.  Changed in ML also.
//08/19/2011    337     mselvaga    #13797 - TLD12500 Shared branch TCD Cash Out with partial from teller drawer, teller drawer cash out posting as a posting of gl does not balance.
//08/19/2011	338		njoshi		#13555 - Float amts should be printed correctly.
//08/29/2011    339     RBhavsar    #14486 - Loan Account Type Payment Problem - User able to enter a wrong acct type/number validation on a loan and post the transaction.
//09/08/2011    340     SDhamija	#15431 - windows resizing, UI only change
//09/08/2011    341     SDighe      WI#14024 - Restricted access employees are able to post to their own accounts using the transfer trancodes
//09/14/2011    342     TTaylor     #14630 - Corrected the problem with the member displayed in the title switching to primary member under certain conditions.
//09/14/2011    343     TTaylor     #14573/#14574 - Corrected the problem of throwing an exception and not printing a receipt when a tc 176 is performed.
//09/30/2011    344     LSimpson    #80657 - Added note.RimNo.
//09/20/2011    344     VDevadoss   #15149 - Added code to set the IsDisabled Property for the CustomerSummary tab.
//09/20/2011    345     JWatts      #13697 - Transactions for which "Reg D"checkbox was unchecked still presented as checked in "View Transaction."
//08/26/2011	346		njoshi		#15177 - Application error received when posting a real time Teller Cash Buy or Cash Sell transaction
//09/08/2011	347		njoshi		#15377 - Application error received when when signature attached to form, making changes to issue 14629.
//09/19/2011	348		njoshi 		#15505 - Modifying 14629 to check for nulls
//09/27/2011	349		sdhamija	#15525- Remote Supervisor Override - Cancel and attempt to Post, Ownership Accounts display
//10/24/2011    350     LSimpson    #15891 - Shifted controls that appear in onUsControlsOne so none are truncated.
//10/28/2011    351     JWatts      #14486 - Ensure that when "cmbAcctType.SelectedIndex" is changed that related field values are cleared.
//10/31/2011    352     LSimpson    #15942 - Designer change to display Notes Plus icon if note count > 1.
//11/01/2011	353		VDevadoss   #15978 - Set the proper TabIndex for the "Search" tab.
//11/30/2011    324     DEIland     WI#16236/#16237/#16238 - Fix issues with Security and Employee Access
//12/1/2011		325		NJoshi		#16278 - Reprinted receipt shows incorrect information.
//12/08/2011    326     DEiland     WI#16236_2/#16237/#16238 - Additional Change Needed
//12/27/2011    354     LSimpson    #15828 - Call frmOnMessenger directly, bypassing messengerinvoker.
//11/30/2011    324     DEIland     WI#16236/#16237/#16238 - Fix issues with Security and Employee Access
//12/1/2011		325		NJoshi		#16278 - Reprinted receipt shows incorrect information.
//12/08/2011    326     DEiland     WI#16236_2/#16237/#16238 - Additional Change Needed
//01/30/2012    327     mselvaga    WI#16515 - Transaction is not displayed correctly when selecting from the View Transaction tab.
//02/07/2012    328     SDighe      WI#16340 - Regarding TC187, penalty filed resetting the values.
//02/08/2012    329     rpoddar     #79496, #16763 - TL DRAWER BALANCES Not Being Updated Correctly By Transactions with Custom Offset
//02/21/2012    330     mselvaga    #16909 - Suspect Tran- Multiple Rows in Teller when Cancel in Teller Override.
//02/22/2012    331     mselvaga    #16961 - OnUs action on teller Workspace is not verifying customer access security of user.
//02/28/2012    332     DEiland     WI#16237 - Put back fixes for commented out code done under WI#16236 that is now causing employee access problems
//03/02/2012    333     LSimpson    #17048 - Changed picTCD.Image to use TellerImages.TCDSmall.
//03/20/2012    334     rpoddar     #17178 - Handle enabling/disabling of savings bond TB button on switching workspaces.
//03/20/2012    335     mselvaga    #17229 - Teller - Supervisor Override - #315164 - Invalid Transaction Code
//03/21/2012    336     SDighe      WI#11305 - Additional fix for the onus Trancodes.
//04/22/2012	337		JRhyne		WI#17285 - hide avail bal when tab changed to prevent flicker of info that shouldn't be seen
//03/23/2012    338     rpoddar     #17047 - Added Get Account button
//04/06/2012    339     LSimpson    #17149 - Correct issue with tranacct.rimno switching to tfracct.rimno.
//05/07/2012    340     LSimpson    #17473 - Load note.RimNo for RMS.
//05/25/2012    341     mselvaga    #17958 - Offline Teller: Selected View Trans before entering an acct type or acct # and an App Err appeared.
//05/18/2012    342     LSimpson    #17818 - Added confidential balance printing check for AllowEmployeeToViewConfidentialFlag and AllowEmployeeToIgnoreConfidentialFlag.
//06/05/2012    343     rpoddar     #17716 - Enable Cash-In/Cash_out fields for TC505/555 for custom GL Offset
//06/19/2012    344     fspath      #142717 - For Embedded windows need to call the refresh for the preference customization.
//06/27/2012	345		fspath		142717 UI_Phase2 set the IsAllowedToBeFavorited to false. Cant support windows with embedded windows.
//07/20/2012    346     FOyebola    #140780 - Reg D Enhancement.
//08/16/2012	347		NJoshi		#17571 - Name of member is printing incorrectly on receipt
//08/06/2012    7       Mkrishna    #19058 - Adding call to base on initParameters.
//08/20/2012    349     SDighe      WI#18923 - Receiving application error after closing Signature Information window in teller
//09/26/2012	350		JRhyne		WI#19204 - change Edit Non Member button to not depend on column being in set position for UI preferences
//10/03/2012    351     LSimpson    #19642 - Tweak enable/disable of pbcdredemp.
//10/10/2012    352    FOyebola     WI#19197
//10/10/2012    353     LSimpson    #140784-2 - Added parameter for IsSharedBranch (_tlTranSet.IsAcquirerTran) to ParameterService.
//10/10/2012	354		rpoddar		#140784 - Populate Check Reason for Shared Branch
//10/23/2012    355     LSimpson    #19809 - Changes related to misc DUT issues.
//10/31/2012    356     LSimpson    #19905 - Changes related to misc DUT issues.
//11/08/2012    357     LSimpson    CR#19972 - Added GetTranAcctPenaltyInfo.
//11/14/2012    358     mselvaga    #19904 - Unable to process deposit transaction in Offline Mode -.
//11/30/2012    359     fspath      WI#20338 resetting the IsUIPrefSet = false on the pictabs.
//12/17/2012    360      mselvaga    #140772 - Inventory Tracking changes added.
#endregion
//01/10/2013	361		rpoddar		#19415 - Performance Fixes
//24Jan2013     362     dfutcher    140782-3, 20143, 20072
//04Feb2013     362     dfutcher    140782-3, 20962 Early W/D Calc, refresh fields
//09Feb2013     363     dfutcher    140782-3, 21049
//02/22/2013    364     mselvaga    #21274 - 3203 - frmInventoryTypeEdit - When # of Signatures Required on Purchase >0- messsage in Teller is incorrect.
//28Feb2013     365     dfutcher    #21347,21033,20063 Disable, remove CD Redemp button from Cust Summary
//03/05/2013    366     mselvaga    WI#21321 - 10447 - frmTlTranCode when Rim_transaction is performed where ON-Us - I get Fatal error or window will shut down.
//03/12/2013    367     mselvaga    WI#21564 - Add Next is not working with any combination of transactions - the messages are not presented properly.
//23Feb2013     368     dfutcher    #21599 Disable Penalty when TC187 and != Time
//03/28/2013    369     mselvaga    #21781
//01Apr2013     370     dfutcher    #140780-20052
//09May2013     371     dfutcher    #22488 Dummy calc record for modified penalties
//05/14/2013    372     mselvaga    #22426 - #22427 - 140772 Teller Tran window appears to have "pasted" boxes when using TC916.
//15May2013     373     dfutcher    #22350 - TranAcct default penalty not set when tran entered in Calc window.
//05/17/2013    374     SVasu       #21733  - Added validation for closed GL accounts
//04Jun2013		375		apitava		WI#19027 Enabled OnUs fields for editing if Capture Items contains only 1 item
//06/18/2013    376     bhughes     22564 -
//8/3/2013		377		apitava		#157637 Uses new xfsprinter
//08/08/2013    378     mselvaga    #24218 - Teller - Input Transaction Application Error.
//09Aug2013     379     vsharma     #23466 - For Dormant accounts enable/disable action buttons based on the security//09Aug2013     374     vsharma     #23466 - For Dormant accounts enable/disable action buttons based on the security
//08/13/2013    380     mselvaga    #24267 - Teller - Input Application Transaction Error.
//07/09/2013    381     mselvaga    #140798 - Savings Bond Redemption History Desc changes added.
//09/04/2013    382     spatterson  #24110 - CheckNo field is not visible during add next for a loan advance when the original transaction had an sqr form attached (ref: #10527)
//30Sept2013    383     SDighe      WI#23683 - The Benefitor Screen in an CTR transaction did not pull in the customer.
//1/15/2014     384     bhughes     26537, down arrow causing autocomplete to not work.
//12/12/2013    384     DGarcia     #140792 - Add Post Action for Pending Charges.
//1/31/2014     385     bhughes     26836 - Gl offset, validate empl access.
//02/07/2014    386		NJoshi		wi#26748 - Unable to get passbook to print unless we update number of lines in the passbook to 29.
//01/21/2014    387     DGarcia     WI#140785 - Verification of Deposit.
//02/25/2014    388     BSchlottman #140788 Customer Management Display
//04/09/2014    389     FOyebola    CR#23981
//4/30/2014     390     bhughes     28160 - CDS counter, OffsetNickNameList.
//09/23/2013    391     mselvaga    #140895 - Added Teller Capture Changes.
//05/01/2014    392     DGarcia     WI#28556 - Fixed missing VOD button.
//05/13/2014    393     DGarcia     WI#28477 - Added Service Missing button for ENH#140788
//05/23/2014    394     DGarcia     WI#29080 - Deleted code that was checking for Edit access for Services. Only View access is allowed in Teller.
//05/27/2014    395     DGarcia     WI#29180 - Fix parameter list for window frmGbSvcsList.cs
//05/28/2014    396     mselvaga    WI#29211 - Savings Bond Redemption - Click calculator to enter bond but it is greyed out.
//05/29/2014	397		jrhyne		WI#29068 - fix app error
//05/29/2014    398     FOyebola    WI#29225
//05/29/2014    399     DGarcia     WI#29198 - Added warning message in ML.
//06/04/2014    400     DGarcia     WI#29312 - Reversed previously coded WI#28477(Added Service Missing button for ENH#140788).
//06/13/2014    401     mselvaga    WI#26116 - UAT1 - Teller - Item Capture for On-Us items.
//06/18/2014    402     EJose       WI#29161 - IF statement is modified to exclude tc176, 179, 187
//07/03/2014    403     EJose       WI#29161 - revoked the changes made in ver 402
//08/25/2014    404     spatterson  WI#30733/30734 - Push RimType into CurTran.TranAcct as well.
//28Nov2014     405      dfutcher    #32891 - sync up Teller alert images with Cust Management.
//01/06/2015    406     BSchlottman #180274 - Add secondary customer search
//01/20/2015    407     BSchlottman #34060  application error because some searches do you put the account type and number in the grid
//01/30/2015    408     BSchlottman #34401  Add Teller capture part of secondary customer search
//01/30/2015    409     BSchlottman #34465 Add account number to View tab title.
//02/02/2015    410     BSchlottman #34405 - Add Owner Executing Transaction to last accounts
//2Feb2015      411     dfutcher    #34406 - Issues with pbRelationship. 
//02/06/2015    412     BSchlottman #34405 - Use the Primary Rim number in the mbr no column.
//12Feb2015     413     dfutcher    #34406 - Streamline interface for Select Secondary.. 
//07/28/2014    414     mselvaga    WI#30227 - Teller Capture - Bulk Unrelated Transactions Not Coming to Phoenix from AVTC.
//08/05/2014    415     mselvaga    #29457 - Duplicate ISN# present New EOB Warning to avoid adding duplicate ISN # to same batch ID.
//08/05/2014    416     mselvaga    #29682 - When tabbing form view transaction TAB, into the Input transaction from a transaction where AVTC is involved the Rim -1.
//09/15/2014    417     rpoddar     #29457-2 EOB message not getting triggered for rim transactions.
//10/06/2014    418     mselvaga    #30969 - 140895-1 - 2014 AVTC changes added.
//01/15/2015    419     mselvaga    33451 - Teller Capture 2014 Standardization - Selecting a different account number from Relationship Mgm Summary Window after returning from AVTC.
//03/09/2015    420     rpoddar     #180277 - Teller Indicates How to Apply Overpayment changes
//03/12/2015    421     rpoddar     #30915 - Fix errorneous partial label
//05/15/2015    422     mselvaga    WI#36684 - Teller - Fix bugs when posting On-Us items.
//05/27/2015    423     Ashok       #32833- Memory Leak Fix
//06/22/2015    424     mselvaga    #37561 - Invalid acct_type is allowed when virtual tickets (F5).
//03/27/2015    425     AnishKumar  WI#35646 - Commented code because, in Realationship Management Summary window when we click on the Title(s) combo box in Accounts tab, we would be able to select an item from the list, but when we click on the same combo box once again it will show the list and suddenly disappear
//08/13/2015    426     mselvaga    #38295 - Select Secondary Owner - AVTC - Teller - Customer Name Not In Title Bar - View Transaction.
//09/28/2015    427     rpoddar    #195669, #35513 - Automate EOB Changes
//10/16/2015    428     vsharma    #38374 - Handled umb code assigment from the redem calc window 
//11/02/2015    429     mselvaga    #38060 - CSAs on the Teller Cash Recyclers are being for a transactor, but are not allowed to add one.
//11/03/2015    430     mselvaga    #38637 - Cross reference table not working in teller for account numbers enterend in item capture.
//12/02/2015    431     BSchlottman #194535 - eReceipts
//12/02/2015    432     mselvaga    #38637 - Removed the swap account parameter instead used sOptions to pass in the swap account indicator. 
//08/04/2015    425     mselvaga    #38294 - Select Secondary Owner - AVTC - Teller - Customer Name Not In Title Bar - View Transaction.
//09/01/2015    427     mselvaga    #38600 - Teller Transactions window - Application error displayed when changing the RIM.
//09/28/2015    428     mselvaga    #39027 - Posting TC 900 and entering on-us information in item capture window is changing tc from 171 to 152 if you go back into the IC window.
//10/01/2015    430     mselvaga    #39094 - CSAs on the Teller Cash Recyclers are being for a transactor, but are not allowed to add one.
//10/20/2015    432     mselvaga    #38532 - Can you advise why 2 Checks cashed by a teller using RIM1 failed to appear on report DPM80000.
//10/23/2015    433     mselvaga    #38280 - Missing Images - account history (TC152 - Add Next with 902, 910 purchase).
//11/24/2015    434     mselvaga    #39946 - EHF - Unable to post transactions in offline - log into offline mode and click post results in error
//12/09/2015    435     RahulPV     Task#39796 -  Modified to to resolve the issue of Title refresh after add next action
//12/10/2015    436     BSchlottman #40177 Enable eReceipt even in account is not selected.
//12/10/2015    437     BSchlottman #40223 Do not show Customer Receipt Delivery Default in info text box if eReceipts is not enabled.
//12/11/2015    438     BSchlottman #40275 Change Customer to Member when it is a credit union and the screen is writing to the info text box.
//12/15/2015    439     BSchlottman #40254 *First Transaction of a multiple transaction receipt datafield missing
//12/15/2015    440     BSchlottman #40224 Fix a duplicate email problem.
//12/16/2015    441     BSchlottman #40196 If the user select Print, clear out the email address.
//12/21/2015    442     BSchlottman #40276 Change the receipt information to remember changes and compact changes to minimize auditing.
//01/08/2016    443     BSchlottman #40787 Remove compact changes
//02/08/2016    444     NKasim      #40347 - .ToString() changed to Convert.ToString() to avoid Null reference error.
//02/08/2016    445     BSchlottman #41417 When searching for a rim, ReceiptDelMethod is not refreshing.
//01/18/2016    446     Arun        TASK #40974 - CAS-1369270-Q7V4Y2 | Tran RimNo issue fixed.
//02/24/2016    447     BSchlottman #41584 Pass with required signature to Hyland
//02/26/2016    448     BSchlottman #41346 When print and Email do not print the Non MT receipt twice.
//03/01/2016    449     mselvaga    #39025 - #39027 - Posting TC 900 and entering on-us information in item capture window is changing tc from 171 to 152 if you go back into the IC window.
//03/03/3016    450     BSchlottman #42171 When printing multiple copies on a non-mt form, only show the dlgReceiptInfo on the first form.
//03/07/3016    451     BSchlottman #42151 eReceipts does not support offline mode.
//04/20/2016    452     rpoddar     #39655 - Fix Rim # with leading spaces
//03/14/2016    452     mselvaga    #38602 Displays no account ‘Nickname’  in ‘Teller Transaction’ window , if the account is retrieved using ‘Get Acct ‘ action button.
//03/14/2016    453     mselvaga/rpoddar     #40977 - AVTC OOB Fixes
//03/15/2016    454     mselvaga    #39073 Teller Transactions window - Application error displayed when changing the RIM.
//03/16/2016    455     BSchlottman #42555 eReceipts needs to show teller account information for a different rim is selecting a secondary owner
//03/17/2016    456     BSchlottman #41417 When a new search is performed, invoke the Clear All action without prompting the user.
//03/18/2106    457     rpoddar     #38024 - Skip Loan overpayment for commitments.
//03/15/2016    458     DGarcia     WI#40789  Added Excess RegD warning to OnUs tfr accounts.
//04/05/2016    459     BSchlottman #41417 Reset AVTC when a new search is performed.
//04/06/2016    460     mselvaga    #43402 - Brentwood - When AVTC/TCR involved the routing number on the virtual Cash In ticket(s) for TCR is incorrect and is causing the teller drawer to be OOB.
//05/09/2016    461     mselvaga    #43810 - Unable to add manual cash when bills reject from TCR when also using teller capture.
//05/09/2016    462     RDeepthi    #203301.User Story 01: 44600. Resizing Issue for embedded window on High Resolution. Code given by Rajiv.
//05/24/2016    463     RDeepthi    #45681. Notification and Alerts were not displaying because focus was on search tab even after summary window is shown.So set focus on Summary tab.
//06/01/2016    464     BSchlottman #42567 and #43143 Reg CC changes
//06/17/2016    465     BSchlottman #43143 Reg CC MT voucher changes 
//09/19/2016    466     mselvaga    #48926 - Submitting Reversed items for payment.
//09/19/2016    467     vsharma    #49466 - Do not allow AVTC for zero amount GL transactions
//09/19/2016    468     vsharma    #50972 - AVTC alt + f5 Validation for check number
//09/16/2016    469     mselvaga    #50964 - 207627 2016 SP4 Tran codes not working while process AVTC. 
//06/06/2016    470     mselvaga    #45773 - 197928 Code - Post Sends Info to Device
//06/15/2016    471     mselvaga    #45778 - 197928 Code - Receipt Descriptions and Signature
//06/17/2016    472     BSchlottman #43143 Reg CC MT voucher changes
//10/31/2016    473     mselvaga    #54638 - Error when GL TC has a MT form attached 
//12/05/2016    474     mselvaga    #56225 -  2016 SP5 EHF - AVTC screen has a misspelled word.
//03/21/2017    475     RDeepthi    Enh #209693/US #60568/Task #60578 -Added Teller Grouping
//03/21/2017    476     RDeepthi    Enh #209693/US #60619/Task #60620 -Added Customer Grouping Grouping
//03/21/2017    477     RDeepthi    Enh #209693/US #60646/Task #60647 -Added Account Grouping Grouping
//04/04/2017    478     RDeepthi    61730. Refresh RMS window on Customer Related information
//04/05/2017    479     RDeepthi    61886. Dormant Acct Issue. ( Text of Edit Acct is Not Correct). Removed unwanted Code setting text in wrong condition
//04/07/2017    480     RDeepthi    61726. CustMngt and Teller-16- Servicing Flyout. Moved some button in to Direct fly out and get some space after servicing fly out.
//04/07/2017    481     RDeepthi    Enh #209693/US #61239/Task 61240. services and Sales button on Service Tab.
//04/12/2017    482     RDeepthi     Enh #209693/US #61239/Task #60671.Stop at summary logic
//04/12/2017    483     RDeepthi    Bug #62593.On Tab change of Parent window fire selected changed index for Account tab if tabe is services.
//04/12/2017    484     RDeepthi     Enh #209693/US #61239/Task #60686.Recently looked customer
//04/12/2017    485     RDeepthi     Enh #209693/US #62739/Task #62740.Double Click event on grid on the basis of Drawer No
//04/19/2017    486     Vipin      Task 60716:DEV-New icon online post and Auto Transfer.Check In as a part of #60719
//04/19/2017    487     GlaxeenaJ   US #209693 Task #62382 -Addition of New Product offer and BI window for invision
//04/20/2017    488     Vipin       #60713 - User story - 60712 -  CustMngt and Teller-33-Addition of ID Icon in the toolbar
//04/22/2017    489     Vipin       Bug 63385 - Error message when we click on new button in account transfers.
//04/23/2017    490     Vipin       Bug 63110 - With security disabled, we can double click on account and open account display window
//04/24/2017    491     Vipin       Bug 63426:ID button and DL scan security behavior is random
//05/3/2017     492     GlaxeenaJ   Enh #209693 US #63933 Task #63936-New method to select biProduct from Helper Class instead of MDI. S removed method added in task #62382
//05/06/2017    493     GlaxeenaJ   Enh #209693, US #65380, Task #65382  Product Offer Window for teller and Cust Mgnt as an Alert, then to dialogue box
//05/06/2017    494     RDeepthi     Enh #209693/US #60673/Task #60674.Direct Access Window
//05/07/2017    495     RDeepthi     Enh #209693/US #60721/Task #60722.Direct Relation of MDI Button
//05/07/2017    496     RDeepthi     Enh #209693/US #60688/Task #60689.Search Action Button
//05/16/2017    497     RDeepthi     Bug 65205.Search and Select Button
//05/17/2017    498     RDeepthi     #209693/User Story 60667/Task #60668. Alert and Notification
//05/29/2017    499     RDeepthi     WI#65809. There is not functional change. Just rearranged the Code in CallParent.
//05/29/2017    500     JGalxeena    WI#60774. Message box added for tltrancode print button if there is no accounts against Rim on search winodw.
//05/30/2017    501     RDeepthi     US #60697, Task #60698 - Addition Search  Fly out icon in MDI.
//05/06/2017    502     RDeepthi     #60698. Revoke Code for GlobalSearchAgain. Implemented in MDI Teller with another approach
//06/13/2017    503     RDeepthi     US #66693, Task #66693 - Error on Selecting account without Drawer and Disqble Transaction Tab if Drawer is not selected
//06/13/2017    504     RDeepthi     US #65371, Task #65372 - Mdi Enable Disable 
//07/21/2017    506     RDeepthi    WI #63225. Base bug. Screen Id should be referralEdit.
//08/06/2017    507     GlaxeenaJ   Enh #209693, US #65380, Task #65382  Added code to close alert for product offer when closing workspace for teller transaction 
//08/06/2017    508     GlaxeenaJ   Enh #209693, US #65380, Task #65382  Added code to close alert for product offer when closing workspace for teller transaction 
//06/07/2017    509     GlaxeenaJ   Enh #209693, Task 65456:CVT Issue 115817 - Dereference after null check
//07/07/2017    510     mselvaga    #67156 - eReceipt Beta Testing
//10/06/2017    511     RDeepthi    #73409 #73404 CVT Issue.
//10/13/2017    512     Minu        #U.S #73902-#73903 Add new parameter for setting ModuleName as 'Teller' for Inventory.
//10/16/2017    513      RDeepthi    US #73907 - Task #73908. Call Cd Redemption window in Teller Mode if"Teller Transaction" Tab. also Display History from Teller Tab should paas Param to identify CDRedemption window navigation
//10/19/2017    514     Minu        #U.S #73902-#73905 Pass parameter for setting ModuleName as 'Teller' for GLAccount.
//10/23/2017    515     RDeepthi       WI #73938. Recent Look up select on enter
//10/25/2017    516     RDeepthi        WI ##75074. Display window in RMS Tab
//10/25/2017    517     RDeepthi        WI# 75129. Issue with TC801 posting for Non Cust
//10/25/2014    518     RDeepthi    WI #75151. Check Workspace variable before defaulting the Tab
//09/25/2017    519     AshishBabu  Task#70707 added code to Track of the non customer transaction which failed to generate CTR
//10/04/2017    520     AshishBabu  Bug#73424 Revoking the changes done for Task#70707
//10/26/2017    521     RDeepthi        WI #75208. Focus after Signer window
//11/03/2017    522     RDeepthi       WI #75588. Disable Teller Specific utton for AcProc User Type from RMS tab.
//11/15/2017    523     mselvaga    Task#75436 - 210941- DEV-Integration and sslcert validation override for Mx925.
//11/20/2017    524     RDeepthi       WI #76629.The I.D MDI button (View/Scan Related Images/Signature Information) window will not open for a RIM that has no accounts.  
//11/20/2017    525     RDeepthi    WI#75604. Asume Decimal Config in Teller Transaction Tab
//11/23/2017    526     RDeepthi    WI 77049. Save of Status of account in a Workspace variable
//11/27/2017    527     RDeepthi    WI #77062. Setting next screen Id on the basis of UserType.because we want teller specific window to be accessed from AcProc Tree for COmbined user.
//11/29/2017    528     RDeepthi    #77358. Bond Purchase window on the basis of screen Id.pass this value to resolve hardcoded module name logic in BOnd Purchase window
//12/04/2017    529     rdeepthi    //73404. CVT Issue. Dereference null return value
//01/17/2018    530     mselvaga    Task#75273 - Country Bank eReceipts - Do not prompt select secondary owner dialog for AVTC Bulk Transactions.
//01/17/2018    531     AshishBabu  Task#56865 Added code to report the transaction which exceeds the transactor threshold for non customer
//01/17/2018    532     AshishBabu  Bug#75075 Added code to validate with netamt for non customer if tc900 and cashout is null
//01/29/2018    533     mselvaga    #82433 - Error while posting TC 902,910 in offline mode
//01/31/2018    534     RDeepthi    WI #82865. RimNo Conversion should be of int32
//01/31/2018    535     RDeepthi    Wi #82863.While searching for a rim it should through restriction msg only for "Teller" UserType//Begin 
//01/31/2018    536     RDeepthi    WI#82866. shuld reset the flag to invoke proper call parent
//02/08/2018    537     RDeepthi    #83279 PCI Enabled then colDecryptAcctNo else colAcctNO. Because colDecryptAcctNo will have actual AcctNo
//02/08/2018    538     Minu        Bug#83779- Error while searching for a Customer created from Deposit Origination
//02/13/2018    539     Minu        Bug#83857 - Comb Teller - New Restriction in Cust Mangmt shows Origin as Real Time Teller
//02/16/2018    540     Minu        Task #84223:CVT Issue 158248	Logically dead code
//02/20/2018    541     mselvaga    Task#84418 - Add missing changes from #56734 - 208795 - Error:  when posting tc901 and a fee is charged, the fee does not populate unless you enter cash in.
//02/27/2018    542     RDeepthi    WI #84653. Wrong object Id was assigned. changed it.
//03/20/2018    543     mselvaga    Task#86161 - Issue with GL transactions.
//04/04/2018    544     RDeepthi    WI #86464. Assume decimal Config was not resetting. fixed it
//04/04/2018    543     RDeepthi    WI #86464. Assume decimal Config was not resetting. fixed it
//04/12/2018    544     mselvaga    Task#87717 - Add a new tab to Teller titled "Quick Transaction"
//04/13/2018    545     mselvaga    Task#88150 - Dev - Use SA controls to enable Quick Tab
//04/16/2018    546     mselvaga    Task#87731 - DEV - TC 100 Deposit Quick Transaction
//04/23/2018    547     FOyebola    Enh#220316 - Task 87725
//04/23/2018    548     FOyebola    Enh#220316 - Task 89208
//04/30/2018    549     FOyebola    Enh#220316 - Task 89886
//05/02/2018    550     FOyebola    Enh#220316 - Task 89899
//05/04/2018    551     FOyebola    Enh#220316 - Task 89907
//05/10/2018    551     mselvaga    Enh#220316 - Task#87739 - DEV - TC 152 Withdrawal Quick Transaction
//01/09/2018    552     SVasu       Bug#78007 - Dummy Check in
//03/14/2018    553     AshishBabu  Task#85013 - Fixed confidentail accounts balance view while posting
//05/09/2018    554     mselvaga    Enh#220316 - Task#87739 - DEV - TC 152 Withdrawal Quick Transaction
//05/14/2018    555     FOyebola    Enh#220316 - Task 87735
//05/15/2018    556     DGarcia     Bug#90201 - Hide alerts when Quic Tran tab is selected
//05/16/2018    557     DGarcia     Task#89976 - Display and History Action buttons in Quick Transaction tab
//05/17/2018    558     CRoy        US #88994 Task #88995 - Add Clear all feature.
//05/15/2018    559     DGarcia     Bug#90201 - Hide alerts when Quic Tran tab is selected
//05/16/2018    560     FOyebola    Enh#220316 - Task 89989
//05/23/2018    561     DGarcia     Task#89967 - Account Alerts & Notifications
//05/24/2018    562     CRoy        Bug #92171 - Item capture and Cash in buttons are enabled when switching from Quick Tran Tab to Teller Tran tab
//05/24/2018    563     CRoy        Bug #92022 - Don't disable item capture button on clear all in quick tran tab
//05/24/2018    564     CRoy        Bug #92190 - Hide Cash in button if there is no data entered.
//05/23/2018    565     FOyebola    Enh#220316 - Task 87757
//05/29/2018    566     DGarcia     Bug#92186/92188/92189 - Display/History errors.
//06/04/2018    567     DGarcia     Bug#92483  - REJ Alerts are raising an exception when clicked.
//06/04/2018    568     DGarcia     Bug#92482  - Analysis group alert showed in the quick tran vs RMS don't match
//06/05/2018    569     DGarcia     Bug#92484 -  Sweep alerts don't match RMS Window
//06/05/2018    570     CRoy        Bug #92877 -  Add message processing for customer preference window.
//06/06/2018    571     CRoy        Bug #92955 - Make the Item Capture always visible
//06/06/2018    572     CRoy        Bug #92023 - Enable Item Capture only when a search has been done.
//06/07/2018    573     CRoy        Bug #93073 - Reset the quick tran selected row on clear all.
//06/07/2018    574     FOyebola    Enh#220316 - Task 87759
//06/07/2018    575     FOyebola    Enh#220316 - Bug 92498 
//06/08/2018    576     DGarcia     Enh#220316 - Bug#93072
//06/08/2018    577     FOyebola    Enh#220316 - Task 87761
//06/08/2018    578     FOyebola    Enh#220316 - Bug 93234 
//06/11/2018    579     mselvaga    Enh#220316 - Task#93233 - Quick Tran - Cash In field not calculating the difference in specific scenario
//06/13/2018    580     mselvaga    Enh#220316 - Task#92491 - Quick Transaction -> Switch to Advanced option issues
//06/05/2018    581     DGarcia     Enh#220316 - Task#87747
//06/18/2018    582     CRoy        Bug #93430 - Cash in is not enabled in quick tran
//06/13/2018    583     FOyebola    Enh#220316 - Task 87751
//06/19/2018    584     mselvaga    Enh#220316 - Task#93834 - Quick Transaction -> Advanced -> Focus was not set to first row
//06/13/2018    585     FOyebola    Enh#220316 - Bug 93431
//06/21/2018    586     mselvaga    Enh#220316 - Task#87755 - DEV - TC 902, Purchase MO, 910 Purchase Cashier Check Quick Transaction
//06/25/2018    587     FOyebola    Enh#220316 - Bug 94071
//12/22/2017    588     Rakesh-HCL  #78421- Code - Post > Last Account displays only first name for RIM account types
//05/25/2018    589     SChacko     Task#92180 - When calling Trnacode Post window need to pass the correct RimNo
//05/24/2018    590     RDeepthi     WI #//9200. Object reference error fixed
//05/25/2018    591     RDeepthi    Task#92056. Use new flag for "AcProc" User to enable NonCust related button. Have more issues in non Cust. FIxed all thoese along with this WI
//05/31/2018    592     RDeepthi    Bug 92591 - Bug - Refresh issue for RMS window upon closing  windows  “Edit Customer” , “Address” and “Identification window
//06/04/2018    593     RDeepthi    Bug WI #92711. Enable disable of Grid row when MDI window is closed.Elxe on MDI window closed icons arfe not getting enabled properly
//05/30/2018    594     AshishBabu  Task#91967 -Fixed all customer accounts are listed as "confidential" in the teller screen 
//06/28/2018    595     FOyebola    Enh#220316 - Bug 94416
//07/03/2018    596     RDeepthi    WI#94537. Screen Id Of CheckOrder corrected. Earlier it was referring GbHoldStop Window
//07/05/2018    596     DGarcia     Task 94607/94608
//05/25/2018    597     Rakesh HCL  #84704 - HF - Title & Suffix Not Included When 'Select Cust' Used
//07/06/2018    598      CRoy       Task 90001 - Disable quick tran in night mode.
//07/10/2018    599     RDeepthi    WI#95472. Screen Id Of Starter Check. Earlier it was referring GbHoldStop Window
//07/12/2018    600     Minu        #94549- Show message when user trying to post transactions, when drawer is closed out.
//07/19/2018    601     CRoy        Bug #95957 - Setup more workspace variables so the Customer ID button is displayed in Quick Tran..
//07/24/2018    602     mselvaga    Bug #96623 - Fixed visible property of IRS Rpt and Print Mailer buttons for search tab.
//07/24/2018    603     FOyebola    Enh#220316 - Bug 95598
//07/25/2018    604     DGarcia     Task#87765 - Quick Acct Relationships
//07/25/2018    605     Ashok-HCL   Task #90671 - HF - Account information in Input Transaction, show some nicknames, account types, etc
//07/27/2018    606     FOyebola    Enh#220316 - Bug 95645
//08/02/2018    607     DGarcia     Bug#97688 -  Quick Select Secondary
//08/03/2018    608     DGarcia     Task#89981 - Quick Cross Ref Accounts
//08/15/2018    609     CRoy        Bug #98536 - Fix multiple error dialogs showing at the same time.
//08/03/2018    610     RDeepthi    Task #97861. RMS grid is not getting refreshed when posting transaction from Display window without going to RMS. So Calling the Call Prent of frmGloAccountListRIm with correct parameter.
//08/16/2018    611     DGarcia     Task#97603 - Quick Fraud.
//08/27/2018    612     DGArcia     Bug#99140 - Fixed message popping up when user cancel override.
//09/06/2018    613     CRoy        Bug #100897 - Refresh rim info when rms is updated.
//09/07/2018    614     CRoy        Bug #99011 - Update workspace variables to set the enabled/disabled state of ui properly.
//09/11/2018    615     CRoy        Bug #95565 - Set rim display and rim history enabled state.
//09/12/2018    616     CRoy        Bug #100884 - Make all readonly textboxes to default windows color.
//09/13/2018    616     mselvaga    Task#101468 - Fixed Quick Tran buttons
//08/01/2018    617     SChacko     Task#97343 - need to translate non-customer seperator text for credit union.
//09/13/2018    618     DGarcia     Task#90007 - Offline teller for Quick Transactions
//09/26/2018    619     RDeepthi    TASK #102387. Height of the picture box got 0 while doing combine application Code. So changed it back to original size.
//09/27/2018    620     CRoy        Bug #102323 - ID Icon was disabled after entering the tran code in input tran.
//10/08/2018    621     Akhil V	    US#98826 |Task #102380 - Incorrectly sending SD accounts to the frmDpLnTCHistory screen, instead of frmSdTCHistory screen
//10/15/2018    622     CRoy	    Bug #102824 - Member Initiated ID is not feeding the RIM# into the Quick Tab
//10/11/2018    622     mselvaga    Task#90021 - DEV - Devices “after” the transaction
//10/25/2018    623     DEiland     Task#99061 - Fix issue with message #11435 when using Favorites and should not display
//08/28/2018    624     Shebin      Task#99220 - Fix done for recent customer lookup is not working when AD_RM_CONTROL.select_second_owner ='Y'
//09/12/2018    625     SChacko     Bug#101490 - Customer Notes added from RMS window is not popping up while searching a customer
//10/29/2018    626     FOyebola    Task#103714
//10/30/2018    627     DGArcia     Bug#103638 - eReceipt
//11/01/2018    628     FOyebola    Task#100774
//11/02/2018    629     CRoy        Task #103255 - Add validation before posting transaction
//11/09/2018    630     Vipin       Task #104474:DEV - Access to ATM ACCT windows
//11/14/2018    631     DGarcia     Bug#103647 - Offline misc
//11/26/2018    632     CRoy        Bug #104269 - Quick tran action panel buttons reset.
//11/27/2018    633     FOyebola    Enh#220316 - Task#104267
//11/30/2018    634     RDeepthi    task #105267. Currecnlty setting the fields only if AcctNo Is different . Since acctNo can be same it should check AcctNo  along with AcctType.
//12/06/2018    635     RDeepthi     Task #102195. Edited Cust Name not updated on Workspace Header and Page Navigation
//11/14/2018    631     mselvaga    Task#102719 - Add checks only AVTC transaction.
//12/10/2018    632     DGarcia     Bug#104268 - Added SDB to accounts excluded for QuickTran.
//12/19/2018    633     Sandeep.S   #56039 - Need to be  able to uncheck Reg D Option
//12/06/2018    634     AneeshKumar Bug #105472 - Phoenix Warning # 318515 appears when entering a SDB account number in Teller Transactions
//01/08/2019    634     CRoy        Bug #107396 - Error when pressing "Esc" key while entering a transaction in the input teller tab
//01/10/2019    635     mselvaga    Bug# - #106777 - Deposit transaction with cash in posted but cash count information not showing in journal.
//01/17/2019    636     RDeepthi     Bug #108562 umcommented the Code which has been commented mistakelny.
//01/22/2019    637     CRoy        Bug #108622 - Switching account in quick tran grid and posting tran, didn't post to proper account.
//01/23/2019    638     DGarcia     Bug#108569 - Action Buttons Show/Hide/Enable/Disable not working properly for Quick Tran---------------------------------------------------------------------------------------------------------------------------------------------
//01/23/2019    639     mselvaga    Bug #109176 - System allows AVTC after transit checks have been entered 
//01/28/2019    640     DGarcia     Bug #109821 - Mic changes for quick tran.
//01/30/2019    641     DGarcia     Bug# 109868 - Receiving error when changing trancode in offline mode quick tran.
//01/31/2019    642     DGarcia     Bug#109955 
//02/04/2019    643     DGarcia     Bug #109871
//02/21/2019    644     FOyebola    Task#111436
//02/21/2019    645     AshishBabu  Bug#111419 - Added code to fix the Application Error when closing Teller Cash Drawer Count window
//03/15/2019    646     RDeepthi    Task 111762. If call comes from define relation or favorites then we should skip confidential Account posting validation as we need to just show Rim Summary. Also fixed Femis issue.
//03/18/2019    647     Vipin       Task #111735:DEV - 34745 - Adding condition for GL Restriction checking for Tranfer Account(GL Offset for Trancode)
//03/20/2019    648     Akhil V     Bug #112458 - Close restriction after posting transactions sucessfully.
//03/19/2019    649     CRoy        Bug #112463 - Fix adapter type string formatting.
//03/19/2019    650     CRoy        Bug #112698 - Fix error when clicking umbrella with no account focuxed.
//03/27/2019    651     FOyebola    Bug #112736 - The Teller Transaction & Quick Transaction tabs are disabled when there is no Drawer.
//03/28/2019    652     CRoy        Task #112924 - Rename Quick Transactions to Multi Transactions.
//04/02/2019    653     CRoy        Task #113107 - Handle when select secondary owner is null to prevent exception.
//04/29/2019    654     CRoy        Task #113989 - Remove the 0 in the check number.
//05/08/2019    655     FOyebola    Task#113334
//05/07/2019    656     MBachala    113992 - 114236 - LaserPro - added new menu item
//05/21/2019    657     DGarcia     Task# 114935 - Show both Display/History buttons for RIms in Multi-Tran.
//05/23/2019    658     DGarcia     Bug# 115299 - Disable Account Display/History when Rim Transaction is selected(or Rim has not accounts).
//05/26/2019    659     mselvaga    Task#111431 - Enable client workstation property changes for Citrix - JIRA 376
//05/02/2019    660     AshishBabu  Task#113424 - adding Mainbusobj for custSummary Tab inorder to get entry in gb_audit_view
//05/15/2019    661     AshishBabu  Bug#114796 - adding Mainbusobj for custSummary Tab inorder to get entry in gb_audit_view
//05/31/2019    662     DEiland     Task#115610 - Fix Issues Around EX Accounts have history sub menu not enabled due to fields not set correctly
//06/03/2019    663     DGarcia     Task#115614 - Fix issues around EX Accounts history sub menu on the Multi Transaction window
//05/30/2019    664     AshishBabu  Bug#115201 - Regression Bug label missing
//06/04/2019    665     AshishBabu  Bug#115682 - Adding the view audit for each Relationship management summary window view
//06/72/2019    666     Kiran       Task #116572 - Rmoved ML DI from pbEdit button designer. It is using transalation Id from ML
//07/30/2019    667     Riya        US# 113694||Task# 117726 - 'Get Acct' option does not enable correctly on 'Charge Acct' selection boxes in Teller
//08/16/2019    668     Shebin      Task#116383 - Include the input mask for the BOX type
//08/21/2019    669     mselvaga    Task#118299 - ECM Voucher printing changes added
//09/05/2019    670     rpoddar     #118850 - Teller WF Changes ( tagged by  #TellerWF )
//09/24/2019	671		Sandeep.S	#73105 - HF CR - Non-cash drawer will freeze when posting cashier's check (tc902), gift card purchase (tc916), when tabbing past on-us field and no value is poplated, teller app will freeze
//10/08/2019    672     mselvaga    Bug#119678 - Non MT teller Receipt is not appending the signature, getting email with the receipt image but no signature is stitched.PHX-2939
//10/09/2019    673     FOyebola    Bug#120142
//10/16/2019    674     mselvaga    #120397 - Receipts via Documents paper clip - sub sequence number not displaying value
//11/11/2019    675     NKasim      #121408 - enabled pdfInfo field to correct back color with form. 
//10/9/2019     676     AshishBabu  Task#120093 -Fixed employee was not getting updated correctly for failed acess
//10/19/2019    677     DEiland     Story#119103 - Fix issue around AVTC where previous fix was added for QuickTran that can change ItemCapture when tabbing between first 2 tabs

//12/18/2019    679     bhughes     121712 - App insights monitoring.
//01/24/2020    680     FOyebola    Task#121713
//01/24/2020    681     FOyebola    Task#121714
//01/24/2020    682     FOyebola    Task#122355
//01/24/2020    683     mselvaga    Bug#122798 - MT Tran is very slow and is flickering 
//01/24/2020    684     FOyebola    Task#122798
//01/24/2020    685     mselvaga    Task#121627 - 240921 - 2019 SP5 - 2 - DEV - Multi Tran - Item Capture immediate avail amt and avail remaining is not being calculated
//01/24/2020    686     mselvaga    Task#110046 - 240921 - 2019 SP5 - 1 - Multi-Tran Item capture items are not staying
//01/24/2020    687     mselvaga    Task#122532 -  240921 - 2019 SP5 - 12 - DEV - loans transaction with checks are not working.It doesn’t matter if it’s manual or AVTC invoked.
//01/24/2020    688     mselvaga    Bug#122567 - Fixed Invalid TC problem reported for supervisor view only mode during RSO testing.
//01/24/2020    689     mselvaga    Bug#122727 - MT Tab:  Add accelerator key 'G' on Get Acct button
//01/24/2020    690     mselvaga    Bug#123465 - Offline MT - several issues
//02/03/2020    691     Vipin       Bug 124027:Added null check for Teller windows on Workflow. Getting object reference issue.
//02/20/2020    692     mselvaga    Bug#124295 - MT 2020 - Open check column for Loan Advance
//02/25/2020    693     mselvaga    Bug #124152 - Addressed duplicate customer title introduced as part of global UI changes.
//03/02/2020    694     mselvaga    #124249 - Added changes to remove empty transaction row.
//03/09/2020    695     mselvaga    #125019 - 2020 Beta - Upon entering an invalid acct type/number combo in the Teller Tran tab, the window behaves oddly
//02/19/2020    696     AshishBabu  Task#124157 - Wrong receipt information caused by a value of Rim_no = -1 in tl_journal
//02/12/2020    697     Jissa       US #113318|Task #124259 - Supervisor that overrode transactions is being recorded as System (0) instead of actual supervisor
//06/04/2020    698     mselvaga    Bug#126128 - Aux # isn't being transferred into the Pheonix History from Deposit Slips
//5/18/2020     699     MBachala    126864 - 126863 - Remove the need for custom option check for Laserpro
//06/11/2020    700     FOyebola    Task#126205
//04/21/2020    701     FOyebola    Task#126205
//08/04/2020    702     Vipin       Task 130474:. Add a Flyout option for IRA Form
//08/04/2020    703     Vipin       Task #130831 - Task 130474:. checkin along with 130831, use the securty for GbIraForms
//08/20/2020    704     mselvaga    Task#129853 - CAS-2438854-D5S9R8 - AVTC screen does not remain as active screen instead it is minimized to taskbar. REVOKED - Due to AVTC freeze issue.
//08/24/2020    705     EJose       #126669 - TC920 post - utilityId not populated when loading saved transaction using 'Add New'
//09/10/2020    706     mselvaga    Task#132275 - REVOKED #129853 Fix due to AVTC window freeze issue.
//10/05/2020    707     mselvaga    Task#132711 - HF - Addresses occasionally print on vouchers.
//10/15/2020    708     Sandeep.S   #127787 : HF - User enters Cross Referenced account number in Teller with a pop-up note, but  receives an error message instead when running a Teller transaction for the customer.
//10/29/2020    709      Sandeep.S   #126357 | 244510 - 6 New Action Button - Exception Hold in Teller Transaction Window.
//11/20/2020    710     mselvaga    Task#129853 - CAS-2438854-D5S9R8 - AVTC screen does not remain as active screen instead it is minimized to taskbar. Added with additional changes.
//11/23/2020    711     Kiran       Task #133851 Added Cash Reward in servicing menu
//11/26/2020    712     EJose       Task #134650 enabled RegD checkbox for Tc164 if enabled in SA.
//11/26/2020    713     Jissa       US #126358 | Task #134375: 244510 - Create an exception hold for a teller TC
//12/02/2020    714     Jissa       Bug #134756: Possible to create a Hold without giving Hold reason
//12/02/2020    715     Sandeep     Bug #134757: Extra space on Restriction list window & Exception hold action button is available in every Tab when logged in as Teller
//12/08/2020    716     Jissa       US #126363 | Task #134380: 244510 - 12 New Fly-out option to create exception hold from Multi Transaction Window
//---------------------------------------------------------------------------------------------------------------------------------------------
#endregion

using System;
using System.Drawing;
using System.Collections;
using System.ComponentModel;
using System.Windows.Forms;
using System.Data;
using System.Text;
using System.Text.RegularExpressions;   //140793
using GlacialComponents.Controls;
using System.Xml;
using System.Threading;
using System.IO; //#76033
//
using Phoenix.Windows.Forms;
using Phoenix.FrameWork.BusFrame;
using Phoenix.BusObj.Teller;
using Phoenix.BusObj.Deposit; // #7449
using Phoenix.FrameWork.Core.Utilities;
using Phoenix.FrameWork.Core;
using Phoenix.FrameWork.Shared.Variables;
using Phoenix.Shared;  //60647
using Phoenix.Shared.Constants;
using Phoenix.BusObj.Admin.Global;
using Phoenix.BusObj.Admin.RIM; // #14251
using Phoenix.Shared.Images;
using Phoenix.BusObj.Misc;
using Phoenix.Busobj.Reports;
using Phoenix.Shared.Xfs;
using Phoenix.BusObj.Global;
using Phoenix.Shared.Windows;
using Phoenix.Shared.Ucm;
//using Phoenix.Hyland.Service;
//using Microsoft.Win32;
using Phoenix.Shared.Variables;
using System.Collections.Generic; //#76033
using Phoenix.BusObj.Control;   //#79572
//using Phoenix.Shared.BusFrame;
using Phoenix.BusObj.Admin.Teller; /*11396*/
using Phoenix.BusObj.GL;        //WI#13780
using Phoenix.BusObj.RIM;       //WI#23683
using Phoenix.Client.Teller;  //#140895
using Phoenix.Client.MsgBox;  //#180274
using Phoenix.BusObj.Admin;   //#180274
using phoenix.client.tlprinting; //#194535
using Phoenix.MultiTranTeller.Base.Models;
using Phoenix.MultiTranTeller.Base;


namespace Phoenix.Windows.Client
{
    /// <summary>
    /// Summary description for frmTlTranCode.
    /// </summary>
    public partial class frmTlTranCode : Phoenix.Windows.Forms.PfwStandard, ITlTranCodeWindow
    {
        public enum TAB
        {   //140782  
            InputTran = 0,
            ViewTran = 1,
            Search = 2,
            CustSummary = 3,
            Passbook = 4,
            QuickTran = 5
        }

        #region Private Objects
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.Container components = null;
        public Phoenix.Windows.Forms.PTabControl picTabs;		//#79572
        private Phoenix.Windows.Forms.PTabPage Name0;
        private Phoenix.Windows.Forms.PTabPage Name1;
        private Phoenix.Windows.Forms.PTabPage Name4;
        private Phoenix.Windows.Forms.PGroupBoxStandard gbAccountInformation;
        private Phoenix.Windows.Forms.PLabelStandard lblAccount;
        private Phoenix.Windows.Forms.PComboBoxStandard cmbAcctType;
        private Phoenix.Windows.Forms.PLabelStandard lbl;
        private Phoenix.Windows.Forms.PdfStandard dfAcctNo;
        private Phoenix.Windows.Forms.PCheckBoxStandard cbPbPresent;
        private Phoenix.Windows.Forms.PCheckBoxStandard cbPayrollTran;
        private Phoenix.Windows.Forms.PCheckBoxStandard cbRetirement;
        private Phoenix.Windows.Forms.PLabelStandard lblCurrency;
        private Phoenix.Windows.Forms.PComboBoxStandard cmbCrncy;
        private Phoenix.Windows.Forms.PLabelStandard lblTitle1;
        private Phoenix.Windows.Forms.PdfStandard dfTitle1;
        private Phoenix.Windows.Forms.PLabelStandard lblTitle2;
        private Phoenix.Windows.Forms.PdfStandard dfTitle2;
        private Phoenix.Windows.Forms.PGroupBoxStandard dfTransactionInformation;
        private Phoenix.Windows.Forms.PLabelStandard lblTranCode;
        private Phoenix.Windows.Forms.PdfStandard dfQuickTranCode;
        private Phoenix.Windows.Forms.PComboBoxStandard cmbTranCode;
        private Phoenix.Windows.Forms.PLabelStandard lblExchCurrency;
        private Phoenix.Windows.Forms.PComboBoxStandard cmbExchCrncy;
        private Phoenix.Windows.Forms.PLabelStandard lblDescription;
        private Phoenix.Windows.Forms.PdfStandard dfTranDescription;
        private Phoenix.Windows.Forms.PLabelStandard lblUtility;
        private Phoenix.Windows.Forms.PComboBoxStandard cmbUtility;
        private Phoenix.Windows.Forms.PLabelStandard lblReference;
        private Phoenix.Windows.Forms.PdfStandard dfReference;
        private Phoenix.Windows.Forms.PLabelStandard lblRefAccount;
        private Phoenix.Windows.Forms.PComboBoxStandard cmbRefAcctType;
        private Phoenix.Windows.Forms.PLabelStandard lblRefAcctNo;
        private Phoenix.Windows.Forms.PdfStandard dfRefAcctNo;
        private Phoenix.Windows.Forms.PLabelStandard lblCashIn;
        private Phoenix.Windows.Forms.PdfCurrency dfCashIn;
        private PdfCurrency dfWithholdingAmt;
        private PLabelStandard lblCalcWh;
        private Phoenix.Windows.Forms.PLabelStandard lblChecksAsCash;
        private Phoenix.Windows.Forms.PdfCurrency dfChksAsCash;
        private Phoenix.Windows.Forms.PLabelStandard lblOnUsChecks;
        private Phoenix.Windows.Forms.PdfCurrency dfOnUsChks;
        private Phoenix.Windows.Forms.PComboBoxStandard cmbTfrAcctType;
        private Phoenix.Windows.Forms.PLabelStandard lblTfrAcctNo;
        private Phoenix.Windows.Forms.PdfStandard dfTfrAcctNo;
        private Phoenix.Windows.Forms.PLabelStandard lblCheck;
        private Phoenix.Windows.Forms.PdfStandard dfTfrCheckNo;
        private Phoenix.Windows.Forms.PLabelStandard lblTransitChecks;
        private Phoenix.Windows.Forms.PdfCurrency dfTransitChks;
        private Phoenix.Windows.Forms.PLabelStandard lblCashOut;
        private Phoenix.Windows.Forms.PdfCurrency dfCashOut;
        private Phoenix.Windows.Forms.PLabelStandard lblAmount;
        private Phoenix.Windows.Forms.PdfCurrency dfAmt;
        private Phoenix.Windows.Forms.PLabelStandard lblRate;
        private Phoenix.Windows.Forms.PdfStandard dfPostingExchRate;
        private Phoenix.Windows.Forms.PLabelStandard lblForeignAmount;
        private Phoenix.Windows.Forms.PdfCurrency dfAmtEq;
        private Phoenix.Windows.Forms.PLabelStandard lblItems;
        private Phoenix.Windows.Forms.PdfStandard dfCheckNo;
        private Phoenix.Windows.Forms.PLabelStandard lblFeeAmount;
        private Phoenix.Windows.Forms.PdfCurrency dfCCAmt;
        private Phoenix.Windows.Forms.PLabelStandard lblInterestPaid;
        private Phoenix.Windows.Forms.PdfCurrency dfInterestPaid;
        private Phoenix.Windows.Forms.PLabelStandard lblPenalty;
        private Phoenix.Windows.Forms.PdfCurrency dfPenaltyAmt;
        private Phoenix.Windows.Forms.PLabelStandard lblTotalDebits;
        private Phoenix.Windows.Forms.PdfCurrency dfTotalDebits;
        private Phoenix.Windows.Forms.PLabelStandard lblTotalCredits;
        private Phoenix.Windows.Forms.PdfCurrency dfTotalCredits;
        private Phoenix.Windows.Forms.PLabelStandard lblDifference;
        private Phoenix.Windows.Forms.PdfCurrency dfDifference;
        private Phoenix.Windows.Forms.PAction pbLastAcct;
        private PAction pbPrintMailer; // #80615
        private PAction pbNOCHistory; // #80649
        private Phoenix.Windows.Forms.PAction pbCashIn;
        private Phoenix.Windows.Forms.PAction pbCashOut;
        private Phoenix.Windows.Forms.PAction pbTCDDenom;
        private Phoenix.Windows.Forms.PAction pbItemCapture;
        private Phoenix.Windows.Forms.PAction pbFees;
        private Phoenix.Windows.Forms.PAction pbDisplay;
        private Phoenix.Windows.Forms.PAction pbHistory;
        private Phoenix.Windows.Forms.PAction pbRestrictions;
        private Phoenix.Windows.Forms.PAction pbGetAcct;        // #17047
        private Phoenix.Windows.Forms.PAction pbGetGLAcct;
        private Phoenix.Windows.Forms.PGroupBoxStandard gbTransactionSet;
        private Phoenix.Windows.Forms.PGrid ctwTranSet;
        private Phoenix.Windows.Forms.PGridColumn colAccount;
        private Phoenix.Windows.Forms.PGridColumn colTranDesc;
        private Phoenix.Windows.Forms.PGridColumn colComponents;
        private Phoenix.Windows.Forms.PGridColumn colCompAmts;
        private Phoenix.Windows.Forms.PGridColumn colActualRate;
        private Phoenix.Windows.Forms.PGridColumn colExchRate;
        private Phoenix.Windows.Forms.PGridColumn colEquivAmt;
        private Phoenix.Windows.Forms.PGridColumn colEquivAmtStr;
        private Phoenix.Windows.Forms.PGridColumn colTfrAccountInfo;
        private Phoenix.Windows.Forms.PGridColumn colDescription;
        private Phoenix.Windows.Forms.PGridColumn colReference;
        private Phoenix.Windows.Forms.PGridColumn colTranIndex;
        private Phoenix.Windows.Forms.PComboBoxStandard cmbRegCC;
        private Phoenix.Windows.Forms.PLabelStandard lblUMBCode;
        private Phoenix.Windows.Forms.PdfStandard dfUMBCode;
        private Phoenix.Windows.Forms.PLabelStandard lblIRACategory;
        private Phoenix.Windows.Forms.PComboBoxStandard cmbUmbCode;
        private Phoenix.Windows.Forms.PLabelStandard lblDraweeBank;
        private Phoenix.Windows.Forms.PComboBoxStandard cmbEndPoint;
        private Phoenix.Windows.Forms.PLabelStandard lblTCDDrawer;
        private Phoenix.Windows.Forms.PComboBoxStandard cmbTCDDrawer;
        private Phoenix.Windows.Forms.PCheckBoxStandard cbTfrPbPresent;
        private Phoenix.Windows.Forms.PdfStandard dfTabTitle1;
        private Phoenix.Windows.Forms.PdfStandard dfTabTitle3;
        private Phoenix.Windows.Forms.PdfStandard dfTabTitle4;
        private Phoenix.Windows.Forms.PdfStandard dfTabTitle0;
        private Phoenix.Windows.Forms.PAction pbRemoveTran;
        private Phoenix.Windows.Forms.PAction pbSelectTran;
        private Phoenix.Windows.Forms.PAction pbSearch;
        private Phoenix.Windows.Forms.PAction pbSelectSearch;
        private Phoenix.Windows.Forms.PAction pbSelectAcct;
        private Phoenix.Windows.Forms.PAction pbSelectRIM;
        private Phoenix.Windows.Forms.PdfStandard dfBatchID;
        private Phoenix.Windows.Forms.PdfStandard dfAcctId;
        private Phoenix.Windows.Forms.PGroupBoxStandard gbAccountInfo;
        private Phoenix.Windows.Forms.PLabelStandard lblPbAcctNo;
        private Phoenix.Windows.Forms.PdfStandard dfPbAcctType;
        private Phoenix.Windows.Forms.PdfStandard dfPbAcctNo;
        private Phoenix.Windows.Forms.PLabelStandard lblPbTitle1;
        private Phoenix.Windows.Forms.PdfStandard dfPbTitle1;
        private Phoenix.Windows.Forms.PLabelStandard lblPbTitle2;
        private Phoenix.Windows.Forms.PdfStandard dfPbTitle2;
        private Phoenix.Windows.Forms.PLabelStandard lblPassbookBalance;
        private Phoenix.Windows.Forms.PDfDisplay dfPbBalance;
        private Phoenix.Windows.Forms.PLabelStandard lblUnbookedDeposits;
        private Phoenix.Windows.Forms.PDfDisplay dfUnbookedDeposits;
        private Phoenix.Windows.Forms.PLabelStandard lblUnbookedWithdrawals;
        private Phoenix.Windows.Forms.PDfDisplay dfUnbookedWithdrawals;
        private Phoenix.Windows.Forms.PLabelStandard lblEndingBalance;
        private Phoenix.Windows.Forms.PDfDisplay dfEndingBalance;
        private Phoenix.Windows.Forms.PGroupBoxStandard gbUnbookedItems;
        private Phoenix.Windows.Forms.PGrid twPassbook;
        private Phoenix.Windows.Forms.PGridColumn colEffectiveDt;
        private Phoenix.Windows.Forms.PGridColumn colTCDescription;
        private Phoenix.Windows.Forms.PGridColumn colDeposit;
        private Phoenix.Windows.Forms.PGridColumn colWithdrawal;
        private Phoenix.Windows.Forms.PGridColumn colPbBalance;
        private Phoenix.Windows.Forms.PGroupBoxStandard gbPrintOptions;
        private Phoenix.Windows.Forms.PLabelStandard lblNumberoflinesinthepassbook;
        private Phoenix.Windows.Forms.PdfStandard dfPbLines;
        private Phoenix.Windows.Forms.PLabelStandard lblPassbookType;
        private Phoenix.Windows.Forms.PComboBoxStandard cmbPassbookType;
        private Phoenix.Windows.Forms.PAction pbUpdatePB;
        private Phoenix.Windows.Forms.PAction pbSkip;
        private Phoenix.Windows.Forms.PdfStandard dfTabTitle2;
        private System.Windows.Forms.RichTextBox pdfInfo;   //#194535
        private Phoenix.Windows.Forms.PdfStandard dfObjectInput;
        private Phoenix.Windows.Forms.PTabPage Name2;
        private Phoenix.Windows.Forms.PTabPage Name3;
        private Phoenix.Windows.Forms.PLabelStandard lblTotalDebits1;
        private Phoenix.Windows.Forms.PdfCurrency dfTotalDebits1;
        private Phoenix.Windows.Forms.PdfCurrency dfDifference1;
        private Phoenix.Windows.Forms.PLabelStandard lblDifference1;
        private Phoenix.Windows.Forms.PdfCurrency dfTotalCredits1;
        private Phoenix.Windows.Forms.PLabelStandard lblTotalCredits1;
        private Phoenix.Windows.Forms.PCheckBoxStandard cbPassDesc;
        private Phoenix.Windows.Forms.PLabelStandard lblEffective;
        private Phoenix.Windows.Forms.PdfStandard dfTranEffectiveDt;
        private Phoenix.Windows.Forms.PAction pbClearAll;
        private Phoenix.Windows.Forms.PAction pbSeparator1;
        private Phoenix.Windows.Forms.PAction iconSweep;
        private Phoenix.Windows.Forms.PAction iconCaution;
        private Phoenix.Windows.Forms.PAction iconHold;
        private PAction iconOnUsNotes;      //#80620 begin
        private PAction iconOnUsSigner;
        private PAction iconOnUsStop;
        private PAction iconOnUsCaution;
        private PAction iconOnUsSweep;
        private PAction iconOnUsAnalysis;
        private PAction iconOnUsHold;       //#80620 end
        private PAction iconOnUsAcctRegD;   //140780-20052
        private Phoenix.Windows.Forms.PAction iconRetirement;
        private Phoenix.Windows.Forms.PAction iconStop;
        private Phoenix.Windows.Forms.PAction iconNSF;
        private Phoenix.Windows.Forms.PAction iconREJ;
        private Phoenix.Windows.Forms.PAction iconUCF;
        private Phoenix.Windows.Forms.PAction iconRealTime;
        private Phoenix.Windows.Forms.PAction iconSigner;
        private Phoenix.Windows.Forms.PLabelStandard lbPbAcctType;
        private System.Windows.Forms.PictureBox picRealTime;
        private System.Windows.Forms.PictureBox picMemo;
        private Phoenix.Windows.Forms.PAction iconAnalysis;
        private System.Windows.Forms.Panel panelAvailBal;
        private Phoenix.Windows.Forms.PLabelStandard lblAvailBal;
        private Phoenix.Windows.Forms.PLabelStandard lblCurBal;
        private Phoenix.Windows.Forms.PDfDisplay dfColBal;
        private Phoenix.Windows.Forms.PDfDisplay dfCurBal;
        private Phoenix.Windows.Forms.PDfDisplay dfAvailBal;
        private Phoenix.Windows.Forms.PLabelStandard lblColBal;
        private Phoenix.Windows.Forms.PAction pbMakeBreakStrap;
        private Phoenix.Windows.Forms.PAction pbCDRedemp; // #140782
        private PictureBox picTCD;
        private PictureBox picDrawer;
        private PCheckBoxStandard cbDenominate;
        private PAction pbChkTCDStatus;
        private PdfStandard dfOnUsTitle2;
        private PdfStandard dfOnUsTitle1;
        private PdfStandard dfOnUsAlerts;
        private PdfStandard dfOnUsSignatures;
        private PAction pbOnUsDisplay;
        private PAction pbOnUsSig;
        #region #80620
        private PAction pbOnUs;
        private PActionManager _onUsActionMgr = new PActionManager();
        private ContextMenu cmOnUs;
        private PictureBox picSignature;
        private bool _isShowOnUsNotes = false;
        private int _onUsNoteCount = 0;
        private int _onUsNotePopupCount = 0;
        #endregion
        private PLabelStandard lblOnUsTitle2;
        private PLabelStandard lblOnUsTitle1;
        private PAction pbBondPurchase;
        private PLabelStandard lblRecalcPmt;
        private PComboBoxStandard cmbRecalcPmtDt;
        private PLabelStandard lblRecalcPmtDt;
        private PDfDisplay dfRecalcPmt;
        private PDfDisplay dfAcctNickname;
        private PGridColumn colAcctNickname;
        private PAction pbACHFut;
        private PCheckBoxStandard cbWaiveSignature;
        private PGridColumn colRimNo;
        private PAction pbIrsRpt;					//#79156
        private PComboBoxStandard cmbOnUsTc;
        private PLabelStandard lblOnUsTc;					//#79156
        private AdGbRsm _adGbRsm = (GlobalObjects.Instance[Phoenix.FrameWork.Shared.Variables.GlobalObjectNames.AdGbRsm] as AdGbRsm);
        private PCheckBoxStandard cbRegD; //#5117
        private PAction pbInstChkSrch;	// #79370
        private PLabelStandard lblChannel;
        private PComboBoxStandard cmbChannel; //#6656
        private PdfStandard dfTlItemCheckNo;
        private PLabelStandard lblTlItemCheckNo;
        private PdfStandard dfTlItemAcctNo;
        private PLabelStandard lblTlItemAcctNo;
        private PdfStandard dfTlItemRoutingNo;
        private PLabelStandard lblTlItemRoutingNo;
        private PAction pbReset;
        private PAction pbAddNonCust;	//#9320
        private PLabelStandard lblNonCustomer; //#6656
        private bool NonPerOnUs; //WI#23683
        private bool NonPerOwner; // WI#23683
        //Begin #60647
        private Phoenix.Windows.Forms.PAction pbEdit;
        private Phoenix.Windows.Forms.PAction pbUmbrella;
        private Phoenix.Windows.Forms.PAction pbArchive;
        //End  #60647
        //Begin 60620. Cust Grouping
        private PAction pbSeperatorCust;
        private PAction pbRim;
        private PAction pbRimDisplay;
        private PAction pbRimHistory;
        private PAction pbPortfolio;
        private PAction pbRimAchFuture;
        private PAction pbRimDirect;
        //End #60620
        private PAction pActionSepNonCust;
        private PAction pActionSepSrchMisc;
        //Begin #60578 Teller Grouping     
        private PAction pbSeperatorTeller;
        private PAction pbMisc;
        private ContextMenu cmTellerMiscMenu;
        //End #60578
        //Begin  #60647 Account and Servicing Grouping
        private PAction pbSeperatorAcct;
        private PAction pbSeperatorServ;
        private PAction pbServicing;
        private PAction pbNewAcct; 
        private PAction pbDirectAcct;
        private ContextMenu cmDpDirectMenu;
        private ContextMenu cmLnDirectMenu;
        private ContextMenu cmAtmDirectMenu;
        private ContextMenu cmNewAcctMenu;
        private ContextMenu cmExHistoryMenu;
        private ContextMenu cmServicingMenu;
        private PAction miExHistory;
        private PAction miTcLog;
        //End  #60647
        //Begin 61240
        private PAction pbEditService;
        private PAction pbActionSeperator4;
        private PAction pbSales;
        //End 61240
        private PAction pbOnUsMisc; //#60578
        private PAction pbInventoryMisc;//#60578
        private PAction pbeReceiptMisc;//#60578
        private PAction pbPrintMailerMisc;//#60578
        private PAction pbNOCHistoryMisc;//#60578
        private Phoenix.Windows.Forms.PComboBoxStandard cmbLnEscrowAgent;
        private Phoenix.Windows.Forms.PLabelStandard lblLnEscrowAgent;

        #endregion

        #region Private Variables

        #region bus objects
        private Phoenix.BusObj.Teller.TlTransactionSet _tlTranSet = new TlTransactionSet();
        private GbMemo _gbMemo = new GbMemo(); // #15942
        private Phoenix.BusObj.Teller.TlDrawer _tlDrawer = new TlDrawer(); //#79619
        private Phoenix.BusObj.Deposit.DpAcct _dpAcct = new DpAcct(); //#7449
        private Phoenix.BusObj.Deposit.DpDisplay _dpDisplay = new DpDisplay(); //#7449
        private PcCustomOptions _pcCustomOptions = new PcCustomOptions();    //#79572
        private Phoenix.Client.Search.frmtbarsearchMerged frmTBarSearch = null; //60671 Create instance of new clone window
        private Phoenix.Client.RimAccounts.frmGloAccountListRim frmGloAccountListRim = null;
        private Phoenix.BusObj.Global.GbHelper _gbHelper = new Phoenix.BusObj.Global.GbHelper();
        private TlJournal _busObjTlJournal = new TlJournal();//Task#124157
        AdGbRsmFailedAccess _adGbRsmFailedAccess = null;
        TlJournal _tlJournal = null;
        TlJournalOvrd _tlJournalOvrd = null;
        AccountHistory _accountHistory = null;
        AchNocHistory _achNocHistory; // #14251

        PrintInfo printInfoForm = null;
        CashDispenser cashDisp = null; //#72916
        ArrayList _tcdDeviceResp = new ArrayList();
        ArrayList MailerForm = new ArrayList(); // #80615
        ArrayList MTDepositForm = new ArrayList(); // #80615
        List<PrintInfo> PrintInfoArray = new List<PrintInfo>();
		XfsPrinter _printer = null;
		TlJournalAddlInfo _tlJournalAddlInfo = null;    // #79510, #09218
        
        private AdGbBankControl _adGbBankControl = (AdGbBankControl)GlobalObjects.Instance[Phoenix.Shared.Variables.GlobalObjectNames.AdGbBankControl];   //#76048
        private AdRmControl _adRmControl;   //#180274 

        TlAcctDetails passbookAcctDetails = null;
        private GbBondPurchase _gbBondPurchase = null; //#76047
        private Phoenix.BusObj.Misc.CustomerSearch _acctSearchBusObj = new CustomerSearch(); // #80615
        private Phoenix.BusObj.Admin.Teller.AdTlForm _adTlForm = new Phoenix.BusObj.Admin.Teller.AdTlForm(); // #80615
        private Phoenix.BusObj.Admin.Global.AdGbInventoryType _adGbInventoryType = new AdGbInventoryType(); //#140772
        private ArrayList _tempInventoryItems = new ArrayList();    //#21549
        private Phoenix.BusObj.Global.GbBondRedemptHistory bondHistObj = new GbBondRedemptHistory();

        ArrayList _transForOverride = new ArrayList();  //#79314
        ReceiptDeliveryInstruction myInstruction = new ReceiptDeliveryInstruction();    //#194535
        /*Begin Tas- #65382*/
        Phoenix.Client.WorkQueue.AlertForProductOffer objAlert = new Phoenix.Client.WorkQueue.AlertForProductOffer();
        Form frmTltrn;
        IPhoenixWorkspace curWkspace;
        /*End Tas- #65382*/
        #endregion

        private bool isRmSumInvoked = false; //111762
        public IQuickTranWindow _quickTranWindow;  //Task#87717
        //EasyCaptureTranSet _easyCaptureTranSet;     // #87731
        SemaphoreSlim _semaphoreSlim = new SemaphoreSlim(1, 1); // #87731


        //Begin Task#89976
        public DataRow QuickAccountSelectedRow { get; set; }
        public bool quickAccountGridPopulated = false;
        //End Task#89976
        public bool isTransactionGridPopulated { get; set; }  //Bug #109821
        public int RmAcctPtid { get; set; } //Task#89967

        //Begin Task#89981
        public string CrossRefSearchAcct { get; set; }
        public string CrossRefSearchMapAcctNo { get; set; }
        public string CrossRefSearchMapAcctType { get; set; }
        //End Task#89981
        
        public bool RefreshCustLookupGrid { get; set; }

        #region control objects
        private ArrayList amtFields = new ArrayList();
        private ArrayList hiddenFields = new ArrayList();
        private ArrayList miscTCFields = new ArrayList();
        private ArrayList miscAcctFields = new ArrayList();
        private ArrayList iconFields = new ArrayList();
        private Hashtable acctsTrackHash = new Hashtable();	//Begin Enh# 69248
        private Control focusControlAfterOnUs = null;
        private Control focusControlAfterTransit = null;    //#79572
        private PComboBoxStandard drawerCombo = null;
        private Control focusAcctField = null;
        private DialogResult dialogResult = DialogResult.None;
        private DialogResult dialogResultOdCc = DialogResult.None;
        private Control vldnFailedCntrl = null;
        private Control calcControl = null;
        private PAction bondAction;
        private PAction tcdAction; //#72916TBD
        private Control lastFocussedField = null;
        private Control lastActiveControl = null;
        private Control prevLastActiveControl = null;
        private ArrayList notePtids = new ArrayList();	//#4889
        private AutoCompleteStringCollection OffsetNickNameList = new AutoCompleteStringCollection();   //26537
        #endregion

        #region bool
        private bool processingEvent = false;
        private bool showRetirement = false;
        private bool enableAddNext = true;
        private bool acctHasPostAccessOnly = false;
        private bool acctHasViewAcesssOnly = false;
        private bool acctTypeSrch = false;
        private bool eventInitialized = false;
        private bool populatePending = false;
        private bool processingSelectTran = false;
        private bool forceFetchRim = false;
        private bool msgrPopped = false;	//Begin Enh# 69248
        private bool cTRRequired = false;
        private bool triggerOwnBehalf = false;
        private bool isTranferTran = false;
        private bool passbookPending = false;
        private bool processingPrint = false;
        private bool cTRDeferred = false;
        private bool saveActionType = false;
        private bool addNextCashInTriggered = false;
        private bool ovrdTriggered = false;
        private bool postCashOutTriggered = false;
        private bool tcdDispenseTriggered = false;
        private bool postTcdCashOutTriggered = false;
        private bool printPending = false;
        private bool canReprint = false;
        private bool showNotes = false;
        private bool showItemField = false;
        private bool formLostFocus = false;
        private bool postCashInTriggered = false;
        private bool isTcdDispenseFailed = false;
        private bool isHotKey = false; //#76430
        private bool _isTcdToggleWarningShown = false;
        private bool _isOkToBlockF1Key = false;
        private bool sharePrimaryCheck = false; //#76029
        private bool _isWaiveSigWarningShown = false; //#76033
        private bool _isFormRecalcPmtHistoryClosed = true; //#76425
        private bool _isFormRecalcPmtHistoryInvoked = false; //#76425
        private bool _isSwitchedToRim = false;
        private bool _isRevDepositPerformed = false;
        private bool _loadCustSummary = false;
        private bool _fromAddNext = false;
        private bool _fromDpRedempCalc = false;     // Input Tran can be launched from CD Redemp Calc. Window behaviour different.
        private bool _isForceDeviceReset = false;   //#9142
        private bool _tranPostingAttempted = false; //#9433
        private bool rimRestrictTfrAcct;        //74778
        private bool myPost;
        private bool gotAccts = false;
        private bool notePtidFound = false;				//#4889
        private bool acquirerWinOkToClose = false;
        private bool acquirerTransactorCollected = false;
        private bool closeFormOnComplete = false;
        private bool acquirerTranIsOwner = false;
        private bool transactorWindowCalled = false;		//found out while testing #9503
        public bool isNonCustAllowed = false;	//#9320
        private bool _bAcProcFraudEnabled = false;//92056
        private bool closedWkspace = false;
        private bool _hadCheckPrintingError = false; // #9723
        //Begin #79510, #09614
        bool acquirerEnableTCR = false;
        bool acquirerEnableTCD = false;
        bool _fromRelMgmtSummary = false;   //#8609
        //End #79510, #09614
        bool _bRegDOnUsAcct = false;        //#80621
        bool isBlocked = false; //WI#11021
        private bool _isSupervisorViewOnlyMode = false; //#79314
		private bool bPenaltyIsNull = false;	// WI#12051
        private bool ovrdSig = false; //#12619
        private bool _printBalances = true; // #79502
        private string _printBalOption = null; // #79502
        private bool _printPrimaryBalances = true; // #79502
        private bool _printTfrBalances = true; // #79502
        private bool _promptBalances = false; // #79502
        private bool _balancesAlreadyPrompted = false; // #79502
        private bool _tcdConnBeforeAcquirerTranPosting = false; //#11655
        private bool populateGridWithSavedRim = false; //#13182/#13183
        private bool tfracctHasPostAccessOnly = false; //14286
        private bool tfracctHasViewAcesssOnly = false; //14286
        private bool isTranView = false;                //13697
        private bool isTfrAcct;                 // WI#16236
        //Begin #140780
        private bool bODPMsgDisplayed = false;
        private bool bRegdExceeded = false;
        //End #140780
        private bool _isInventoryPurchaseVerified = true;   //#140772
        //private bool _isEnableBondAction = false;   //#140798 #29211
        private bool _jointRimsShownForTellerCapture = false;	//#34401
        private bool _jointRimsShownForCrossRef = false;    //#38637
        private bool isPrintRequired = false;    //#43143 Do not disable the email radio button in dlgReceiptInfo
        private bool isReadOnly = false;      //#42567 Do not disable screen edits in dlgReceiptInfo
        private bool _turnOffWaitCursor = false; //121713-#7
        #endregion

        #region string
        private string holdTlTranCode;  // #8096
        private string searchAcctType = null;
        private string searchAcctNo = null;
        private string invalidAcctNo;
        private string focusField = "";
        private string cashDenomCallType = null;
        private string cTRPtids = null;
        private string gLSearchAcctNo = null;
        private string _idsSignedArchieved = "";    //#76033
        private string _mlTitle1Label = ""; //#3757
        private string _mlTitle2Label = ""; //#3757
        private string myPostAccess = string.Empty;    //#5700
        private string myEditAccess = string.Empty;    //#5700
        private string acquirerResponseXml = null;
        private string MailerStatus = null; // #80615
        private string _printCustName = null; // #80615
        private string _myPostAccessAddNext = string.Empty;    //#10495
        private string _myEditAccessAddNext = string.Empty;    //#10495
        private string nickName; // #13269
        private string emailAddress = string.Empty; //#194535
        private string myLogicalService = string.Empty; //#194535
        //private string rimName = ""; //#14630 //16278 commented this
        public const string PRINTANDEMAIL = "Print and Email";  //#194535
        public const string EMAIL = "Email";                    //#194535
        public const string PRINT = "Print";                    //#194535
        //Begin Bug#92189
        public string colHistorySupport = null;
        public string colAdapterType = null;
        public string colCrTcSupport = null;
        public string colDrTcSupport = null;
        //End Bug#92189
        #endregion

        #region decimal
        private decimal _historyPtid = Decimal.MinValue; //#76425
        private decimal _totalCashOutAmount;
        private decimal _archivePtid = decimal.MinValue; // #80615
        private decimal _calcAmt = 0;
        private decimal _calcPen = 0;
        private int _totalInventoryItems = 0;
        private decimal _prevInvItemAmt = 0;
        #endregion

        #region int
        private int _myRim;
        private int _holdRimNo = -1;					// #5002
        private int acquirerCashInTranIndex = 0;
        private int _lastSearchRimNo = -1;
        private int searchRimNo = 0;
        private int prevTabSelection = 0;
        private int controlLocXShift = -1;
        private int labelLocXShift = -1;
        private int curTranIndex = -1;
        private int cTRTranNo = -1;
        private int cTRPTID = -1;
        private int passbookTranNo = -1;
        private int failedTran = 0;
        private int formId = -1;
        private int workSpaceWinCount = -1;
        private int _refreshPassbook = -1;
        private int _mtTranCount = 0; // #80615
        private int _printRimNo = 0; // #80615

        private DpRedempCalc _dpRedempCalc;

        private int CurRimNo = 0; /*WI#11021c*/
        #endregion
		public PAction pbEditNonCust;
        private POutlookBar onUsBar;

        private PString _nOCDfiAcctNo = new PString("NocDfiAcctNo"); //#14251

        private PInt _nOCCount = new PInt("NOCCount"); // #14251
        private PInt _nOCRimNo = new PInt("NOCRimNo"); // #14251
        public static string HK_RimNO = null; //#76430 make visible to parent
        public PSmallInt _RimRestrictLevel = new PSmallInt();/*11396*/


        #region public Property //#142717
        public bool IsUIPrefSet { get; set; }
        #endregion
        private string getAcctSearchAcctType = null;      // #17047
        private string getAcctSearchAcctNo = null;        // #17047
        private ContextMenu cmInventory;

        //private decimal packetIdent;                  // #23981
        //private string workPacketId = string.Empty;   // #23981

        private TellerCapture _tellerCapture = null;  //#140895

        private bool _tranSetPopulating = false;    // #140895-ReadOnly
        private ArrayList _tellerCaptureReadOnlyFields = null;  // #140895-ReadOnly
        private bool _creatingTlCaptureTranSet = false;    // #140895
        private int _curCreateTlCaptureTranIndex = -1;  // #140895
        private bool _triggeredCashInOnPostTlCapture = false;    // #140895
        private ArrayList _popUpWindows = null;      // #140895
        private string _clearAllActionLabel = null;  // #140895
        private bool _tlCaptureForceAddNextForLastTran = false;  // #140895
        private bool _tlCaptureAVTCSilentMode = false;  // #140895
        private string _tlCaptureTranXML = null;    // #140895
        private bool _tlCaptureResendingAVTCTran = false;   // #140895
        private Keys _tlCaptureNoDeviceDebugKey = Keys.Control | Keys.Shift | Keys.T;   // #140895
        private bool _tlCaptureNoDeviceDebugMode = false;   // #140895
        private bool _tlCaptureBulkModePosting = false;    // #140895 - Bulk Mode
        private bool _tlCaptureBulkOptionClicked = false; // #140895 - Bulk Mode
        private short _tlCaptureBulkPostStatus = -1; // #140895 - Bulk Mode
        private bool _revDueToAmtMismatch = false;   //#140895
        private TlCaptureScanItem _tlCaptureErrorItem = null;    //#140895
        private bool _skipDisposeCleanUp = false;   // #40977
        private bool _eReceiptClick = false;   //#40787
        private bool tellerCaptureMemo = false; //#50964
        private bool IsNonCustCTR = false;//Task#70707//Bug#73424//Task#56865
        private bool _isOvRunning = false; //Task #90001
        private bool _isHardHoldNoticePending = true;
        private DateTime viewTimeIn = DateTime.MinValue;//Bug#115201
        private DateTime checkTimeIn = DateTime.MinValue;//Bug#115682
        private bool isAudit = false;//Bug#115682
        private bool isTabAudit = false;//Bug#115682
        private int _previousTab = -1; //Bug #104269
        private Dictionary<PAction, bool> _previousActionPanelsButtonsValue = null; //Bug #104269
        InputParamTranSet _inputParamTranSet = null;    // #TellerWF
        bool _invokedByWorkflow = false;    // #TellerWF
        bool _isWindowShown = false;    // #UI Refresh

        private object _tempExceptionHoldInfo;  //Task #134375

        #endregion

        #region Merged Application Variable
        //Begin #60647
        private int atmMemberNo;
        private string parentAcctNo;
        private string parentAcctType;
        private int parentRimNo;
        private string DpAllowMultiInt = "N";
        private int DpcheckId;
        private Boolean DpOdpEnabled = false;
        private string DpIbaCr = "Y";
        private int DpAcctRowVersion = 1;
        private bool acctChanged = true;
        private int LnAcctRowVersion = 1;
        private string LnAllowMultiInt = "N";
        private string LaserproTransNumber = ""; //113992
        bool bRimEditAccess;
        bool bRimPostAccess;
        //Begin 61240
        private string BillPaymentAcctNo = "";
        private string BillPaymentAcctType = "";
        private int historyPtid;
        private int gnTemp = 0;
        //End 61240
        private string atmPanNo;
        bool bRenewal = false;
        bool bSdVisit = true;
        bool isCreateDisplayWindow = false; //#60671
        bool isDirectWindowAccess = false;// #60674.
        private bool _pbIsTeller = false;  //#73903 This flag is used to set module name as Teller if formname is Tltrancode.
        //    private Phoenix.BusObj.Admin.RIM.AdRmControl _adRmControlBusObj; //73409
        bool showDisplayWindow = false; //#75074
        Phoenix.Shared.Variables.AcctInfo quickAcctInfo = new Phoenix.Shared.Variables.AcctInfo(); //89989

        Phoenix.BusObj.Admin.Teller.AdTlTc _adtlTc = new Phoenix.BusObj.Admin.Teller.AdTlTc(); //87757-2

        //Begin 92498
        bool _quickTabFocusedOnSave = false; 
        bool _tabOnSave = false;
        //End 92498

        bool _bIncQuickTCs = false;    //95645 
        private ArrayList _myCachedMTAcctInfo = new ArrayList();    //#122798

        bool EnableUmbCode60 = false; //126205

        private int EmpRestrictId
        {
            get { return this.Workspace.Variables.ContainsKey("RestrictId") ? Convert.ToInt32(this.Workspace.Variables["RestrictId"]) : 0; }
        }
        //End #60647
        private ContextMenu cmRimDirectMenu;        //#60620. Cust Direct Flyout
        #endregion

        #region Constructor
        public frmTlTranCode()
        {
            SelectFirstControl = false; //Bug #114526
            //
            // Required for Windows Form Designer support
            //
            InitializeComponent();
            this.SupportedActions |= StandardAction.Save | StandardAction.AddNext;

            //
            // TODO: Add any constructor code after InitializeComponent call
            //

            ShowNotes = false;
        }

        #endregion

        #region Destructor
        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if (components != null)
                {
                    components.Dispose();
                }

                //Begin #40977
                if (_skipDisposeCleanUp)
                    return;
                //End #40977

                //#32833- Aggressive Clearing
                if (_tlTranSet != null)
                    _tlTranSet = null;
                if (PrintInfoArray != null)
                    PrintInfoArray = null;

                if (frmGloAccountListRim != null)
                    frmGloAccountListRim = null;

                if (frmTBarSearch != null)
                    frmTBarSearch = null;

                
                if (hiddenFields != null)
                    hiddenFields = null;

                if (amtFields != null)
                    amtFields = null;

                if (miscTCFields != null)
                    miscTCFields = null;

                if (miscAcctFields != null)
                    miscAcctFields = null;

                if (acctsTrackHash != null)
                    acctsTrackHash = null;

                if (notePtids != null)
                    notePtids = null;

                if (OffsetNickNameList != null)
                    OffsetNickNameList = null;

                if (_gbMemo != null)
                    _gbMemo = null;

                if (_tlDrawer != null)
                    _tlDrawer = null;

                if (_dpAcct != null)
                    _dpAcct = null;

                if (_dpDisplay != null)
                    _dpDisplay = null;


                if (_pcCustomOptions != null)
                    _pcCustomOptions = null;


                if (_tlJournalAddlInfo != null)
                    _tlJournalAddlInfo = null;

                if (_acctSearchBusObj != null)
                    _acctSearchBusObj = null;

                if (_adTlForm != null)
                    _adTlForm = null;

                if (_adGbInventoryType != null)
                    _adGbInventoryType = null;

                if (_tempInventoryItems != null)
                    _tempInventoryItems = null;

                if (_transForOverride != null)
                    _transForOverride = null;

                if (_popUpWindows != null)
                    _popUpWindows = null;
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Windows Form Designer generated code
        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            Phoenix.FrameWork.Core.ControlInfo controlInfo1 = new Phoenix.FrameWork.Core.ControlInfo();
            Phoenix.FrameWork.Core.ControlInfo controlInfo2 = new Phoenix.FrameWork.Core.ControlInfo();
            Phoenix.FrameWork.Core.ControlInfo controlInfo3 = new Phoenix.FrameWork.Core.ControlInfo();
            Phoenix.FrameWork.Core.ControlInfo controlInfo4 = new Phoenix.FrameWork.Core.ControlInfo();
            Phoenix.FrameWork.Core.ControlInfo controlInfo5 = new Phoenix.FrameWork.Core.ControlInfo();
            Phoenix.FrameWork.Core.ControlInfo controlInfo6 = new Phoenix.FrameWork.Core.ControlInfo();
            this.picTabs = new Phoenix.Windows.Forms.PTabControl();
            this.Name0 = new Phoenix.Windows.Forms.PTabPage();
            this.dfTransactionInformation = new Phoenix.Windows.Forms.PGroupBoxStandard();
            this.cmbInventoryPacket = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.dfInvSerialNo = new Phoenix.Windows.Forms.PdfStandard();
            this.dfNoInvAvailable = new Phoenix.Windows.Forms.PdfStandard();
            this.lblNoInvAvailable = new Phoenix.Windows.Forms.PLabelStandard();
            this.lblPacket = new Phoenix.Windows.Forms.PLabelStandard();
            this.cmbInventoryType = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.lblInventoryType = new Phoenix.Windows.Forms.PLabelStandard();
            this.lblCalcWh = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfWithholdingAmt = new Phoenix.Windows.Forms.PdfCurrency();
            this.cmbLnEscrowAgent = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.lblLnEscrowAgent = new Phoenix.Windows.Forms.PLabelStandard();
            this.onUsBar = new Phoenix.Windows.Forms.POutlookBar();
            this.lblTlItemRoutingNo = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfTlItemRoutingNo = new Phoenix.Windows.Forms.PdfStandard();
            this.dfTlItemCheckNo = new Phoenix.Windows.Forms.PdfStandard();
            this.lblTlItemCheckNo = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfTlItemAcctNo = new Phoenix.Windows.Forms.PdfStandard();
            this.lblTlItemAcctNo = new Phoenix.Windows.Forms.PLabelStandard();
            this.lblChannel = new Phoenix.Windows.Forms.PLabelStandard();
            this.cbRegD = new Phoenix.Windows.Forms.PCheckBoxStandard();
            this.cmbChannel = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.cmbOnUsTc = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.lblOnUsTc = new Phoenix.Windows.Forms.PLabelStandard();
            this.lblRecalcPmtDt = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfRecalcPmt = new Phoenix.Windows.Forms.PDfDisplay();
            this.lblRecalcPmt = new Phoenix.Windows.Forms.PLabelStandard();
            this.cmbRecalcPmtDt = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.cbWaiveSignature = new Phoenix.Windows.Forms.PCheckBoxStandard();
            this.lblOnUsTitle2 = new Phoenix.Windows.Forms.PLabelStandard();
            this.lblOnUsTitle1 = new Phoenix.Windows.Forms.PLabelStandard();
            this.cbDenominate = new Phoenix.Windows.Forms.PCheckBoxStandard();
            this.picDrawer = new System.Windows.Forms.PictureBox();
            this.picTCD = new System.Windows.Forms.PictureBox();
            this.picMemo = new System.Windows.Forms.PictureBox();
            this.picRealTime = new System.Windows.Forms.PictureBox();
            this.dfTranEffectiveDt = new Phoenix.Windows.Forms.PdfStandard();
            this.lblEffective = new Phoenix.Windows.Forms.PLabelStandard();
            this.cbPassDesc = new Phoenix.Windows.Forms.PCheckBoxStandard();
            this.cbTfrPbPresent = new Phoenix.Windows.Forms.PCheckBoxStandard();
            this.cmbTCDDrawer = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.lblTCDDrawer = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfDifference = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblDifference = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfTotalCredits = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblTotalCredits = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfTotalDebits = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblTotalDebits = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfPenaltyAmt = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblPenalty = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfInterestPaid = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblInterestPaid = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfCCAmt = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblFeeAmount = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfCheckNo = new Phoenix.Windows.Forms.PdfStandard();
            this.lblItems = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfAmtEq = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblForeignAmount = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfPostingExchRate = new Phoenix.Windows.Forms.PdfStandard();
            this.lblRate = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfAmt = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblAmount = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfCashOut = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblCashOut = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfTransitChks = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblTransitChecks = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfTfrCheckNo = new Phoenix.Windows.Forms.PdfStandard();
            this.lblCheck = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfTfrAcctNo = new Phoenix.Windows.Forms.PdfStandard();
            this.lblTfrAcctNo = new Phoenix.Windows.Forms.PLabelStandard();
            this.cmbTfrAcctType = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.dfOnUsChks = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblOnUsChecks = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfChksAsCash = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblChecksAsCash = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfCashIn = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblCashIn = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfRefAcctNo = new Phoenix.Windows.Forms.PdfStandard();
            this.lblRefAcctNo = new Phoenix.Windows.Forms.PLabelStandard();
            this.cmbRefAcctType = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.lblRefAccount = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfReference = new Phoenix.Windows.Forms.PdfStandard();
            this.lblReference = new Phoenix.Windows.Forms.PLabelStandard();
            this.cmbUtility = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.dfTranDescription = new Phoenix.Windows.Forms.PdfStandard();
            this.lblDescription = new Phoenix.Windows.Forms.PLabelStandard();
            this.cmbExchCrncy = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.lblExchCurrency = new Phoenix.Windows.Forms.PLabelStandard();
            this.cmbTranCode = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.dfQuickTranCode = new Phoenix.Windows.Forms.PdfStandard();
            this.lblTranCode = new Phoenix.Windows.Forms.PLabelStandard();
            this.cmbRegCC = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.cmbEndPoint = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.cmbUmbCode = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.dfUMBCode = new Phoenix.Windows.Forms.PdfStandard();
            this.lblUMBCode = new Phoenix.Windows.Forms.PLabelStandard();
            this.lblUtility = new Phoenix.Windows.Forms.PLabelStandard();
            this.lblDraweeBank = new Phoenix.Windows.Forms.PLabelStandard();
            this.lblIRACategory = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfOnUsSignatures = new Phoenix.Windows.Forms.PdfStandard();
            this.dfOnUsTitle1 = new Phoenix.Windows.Forms.PdfStandard();
            this.dfOnUsTitle2 = new Phoenix.Windows.Forms.PdfStandard();
            this.gbAccountInformation = new Phoenix.Windows.Forms.PGroupBoxStandard();
            this.lblNonCustomer = new Phoenix.Windows.Forms.PLabelStandard();
            this.cbPayrollTran = new Phoenix.Windows.Forms.PCheckBoxStandard();
            this.dfAcctNickname = new Phoenix.Windows.Forms.PDfDisplay();
            this.panelAvailBal = new System.Windows.Forms.Panel();
            this.dfColBal = new Phoenix.Windows.Forms.PDfDisplay();
            this.lblColBal = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfCurBal = new Phoenix.Windows.Forms.PDfDisplay();
            this.lblCurBal = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfAvailBal = new Phoenix.Windows.Forms.PDfDisplay();
            this.lblAvailBal = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfAcctId = new Phoenix.Windows.Forms.PdfStandard();
            this.dfBatchID = new Phoenix.Windows.Forms.PdfStandard();
            this.pdfInfo = new System.Windows.Forms.RichTextBox();
            this.dfTitle2 = new Phoenix.Windows.Forms.PdfStandard();
            this.lblTitle2 = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfTitle1 = new Phoenix.Windows.Forms.PdfStandard();
            this.lblTitle1 = new Phoenix.Windows.Forms.PLabelStandard();
            this.cmbCrncy = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.cbPbPresent = new Phoenix.Windows.Forms.PCheckBoxStandard();
            this.dfAcctNo = new Phoenix.Windows.Forms.PdfStandard();
            this.lbl = new Phoenix.Windows.Forms.PLabelStandard();
            this.cmbAcctType = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.dfTabTitle0 = new Phoenix.Windows.Forms.PdfStandard();
            this.dfTabTitle4 = new Phoenix.Windows.Forms.PdfStandard();
            this.dfTabTitle3 = new Phoenix.Windows.Forms.PdfStandard();
            this.dfTabTitle1 = new Phoenix.Windows.Forms.PdfStandard();
            this.lblCurrency = new Phoenix.Windows.Forms.PLabelStandard();
            this.lblAccount = new Phoenix.Windows.Forms.PLabelStandard();
            this.cbRetirement = new Phoenix.Windows.Forms.PCheckBoxStandard();
            this.Name1 = new Phoenix.Windows.Forms.PTabPage();
            this.gbTransactionSet = new Phoenix.Windows.Forms.PGroupBoxStandard();
            this.dfDifference1 = new Phoenix.Windows.Forms.PdfCurrency();
            this.ctwTranSet = new Phoenix.Windows.Forms.PGrid();
            this.colRimNo = new Phoenix.Windows.Forms.PGridColumn();
            this.colAccount = new Phoenix.Windows.Forms.PGridColumn();
            this.colAcctNickname = new Phoenix.Windows.Forms.PGridColumn();
            this.colTranDesc = new Phoenix.Windows.Forms.PGridColumn();
            this.colComponents = new Phoenix.Windows.Forms.PGridColumn();
            this.colCompAmts = new Phoenix.Windows.Forms.PGridColumn();
            this.colActualRate = new Phoenix.Windows.Forms.PGridColumn();
            this.colExchRate = new Phoenix.Windows.Forms.PGridColumn();
            this.colEquivAmt = new Phoenix.Windows.Forms.PGridColumn();
            this.colEquivAmtStr = new Phoenix.Windows.Forms.PGridColumn();
            this.colTfrAccountInfo = new Phoenix.Windows.Forms.PGridColumn();
            this.colDescription = new Phoenix.Windows.Forms.PGridColumn();
            this.colReference = new Phoenix.Windows.Forms.PGridColumn();
            this.colTranIndex = new Phoenix.Windows.Forms.PGridColumn();
            this.lblDifference1 = new Phoenix.Windows.Forms.PLabelStandard();
            this.lblTotalDebits1 = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfTotalCredits1 = new Phoenix.Windows.Forms.PdfCurrency();
            this.dfTotalDebits1 = new Phoenix.Windows.Forms.PdfCurrency();
            this.lblTotalCredits1 = new Phoenix.Windows.Forms.PLabelStandard();
            this.Name2 = new Phoenix.Windows.Forms.PTabPage();
            this.Name3 = new Phoenix.Windows.Forms.PTabPage();
            this.Name4 = new Phoenix.Windows.Forms.PTabPage();
            this.gbPrintOptions = new Phoenix.Windows.Forms.PGroupBoxStandard();
            this.dfObjectInput = new Phoenix.Windows.Forms.PdfStandard();
            this.dfTabTitle2 = new Phoenix.Windows.Forms.PdfStandard();
            this.cmbPassbookType = new Phoenix.Windows.Forms.PComboBoxStandard();
            this.lblPassbookType = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfPbLines = new Phoenix.Windows.Forms.PdfStandard();
            this.lblNumberoflinesinthepassbook = new Phoenix.Windows.Forms.PLabelStandard();
            this.gbUnbookedItems = new Phoenix.Windows.Forms.PGroupBoxStandard();
            this.twPassbook = new Phoenix.Windows.Forms.PGrid();
            this.colEffectiveDt = new Phoenix.Windows.Forms.PGridColumn();
            this.colTCDescription = new Phoenix.Windows.Forms.PGridColumn();
            this.colDeposit = new Phoenix.Windows.Forms.PGridColumn();
            this.colWithdrawal = new Phoenix.Windows.Forms.PGridColumn();
            this.colPbBalance = new Phoenix.Windows.Forms.PGridColumn();
            this.gbAccountInfo = new Phoenix.Windows.Forms.PGroupBoxStandard();
            this.lbPbAcctType = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfEndingBalance = new Phoenix.Windows.Forms.PDfDisplay();
            this.lblEndingBalance = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfUnbookedWithdrawals = new Phoenix.Windows.Forms.PDfDisplay();
            this.lblUnbookedWithdrawals = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfUnbookedDeposits = new Phoenix.Windows.Forms.PDfDisplay();
            this.lblUnbookedDeposits = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfPbBalance = new Phoenix.Windows.Forms.PDfDisplay();
            this.lblPassbookBalance = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfPbTitle2 = new Phoenix.Windows.Forms.PdfStandard();
            this.lblPbTitle2 = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfPbTitle1 = new Phoenix.Windows.Forms.PdfStandard();
            this.lblPbTitle1 = new Phoenix.Windows.Forms.PLabelStandard();
            this.dfPbAcctNo = new Phoenix.Windows.Forms.PdfStandard();
            this.dfPbAcctType = new Phoenix.Windows.Forms.PdfStandard();
            this.lblPbAcctNo = new Phoenix.Windows.Forms.PLabelStandard();
            this.tabEasyCapture = new Phoenix.Windows.Forms.PTabPage();
            this.dfOnUsAlerts = new Phoenix.Windows.Forms.PdfStandard();
            this.pbSelectTran = new Phoenix.Windows.Forms.PAction();
            this.pbNOCHistory = new Phoenix.Windows.Forms.PAction();
            this.pbLastAcct = new Phoenix.Windows.Forms.PAction();
            this.pbCashIn = new Phoenix.Windows.Forms.PAction();
            this.pbCashOut = new Phoenix.Windows.Forms.PAction();
            this.pbTCDDenom = new Phoenix.Windows.Forms.PAction();
            this.pbItemCapture = new Phoenix.Windows.Forms.PAction();
            this.pbFees = new Phoenix.Windows.Forms.PAction();
            this.pbDisplay = new Phoenix.Windows.Forms.PAction();
            this.pbHistory = new Phoenix.Windows.Forms.PAction();
            this.pbRestrictions = new Phoenix.Windows.Forms.PAction();
            this.pbGetGLAcct = new Phoenix.Windows.Forms.PAction();
            this.pbRemoveTran = new Phoenix.Windows.Forms.PAction();
            this.pbSearch = new Phoenix.Windows.Forms.PAction();
            this.pbSelectSearch = new Phoenix.Windows.Forms.PAction();
            this.pbSelectAcct = new Phoenix.Windows.Forms.PAction();
            this.pbSelectRIM = new Phoenix.Windows.Forms.PAction();
            this.pbUpdatePB = new Phoenix.Windows.Forms.PAction();
            this.pbSkip = new Phoenix.Windows.Forms.PAction();
            this.pbClearAll = new Phoenix.Windows.Forms.PAction();
            this.pbSeparator1 = new Phoenix.Windows.Forms.PAction();
            this.iconSweep = new Phoenix.Windows.Forms.PAction();
            this.iconCaution = new Phoenix.Windows.Forms.PAction();
            this.iconHold = new Phoenix.Windows.Forms.PAction();
            this.iconRetirement = new Phoenix.Windows.Forms.PAction();
            this.iconStop = new Phoenix.Windows.Forms.PAction();
            this.iconNSF = new Phoenix.Windows.Forms.PAction();
            this.iconREJ = new Phoenix.Windows.Forms.PAction();
            this.iconUCF = new Phoenix.Windows.Forms.PAction();
            this.iconRealTime = new Phoenix.Windows.Forms.PAction();
            this.iconSigner = new Phoenix.Windows.Forms.PAction();
            this.iconOnUsSigner = new Phoenix.Windows.Forms.PAction();
            this.iconOnUsAnalysis = new Phoenix.Windows.Forms.PAction();
            this.iconOnUsCaution = new Phoenix.Windows.Forms.PAction();
            this.iconOnUsNotes = new Phoenix.Windows.Forms.PAction();
            this.iconOnUsStop = new Phoenix.Windows.Forms.PAction();
            this.iconOnUsSweep = new Phoenix.Windows.Forms.PAction();
            this.iconOnUsHold = new Phoenix.Windows.Forms.PAction();
            this.iconOnUsAcctRegD = new Phoenix.Windows.Forms.PAction();
            this.iconAnalysis = new Phoenix.Windows.Forms.PAction();
            this.pbMakeBreakStrap = new Phoenix.Windows.Forms.PAction();
            this.pbCDRedemp = new Phoenix.Windows.Forms.PAction();
            this.pbChkTCDStatus = new Phoenix.Windows.Forms.PAction();
            this.pbOnUsDisplay = new Phoenix.Windows.Forms.PAction();
            this.pbOnUsSig = new Phoenix.Windows.Forms.PAction();
            this.pbPrintMailer = new Phoenix.Windows.Forms.PAction();
            this.pbOnUs = new Phoenix.Windows.Forms.PAction();
            this.picSignature = new System.Windows.Forms.PictureBox();
            this.cmOnUs = new System.Windows.Forms.ContextMenu();
            this.pbACHFut = new Phoenix.Windows.Forms.PAction();
            this.pbBondPurchase = new Phoenix.Windows.Forms.PAction();
            this.pbIrsRpt = new Phoenix.Windows.Forms.PAction();
            this.pbInstChkSrch = new Phoenix.Windows.Forms.PAction();
            this.pbReset = new Phoenix.Windows.Forms.PAction();
            this.pbAddNonCust = new Phoenix.Windows.Forms.PAction();
            this.pbEditNonCust = new Phoenix.Windows.Forms.PAction();
            this.pbGetAcct = new Phoenix.Windows.Forms.PAction();
            this.pbInventory = new Phoenix.Windows.Forms.PAction();
            this.pbPendingCC = new Phoenix.Windows.Forms.PAction();
            this.pbVod = new Phoenix.Windows.Forms.PAction();
            this.pbRelationship = new Phoenix.Windows.Forms.PAction();
            this.pbOnUsMisc = new Phoenix.Windows.Forms.PAction();
            this.pbInventoryMisc = new Phoenix.Windows.Forms.PAction();
            this.pbeReceipt = new Phoenix.Windows.Forms.PAction();
            this.pbeReceiptMisc = new Phoenix.Windows.Forms.PAction();
            this.pbPrintMailerMisc = new Phoenix.Windows.Forms.PAction();
            this.pbNOCHistoryMisc = new Phoenix.Windows.Forms.PAction();
            this.pbSeperatorCust = new Phoenix.Windows.Forms.PAction();
            this.pbRim = new Phoenix.Windows.Forms.PAction();
            this.pbRimDisplay = new Phoenix.Windows.Forms.PAction();
            this.pbRimHistory = new Phoenix.Windows.Forms.PAction();
            this.pbRimAchFuture = new Phoenix.Windows.Forms.PAction();
            this.pbPortfolio = new Phoenix.Windows.Forms.PAction();
            this.pbRimDirect = new Phoenix.Windows.Forms.PAction();
            this.pbSeperatorTeller = new Phoenix.Windows.Forms.PAction();
            this.pbMisc = new Phoenix.Windows.Forms.PAction();
            this.cmTellerMiscMenu = new System.Windows.Forms.ContextMenu();
            this.cmRimDirectMenu = new System.Windows.Forms.ContextMenu();
            this.pbSeperatorAcct = new Phoenix.Windows.Forms.PAction();
            this.pbEdit = new Phoenix.Windows.Forms.PAction();
            this.cmDpDirectMenu = new System.Windows.Forms.ContextMenu();
            this.pbDirectAcct = new Phoenix.Windows.Forms.PAction();
            this.cmLnDirectMenu = new System.Windows.Forms.ContextMenu();
            this.cmAtmDirectMenu = new System.Windows.Forms.ContextMenu();
            this.cmNewAcctMenu = new System.Windows.Forms.ContextMenu();
            this.cmExHistoryMenu = new System.Windows.Forms.ContextMenu();
            this.cmServicingMenu = new System.Windows.Forms.ContextMenu();
            this.miExHistory = new Phoenix.Windows.Forms.PAction();
            this.miTcLog = new Phoenix.Windows.Forms.PAction();
            this.pbUmbrella = new Phoenix.Windows.Forms.PAction();
            this.pbArchive = new Phoenix.Windows.Forms.PAction();
            this.pbNewAcct = new Phoenix.Windows.Forms.PAction();
            this.pbSeperatorServ = new Phoenix.Windows.Forms.PAction();
            this.pbServicing = new Phoenix.Windows.Forms.PAction();
            this.pbEditService = new Phoenix.Windows.Forms.PAction();
            this.pbActionSeperator4 = new Phoenix.Windows.Forms.PAction();
            this.pbSales = new Phoenix.Windows.Forms.PAction();
            this.pActionSepNonCust = new Phoenix.Windows.Forms.PAction();
            this.pActionSepSrchMisc = new Phoenix.Windows.Forms.PAction();
            this.pbAdvancedSep = new Phoenix.Windows.Forms.PAction();
            this.pbAdvancedView = new Phoenix.Windows.Forms.PAction();
            this.pbExceptionHold = new Phoenix.Windows.Forms.PAction();
            this.picTabs.SuspendLayout();
            this.Name0.SuspendLayout();
            this.dfTransactionInformation.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picDrawer)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.picTCD)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.picMemo)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.picRealTime)).BeginInit();
            this.gbAccountInformation.SuspendLayout();
            this.panelAvailBal.SuspendLayout();
            this.Name1.SuspendLayout();
            this.gbTransactionSet.SuspendLayout();
            this.Name4.SuspendLayout();
            this.gbPrintOptions.SuspendLayout();
            this.gbUnbookedItems.SuspendLayout();
            this.gbAccountInfo.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picSignature)).BeginInit();
            this.SuspendLayout();
            // 
            // ActionManager
            // 
            this.ActionManager.Actions.AddRange(new Phoenix.Windows.Forms.PAction[] {
            this.pbSeperatorTeller,
            this.pbClearAll,
            this.pbSeparator1,
            this.pbLastAcct,
            this.pbCashIn,
            this.pbItemCapture,
            this.pbFees,
            this.pbSelectRIM,
            this.pbSelectAcct,
            this.pbRelationship,
            this.pbMisc,
            this.pbSeperatorCust,
            this.pbRim,
            this.pbRimDisplay,
            this.pbRimHistory,
            this.pbRimDirect,
            this.pbSeperatorAcct,
            this.pbEdit,
            this.pbDisplay,
            this.pbHistory,
            this.pbDirectAcct,
            this.pbUmbrella,
            this.pbNewAcct,
            this.pbArchive,
            this.pbSeperatorServ,
            this.pbServicing,
            this.pbActionSeperator4,
            this.pbEditService,
            this.pbSales,
            this.pbRestrictions,
            this.pbGetAcct,
            this.pbBondPurchase,
            this.pbGetGLAcct,
            this.pbRemoveTran,
            this.pbSelectTran,
            this.pbSelectSearch,
            this.pbSearch,
            this.pbTCDDenom,
            this.pbCashOut,
            this.pbUpdatePB,
            this.pbSkip,
            this.pbMakeBreakStrap,
            this.pbChkTCDStatus,
            this.pbReset,
            this.pActionSepNonCust,
            this.pbAddNonCust,
            this.pbEditNonCust,
            this.pActionSepSrchMisc,
            this.pbOnUs,
            this.pbPrintMailer,
            this.pbACHFut,
            this.pbNOCHistory,
            this.pbIrsRpt,
            this.pbInstChkSrch,
            this.pbCDRedemp,
            this.pbInventory,
            this.pbPendingCC,
            this.pbVod,
            this.pbeReceipt,
            this.pbExceptionHold,
            this.pbAdvancedSep,
            this.pbAdvancedView});
            // 
            // NotificationManager
            // 
            this.NotificationManager.Actions.AddRange(new Phoenix.Windows.Forms.PAction[] {
            this.iconSweep,
            this.iconCaution,
            this.iconHold,
            this.iconRetirement,
            this.iconStop,
            this.iconNSF,
            this.iconREJ,
            this.iconUCF,
            this.iconRealTime,
            this.iconSigner,
            this.iconAnalysis});
            // 
            // picTabs
            // 
            this.picTabs.Controls.Add(this.Name0);
            this.picTabs.Controls.Add(this.Name1);
            this.picTabs.Controls.Add(this.Name2);
            this.picTabs.Controls.Add(this.Name3);
            this.picTabs.Controls.Add(this.Name4);
            this.picTabs.Controls.Add(this.tabEasyCapture);
            this.picTabs.DrawMode = System.Windows.Forms.TabDrawMode.Normal;
            this.picTabs.Location = new System.Drawing.Point(0, 0);
            this.picTabs.Name = "picTabs";
            this.picTabs.SelectedIndex = 0;
            this.picTabs.Size = new System.Drawing.Size(690, 448);
            this.picTabs.TabIndex = 0;
            this.picTabs.SelectedIndexChanged += new System.EventHandler(this.picTabs_SelectedIndexChanged);
            this.picTabs.Leave += new System.EventHandler(this.PicTabs_Leave);
            // 
            // Name0
            // 
            this.Name0.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(255)))), ((int)(((byte)(255)))));
            this.Name0.Controls.Add(this.dfTransactionInformation);
            this.Name0.Controls.Add(this.gbAccountInformation);
            this.Name0.Location = new System.Drawing.Point(4, 22);
            controlInfo1.ObjectId = 1;
            this.Name0.MLInfo = controlInfo1;
            this.Name0.Name = "Name0";
            this.Name0.ObjectId = 1;
            this.Name0.Size = new System.Drawing.Size(682, 422);
            this.Name0.TabIndex = 0;
            this.Name0.Text = "Teller Transaction";
            // 
            // dfTransactionInformation
            // 
            this.dfTransactionInformation.Controls.Add(this.cmbInventoryPacket);
            this.dfTransactionInformation.Controls.Add(this.dfInvSerialNo);
            this.dfTransactionInformation.Controls.Add(this.dfNoInvAvailable);
            this.dfTransactionInformation.Controls.Add(this.lblNoInvAvailable);
            this.dfTransactionInformation.Controls.Add(this.lblPacket);
            this.dfTransactionInformation.Controls.Add(this.cmbInventoryType);
            this.dfTransactionInformation.Controls.Add(this.lblInventoryType);
            this.dfTransactionInformation.Controls.Add(this.lblCalcWh);
            this.dfTransactionInformation.Controls.Add(this.dfWithholdingAmt);
            this.dfTransactionInformation.Controls.Add(this.cmbLnEscrowAgent);
            this.dfTransactionInformation.Controls.Add(this.lblLnEscrowAgent);
            this.dfTransactionInformation.Controls.Add(this.onUsBar);
            this.dfTransactionInformation.Controls.Add(this.lblTlItemRoutingNo);
            this.dfTransactionInformation.Controls.Add(this.dfTlItemRoutingNo);
            this.dfTransactionInformation.Controls.Add(this.dfTlItemCheckNo);
            this.dfTransactionInformation.Controls.Add(this.lblTlItemCheckNo);
            this.dfTransactionInformation.Controls.Add(this.dfTlItemAcctNo);
            this.dfTransactionInformation.Controls.Add(this.lblTlItemAcctNo);
            this.dfTransactionInformation.Controls.Add(this.lblChannel);
            this.dfTransactionInformation.Controls.Add(this.cbRegD);
            this.dfTransactionInformation.Controls.Add(this.cmbChannel);
            this.dfTransactionInformation.Controls.Add(this.cmbOnUsTc);
            this.dfTransactionInformation.Controls.Add(this.lblOnUsTc);
            this.dfTransactionInformation.Controls.Add(this.lblRecalcPmtDt);
            this.dfTransactionInformation.Controls.Add(this.dfRecalcPmt);
            this.dfTransactionInformation.Controls.Add(this.lblRecalcPmt);
            this.dfTransactionInformation.Controls.Add(this.cmbRecalcPmtDt);
            this.dfTransactionInformation.Controls.Add(this.cbWaiveSignature);
            this.dfTransactionInformation.Controls.Add(this.lblOnUsTitle2);
            this.dfTransactionInformation.Controls.Add(this.lblOnUsTitle1);
            this.dfTransactionInformation.Controls.Add(this.cbDenominate);
            this.dfTransactionInformation.Controls.Add(this.picDrawer);
            this.dfTransactionInformation.Controls.Add(this.picTCD);
            this.dfTransactionInformation.Controls.Add(this.picMemo);
            this.dfTransactionInformation.Controls.Add(this.picRealTime);
            this.dfTransactionInformation.Controls.Add(this.dfTranEffectiveDt);
            this.dfTransactionInformation.Controls.Add(this.lblEffective);
            this.dfTransactionInformation.Controls.Add(this.cbPassDesc);
            this.dfTransactionInformation.Controls.Add(this.cbTfrPbPresent);
            this.dfTransactionInformation.Controls.Add(this.cmbTCDDrawer);
            this.dfTransactionInformation.Controls.Add(this.lblTCDDrawer);
            this.dfTransactionInformation.Controls.Add(this.dfDifference);
            this.dfTransactionInformation.Controls.Add(this.lblDifference);
            this.dfTransactionInformation.Controls.Add(this.dfTotalCredits);
            this.dfTransactionInformation.Controls.Add(this.lblTotalCredits);
            this.dfTransactionInformation.Controls.Add(this.dfTotalDebits);
            this.dfTransactionInformation.Controls.Add(this.lblTotalDebits);
            this.dfTransactionInformation.Controls.Add(this.dfPenaltyAmt);
            this.dfTransactionInformation.Controls.Add(this.lblPenalty);
            this.dfTransactionInformation.Controls.Add(this.dfInterestPaid);
            this.dfTransactionInformation.Controls.Add(this.lblInterestPaid);
            this.dfTransactionInformation.Controls.Add(this.dfCCAmt);
            this.dfTransactionInformation.Controls.Add(this.lblFeeAmount);
            this.dfTransactionInformation.Controls.Add(this.dfCheckNo);
            this.dfTransactionInformation.Controls.Add(this.lblItems);
            this.dfTransactionInformation.Controls.Add(this.dfAmtEq);
            this.dfTransactionInformation.Controls.Add(this.lblForeignAmount);
            this.dfTransactionInformation.Controls.Add(this.dfPostingExchRate);
            this.dfTransactionInformation.Controls.Add(this.lblRate);
            this.dfTransactionInformation.Controls.Add(this.dfAmt);
            this.dfTransactionInformation.Controls.Add(this.lblAmount);
            this.dfTransactionInformation.Controls.Add(this.dfCashOut);
            this.dfTransactionInformation.Controls.Add(this.lblCashOut);
            this.dfTransactionInformation.Controls.Add(this.dfTransitChks);
            this.dfTransactionInformation.Controls.Add(this.lblTransitChecks);
            this.dfTransactionInformation.Controls.Add(this.dfTfrCheckNo);
            this.dfTransactionInformation.Controls.Add(this.lblCheck);
            this.dfTransactionInformation.Controls.Add(this.dfTfrAcctNo);
            this.dfTransactionInformation.Controls.Add(this.lblTfrAcctNo);
            this.dfTransactionInformation.Controls.Add(this.cmbTfrAcctType);
            this.dfTransactionInformation.Controls.Add(this.dfOnUsChks);
            this.dfTransactionInformation.Controls.Add(this.lblOnUsChecks);
            this.dfTransactionInformation.Controls.Add(this.dfChksAsCash);
            this.dfTransactionInformation.Controls.Add(this.lblChecksAsCash);
            this.dfTransactionInformation.Controls.Add(this.dfCashIn);
            this.dfTransactionInformation.Controls.Add(this.lblCashIn);
            this.dfTransactionInformation.Controls.Add(this.dfRefAcctNo);
            this.dfTransactionInformation.Controls.Add(this.lblRefAcctNo);
            this.dfTransactionInformation.Controls.Add(this.cmbRefAcctType);
            this.dfTransactionInformation.Controls.Add(this.lblRefAccount);
            this.dfTransactionInformation.Controls.Add(this.dfReference);
            this.dfTransactionInformation.Controls.Add(this.lblReference);
            this.dfTransactionInformation.Controls.Add(this.cmbUtility);
            this.dfTransactionInformation.Controls.Add(this.dfTranDescription);
            this.dfTransactionInformation.Controls.Add(this.lblDescription);
            this.dfTransactionInformation.Controls.Add(this.cmbExchCrncy);
            this.dfTransactionInformation.Controls.Add(this.lblExchCurrency);
            this.dfTransactionInformation.Controls.Add(this.cmbTranCode);
            this.dfTransactionInformation.Controls.Add(this.dfQuickTranCode);
            this.dfTransactionInformation.Controls.Add(this.lblTranCode);
            this.dfTransactionInformation.Controls.Add(this.cmbRegCC);
            this.dfTransactionInformation.Controls.Add(this.cmbEndPoint);
            this.dfTransactionInformation.Controls.Add(this.cmbUmbCode);
            this.dfTransactionInformation.Controls.Add(this.dfUMBCode);
            this.dfTransactionInformation.Controls.Add(this.lblUMBCode);
            this.dfTransactionInformation.Controls.Add(this.lblUtility);
            this.dfTransactionInformation.Controls.Add(this.lblDraweeBank);
            this.dfTransactionInformation.Controls.Add(this.lblIRACategory);
            this.dfTransactionInformation.Controls.Add(this.dfOnUsSignatures);
            this.dfTransactionInformation.Controls.Add(this.dfOnUsTitle1);
            this.dfTransactionInformation.Controls.Add(this.dfOnUsTitle2);
            this.dfTransactionInformation.Location = new System.Drawing.Point(4, 129);
            this.dfTransactionInformation.Name = "dfTransactionInformation";
            this.dfTransactionInformation.PhoenixUIControl.ObjectId = 15;
            this.dfTransactionInformation.Size = new System.Drawing.Size(676, 328);
            this.dfTransactionInformation.TabIndex = 1;
            this.dfTransactionInformation.TabStop = false;
            this.dfTransactionInformation.Text = "Transaction Information";
            this.dfTransactionInformation.Enter += new System.EventHandler(this.dfTransactionInformation_Enter);
            // 
            // cmbInventoryPacket
            // 
            this.cmbInventoryPacket.InitialDisplayType = Phoenix.Windows.Forms.UIComboInitialDisplayType.DisplayDefault;
            this.cmbInventoryPacket.Location = new System.Drawing.Point(335, 83);
            this.cmbInventoryPacket.Name = "cmbInventoryPacket";
            this.cmbInventoryPacket.PhoenixUIControl.ObjectId = 224;
            this.cmbInventoryPacket.PhoenixUIControl.XmlTag = "PacketId";
            this.cmbInventoryPacket.Size = new System.Drawing.Size(160, 21);
            this.cmbInventoryPacket.TabIndex = 83;
            this.cmbInventoryPacket.Value = null;
            this.cmbInventoryPacket.Visible = false;
            this.cmbInventoryPacket.PhoenixUISelectedIndexChangedEvent += new Phoenix.Windows.Forms.SelectedIndexChangedEventHandler(this.cmbInventoryPacket_PhoenixUISelectedIndexChangedEvent);
            // 
            // dfInvSerialNo
            // 
            this.dfInvSerialNo.DataType = Phoenix.Windows.Forms.UIDataType.Integer;
            this.dfInvSerialNo.Location = new System.Drawing.Point(335, 83);
            this.dfInvSerialNo.MaxLength = 16;
            this.dfInvSerialNo.Name = "dfInvSerialNo";
            this.dfInvSerialNo.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Integer;
            this.dfInvSerialNo.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.UserDefined;
            this.dfInvSerialNo.PhoenixUIControl.InputMask = "9999999999999999";
            this.dfInvSerialNo.PhoenixUIControl.XmlTag = "InvSerialNo";
            this.dfInvSerialNo.PreviousValue = null;
            this.dfInvSerialNo.Size = new System.Drawing.Size(160, 20);
            this.dfInvSerialNo.TabIndex = 21;
            this.dfInvSerialNo.Visible = false;
            this.dfInvSerialNo.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfInvSerialNo_PhoenixUIValidateEvent);
            // 
            // dfNoInvAvailable
            // 
            this.dfNoInvAvailable.DataType = Phoenix.Windows.Forms.UIDataType.Integer;
            this.dfNoInvAvailable.Location = new System.Drawing.Point(568, 83);
            this.dfNoInvAvailable.Name = "dfNoInvAvailable";
            this.dfNoInvAvailable.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Integer;
            this.dfNoInvAvailable.PhoenixUIControl.ObjectId = 225;
            this.dfNoInvAvailable.PhoenixUIControl.XmlTag = "NoInvAvailable";
            this.dfNoInvAvailable.PreviousValue = null;
            this.dfNoInvAvailable.Size = new System.Drawing.Size(100, 20);
            this.dfNoInvAvailable.TabIndex = 23;
            this.dfNoInvAvailable.Visible = false;
            // 
            // lblNoInvAvailable
            // 
            this.lblNoInvAvailable.AutoEllipsis = true;
            this.lblNoInvAvailable.Location = new System.Drawing.Point(500, 83);
            this.lblNoInvAvailable.Name = "lblNoInvAvailable";
            this.lblNoInvAvailable.PhoenixUIControl.ObjectId = 225;
            this.lblNoInvAvailable.Size = new System.Drawing.Size(63, 21);
            this.lblNoInvAvailable.TabIndex = 22;
            this.lblNoInvAvailable.Text = "# Available:";
            // 
            // lblPacket
            // 
            this.lblPacket.AutoEllipsis = true;
            this.lblPacket.Location = new System.Drawing.Point(281, 83);
            this.lblPacket.Name = "lblPacket";
            this.lblPacket.PhoenixUIControl.ObjectId = 224;
            this.lblPacket.Size = new System.Drawing.Size(52, 21);
            this.lblPacket.TabIndex = 20;
            this.lblPacket.Text = "Packet:";
            this.lblPacket.Visible = false;
            // 
            // cmbInventoryType
            // 
            this.cmbInventoryType.DisplayType = Phoenix.Windows.Forms.UIComboDisplayType.CombinedValue;
            this.cmbInventoryType.InitialDisplayType = Phoenix.Windows.Forms.UIComboInitialDisplayType.DisplayDefault;
            this.cmbInventoryType.Location = new System.Drawing.Point(104, 83);
            this.cmbInventoryType.Name = "cmbInventoryType";
            this.cmbInventoryType.PhoenixUIControl.ObjectId = 223;
            this.cmbInventoryType.PhoenixUIControl.XmlTag = "TypeId";
            this.cmbInventoryType.Size = new System.Drawing.Size(170, 21);
            this.cmbInventoryType.TabIndex = 19;
            this.cmbInventoryType.Value = null;
            this.cmbInventoryType.PhoenixUISelectedIndexChangedEvent += new Phoenix.Windows.Forms.SelectedIndexChangedEventHandler(this.cmbInventoryType_PhoenixUISelectedIndexChangedEvent);
            this.cmbInventoryType.PhoenixUIEditedEvent += new Phoenix.Windows.Forms.ValueEditedEventHandler(this.cmbInventoryType_PhoenixUIEditedEvent);
            this.cmbInventoryType.Enter += new System.EventHandler(this.cmbInventoryType_Enter);
            this.cmbInventoryType.Validating += new System.ComponentModel.CancelEventHandler(this.cmbInventoryType_Validating);
            // 
            // lblInventoryType
            // 
            this.lblInventoryType.AutoEllipsis = true;
            this.lblInventoryType.Location = new System.Drawing.Point(4, 83);
            this.lblInventoryType.Name = "lblInventoryType";
            this.lblInventoryType.PhoenixUIControl.ObjectId = 223;
            this.lblInventoryType.Size = new System.Drawing.Size(66, 21);
            this.lblInventoryType.TabIndex = 18;
            this.lblInventoryType.Text = "Inventory:";
            // 
            // lblCalcWh
            // 
            this.lblCalcWh.AutoEllipsis = true;
            this.lblCalcWh.Location = new System.Drawing.Point(500, 285);
            this.lblCalcWh.Name = "lblCalcWh";
            this.lblCalcWh.PhoenixUIControl.ObjectId = 222;
            this.lblCalcWh.Size = new System.Drawing.Size(67, 22);
            this.lblCalcWh.TabIndex = 74;
            this.lblCalcWh.Text = "Withholding:";
            // 
            // dfWithholdingAmt
            // 
            this.dfWithholdingAmt.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfWithholdingAmt.Location = new System.Drawing.Point(568, 284);
            this.dfWithholdingAmt.MaxLength = 14;
            this.dfWithholdingAmt.Name = "dfWithholdingAmt";
            this.dfWithholdingAmt.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfWithholdingAmt.PhoenixUIControl.ObjectId = 222;
            this.dfWithholdingAmt.PreviousValue = null;
            this.dfWithholdingAmt.Size = new System.Drawing.Size(100, 20);
            this.dfWithholdingAmt.TabIndex = 75;
            this.dfWithholdingAmt.Text = "$0.00";
            // 
            // cmbLnEscrowAgent
            // 
            this.cmbLnEscrowAgent.Location = new System.Drawing.Point(432, 39);
            this.cmbLnEscrowAgent.Name = "cmbLnEscrowAgent";
            this.cmbLnEscrowAgent.PhoenixUIControl.ObjectId = 218;
            this.cmbLnEscrowAgent.Size = new System.Drawing.Size(238, 21);
            this.cmbLnEscrowAgent.TabIndex = 11;
            this.cmbLnEscrowAgent.Value = null;
            // 
            // lblLnEscrowAgent
            // 
            this.lblLnEscrowAgent.AutoEllipsis = true;
            this.lblLnEscrowAgent.Location = new System.Drawing.Point(356, 39);
            this.lblLnEscrowAgent.Name = "lblLnEscrowAgent";
            this.lblLnEscrowAgent.PhoenixUIControl.ObjectId = 218;
            this.lblLnEscrowAgent.Size = new System.Drawing.Size(81, 21);
            this.lblLnEscrowAgent.TabIndex = 10;
            this.lblLnEscrowAgent.Text = "Escrow Agent:";
            // 
            // onUsBar
            // 
            this.onUsBar.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) 
            | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.onUsBar.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
            this.onUsBar.DockMargin = 2;
            this.onUsBar.ItemDisplayType = Phoenix.Windows.Forms.POutlookBar.DisplayType.ImageOnly;
            this.onUsBar.Location = new System.Drawing.Point(507, 256);
            this.onUsBar.Name = "onUsBar";
            this.onUsBar.Size = new System.Drawing.Size(2, 24);
            this.onUsBar.TabIndex = 70;
            this.onUsBar.UseBlend = false;
            this.onUsBar.Vertical = false;
            // 
            // lblTlItemRoutingNo
            // 
            this.lblTlItemRoutingNo.AutoEllipsis = true;
            this.lblTlItemRoutingNo.Location = new System.Drawing.Point(381, 172);
            this.lblTlItemRoutingNo.Name = "lblTlItemRoutingNo";
            this.lblTlItemRoutingNo.PhoenixUIControl.ObjectId = 211;
            this.lblTlItemRoutingNo.Size = new System.Drawing.Size(56, 22);
            this.lblTlItemRoutingNo.TabIndex = 45;
            this.lblTlItemRoutingNo.Text = "Routing #:";
            this.lblTlItemRoutingNo.Visible = false;
            // 
            // dfTlItemRoutingNo
            // 
            this.dfTlItemRoutingNo.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTlItemRoutingNo.Location = new System.Drawing.Point(443, 172);
            this.dfTlItemRoutingNo.Name = "dfTlItemRoutingNo";
            this.dfTlItemRoutingNo.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTlItemRoutingNo.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.UserDefined;
            this.dfTlItemRoutingNo.PhoenixUIControl.InputMask = "9999-99999";
            this.dfTlItemRoutingNo.PhoenixUIControl.ObjectId = 211;
            this.dfTlItemRoutingNo.PhoenixUIControl.XmlTag = "TlItemRoutingNo";
            this.dfTlItemRoutingNo.PreviousValue = null;
            this.dfTlItemRoutingNo.Size = new System.Drawing.Size(81, 20);
            this.dfTlItemRoutingNo.TabIndex = 46;
            this.dfTlItemRoutingNo.Visible = false;
            // 
            // dfTlItemCheckNo
            // 
            this.dfTlItemCheckNo.DataType = Phoenix.Windows.Forms.UIDataType.Integer;
            this.dfTlItemCheckNo.Location = new System.Drawing.Point(580, 172);
            this.dfTlItemCheckNo.MaxLength = 10;
            this.dfTlItemCheckNo.Name = "dfTlItemCheckNo";
            this.dfTlItemCheckNo.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Integer;
            this.dfTlItemCheckNo.PhoenixUIControl.ObjectId = 212;
            this.dfTlItemCheckNo.PhoenixUIControl.XmlTag = "TlItemCheckNo";
            this.dfTlItemCheckNo.PreviousValue = null;
            this.dfTlItemCheckNo.Size = new System.Drawing.Size(88, 20);
            this.dfTlItemCheckNo.TabIndex = 49;
            this.dfTlItemCheckNo.Visible = false;
            // 
            // lblTlItemCheckNo
            // 
            this.lblTlItemCheckNo.AutoEllipsis = true;
            this.lblTlItemCheckNo.Location = new System.Drawing.Point(529, 172);
            this.lblTlItemCheckNo.Name = "lblTlItemCheckNo";
            this.lblTlItemCheckNo.PhoenixUIControl.ObjectId = 212;
            this.lblTlItemCheckNo.Size = new System.Drawing.Size(52, 22);
            this.lblTlItemCheckNo.TabIndex = 48;
            this.lblTlItemCheckNo.Text = "Check #:";
            this.lblTlItemCheckNo.Visible = false;
            // 
            // dfTlItemAcctNo
            // 
            this.dfTlItemAcctNo.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTlItemAcctNo.Location = new System.Drawing.Point(280, 172);
            this.dfTlItemAcctNo.MaxLength = 60;
            this.dfTlItemAcctNo.Name = "dfTlItemAcctNo";
            this.dfTlItemAcctNo.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTlItemAcctNo.PhoenixUIControl.ObjectId = 210;
            this.dfTlItemAcctNo.PhoenixUIControl.XmlTag = "TlItemAcctNo";
            this.dfTlItemAcctNo.PreviousValue = null;
            this.dfTlItemAcctNo.Size = new System.Drawing.Size(93, 20);
            this.dfTlItemAcctNo.TabIndex = 43;
            this.dfTlItemAcctNo.Visible = false;
            // 
            // lblTlItemAcctNo
            // 
            this.lblTlItemAcctNo.AutoEllipsis = true;
            this.lblTlItemAcctNo.Location = new System.Drawing.Point(212, 172);
            this.lblTlItemAcctNo.Name = "lblTlItemAcctNo";
            this.lblTlItemAcctNo.PhoenixUIControl.ObjectId = 210;
            this.lblTlItemAcctNo.Size = new System.Drawing.Size(62, 22);
            this.lblTlItemAcctNo.TabIndex = 42;
            this.lblTlItemAcctNo.Text = "Account:";
            this.lblTlItemAcctNo.Visible = false;
            // 
            // lblChannel
            // 
            this.lblChannel.AutoEllipsis = true;
            this.lblChannel.Location = new System.Drawing.Point(265, 129);
            this.lblChannel.Name = "lblChannel";
            this.lblChannel.PhoenixUIControl.ObjectId = 208;
            this.lblChannel.Size = new System.Drawing.Size(63, 22);
            this.lblChannel.TabIndex = 30;
            this.lblChannel.Text = "Channel:";
            // 
            // cbRegD
            // 
            this.cbRegD.AutoSize = true;
            this.cbRegD.BackColor = System.Drawing.SystemColors.Control;
            this.cbRegD.Checked = true;
            this.cbRegD.CheckState = System.Windows.Forms.CheckState.Checked;
            this.cbRegD.Location = new System.Drawing.Point(356, 14);
            this.cbRegD.Name = "cbRegD";
            this.cbRegD.PhoenixUIControl.ObjectId = 206;
            this.cbRegD.Size = new System.Drawing.Size(57, 17);
            this.cbRegD.TabIndex = 3;
            this.cbRegD.Text = "Reg D";
            this.cbRegD.UseVisualStyleBackColor = false;
            this.cbRegD.Value = null;
            this.cbRegD.Visible = false;
            // 
            // cmbChannel
            // 
            this.cmbChannel.Location = new System.Drawing.Point(347, 128);
            this.cmbChannel.Name = "cmbChannel";
            this.cmbChannel.PhoenixUIControl.ObjectId = 208;
            this.cmbChannel.Size = new System.Drawing.Size(90, 21);
            this.cmbChannel.TabIndex = 31;
            this.cmbChannel.Value = null;
            // 
            // cmbOnUsTc
            // 
            this.cmbOnUsTc.Location = new System.Drawing.Point(622, 151);
            this.cmbOnUsTc.Name = "cmbOnUsTc";
            this.cmbOnUsTc.PhoenixUIControl.IsVisible = Phoenix.Windows.Forms.VisibilityState.Hide;
            this.cmbOnUsTc.PhoenixUIControl.ObjectId = 205;
            this.cmbOnUsTc.Size = new System.Drawing.Size(48, 21);
            this.cmbOnUsTc.TabIndex = 39;
            this.cmbOnUsTc.Value = null;
            // 
            // lblOnUsTc
            // 
            this.lblOnUsTc.AutoEllipsis = true;
            this.lblOnUsTc.Location = new System.Drawing.Point(588, 151);
            this.lblOnUsTc.Name = "lblOnUsTc";
            this.lblOnUsTc.PhoenixUIControl.IsVisible = Phoenix.Windows.Forms.VisibilityState.Hide;
            this.lblOnUsTc.PhoenixUIControl.ObjectId = 205;
            this.lblOnUsTc.Size = new System.Drawing.Size(24, 21);
            this.lblOnUsTc.TabIndex = 38;
            this.lblOnUsTc.Text = "TC:";
            // 
            // lblRecalcPmtDt
            // 
            this.lblRecalcPmtDt.AutoEllipsis = true;
            this.lblRecalcPmtDt.Location = new System.Drawing.Point(4, 237);
            this.lblRecalcPmtDt.Name = "lblRecalcPmtDt";
            this.lblRecalcPmtDt.PhoenixUIControl.ObjectId = 198;
            this.lblRecalcPmtDt.Size = new System.Drawing.Size(92, 21);
            this.lblRecalcPmtDt.TabIndex = 61;
            this.lblRecalcPmtDt.Text = "Recalc Date:";
            // 
            // dfRecalcPmt
            // 
            this.dfRecalcPmt.Location = new System.Drawing.Point(568, 237);
            this.dfRecalcPmt.Name = "dfRecalcPmt";
            this.dfRecalcPmt.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfRecalcPmt.PhoenixUIControl.ObjectId = 199;
            this.dfRecalcPmt.PreviousValue = null;
            this.dfRecalcPmt.Size = new System.Drawing.Size(100, 13);
            this.dfRecalcPmt.TabIndex = 67;
            // 
            // lblRecalcPmt
            // 
            this.lblRecalcPmt.AutoEllipsis = true;
            this.lblRecalcPmt.Location = new System.Drawing.Point(464, 237);
            this.lblRecalcPmt.Name = "lblRecalcPmt";
            this.lblRecalcPmt.PhoenixUIControl.ObjectId = 199;
            this.lblRecalcPmt.Size = new System.Drawing.Size(92, 21);
            this.lblRecalcPmt.TabIndex = 65;
            this.lblRecalcPmt.Text = "Recalc Payment:";
            // 
            // cmbRecalcPmtDt
            // 
            this.cmbRecalcPmtDt.DisplayType = Phoenix.Windows.Forms.UIComboDisplayType.CodeValue;
            this.cmbRecalcPmtDt.InitialDisplayType = Phoenix.Windows.Forms.UIComboInitialDisplayType.DisplayDefault;
            this.cmbRecalcPmtDt.Location = new System.Drawing.Point(104, 237);
            this.cmbRecalcPmtDt.Name = "cmbRecalcPmtDt";
            this.cmbRecalcPmtDt.PhoenixUIControl.ObjectId = 198;
            this.cmbRecalcPmtDt.PhoenixUIControl.XmlTag = "RecalcPmtDt";
            this.cmbRecalcPmtDt.Size = new System.Drawing.Size(100, 21);
            this.cmbRecalcPmtDt.TabIndex = 62;
            this.cmbRecalcPmtDt.Value = null;
            this.cmbRecalcPmtDt.PhoenixUISelectedIndexChangedEvent += new Phoenix.Windows.Forms.SelectedIndexChangedEventHandler(this.cmbRecalcPmtDt_PhoenixUISelectedIndexChangedEvent);
            this.cmbRecalcPmtDt.PhoenixUIEditedEvent += new Phoenix.Windows.Forms.ValueEditedEventHandler(this.cmbRecalcPmtDt_PhoenixUIEditedEvent);
            // 
            // cbWaiveSignature
            // 
            this.cbWaiveSignature.AutoSize = true;
            this.cbWaiveSignature.BackColor = System.Drawing.SystemColors.Control;
            this.cbWaiveSignature.Checked = true;
            this.cbWaiveSignature.CheckState = System.Windows.Forms.CheckState.Checked;
            this.cbWaiveSignature.Location = new System.Drawing.Point(212, 194);
            this.cbWaiveSignature.Name = "cbWaiveSignature";
            this.cbWaiveSignature.PhoenixUIControl.ObjectId = 202;
            this.cbWaiveSignature.PhoenixUIControl.XmlTag = "WaiveSignature";
            this.cbWaiveSignature.Size = new System.Drawing.Size(105, 17);
            this.cbWaiveSignature.TabIndex = 52;
            this.cbWaiveSignature.Text = "Waive Signature";
            this.cbWaiveSignature.UseVisualStyleBackColor = false;
            this.cbWaiveSignature.Value = null;
            this.cbWaiveSignature.PhoenixUICheckedChangedEvent += new Phoenix.Windows.Forms.CheckedChangedEventHandler(this.cbWaiveSignature_PhoenixUICheckedChangedEvent);
            // 
            // lblOnUsTitle2
            // 
            this.lblOnUsTitle2.AutoEllipsis = true;
            this.lblOnUsTitle2.Location = new System.Drawing.Point(4, 280);
            this.lblOnUsTitle2.Name = "lblOnUsTitle2";
            this.lblOnUsTitle2.PhoenixUIControl.ObjectId = 193;
            this.lblOnUsTitle2.Size = new System.Drawing.Size(96, 22);
            this.lblOnUsTitle2.TabIndex = 71;
            this.lblOnUsTitle2.Text = "On Us Title 2:";
            // 
            // lblOnUsTitle1
            // 
            this.lblOnUsTitle1.AutoEllipsis = true;
            this.lblOnUsTitle1.Location = new System.Drawing.Point(4, 258);
            this.lblOnUsTitle1.Name = "lblOnUsTitle1";
            this.lblOnUsTitle1.PhoenixUIControl.ObjectId = 192;
            this.lblOnUsTitle1.Size = new System.Drawing.Size(96, 22);
            this.lblOnUsTitle1.TabIndex = 68;
            this.lblOnUsTitle1.Text = "On Us Title 1:";
            // 
            // cbDenominate
            // 
            this.cbDenominate.AutoSize = true;
            this.cbDenominate.BackColor = System.Drawing.SystemColors.Control;
            this.cbDenominate.Checked = true;
            this.cbDenominate.CheckState = System.Windows.Forms.CheckState.Checked;
            this.cbDenominate.Location = new System.Drawing.Point(328, 194);
            this.cbDenominate.Name = "cbDenominate";
            this.cbDenominate.PhoenixUIControl.ObjectId = 190;
            this.cbDenominate.PhoenixUIControl.XmlTag = "TcdDenominate";
            this.cbDenominate.Size = new System.Drawing.Size(83, 17);
            this.cbDenominate.TabIndex = 53;
            this.cbDenominate.Text = "Denomi&nate";
            this.cbDenominate.UseVisualStyleBackColor = false;
            this.cbDenominate.Value = null;
            this.cbDenominate.CheckedChanged += new System.EventHandler(this.cbDenominate_CheckedChanged);
            // 
            // picDrawer
            // 
            this.picDrawer.Location = new System.Drawing.Point(76, 194);
            this.picDrawer.Name = "picDrawer";
            this.picDrawer.Size = new System.Drawing.Size(24, 21);
            this.picDrawer.TabIndex = 61;
            this.picDrawer.TabStop = false;
            this.picDrawer.Click += new System.EventHandler(this.picDrawer_Click);
            // 
            // picTCD
            // 
            this.picTCD.Location = new System.Drawing.Point(76, 212);
            this.picTCD.Name = "picTCD";
            this.picTCD.Size = new System.Drawing.Size(24, 22);
            this.picTCD.TabIndex = 60;
            this.picTCD.TabStop = false;
            this.picTCD.Click += new System.EventHandler(this.picTCD_Click);
            // 
            // picMemo
            // 
            this.picMemo.Location = new System.Drawing.Point(76, 13);
            this.picMemo.Name = "picMemo";
            this.picMemo.Size = new System.Drawing.Size(24, 21);
            this.picMemo.TabIndex = 59;
            this.picMemo.TabStop = false;
            // 
            // picRealTime
            // 
            this.picRealTime.Location = new System.Drawing.Point(76, 13);
            this.picRealTime.Name = "picRealTime";
            this.picRealTime.Size = new System.Drawing.Size(24, 21);
            this.picRealTime.TabIndex = 58;
            this.picRealTime.TabStop = false;
            // 
            // dfTranEffectiveDt
            // 
            this.dfTranEffectiveDt.DataType = Phoenix.Windows.Forms.UIDataType.DateTime;
            this.dfTranEffectiveDt.Location = new System.Drawing.Point(592, 13);
            this.dfTranEffectiveDt.Name = "dfTranEffectiveDt";
            this.dfTranEffectiveDt.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.DateTime;
            this.dfTranEffectiveDt.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Date;
            this.dfTranEffectiveDt.PhoenixUIControl.ObjectId = 183;
            this.dfTranEffectiveDt.PreviousValue = null;
            this.dfTranEffectiveDt.Size = new System.Drawing.Size(76, 20);
            this.dfTranEffectiveDt.TabIndex = 7;
            this.dfTranEffectiveDt.PhoenixUILeaveEvent += new Phoenix.Windows.Forms.LeaveEventHandler(this.dfTranEffectiveDt_PhoenixUILeaveEvent);
            // 
            // lblEffective
            // 
            this.lblEffective.AutoEllipsis = true;
            this.lblEffective.Location = new System.Drawing.Point(529, 12);
            this.lblEffective.Name = "lblEffective";
            this.lblEffective.Size = new System.Drawing.Size(56, 25);
            this.lblEffective.TabIndex = 6;
            this.lblEffective.Text = "Effective:";
            // 
            // cbPassDesc
            // 
            this.cbPassDesc.BackColor = System.Drawing.SystemColors.Control;
            this.cbPassDesc.Checked = true;
            this.cbPassDesc.CheckState = System.Windows.Forms.CheckState.Checked;
            this.cbPassDesc.Location = new System.Drawing.Point(425, 11);
            this.cbPassDesc.Name = "cbPassDesc";
            this.cbPassDesc.PhoenixUIControl.ObjectId = 182;
            this.cbPassDesc.Size = new System.Drawing.Size(99, 26);
            this.cbPassDesc.TabIndex = 4;
            this.cbPassDesc.Text = "Pass Description to History";
            this.cbPassDesc.UseVisualStyleBackColor = false;
            this.cbPassDesc.Value = null;
            // 
            // cbTfrPbPresent
            // 
            this.cbTfrPbPresent.BackColor = System.Drawing.SystemColors.Control;
            this.cbTfrPbPresent.Checked = true;
            this.cbTfrPbPresent.CheckState = System.Windows.Forms.CheckState.Checked;
            this.cbTfrPbPresent.Location = new System.Drawing.Point(600, 151);
            this.cbTfrPbPresent.Name = "cbTfrPbPresent";
            this.cbTfrPbPresent.PhoenixUIControl.ObjectId = 30;
            this.cbTfrPbPresent.Size = new System.Drawing.Size(68, 21);
            this.cbTfrPbPresent.TabIndex = 31;
            this.cbTfrPbPresent.Text = "Passbook";
            this.cbTfrPbPresent.UseVisualStyleBackColor = false;
            this.cbTfrPbPresent.Value = null;
            this.cbTfrPbPresent.Visible = false;
            // 
            // cmbTCDDrawer
            // 
            this.cmbTCDDrawer.Location = new System.Drawing.Point(432, 108);
            this.cmbTCDDrawer.Name = "cmbTCDDrawer";
            this.cmbTCDDrawer.PhoenixUIControl.ObjectId = 170;
            this.cmbTCDDrawer.Size = new System.Drawing.Size(238, 21);
            this.cmbTCDDrawer.TabIndex = 27;
            this.cmbTCDDrawer.Value = null;
            this.cmbTCDDrawer.Visible = false;
            // 
            // lblTCDDrawer
            // 
            this.lblTCDDrawer.AutoEllipsis = true;
            this.lblTCDDrawer.Location = new System.Drawing.Point(356, 108);
            this.lblTCDDrawer.Name = "lblTCDDrawer";
            this.lblTCDDrawer.PhoenixUIControl.ObjectId = 170;
            this.lblTCDDrawer.Size = new System.Drawing.Size(76, 21);
            this.lblTCDDrawer.TabIndex = 26;
            this.lblTCDDrawer.Text = "TCD Drawer:";
            this.lblTCDDrawer.Visible = false;
            // 
            // dfDifference
            // 
            this.dfDifference.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfDifference.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfDifference.Location = new System.Drawing.Point(568, 306);
            this.dfDifference.Name = "dfDifference";
            this.dfDifference.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfDifference.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfDifference.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfDifference.PhoenixUIControl.MaxPrecision = 14;
            this.dfDifference.PhoenixUIControl.ObjectId = 42;
            this.dfDifference.PreviousValue = null;
            this.dfDifference.ReadOnly = true;
            this.dfDifference.Size = new System.Drawing.Size(100, 13);
            this.dfDifference.TabIndex = 81;
            this.dfDifference.TabStop = false;
            // 
            // lblDifference
            // 
            this.lblDifference.AutoEllipsis = true;
            this.lblDifference.Font = new System.Drawing.Font("Microsoft Sans Serif", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblDifference.Location = new System.Drawing.Point(488, 306);
            this.lblDifference.Name = "lblDifference";
            this.lblDifference.PhoenixUIControl.ObjectId = 42;
            this.lblDifference.Size = new System.Drawing.Size(64, 13);
            this.lblDifference.TabIndex = 80;
            this.lblDifference.Text = "Difference";
            // 
            // dfTotalCredits
            // 
            this.dfTotalCredits.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfTotalCredits.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfTotalCredits.Location = new System.Drawing.Point(320, 306);
            this.dfTotalCredits.Name = "dfTotalCredits";
            this.dfTotalCredits.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfTotalCredits.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfTotalCredits.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfTotalCredits.PhoenixUIControl.MaxPrecision = 14;
            this.dfTotalCredits.PhoenixUIControl.ObjectId = 41;
            this.dfTotalCredits.PreviousValue = null; 
            this.dfTotalCredits.ReadOnly = true;
            this.dfTotalCredits.Size = new System.Drawing.Size(100, 13);
            this.dfTotalCredits.TabIndex = 79;
            this.dfTotalCredits.TabStop = false;
            // 
            // lblTotalCredits
            // 
            this.lblTotalCredits.AutoEllipsis = true;
            this.lblTotalCredits.Font = new System.Drawing.Font("Microsoft Sans Serif", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblTotalCredits.Location = new System.Drawing.Point(216, 306);
            this.lblTotalCredits.Name = "lblTotalCredits";
            this.lblTotalCredits.PhoenixUIControl.ObjectId = 41;
            this.lblTotalCredits.Size = new System.Drawing.Size(90, 13);
            this.lblTotalCredits.TabIndex = 78;
            this.lblTotalCredits.Text = "Total Credits";
            // 
            // dfTotalDebits
            // 
            this.dfTotalDebits.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfTotalDebits.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfTotalDebits.Location = new System.Drawing.Point(104, 306);
            this.dfTotalDebits.Name = "dfTotalDebits";
            this.dfTotalDebits.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfTotalDebits.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfTotalDebits.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfTotalDebits.PhoenixUIControl.MaxPrecision = 14;
            this.dfTotalDebits.PhoenixUIControl.ObjectId = 40;
            this.dfTotalDebits.PreviousValue = null; 
            this.dfTotalDebits.ReadOnly = true;
            this.dfTotalDebits.Size = new System.Drawing.Size(100, 13);
            this.dfTotalDebits.TabIndex = 77;
            this.dfTotalDebits.TabStop = false;
            // 
            // lblTotalDebits
            // 
            this.lblTotalDebits.AutoEllipsis = true;
            this.lblTotalDebits.Font = new System.Drawing.Font("Microsoft Sans Serif", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblTotalDebits.Location = new System.Drawing.Point(4, 306);
            this.lblTotalDebits.Name = "lblTotalDebits";
            this.lblTotalDebits.PhoenixUIControl.ObjectId = 40;
            this.lblTotalDebits.Size = new System.Drawing.Size(90, 13);
            this.lblTotalDebits.TabIndex = 76;
            this.lblTotalDebits.Text = "Total Debits";
            // 
            // dfPenaltyAmt
            // 
            this.dfPenaltyAmt.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfPenaltyAmt.Location = new System.Drawing.Point(568, 237);
            this.dfPenaltyAmt.MaxLength = 14;
            this.dfPenaltyAmt.Name = "dfPenaltyAmt";
            this.dfPenaltyAmt.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfPenaltyAmt.PhoenixUIControl.ObjectId = 39;
            this.dfPenaltyAmt.PreviousValue = null;
            this.dfPenaltyAmt.Size = new System.Drawing.Size(100, 20);
            this.dfPenaltyAmt.TabIndex = 51;
            this.dfPenaltyAmt.Text = "$0.00";
            this.dfPenaltyAmt.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfPenaltyAmt_PhoenixUIValidateEvent);
            // 
            // lblPenalty
            // 
            this.lblPenalty.AutoEllipsis = true;
            this.lblPenalty.Location = new System.Drawing.Point(500, 241);
            this.lblPenalty.Name = "lblPenalty";
            this.lblPenalty.PhoenixUIControl.ObjectId = 39;
            this.lblPenalty.Size = new System.Drawing.Size(56, 13);
            this.lblPenalty.TabIndex = 66;
            this.lblPenalty.Text = "Penalty:";
            // 
            // dfInterestPaid
            // 
            this.dfInterestPaid.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfInterestPaid.Location = new System.Drawing.Point(400, 237);
            this.dfInterestPaid.MaxLength = 14;
            this.dfInterestPaid.Name = "dfInterestPaid";
            this.dfInterestPaid.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfInterestPaid.PhoenixUIControl.ObjectId = 38;
            this.dfInterestPaid.PreviousValue = null;
            this.dfInterestPaid.Size = new System.Drawing.Size(100, 20);
            this.dfInterestPaid.TabIndex = 64;
            this.dfInterestPaid.Text = "$0.00";
            // 
            // lblInterestPaid
            // 
            this.lblInterestPaid.AutoEllipsis = true;
            this.lblInterestPaid.Location = new System.Drawing.Point(328, 241);
            this.lblInterestPaid.Name = "lblInterestPaid";
            this.lblInterestPaid.PhoenixUIControl.ObjectId = 38;
            this.lblInterestPaid.Size = new System.Drawing.Size(71, 13);
            this.lblInterestPaid.TabIndex = 63;
            this.lblInterestPaid.Text = "Interest Paid:";
            // 
            // dfCCAmt
            // 
            this.dfCCAmt.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfCCAmt.Location = new System.Drawing.Point(104, 237);
            this.dfCCAmt.MaxLength = 14;
            this.dfCCAmt.Name = "dfCCAmt";
            this.dfCCAmt.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfCCAmt.PhoenixUIControl.ObjectId = 37;
            this.dfCCAmt.PhoenixUIControl.XmlTag = "CcAmt";
            this.dfCCAmt.PreviousValue = null;
            this.dfCCAmt.Size = new System.Drawing.Size(100, 20);
            this.dfCCAmt.TabIndex = 47;
            this.dfCCAmt.Text = "$0.00";
            // 
            // lblFeeAmount
            // 
            this.lblFeeAmount.AutoEllipsis = true;
            this.lblFeeAmount.Location = new System.Drawing.Point(4, 237);
            this.lblFeeAmount.Name = "lblFeeAmount";
            this.lblFeeAmount.PhoenixUIControl.ObjectId = 37;
            this.lblFeeAmount.Size = new System.Drawing.Size(90, 21);
            this.lblFeeAmount.TabIndex = 46;
            this.lblFeeAmount.Text = "Fee Amount:";
            // 
            // dfCheckNo
            // 
            this.dfCheckNo.DataType = Phoenix.Windows.Forms.UIDataType.Integer;
            this.dfCheckNo.Location = new System.Drawing.Point(568, 215);
            this.dfCheckNo.MaxLength = 10;
            this.dfCheckNo.Name = "dfCheckNo";
            this.dfCheckNo.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Integer;
            this.dfCheckNo.PhoenixUIControl.ObjectId = 36;
            this.dfCheckNo.PhoenixUIControl.XmlTag = "CheckNo";
            this.dfCheckNo.PreviousValue = null;
            this.dfCheckNo.Size = new System.Drawing.Size(100, 20);
            this.dfCheckNo.TabIndex = 60;
            this.dfCheckNo.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfCheckNo_PhoenixUIValidateEvent);
            // 
            // lblItems
            // 
            this.lblItems.AutoEllipsis = true;
            this.lblItems.Location = new System.Drawing.Point(500, 212);
            this.lblItems.Name = "lblItems";
            this.lblItems.PhoenixUIControl.ObjectId = 36;
            this.lblItems.Size = new System.Drawing.Size(64, 22);
            this.lblItems.TabIndex = 59;
            this.lblItems.Text = "# Items:";
            // 
            // dfAmtEq
            // 
            this.dfAmtEq.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfAmtEq.Location = new System.Drawing.Point(306, 215);
            this.dfAmtEq.MaxLength = 14;
            this.dfAmtEq.Name = "dfAmtEq";
            this.dfAmtEq.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfAmtEq.PhoenixUIControl.ObjectId = 35;
            this.dfAmtEq.PreviousValue = null;
            this.dfAmtEq.Size = new System.Drawing.Size(100, 20);
            this.dfAmtEq.TabIndex = 58;
            this.dfAmtEq.Text = "$0.00";
            this.dfAmtEq.Visible = false;
            // 
            // lblForeignAmount
            // 
            this.lblForeignAmount.AutoEllipsis = true;
            this.lblForeignAmount.Location = new System.Drawing.Point(448, 177);
            this.lblForeignAmount.Name = "lblForeignAmount";
            this.lblForeignAmount.PhoenixUIControl.ObjectId = 35;
            this.lblForeignAmount.Size = new System.Drawing.Size(100, 13);
            this.lblForeignAmount.TabIndex = 47;
            this.lblForeignAmount.Text = "Foreign Amount";
            this.lblForeignAmount.Visible = false;
            // 
            // dfPostingExchRate
            // 
            this.dfPostingExchRate.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfPostingExchRate.Location = new System.Drawing.Point(210, 215);
            this.dfPostingExchRate.MaxLength = 14;
            this.dfPostingExchRate.Name = "dfPostingExchRate";
            this.dfPostingExchRate.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfPostingExchRate.PhoenixUIControl.ObjectId = 34;
            this.dfPostingExchRate.PreviousValue = null;
            this.dfPostingExchRate.Size = new System.Drawing.Size(65, 20);
            this.dfPostingExchRate.TabIndex = 57;
            this.dfPostingExchRate.Visible = false;
            // 
            // lblRate
            // 
            this.lblRate.AutoEllipsis = true;
            this.lblRate.Location = new System.Drawing.Point(524, 198);
            this.lblRate.Name = "lblRate";
            this.lblRate.PhoenixUIControl.ObjectId = 34;
            this.lblRate.Size = new System.Drawing.Size(53, 13);
            this.lblRate.TabIndex = 54;
            this.lblRate.Text = "Rate";
            this.lblRate.Visible = false;
            // 
            // dfAmt
            // 
            this.dfAmt.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfAmt.Location = new System.Drawing.Point(104, 215);
            this.dfAmt.MaxLength = 14;
            this.dfAmt.Name = "dfAmt";
            this.dfAmt.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfAmt.PhoenixUIControl.ObjectId = 33;
            this.dfAmt.PhoenixUIControl.XmlTag = "NetAmt";
            this.dfAmt.PreviousValue = null;
            this.dfAmt.Size = new System.Drawing.Size(100, 20);
            this.dfAmt.TabIndex = 56;
            this.dfAmt.Text = "$0.00";
            this.dfAmt.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfAmt_PhoenixUIValidateEvent);
            // 
            // lblAmount
            // 
            this.lblAmount.AutoEllipsis = true;
            this.lblAmount.Location = new System.Drawing.Point(4, 215);
            this.lblAmount.Name = "lblAmount";
            this.lblAmount.PhoenixUIControl.ObjectId = 33;
            this.lblAmount.Size = new System.Drawing.Size(50, 22);
            this.lblAmount.TabIndex = 55;
            this.lblAmount.Text = "Amount:";
            // 
            // dfCashOut
            // 
            this.dfCashOut.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfCashOut.Location = new System.Drawing.Point(104, 194);
            this.dfCashOut.MaxLength = 14;
            this.dfCashOut.Name = "dfCashOut";
            this.dfCashOut.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfCashOut.PhoenixUIControl.ObjectId = 32;
            this.dfCashOut.PhoenixUIControl.XmlTag = "CashOut";
            this.dfCashOut.PreviousValue = null;
            this.dfCashOut.Size = new System.Drawing.Size(100, 20);
            this.dfCashOut.TabIndex = 51;
            this.dfCashOut.Text = "$0.00";
            this.dfCashOut.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfCashOut_PhoenixUIValidateEvent);
            // 
            // lblCashOut
            // 
            this.lblCashOut.AutoEllipsis = true;
            this.lblCashOut.Location = new System.Drawing.Point(4, 194);
            this.lblCashOut.Name = "lblCashOut";
            this.lblCashOut.PhoenixUIControl.ObjectId = 32;
            this.lblCashOut.Size = new System.Drawing.Size(66, 21);
            this.lblCashOut.TabIndex = 50;
            this.lblCashOut.Text = "Cash Out:";
            // 
            // dfTransitChks
            // 
            this.dfTransitChks.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfTransitChks.Location = new System.Drawing.Point(104, 172);
            this.dfTransitChks.MaxLength = 14;
            this.dfTransitChks.Name = "dfTransitChks";
            this.dfTransitChks.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfTransitChks.PhoenixUIControl.ObjectId = 31;
            this.dfTransitChks.PhoenixUIControl.XmlTag = "TransitChks";
            this.dfTransitChks.PreviousValue = null;
            this.dfTransitChks.Size = new System.Drawing.Size(100, 20);
            this.dfTransitChks.TabIndex = 41;
            this.dfTransitChks.Text = "$0.00";
            this.dfTransitChks.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfTransitChks_PhoenixUIValidateEvent);
            // 
            // lblTransitChecks
            // 
            this.lblTransitChecks.AutoEllipsis = true;
            this.lblTransitChecks.Location = new System.Drawing.Point(4, 172);
            this.lblTransitChecks.Name = "lblTransitChecks";
            this.lblTransitChecks.PhoenixUIControl.ObjectId = 31;
            this.lblTransitChecks.Size = new System.Drawing.Size(90, 22);
            this.lblTransitChecks.TabIndex = 40;
            this.lblTransitChecks.Text = "Transit Checks:";
            // 
            // dfTfrCheckNo
            // 
            this.dfTfrCheckNo.DataType = Phoenix.Windows.Forms.UIDataType.Integer;
            this.dfTfrCheckNo.Location = new System.Drawing.Point(484, 151);
            this.dfTfrCheckNo.MaxLength = 8;
            this.dfTfrCheckNo.Name = "dfTfrCheckNo";
            this.dfTfrCheckNo.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Integer;
            this.dfTfrCheckNo.PhoenixUIControl.ObjectId = 29;
            this.dfTfrCheckNo.PreviousValue = null;
            this.dfTfrCheckNo.Size = new System.Drawing.Size(100, 20);
            this.dfTfrCheckNo.TabIndex = 37;
            this.dfTfrCheckNo.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfTfrCheckNo_PhoenixUIValidateEvent);
            this.dfTfrCheckNo.PhoenixUILeaveEvent += new Phoenix.Windows.Forms.LeaveEventHandler(this.dfTfrCheckNo_PhoenixUILeaveEvent);
            // 
            // lblCheck
            // 
            this.lblCheck.AutoEllipsis = true;
            this.lblCheck.Location = new System.Drawing.Point(416, 151);
            this.lblCheck.Name = "lblCheck";
            this.lblCheck.PhoenixUIControl.ObjectId = 29;
            this.lblCheck.Size = new System.Drawing.Size(56, 21);
            this.lblCheck.TabIndex = 36;
            this.lblCheck.Text = "Check #:";
            // 
            // dfTfrAcctNo
            // 
            this.dfTfrAcctNo.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTfrAcctNo.Location = new System.Drawing.Point(288, 151);
            this.dfTfrAcctNo.Name = "dfTfrAcctNo";
            this.dfTfrAcctNo.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTfrAcctNo.PhoenixUIControl.ObjectId = 28;
            this.dfTfrAcctNo.PreviousValue = null;
            this.dfTfrAcctNo.Size = new System.Drawing.Size(119, 20);
            this.dfTfrAcctNo.TabIndex = 35;
            this.dfTfrAcctNo.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfTfrAcctNo_PhoenixUIValidateEvent);
            this.dfTfrAcctNo.GotFocus += new System.EventHandler(this.dfTfrAcctNo_GotFocus);
            this.dfTfrAcctNo.KeyUp += new System.Windows.Forms.KeyEventHandler(this.dfTfrAcctNo_KeyUp);
            this.dfTfrAcctNo.LostFocus += new System.EventHandler(this.dfTfrAcctNo_LostFocus);
            // 
            // lblTfrAcctNo
            // 
            this.lblTfrAcctNo.AutoEllipsis = true;
            this.lblTfrAcctNo.Location = new System.Drawing.Point(496, 65);
            this.lblTfrAcctNo.Name = "lblTfrAcctNo";
            this.lblTfrAcctNo.PhoenixUIControl.ObjectId = 28;
            this.lblTfrAcctNo.Size = new System.Drawing.Size(6, 13);
            this.lblTfrAcctNo.TabIndex = 16;
            this.lblTfrAcctNo.Text = "-";
            this.lblTfrAcctNo.Visible = false;
            // 
            // cmbTfrAcctType
            // 
            this.cmbTfrAcctType.DisplayType = Phoenix.Windows.Forms.UIComboDisplayType.CodeValue;
            this.cmbTfrAcctType.Location = new System.Drawing.Point(212, 151);
            this.cmbTfrAcctType.Name = "cmbTfrAcctType";
            this.cmbTfrAcctType.PhoenixUIControl.ObjectId = 27;
            this.cmbTfrAcctType.Size = new System.Drawing.Size(65, 21);
            this.cmbTfrAcctType.TabIndex = 34;
            this.cmbTfrAcctType.Value = null;
            this.cmbTfrAcctType.Enter += new System.EventHandler(this.cmbTfrAcctType_Enter);
            this.cmbTfrAcctType.Validating += new System.ComponentModel.CancelEventHandler(this.cmbTfrAcctType_Validating);
            // 
            // dfOnUsChks
            // 
            this.dfOnUsChks.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfOnUsChks.Location = new System.Drawing.Point(104, 151);
            this.dfOnUsChks.MaxLength = 14;
            this.dfOnUsChks.Name = "dfOnUsChks";
            this.dfOnUsChks.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfOnUsChks.PhoenixUIControl.ObjectId = 26;
            this.dfOnUsChks.PhoenixUIControl.XmlTag = "OnUsChks";
            this.dfOnUsChks.PreviousValue = null;
            this.dfOnUsChks.Size = new System.Drawing.Size(100, 20);
            this.dfOnUsChks.TabIndex = 33;
            this.dfOnUsChks.Text = "$0.00";
            this.dfOnUsChks.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfOnUsChks_PhoenixUIValidateEvent);
            // 
            // lblOnUsChecks
            // 
            this.lblOnUsChecks.AutoEllipsis = true;
            this.lblOnUsChecks.Location = new System.Drawing.Point(4, 151);
            this.lblOnUsChecks.Name = "lblOnUsChecks";
            this.lblOnUsChecks.PhoenixUIControl.ObjectId = 26;
            this.lblOnUsChecks.Size = new System.Drawing.Size(92, 21);
            this.lblOnUsChecks.TabIndex = 32;
            this.lblOnUsChecks.Text = "On-Us Checks:";
            // 
            // dfChksAsCash
            // 
            this.dfChksAsCash.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfChksAsCash.Location = new System.Drawing.Point(104, 129);
            this.dfChksAsCash.MaxLength = 14;
            this.dfChksAsCash.Name = "dfChksAsCash";
            this.dfChksAsCash.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfChksAsCash.PhoenixUIControl.ObjectId = 25;
            this.dfChksAsCash.PreviousValue = null;
            this.dfChksAsCash.Size = new System.Drawing.Size(100, 20);
            this.dfChksAsCash.TabIndex = 29;
            this.dfChksAsCash.Text = "$0.00";
            this.dfChksAsCash.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfChksAsCash_PhoenixUIValidateEvent);
            // 
            // lblChecksAsCash
            // 
            this.lblChecksAsCash.AutoEllipsis = true;
            this.lblChecksAsCash.Location = new System.Drawing.Point(4, 129);
            this.lblChecksAsCash.Name = "lblChecksAsCash";
            this.lblChecksAsCash.PhoenixUIControl.ObjectId = 25;
            this.lblChecksAsCash.Size = new System.Drawing.Size(92, 22);
            this.lblChecksAsCash.TabIndex = 28;
            this.lblChecksAsCash.Text = "Checks As Cash:";
            // 
            // dfCashIn
            // 
            this.dfCashIn.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfCashIn.Location = new System.Drawing.Point(104, 108);
            this.dfCashIn.MaxLength = 14;
            this.dfCashIn.Name = "dfCashIn";
            this.dfCashIn.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfCashIn.PhoenixUIControl.ObjectId = 24;
            this.dfCashIn.PreviousValue = null;
            this.dfCashIn.Size = new System.Drawing.Size(100, 20);
            this.dfCashIn.TabIndex = 25;
            this.dfCashIn.Text = "$0.00";
            this.dfCashIn.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfCashIn_PhoenixUIValidateEvent);
            // 
            // lblCashIn
            // 
            this.lblCashIn.AutoEllipsis = true;
            this.lblCashIn.Location = new System.Drawing.Point(4, 108);
            this.lblCashIn.Name = "lblCashIn";
            this.lblCashIn.PhoenixUIControl.ObjectId = 24;
            this.lblCashIn.Size = new System.Drawing.Size(92, 21);
            this.lblCashIn.TabIndex = 24;
            this.lblCashIn.Text = "Cash In:";
            // 
            // dfRefAcctNo
            // 
            this.dfRefAcctNo.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfRefAcctNo.Location = new System.Drawing.Point(508, 60);
            this.dfRefAcctNo.MaxLength = 12;
            this.dfRefAcctNo.Name = "dfRefAcctNo";
            this.dfRefAcctNo.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfRefAcctNo.PhoenixUIControl.ObjectId = 177;
            this.dfRefAcctNo.PreviousValue = null;
            this.dfRefAcctNo.Size = new System.Drawing.Size(160, 20);
            this.dfRefAcctNo.TabIndex = 17;
            this.dfRefAcctNo.Visible = false;
            this.dfRefAcctNo.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfRefAcctNo_PhoenixUIValidateEvent);
            // 
            // lblRefAcctNo
            // 
            this.lblRefAcctNo.AutoEllipsis = true;
            this.lblRefAcctNo.Location = new System.Drawing.Point(280, 164);
            this.lblRefAcctNo.Name = "lblRefAcctNo";
            this.lblRefAcctNo.PhoenixUIControl.ObjectId = 177;
            this.lblRefAcctNo.Size = new System.Drawing.Size(6, 13);
            this.lblRefAcctNo.TabIndex = 44;
            this.lblRefAcctNo.Text = "-";
            this.lblRefAcctNo.Visible = false;
            // 
            // cmbRefAcctType
            // 
            this.cmbRefAcctType.DisplayType = Phoenix.Windows.Forms.UIComboDisplayType.CodeValue;
            this.cmbRefAcctType.Location = new System.Drawing.Point(432, 60);
            this.cmbRefAcctType.Name = "cmbRefAcctType";
            this.cmbRefAcctType.PhoenixUIControl.ObjectId = 176;
            this.cmbRefAcctType.Size = new System.Drawing.Size(61, 21);
            this.cmbRefAcctType.TabIndex = 15;
            this.cmbRefAcctType.Value = null;
            this.cmbRefAcctType.Visible = false;
            this.cmbRefAcctType.PhoenixUIEditedEvent += new Phoenix.Windows.Forms.ValueEditedEventHandler(this.cmbRefAcctType_PhoenixUIEditedEvent);
            this.cmbRefAcctType.Validating += new System.ComponentModel.CancelEventHandler(this.cmbRefAcctType_Validating);
            // 
            // lblRefAccount
            // 
            this.lblRefAccount.AutoEllipsis = true;
            this.lblRefAccount.Location = new System.Drawing.Point(356, 60);
            this.lblRefAccount.Name = "lblRefAccount";
            this.lblRefAccount.PhoenixUIControl.ObjectId = 176;
            this.lblRefAccount.Size = new System.Drawing.Size(76, 22);
            this.lblRefAccount.TabIndex = 14;
            this.lblRefAccount.Text = "Ref Account:";
            this.lblRefAccount.Visible = false;
            // 
            // dfReference
            // 
            this.dfReference.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfReference.Location = new System.Drawing.Point(104, 60);
            this.dfReference.MaxLength = 15;
            this.dfReference.Name = "dfReference";
            this.dfReference.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfReference.PhoenixUIControl.ObjectId = 23;
            this.dfReference.PreviousValue = null;
            this.dfReference.Size = new System.Drawing.Size(236, 20);
            this.dfReference.TabIndex = 13;
            // 
            // lblReference
            // 
            this.lblReference.AutoEllipsis = true;
            this.lblReference.Location = new System.Drawing.Point(4, 60);
            this.lblReference.Name = "lblReference";
            this.lblReference.PhoenixUIControl.ObjectId = 23;
            this.lblReference.Size = new System.Drawing.Size(92, 22);
            this.lblReference.TabIndex = 12;
            this.lblReference.Text = "Reference:";
            // 
            // cmbUtility
            // 
            this.cmbUtility.Location = new System.Drawing.Point(432, 39);
            this.cmbUtility.Name = "cmbUtility";
            this.cmbUtility.PhoenixUIControl.ObjectId = 22;
            this.cmbUtility.Size = new System.Drawing.Size(238, 21);
            this.cmbUtility.TabIndex = 12;
            this.cmbUtility.Value = null;
            this.cmbUtility.Visible = false;
            // 
            // dfTranDescription
            // 
            this.dfTranDescription.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTranDescription.Location = new System.Drawing.Point(104, 39);
            this.dfTranDescription.MaxLength = 40;
            this.dfTranDescription.Name = "dfTranDescription";
            this.dfTranDescription.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTranDescription.PhoenixUIControl.ObjectId = 19;
            this.dfTranDescription.PreviousValue = null;
            this.dfTranDescription.Size = new System.Drawing.Size(236, 20);
            this.dfTranDescription.TabIndex = 9;
            // 
            // lblDescription
            // 
            this.lblDescription.AutoEllipsis = true;
            this.lblDescription.Location = new System.Drawing.Point(4, 39);
            this.lblDescription.Name = "lblDescription";
            this.lblDescription.PhoenixUIControl.ObjectId = 19;
            this.lblDescription.Size = new System.Drawing.Size(92, 21);
            this.lblDescription.TabIndex = 8;
            this.lblDescription.Text = "Description:";
            // 
            // cmbExchCrncy
            // 
            this.cmbExchCrncy.Location = new System.Drawing.Point(432, 13);
            this.cmbExchCrncy.Name = "cmbExchCrncy";
            this.cmbExchCrncy.PhoenixUIControl.ObjectId = 18;
            this.cmbExchCrncy.Size = new System.Drawing.Size(238, 21);
            this.cmbExchCrncy.TabIndex = 5;
            this.cmbExchCrncy.Value = null;
            this.cmbExchCrncy.Visible = false;
            // 
            // lblExchCurrency
            // 
            this.lblExchCurrency.AutoEllipsis = true;
            this.lblExchCurrency.Location = new System.Drawing.Point(356, 13);
            this.lblExchCurrency.Name = "lblExchCurrency";
            this.lblExchCurrency.PhoenixUIControl.ObjectId = 18;
            this.lblExchCurrency.Size = new System.Drawing.Size(71, 13);
            this.lblExchCurrency.TabIndex = 4;
            this.lblExchCurrency.Text = "Currency:";
            this.lblExchCurrency.Visible = false;
            // 
            // cmbTranCode
            // 
            this.cmbTranCode.DisplayType = Phoenix.Windows.Forms.UIComboDisplayType.CombinedValue;
            this.cmbTranCode.Location = new System.Drawing.Point(144, 13);
            this.cmbTranCode.Name = "cmbTranCode";
            this.cmbTranCode.PhoenixUIControl.ObjectId = 17;
            this.cmbTranCode.Size = new System.Drawing.Size(196, 21);
            this.cmbTranCode.TabIndex = 2;
            this.cmbTranCode.Value = null;
            this.cmbTranCode.PhoenixUISelectedIndexChangedEvent += new Phoenix.Windows.Forms.SelectedIndexChangedEventHandler(this.cmbTranCode_SelectedIndexChanged);
            this.cmbTranCode.PhoenixUIEditedEvent += new Phoenix.Windows.Forms.ValueEditedEventHandler(this.cmbTranCode_PhoenixUIEditedEvent);
            this.cmbTranCode.Validating += new System.ComponentModel.CancelEventHandler(this.cmbTranCode_Validating);
            // 
            // dfQuickTranCode
            // 
            this.dfQuickTranCode.CharacterCasing = System.Windows.Forms.CharacterCasing.Upper;
            this.dfQuickTranCode.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfQuickTranCode.Location = new System.Drawing.Point(104, 13);
            this.dfQuickTranCode.MaxLength = 3;
            this.dfQuickTranCode.Name = "dfQuickTranCode";
            this.dfQuickTranCode.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfQuickTranCode.PhoenixUIControl.ObjectId = 16;
            this.dfQuickTranCode.PreviousValue = null;
            this.dfQuickTranCode.Size = new System.Drawing.Size(38, 20);
            this.dfQuickTranCode.TabIndex = 1;
            this.dfQuickTranCode.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfQuickTranCode_PhoenixUIValidateEvent);
            this.dfQuickTranCode.PhoenixUIEditedEvent += new Phoenix.Windows.Forms.ValueEditedEventHandler(this.dfQuickTranCode_PhoenixUIEditedEvent);
            this.dfQuickTranCode.KeyUp += new System.Windows.Forms.KeyEventHandler(this.dfQuickTranCode_KeyUp);
            // 
            // lblTranCode
            // 
            this.lblTranCode.AutoEllipsis = true;
            this.lblTranCode.Location = new System.Drawing.Point(4, 13);
            this.lblTranCode.Name = "lblTranCode";
            this.lblTranCode.PhoenixUIControl.ObjectId = 16;
            this.lblTranCode.Size = new System.Drawing.Size(72, 21);
            this.lblTranCode.TabIndex = 0;
            this.lblTranCode.Text = "Tran Code:";
            // 
            // cmbRegCC
            // 
            this.cmbRegCC.Location = new System.Drawing.Point(432, 39);
            this.cmbRegCC.Name = "cmbRegCC";
            this.cmbRegCC.PhoenixUIControl.IsEnabled = Phoenix.Windows.Forms.EnableState.DisableShowText;
            this.cmbRegCC.PhoenixUIControl.IsVisible = Phoenix.Windows.Forms.VisibilityState.Hide;
            this.cmbRegCC.PhoenixUIControl.ObjectId = 68;
            this.cmbRegCC.Size = new System.Drawing.Size(175, 21);
            this.cmbRegCC.TabIndex = 22;
            this.cmbRegCC.TabStop = false;
            this.cmbRegCC.Value = null;
            this.cmbRegCC.Visible = false;
            // 
            // cmbEndPoint
            // 
            this.cmbEndPoint.Location = new System.Drawing.Point(432, 39);
            this.cmbEndPoint.Name = "cmbEndPoint";
            this.cmbEndPoint.PhoenixUIControl.ObjectId = 21;
            this.cmbEndPoint.Size = new System.Drawing.Size(238, 21);
            this.cmbEndPoint.TabIndex = 16;
            this.cmbEndPoint.Value = null;
            this.cmbEndPoint.Visible = false;
            // 
            // cmbUmbCode
            // 
            this.cmbUmbCode.Location = new System.Drawing.Point(432, 39);
            this.cmbUmbCode.Name = "cmbUmbCode";
            this.cmbUmbCode.PhoenixUIControl.ObjectId = 20;
            this.cmbUmbCode.Size = new System.Drawing.Size(238, 21);
            this.cmbUmbCode.TabIndex = 18;
            this.cmbUmbCode.Value = null;
            this.cmbUmbCode.Visible = false;
            // 
            // dfUMBCode
            // 
            this.dfUMBCode.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfUMBCode.Location = new System.Drawing.Point(432, 39);
            this.dfUMBCode.Name = "dfUMBCode";
            this.dfUMBCode.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfUMBCode.PhoenixUIControl.ObjectId = 180;
            this.dfUMBCode.PreviousValue = null;
            this.dfUMBCode.Size = new System.Drawing.Size(233, 20);
            this.dfUMBCode.TabIndex = 20;
            this.dfUMBCode.Visible = false;
            // 
            // lblUMBCode
            // 
            this.lblUMBCode.AutoEllipsis = true;
            this.lblUMBCode.Location = new System.Drawing.Point(356, 39);
            this.lblUMBCode.Name = "lblUMBCode";
            this.lblUMBCode.PhoenixUIControl.ObjectId = 180;
            this.lblUMBCode.Size = new System.Drawing.Size(76, 21);
            this.lblUMBCode.TabIndex = 10;
            this.lblUMBCode.Text = "UMB Code:";
            // 
            // lblUtility
            // 
            this.lblUtility.AutoEllipsis = true;
            this.lblUtility.Location = new System.Drawing.Point(356, 43);
            this.lblUtility.Name = "lblUtility";
            this.lblUtility.PhoenixUIControl.ObjectId = 22;
            this.lblUtility.Size = new System.Drawing.Size(71, 13);
            this.lblUtility.TabIndex = 11;
            this.lblUtility.Text = "Utility:";
            this.lblUtility.Visible = false;
            // 
            // lblDraweeBank
            // 
            this.lblDraweeBank.AutoEllipsis = true;
            this.lblDraweeBank.Location = new System.Drawing.Point(356, 43);
            this.lblDraweeBank.Name = "lblDraweeBank";
            this.lblDraweeBank.PhoenixUIControl.ObjectId = 21;
            this.lblDraweeBank.Size = new System.Drawing.Size(71, 13);
            this.lblDraweeBank.TabIndex = 17;
            this.lblDraweeBank.Text = "Drawee Bank:";
            this.lblDraweeBank.Visible = false;
            // 
            // lblIRACategory
            // 
            this.lblIRACategory.AutoEllipsis = true;
            this.lblIRACategory.Location = new System.Drawing.Point(356, 43);
            this.lblIRACategory.Name = "lblIRACategory";
            this.lblIRACategory.PhoenixUIControl.ObjectId = 20;
            this.lblIRACategory.Size = new System.Drawing.Size(71, 13);
            this.lblIRACategory.TabIndex = 19;
            this.lblIRACategory.Text = "IRA Category:";
            this.lblIRACategory.Visible = false;
            // 
            // dfOnUsSignatures
            // 
            this.dfOnUsSignatures.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfOnUsSignatures.Location = new System.Drawing.Point(282, 284);
            this.dfOnUsSignatures.Name = "dfOnUsSignatures";
            this.dfOnUsSignatures.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfOnUsSignatures.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfOnUsSignatures.PhoenixUIControl.ObjectId = 192;
            this.dfOnUsSignatures.PreviousValue = null;
            this.dfOnUsSignatures.ReadOnly = true;
            this.dfOnUsSignatures.Size = new System.Drawing.Size(220, 13);
            this.dfOnUsSignatures.TabIndex = 73;
            this.dfOnUsSignatures.TabStop = false;
            // 
            // dfOnUsTitle1
            // 
            this.dfOnUsTitle1.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfOnUsTitle1.Location = new System.Drawing.Point(107, 263);
            this.dfOnUsTitle1.Name = "dfOnUsTitle1";
            this.dfOnUsTitle1.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfOnUsTitle1.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfOnUsTitle1.PhoenixUIControl.ObjectId = 192;
            this.dfOnUsTitle1.PreviousValue = null;
            this.dfOnUsTitle1.ReadOnly = true;
            this.dfOnUsTitle1.Size = new System.Drawing.Size(180, 13);
            this.dfOnUsTitle1.TabIndex = 69;
            this.dfOnUsTitle1.TabStop = false;
            // 
            // dfOnUsTitle2
            // 
            this.dfOnUsTitle2.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfOnUsTitle2.Location = new System.Drawing.Point(107, 284);
            this.dfOnUsTitle2.Name = "dfOnUsTitle2";
            this.dfOnUsTitle2.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfOnUsTitle2.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfOnUsTitle2.PhoenixUIControl.ObjectId = 193;
            this.dfOnUsTitle2.PreviousValue = null;
            this.dfOnUsTitle2.ReadOnly = true;
            this.dfOnUsTitle2.Size = new System.Drawing.Size(192, 13);
            this.dfOnUsTitle2.TabIndex = 72;
            this.dfOnUsTitle2.TabStop = false;
            // 
            // gbAccountInformation
            // 
            this.gbAccountInformation.Controls.Add(this.lblNonCustomer);
            this.gbAccountInformation.Controls.Add(this.cbPayrollTran);
            this.gbAccountInformation.Controls.Add(this.dfAcctNickname);
            this.gbAccountInformation.Controls.Add(this.panelAvailBal);
            this.gbAccountInformation.Controls.Add(this.dfAcctId);
            this.gbAccountInformation.Controls.Add(this.dfBatchID);
            this.gbAccountInformation.Controls.Add(this.pdfInfo);
            this.gbAccountInformation.Controls.Add(this.dfTitle2);
            this.gbAccountInformation.Controls.Add(this.lblTitle2);
            this.gbAccountInformation.Controls.Add(this.dfTitle1);
            this.gbAccountInformation.Controls.Add(this.lblTitle1);
            this.gbAccountInformation.Controls.Add(this.cmbCrncy);
            this.gbAccountInformation.Controls.Add(this.cbPbPresent);
            this.gbAccountInformation.Controls.Add(this.dfAcctNo);
            this.gbAccountInformation.Controls.Add(this.lbl);
            this.gbAccountInformation.Controls.Add(this.cmbAcctType);
            this.gbAccountInformation.Controls.Add(this.dfTabTitle0);
            this.gbAccountInformation.Controls.Add(this.dfTabTitle4);
            this.gbAccountInformation.Controls.Add(this.dfTabTitle3);
            this.gbAccountInformation.Controls.Add(this.dfTabTitle1);
            this.gbAccountInformation.Controls.Add(this.lblCurrency);
            this.gbAccountInformation.Controls.Add(this.lblAccount);
            this.gbAccountInformation.Controls.Add(this.cbRetirement);
            this.gbAccountInformation.Location = new System.Drawing.Point(4, 0);
            this.gbAccountInformation.Name = "gbAccountInformation";
            this.gbAccountInformation.PhoenixUIControl.ObjectId = 5;
            this.gbAccountInformation.Size = new System.Drawing.Size(676, 129);
            this.gbAccountInformation.TabIndex = 0;
            this.gbAccountInformation.TabStop = false;
            this.gbAccountInformation.Text = "Account Information";
            // 
            // lblNonCustomer
            // 
            this.lblNonCustomer.AutoEllipsis = true;
            this.lblNonCustomer.Location = new System.Drawing.Point(335, 17);
            this.lblNonCustomer.Name = "lblNonCustomer";
            this.lblNonCustomer.PhoenixUIControl.ObjectId = 209;
            this.lblNonCustomer.Size = new System.Drawing.Size(102, 22);
            this.lblNonCustomer.TabIndex = 5;
            this.lblNonCustomer.Text = "*Non-customer";
            this.lblNonCustomer.Visible = false;
            // 
            // cbPayrollTran
            // 
            this.cbPayrollTran.BackColor = System.Drawing.SystemColors.Control;
            this.cbPayrollTran.Checked = true;
            this.cbPayrollTran.CheckState = System.Windows.Forms.CheckState.Checked;
            this.cbPayrollTran.Location = new System.Drawing.Point(520, 17);
            this.cbPayrollTran.Name = "cbPayrollTran";
            this.cbPayrollTran.PhoenixUIControl.ObjectId = 175;
            this.cbPayrollTran.Size = new System.Drawing.Size(152, 20);
            this.cbPayrollTran.TabIndex = 6;
            this.cbPayrollTran.Text = "Cash Withdrawal for Payroll";
            this.cbPayrollTran.UseVisualStyleBackColor = false;
            this.cbPayrollTran.Value = null;
            this.cbPayrollTran.Visible = false;
            this.cbPayrollTran.CheckedChanged += new System.EventHandler(this.cbPayrollTran_CheckedChanged);
            // 
            // dfAcctNickname
            // 
            this.dfAcctNickname.Location = new System.Drawing.Point(324, 22);
            this.dfAcctNickname.MaxLength = 40;
            this.dfAcctNickname.Name = "dfAcctNickname";
            this.dfAcctNickname.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfAcctNickname.PhoenixUIControl.XmlTag = "AcctNickname";
            this.dfAcctNickname.PreviousValue = null;
            this.dfAcctNickname.Size = new System.Drawing.Size(120, 13);
            this.dfAcctNickname.TabIndex = 4;
            // 
            // panelAvailBal
            // 
            this.panelAvailBal.Controls.Add(this.dfColBal);
            this.panelAvailBal.Controls.Add(this.lblColBal);
            this.panelAvailBal.Controls.Add(this.dfCurBal);
            this.panelAvailBal.Controls.Add(this.lblCurBal);
            this.panelAvailBal.Controls.Add(this.dfAvailBal);
            this.panelAvailBal.Controls.Add(this.lblAvailBal);
            this.panelAvailBal.Location = new System.Drawing.Point(4, 95);
            this.panelAvailBal.Name = "panelAvailBal";
            this.panelAvailBal.Size = new System.Drawing.Size(668, 30);
            this.panelAvailBal.TabIndex = 14;
            // 
            // dfColBal
            // 
            this.dfColBal.Location = new System.Drawing.Point(580, 2);
            this.dfColBal.Multiline = true;
            this.dfColBal.Name = "dfColBal";
            this.dfColBal.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfColBal.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfColBal.PhoenixUIControl.IsNullable = Phoenix.Windows.Forms.NullabilityState.Null;
            this.dfColBal.PreviousValue = null;
            this.dfColBal.Size = new System.Drawing.Size(82, 17);
            this.dfColBal.TabIndex = 5;
            // 
            // lblColBal
            // 
            this.lblColBal.AutoEllipsis = true;
            this.lblColBal.Location = new System.Drawing.Point(476, 0);
            this.lblColBal.Name = "lblColBal";
            this.lblColBal.PhoenixUIControl.ObjectId = 188;
            this.lblColBal.Size = new System.Drawing.Size(100, 22);
            this.lblColBal.TabIndex = 4;
            this.lblColBal.Text = "Collected Balance:";
            // 
            // dfCurBal
            // 
            this.dfCurBal.Location = new System.Drawing.Point(340, 2);
            this.dfCurBal.Multiline = true;
            this.dfCurBal.Name = "dfCurBal";
            this.dfCurBal.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfCurBal.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfCurBal.PhoenixUIControl.IsNullable = Phoenix.Windows.Forms.NullabilityState.Null;
            this.dfCurBal.PreviousValue = null;
            this.dfCurBal.Size = new System.Drawing.Size(82, 17);
            this.dfCurBal.TabIndex = 3;
            // 
            // lblCurBal
            // 
            this.lblCurBal.AutoEllipsis = true;
            this.lblCurBal.Location = new System.Drawing.Point(244, 0);
            this.lblCurBal.Name = "lblCurBal";
            this.lblCurBal.PhoenixUIControl.ObjectId = 187;
            this.lblCurBal.Size = new System.Drawing.Size(92, 22);
            this.lblCurBal.TabIndex = 2;
            this.lblCurBal.Text = "Current Balance:";
            // 
            // dfAvailBal
            // 
            this.dfAvailBal.Location = new System.Drawing.Point(112, 2);
            this.dfAvailBal.Multiline = true;
            this.dfAvailBal.Name = "dfAvailBal";
            this.dfAvailBal.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfAvailBal.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfAvailBal.PhoenixUIControl.IsNullable = Phoenix.Windows.Forms.NullabilityState.Null;
                        this.dfAvailBal.PreviousValue = null;
            this.dfAvailBal.Size = new System.Drawing.Size(82, 17);
            this.dfAvailBal.TabIndex = 1;
            // 
            // lblAvailBal
            // 
            this.lblAvailBal.AutoEllipsis = true;
            this.lblAvailBal.Location = new System.Drawing.Point(0, 0);
            this.lblAvailBal.Name = "lblAvailBal";
            this.lblAvailBal.PhoenixUIControl.ObjectId = 186;
            this.lblAvailBal.Size = new System.Drawing.Size(108, 22);
            this.lblAvailBal.TabIndex = 0;
            this.lblAvailBal.Text = "Available Balance:";
            // 
            // dfAcctId
            // 
            this.dfAcctId.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfAcctId.Location = new System.Drawing.Point(401, 337);
            this.dfAcctId.Name = "dfAcctId";
            this.dfAcctId.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfAcctId.PhoenixUIControl.ObjectId = 67;
            this.dfAcctId.PreviousValue = null;
            this.dfAcctId.Size = new System.Drawing.Size(52, 20);
            this.dfAcctId.TabIndex = 17;
            this.dfAcctId.Visible = false;
            // 
            // dfBatchID
            // 
            this.dfBatchID.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfBatchID.Location = new System.Drawing.Point(401, 337);
            this.dfBatchID.Name = "dfBatchID";
            this.dfBatchID.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfBatchID.PhoenixUIControl.ObjectId = 66;
            this.dfBatchID.PreviousValue = null;
            this.dfBatchID.Size = new System.Drawing.Size(52, 20);
            this.dfBatchID.TabIndex = 8;
            this.dfBatchID.Visible = false;
            // 
            // pdfInfo
            // 
            this.pdfInfo.BorderStyle = System.Windows.Forms.BorderStyle.None;
            this.pdfInfo.Location = new System.Drawing.Point(392, 43);
            this.pdfInfo.Name = "pdfInfo";
            this.pdfInfo.ReadOnly = true;
            this.pdfInfo.Size = new System.Drawing.Size(276, 47);
            this.pdfInfo.TabIndex = 12;
            this.pdfInfo.TabStop = false;
            this.pdfInfo.Text = "";
            // 
            // dfTitle2
            // 
            this.dfTitle2.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTitle2.Location = new System.Drawing.Point(100, 72);
            this.dfTitle2.Name = "dfTitle2";
            this.dfTitle2.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTitle2.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfTitle2.PhoenixUIControl.ObjectId = 13;
            this.dfTitle2.PreviousValue = null;
            this.dfTitle2.ReadOnly = true;
            this.dfTitle2.Size = new System.Drawing.Size(281, 13);
            this.dfTitle2.TabIndex = 14;
            this.dfTitle2.TabStop = false;
            // 
            // lblTitle2
            // 
            this.lblTitle2.AutoEllipsis = true;
            this.lblTitle2.Location = new System.Drawing.Point(4, 73);
            this.lblTitle2.Name = "lblTitle2";
            this.lblTitle2.PhoenixUIControl.ObjectId = 13;
            this.lblTitle2.Size = new System.Drawing.Size(84, 13);
            this.lblTitle2.TabIndex = 13;
            this.lblTitle2.Text = "Title 2:";
            // 
            // dfTitle1
            // 
            this.dfTitle1.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTitle1.Location = new System.Drawing.Point(100, 47);
            this.dfTitle1.Name = "dfTitle1";
            this.dfTitle1.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTitle1.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfTitle1.PhoenixUIControl.ObjectId = 11;
            this.dfTitle1.PreviousValue = null;
            this.dfTitle1.ReadOnly = true;
            this.dfTitle1.Size = new System.Drawing.Size(281, 13);
            this.dfTitle1.TabIndex = 11;
            this.dfTitle1.TabStop = false;
            // 
            // lblTitle1
            // 
            this.lblTitle1.AutoEllipsis = true;
            this.lblTitle1.Location = new System.Drawing.Point(4, 47);
            this.lblTitle1.Name = "lblTitle1";
            this.lblTitle1.PhoenixUIControl.ObjectId = 11;
            this.lblTitle1.Size = new System.Drawing.Size(82, 18);
            this.lblTitle1.TabIndex = 10;
            this.lblTitle1.Text = "Title 1:";
            // 
            // cmbCrncy
            // 
            this.cmbCrncy.Location = new System.Drawing.Point(612, 13);
            this.cmbCrncy.Name = "cmbCrncy";
            this.cmbCrncy.PhoenixUIControl.ObjectId = 10;
            this.cmbCrncy.Size = new System.Drawing.Size(61, 21);
            this.cmbCrncy.TabIndex = 9;
            this.cmbCrncy.Value = null;
            this.cmbCrncy.Visible = false;
            // 
            // cbPbPresent
            // 
            this.cbPbPresent.BackColor = System.Drawing.SystemColors.Control;
            this.cbPbPresent.Checked = true;
            this.cbPbPresent.CheckState = System.Windows.Forms.CheckState.Checked;
            this.cbPbPresent.Location = new System.Drawing.Point(524, 17);
            this.cbPbPresent.Name = "cbPbPresent";
            this.cbPbPresent.PhoenixUIControl.ObjectId = 9;
            this.cbPbPresent.Size = new System.Drawing.Size(104, 20);
            this.cbPbPresent.TabIndex = 7;
            this.cbPbPresent.Text = "Passbook Present";
            this.cbPbPresent.UseVisualStyleBackColor = false;
            this.cbPbPresent.Value = null;
            this.cbPbPresent.Visible = false;
            // 
            // dfAcctNo
            // 
            this.dfAcctNo.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfAcctNo.Location = new System.Drawing.Point(156, 17);
            this.dfAcctNo.MaxLength = 12;
            this.dfAcctNo.Name = "dfAcctNo";
            this.dfAcctNo.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfAcctNo.PhoenixUIControl.ObjectId = 8;
            this.dfAcctNo.PreviousValue = null;
            this.dfAcctNo.Size = new System.Drawing.Size(163, 20);
            this.dfAcctNo.TabIndex = 3;
            this.dfAcctNo.PhoenixUIValidateEvent += new Phoenix.Windows.Forms.ValidateEventHandler(this.dfAcctNo_PhoenixUIValidateEvent);
            this.dfAcctNo.GotFocus += new System.EventHandler(this.dfAcctNo_GotFocus);
            this.dfAcctNo.KeyUp += new System.Windows.Forms.KeyEventHandler(this.dfAcctNo_KeyUp);
            this.dfAcctNo.LostFocus += new System.EventHandler(this.dfAcctNo_LostFocus);
            // 
            // lbl
            // 
            this.lbl.AutoEllipsis = true;
            this.lbl.Location = new System.Drawing.Point(152, 17);
            this.lbl.Name = "lbl";
            this.lbl.PhoenixUIControl.ObjectId = 8;
            this.lbl.Size = new System.Drawing.Size(6, 13);
            this.lbl.TabIndex = 2;
            this.lbl.Text = "-";
            this.lbl.Visible = false;
            // 
            // cmbAcctType
            // 
            this.cmbAcctType.DisplayType = Phoenix.Windows.Forms.UIComboDisplayType.CodeValue;
            this.cmbAcctType.Location = new System.Drawing.Point(92, 17);
            this.cmbAcctType.Name = "cmbAcctType";
            this.cmbAcctType.PhoenixUIControl.ObjectId = 7;
            this.cmbAcctType.Size = new System.Drawing.Size(61, 21);
            this.cmbAcctType.TabIndex = 1;
            this.cmbAcctType.Value = null;
            this.cmbAcctType.PhoenixUIEditedEvent += new Phoenix.Windows.Forms.ValueEditedEventHandler(this.cmbAcctType_PhoenixUIEditedEvent);
            this.cmbAcctType.PhoenixUIEnterEvent += new Phoenix.Windows.Forms.EnterEventHandler(this.cmbAcctType_PhoenixUIEnterEvent);
            this.cmbAcctType.PhoenixUILeaveEvent += new Phoenix.Windows.Forms.LeaveEventHandler(this.cmbAcctType_PhoenixUILeaveEvent);
            this.cmbAcctType.SelectedIndexChanged += new System.EventHandler(this.cmbAcctType_SelectedIndexChanged);
            this.cmbAcctType.Validating += new System.ComponentModel.CancelEventHandler(this.cmbAcctType_Validating);
            // 
            // dfTabTitle0
            // 
            this.dfTabTitle0.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTabTitle0.Location = new System.Drawing.Point(600, 56);
            this.dfTabTitle0.Name = "dfTabTitle0";
            this.dfTabTitle0.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTabTitle0.PhoenixUIControl.ObjectId = 1;
            this.dfTabTitle0.PreviousValue = null;
            this.dfTabTitle0.Size = new System.Drawing.Size(52, 20);
            this.dfTabTitle0.TabIndex = 15;
            this.dfTabTitle0.Visible = false;
            // 
            // dfTabTitle4
            // 
            this.dfTabTitle4.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTabTitle4.Location = new System.Drawing.Point(600, 56);
            this.dfTabTitle4.Name = "dfTabTitle4";
            this.dfTabTitle4.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTabTitle4.PhoenixUIControl.ObjectId = 69;
            this.dfTabTitle4.PreviousValue = null;
            this.dfTabTitle4.Size = new System.Drawing.Size(52, 20);
            this.dfTabTitle4.TabIndex = 10;
            this.dfTabTitle4.Visible = false;
            // 
            // dfTabTitle3
            // 
            this.dfTabTitle3.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTabTitle3.Location = new System.Drawing.Point(600, 56);
            this.dfTabTitle3.Name = "dfTabTitle3";
            this.dfTabTitle3.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTabTitle3.PhoenixUIControl.ObjectId = 4;
            this.dfTabTitle3.PreviousValue = null;
            this.dfTabTitle3.Size = new System.Drawing.Size(52, 20);
            this.dfTabTitle3.TabIndex = 11;
            this.dfTabTitle3.Visible = false;
            // 
            // dfTabTitle1
            // 
            this.dfTabTitle1.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTabTitle1.Location = new System.Drawing.Point(600, 56);
            this.dfTabTitle1.Name = "dfTabTitle1";
            this.dfTabTitle1.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTabTitle1.PhoenixUIControl.ObjectId = 2;
            this.dfTabTitle1.PreviousValue = null;
            this.dfTabTitle1.Size = new System.Drawing.Size(52, 20);
            this.dfTabTitle1.TabIndex = 12;
            this.dfTabTitle1.Visible = false;
            // 
            // lblCurrency
            // 
            this.lblCurrency.AutoEllipsis = true;
            this.lblCurrency.Location = new System.Drawing.Point(508, 108);
            this.lblCurrency.Name = "lblCurrency";
            this.lblCurrency.PhoenixUIControl.ObjectId = 10;
            this.lblCurrency.Size = new System.Drawing.Size(69, 13);
            this.lblCurrency.TabIndex = 16;
            this.lblCurrency.Text = "Currency";
            // 
            // lblAccount
            // 
            this.lblAccount.AutoEllipsis = true;
            this.lblAccount.Location = new System.Drawing.Point(4, 17);
            this.lblAccount.Name = "lblAccount";
            this.lblAccount.PhoenixUIControl.ObjectId = 7;
            this.lblAccount.Size = new System.Drawing.Size(69, 22);
            this.lblAccount.TabIndex = 0;
            this.lblAccount.Text = "Account:";
            // 
            // cbRetirement
            // 
            this.cbRetirement.BackColor = System.Drawing.SystemColors.Control;
            this.cbRetirement.Checked = true;
            this.cbRetirement.CheckState = System.Windows.Forms.CheckState.Checked;
            this.cbRetirement.Location = new System.Drawing.Point(544, 17);
            this.cbRetirement.Name = "cbRetirement";
            this.cbRetirement.PhoenixUIControl.ObjectId = 178;
            this.cbRetirement.Size = new System.Drawing.Size(76, 20);
            this.cbRetirement.TabIndex = 8;
            this.cbRetirement.Text = "Retirement";
            this.cbRetirement.UseVisualStyleBackColor = false;
            this.cbRetirement.Value = null;
            this.cbRetirement.Visible = false;
            this.cbRetirement.CheckedChanged += new System.EventHandler(this.cbRetirement_CheckedChanged);
            // 
            // Name1
            // 
            this.Name1.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(255)))), ((int)(((byte)(255)))));
            this.Name1.Controls.Add(this.gbTransactionSet);
            this.Name1.Location = new System.Drawing.Point(4, 22);
            controlInfo2.ObjectId = 2;
            this.Name1.MLInfo = controlInfo2;
            this.Name1.Name = "Name1";
            this.Name1.ObjectId = 2;
            this.Name1.Size = new System.Drawing.Size(682, 422);
            this.Name1.TabIndex = 1;
            this.Name1.Text = "View Transaction";
            // 
            // gbTransactionSet
            // 
            this.gbTransactionSet.Controls.Add(this.dfDifference1);
            this.gbTransactionSet.Controls.Add(this.ctwTranSet);
            this.gbTransactionSet.Controls.Add(this.lblDifference1);
            this.gbTransactionSet.Controls.Add(this.lblTotalDebits1);
            this.gbTransactionSet.Controls.Add(this.dfTotalCredits1);
            this.gbTransactionSet.Controls.Add(this.dfTotalDebits1);
            this.gbTransactionSet.Controls.Add(this.lblTotalCredits1);
            this.gbTransactionSet.Location = new System.Drawing.Point(4, 0);
            this.gbTransactionSet.Name = "gbTransactionSet";
            this.gbTransactionSet.PhoenixUIControl.ObjectId = 43;
            this.gbTransactionSet.Size = new System.Drawing.Size(676, 457);
            this.gbTransactionSet.TabIndex = 0;
            this.gbTransactionSet.TabStop = false;
            this.gbTransactionSet.Text = "Transaction Set";
            // 
            // dfDifference1
            // 
            this.dfDifference1.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfDifference1.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfDifference1.Location = new System.Drawing.Point(558, 436);
            this.dfDifference1.Name = "dfDifference1";
            this.dfDifference1.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfDifference1.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfDifference1.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfDifference1.PhoenixUIControl.MaxPrecision = 14;
            this.dfDifference1.PhoenixUIControl.ObjectId = 42;
            this.dfDifference1.PreviousValue = null;
            this.dfDifference1.ReadOnly = true;
            this.dfDifference1.Size = new System.Drawing.Size(100, 13);
            this.dfDifference1.TabIndex = 6;
            this.dfDifference1.TabStop = false;
            // 
            // ctwTranSet
            // 
            this.ctwTranSet.Columns.AddRange(new Phoenix.Windows.Forms.PGridColumn[] {
            this.colRimNo,
            this.colAccount,
            this.colAcctNickname,
            this.colTranDesc,
            this.colComponents,
            this.colCompAmts,
            this.colActualRate,
            this.colExchRate,
            this.colEquivAmt,
            this.colEquivAmtStr,
            this.colTfrAccountInfo,
            this.colDescription,
            this.colReference,
            this.colTranIndex});
            this.ctwTranSet.IsMaxNumRowsCustomized = false;
            this.ctwTranSet.ItemWordWrap = true;
            this.ctwTranSet.LinesInHeader = 2;
            this.ctwTranSet.Location = new System.Drawing.Point(6, 17);
            this.ctwTranSet.Name = "ctwTranSet";
            this.ctwTranSet.Size = new System.Drawing.Size(666, 413);
            this.ctwTranSet.TabIndex = 0;
            this.ctwTranSet.SelectedIndexChanged += new Phoenix.Windows.Forms.GridClickedEventHandler(this.ctwTranSet_SelectedIndexChanged);
            this.ctwTranSet.Click += new System.EventHandler(this.ctwTranSet_Click);
            // 
            // colRimNo
            // 
            this.colRimNo.PhoenixUIControl.ObjectId = 203;
            this.colRimNo.Title = "Rim No";
            // 
            // colAccount
            // 
            this.colAccount.PhoenixUIControl.ObjectId = 45;
            this.colAccount.PhoenixUIControl.XmlTag = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" +
    "xxxxxxxx";
            this.colAccount.Title = "Account";
            this.colAccount.Width = 172;
            // 
            // colAcctNickname
            // 
            this.colAcctNickname.PhoenixUIControl.ObjectId = 197;
            this.colAcctNickname.PhoenixUIControl.XmlTag = "0";
            this.colAcctNickname.Title = "Nickname";
            // 
            // colTranDesc
            // 
            this.colTranDesc.PhoenixUIControl.ObjectId = 46;
            this.colTranDesc.PhoenixUIControl.XmlTag = "";
            this.colTranDesc.Title = "Transaction Code";
            this.colTranDesc.Width = 216;
            // 
            // colComponents
            // 
            this.colComponents.PhoenixUIControl.ObjectId = 47;
            this.colComponents.PhoenixUIControl.XmlTag = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" +
    "xxxxxxxxxx";
            this.colComponents.Title = "Components";
            this.colComponents.Width = 124;
            // 
            // colCompAmts
            // 
            this.colCompAmts.PhoenixUIControl.ObjectId = 48;
            this.colCompAmts.PhoenixUIControl.XmlTag = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" +
    "xxxxxxxxxxx";
            this.colCompAmts.Title = "Amounts";
            this.colCompAmts.Width = 114;
            // 
            // colActualRate
            // 
            this.colActualRate.PhoenixUIControl.XmlTag = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" +
    "xxxxxxxxxxxx";
            this.colActualRate.Title = "Column";
            this.colActualRate.Visible = false;
            this.colActualRate.Width = 0;
            // 
            // colExchRate
            // 
            this.colExchRate.PhoenixUIControl.ObjectId = 94;
            this.colExchRate.PhoenixUIControl.XmlTag = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" +
    "xxxxxxxxxxxxx";
            this.colExchRate.Title = "Column";
            this.colExchRate.Visible = false;
            this.colExchRate.Width = 0;
            // 
            // colEquivAmt
            // 
            this.colEquivAmt.PhoenixUIControl.ObjectId = 119;
            this.colEquivAmt.PhoenixUIControl.XmlTag = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" +
    "xxxxxxxxxxxxxx";
            this.colEquivAmt.Title = "Column";
            this.colEquivAmt.Visible = false;
            this.colEquivAmt.Width = 0;
            // 
            // colEquivAmtStr
            // 
            this.colEquivAmtStr.PhoenixUIControl.ObjectId = 119;
            this.colEquivAmtStr.PhoenixUIControl.XmlTag = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" +
    "xxxxxxxxxxxxxxx";
            this.colEquivAmtStr.Title = "Column";
            this.colEquivAmtStr.Visible = false;
            this.colEquivAmtStr.Width = 0;
            // 
            // colTfrAccountInfo
            // 
            this.colTfrAccountInfo.PhoenixUIControl.ObjectId = 148;
            this.colTfrAccountInfo.PhoenixUIControl.XmlTag = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" +
    "xxxxxxxxxxxxxxxx";
            this.colTfrAccountInfo.Title = "Transfer Account";
            this.colTfrAccountInfo.Width = 132;
            // 
            // colDescription
            // 
            this.colDescription.PhoenixUIControl.ObjectId = 111;
            this.colDescription.PhoenixUIControl.XmlTag = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" +
    "xxxxxxxxxxxxxxxxx";
            this.colDescription.Title = "Description";
            this.colDescription.Width = 157;
            // 
            // colReference
            // 
            this.colReference.PhoenixUIControl.ObjectId = 139;
            this.colReference.PhoenixUIControl.XmlTag = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" +
    "xxxxxxxxxxxxxxxxxx";
            this.colReference.Title = "Reference";
            this.colReference.Width = 167;
            // 
            // colTranIndex
            // 
            this.colTranIndex.DataType = Phoenix.Windows.Forms.UIDataType.Integer;
            this.colTranIndex.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Integer;
            this.colTranIndex.PhoenixUIControl.XmlTag = "00";
            this.colTranIndex.Title = "Column";
            this.colTranIndex.Visible = false;
            this.colTranIndex.Width = 0;
            // 
            // lblDifference1
            // 
            this.lblDifference1.AutoEllipsis = true;
            this.lblDifference1.Font = new System.Drawing.Font("Microsoft Sans Serif", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblDifference1.Location = new System.Drawing.Point(442, 436);
            this.lblDifference1.Name = "lblDifference1";
            this.lblDifference1.PhoenixUIControl.ObjectId = 42;
            this.lblDifference1.Size = new System.Drawing.Size(90, 13);
            this.lblDifference1.TabIndex = 5;
            this.lblDifference1.Text = "Difference";
            // 
            // lblTotalDebits1
            // 
            this.lblTotalDebits1.AutoEllipsis = true;
            this.lblTotalDebits1.Font = new System.Drawing.Font("Microsoft Sans Serif", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblTotalDebits1.Location = new System.Drawing.Point(6, 436);
            this.lblTotalDebits1.Name = "lblTotalDebits1";
            this.lblTotalDebits1.PhoenixUIControl.ObjectId = 40;
            this.lblTotalDebits1.Size = new System.Drawing.Size(90, 13);
            this.lblTotalDebits1.TabIndex = 1;
            this.lblTotalDebits1.Text = "Total Debits";
            // 
            // dfTotalCredits1
            // 
            this.dfTotalCredits1.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfTotalCredits1.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfTotalCredits1.Location = new System.Drawing.Point(314, 436);
            this.dfTotalCredits1.Name = "dfTotalCredits1";
            this.dfTotalCredits1.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfTotalCredits1.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfTotalCredits1.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfTotalCredits1.PhoenixUIControl.MaxPrecision = 14;
            this.dfTotalCredits1.PhoenixUIControl.ObjectId = 41;
            this.dfTotalCredits1.PreviousValue = null;
            this.dfTotalCredits1.ReadOnly = true;
            this.dfTotalCredits1.Size = new System.Drawing.Size(100, 13);
            this.dfTotalCredits1.TabIndex = 4;
            this.dfTotalCredits1.TabStop = false;
            // 
            // dfTotalDebits1
            // 
            this.dfTotalDebits1.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfTotalDebits1.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfTotalDebits1.Location = new System.Drawing.Point(110, 436);
            this.dfTotalDebits1.Name = "dfTotalDebits1";
            this.dfTotalDebits1.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfTotalDebits1.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfTotalDebits1.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfTotalDebits1.PhoenixUIControl.MaxPrecision = 14;
            this.dfTotalDebits1.PhoenixUIControl.ObjectId = 40;
            this.dfTotalDebits1.PreviousValue = null;
            this.dfTotalDebits1.ReadOnly = true;
            this.dfTotalDebits1.Size = new System.Drawing.Size(100, 13);
            this.dfTotalDebits1.TabIndex = 2;
            this.dfTotalDebits1.TabStop = false;
            // 
            // lblTotalCredits1
            // 
            this.lblTotalCredits1.AutoEllipsis = true;
            this.lblTotalCredits1.Font = new System.Drawing.Font("Microsoft Sans Serif", 8.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblTotalCredits1.Location = new System.Drawing.Point(214, 436);
            this.lblTotalCredits1.Name = "lblTotalCredits1";
            this.lblTotalCredits1.PhoenixUIControl.ObjectId = 41;
            this.lblTotalCredits1.Size = new System.Drawing.Size(90, 13);
            this.lblTotalCredits1.TabIndex = 3;
            this.lblTotalCredits1.Text = "Total Credits";
            // 
            // Name2
            // 
            this.Name2.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(255)))), ((int)(((byte)(255)))));
            this.Name2.Location = new System.Drawing.Point(4, 22);
            controlInfo3.ObjectId = 3;
            this.Name2.MLInfo = controlInfo3;
            this.Name2.Name = "Name2";
            this.Name2.ObjectId = 3;
            this.Name2.Size = new System.Drawing.Size(682, 422);
            this.Name2.TabIndex = 3;
            this.Name2.Text = "Search";
            // 
            // Name3
            // 
            this.Name3.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(255)))), ((int)(((byte)(255)))));
            this.Name3.Location = new System.Drawing.Point(4, 22);
            controlInfo4.ObjectId = 4;
            this.Name3.MLInfo = controlInfo4;
            this.Name3.Name = "Name3";
            this.Name3.ObjectId = 4;
            this.Name3.Size = new System.Drawing.Size(682, 422);
            this.Name3.TabIndex = 2;
            this.Name3.Text = "Customer Summary  ";
            // 
            // Name4
            // 
            this.Name4.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(255)))), ((int)(((byte)(255)))));
            this.Name4.Controls.Add(this.gbPrintOptions);
            this.Name4.Controls.Add(this.gbUnbookedItems);
            this.Name4.Controls.Add(this.gbAccountInfo);
            this.Name4.Location = new System.Drawing.Point(4, 22);
            controlInfo5.ObjectId = 69;
            this.Name4.MLInfo = controlInfo5;
            this.Name4.Name = "Name4";
            this.Name4.ObjectId = 69;
            this.Name4.Size = new System.Drawing.Size(682, 422);
            this.Name4.TabIndex = 4;
            this.Name4.Text = "Passbook";
            // 
            // gbPrintOptions
            // 
            this.gbPrintOptions.Controls.Add(this.dfObjectInput);
            this.gbPrintOptions.Controls.Add(this.dfTabTitle2);
            this.gbPrintOptions.Controls.Add(this.cmbPassbookType);
            this.gbPrintOptions.Controls.Add(this.lblPassbookType);
            this.gbPrintOptions.Controls.Add(this.dfPbLines);
            this.gbPrintOptions.Controls.Add(this.lblNumberoflinesinthepassbook);
            this.gbPrintOptions.Location = new System.Drawing.Point(4, 297);
            this.gbPrintOptions.Name = "gbPrintOptions";
            this.gbPrintOptions.PhoenixUIControl.ObjectId = 83;
            this.gbPrintOptions.Size = new System.Drawing.Size(676, 48);
            this.gbPrintOptions.TabIndex = 0;
            this.gbPrintOptions.TabStop = false;
            this.gbPrintOptions.Text = "Print Options";
            // 
            // dfObjectInput
            // 
            this.dfObjectInput.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfObjectInput.Location = new System.Drawing.Point(81, 253);
            this.dfObjectInput.Name = "dfObjectInput";
            this.dfObjectInput.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfObjectInput.PhoenixUIControl.ObjectId = 6;
            this.dfObjectInput.PreviousValue = null;
            this.dfObjectInput.Size = new System.Drawing.Size(13, 20);
            this.dfObjectInput.TabIndex = 0;
            // 
            // dfTabTitle2
            // 
            this.dfTabTitle2.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTabTitle2.Location = new System.Drawing.Point(55, 237);
            this.dfTabTitle2.Name = "dfTabTitle2";
            this.dfTabTitle2.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfTabTitle2.PhoenixUIControl.ObjectId = 3;
            this.dfTabTitle2.PreviousValue = null;
            this.dfTabTitle2.Size = new System.Drawing.Size(52, 20);
            this.dfTabTitle2.TabIndex = 1;
            // 
            // cmbPassbookType
            // 
            this.cmbPassbookType.Location = new System.Drawing.Point(540, 13);
            this.cmbPassbookType.Name = "cmbPassbookType";
            this.cmbPassbookType.PhoenixUIControl.ObjectId = 85;
            this.cmbPassbookType.Size = new System.Drawing.Size(131, 21);
            this.cmbPassbookType.TabIndex = 2;
            this.cmbPassbookType.Value = null;
            // 
            // lblPassbookType
            // 
            this.lblPassbookType.AutoEllipsis = true;
            this.lblPassbookType.Location = new System.Drawing.Point(348, 17);
            this.lblPassbookType.Name = "lblPassbookType";
            this.lblPassbookType.PhoenixUIControl.ObjectId = 85;
            this.lblPassbookType.Size = new System.Drawing.Size(93, 13);
            this.lblPassbookType.TabIndex = 3;
            this.lblPassbookType.Text = "Passbook Type:";
            // 
            // dfPbLines
            // 
            this.dfPbLines.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfPbLines.Location = new System.Drawing.Point(264, 13);
            this.dfPbLines.Name = "dfPbLines";
            this.dfPbLines.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfPbLines.PhoenixUIControl.ObjectId = 84;
            this.dfPbLines.PreviousValue = null;
            this.dfPbLines.Size = new System.Drawing.Size(41, 20);
            this.dfPbLines.TabIndex = 4;
            // 
            // lblNumberoflinesinthepassbook
            // 
            this.lblNumberoflinesinthepassbook.AutoEllipsis = true;
            this.lblNumberoflinesinthepassbook.Location = new System.Drawing.Point(4, 17);
            this.lblNumberoflinesinthepassbook.Name = "lblNumberoflinesinthepassbook";
            this.lblNumberoflinesinthepassbook.PhoenixUIControl.ObjectId = 84;
            this.lblNumberoflinesinthepassbook.Size = new System.Drawing.Size(175, 13);
            this.lblNumberoflinesinthepassbook.TabIndex = 5;
            this.lblNumberoflinesinthepassbook.Text = "Number of lines in the passbook:";
            // 
            // gbUnbookedItems
            // 
            this.gbUnbookedItems.Controls.Add(this.twPassbook);
            this.gbUnbookedItems.Location = new System.Drawing.Point(4, 121);
            this.gbUnbookedItems.Name = "gbUnbookedItems";
            this.gbUnbookedItems.PhoenixUIControl.ObjectId = 76;
            this.gbUnbookedItems.Size = new System.Drawing.Size(676, 174);
            this.gbUnbookedItems.TabIndex = 1;
            this.gbUnbookedItems.TabStop = false;
            this.gbUnbookedItems.Text = "Unbooked Items";
            // 
            // twPassbook
            // 
            this.twPassbook.Columns.AddRange(new Phoenix.Windows.Forms.PGridColumn[] {
            this.colEffectiveDt,
            this.colTCDescription,
            this.colDeposit,
            this.colWithdrawal,
            this.colPbBalance});
            this.twPassbook.IsMaxNumRowsCustomized = false;
            this.twPassbook.LinesInHeader = 2;
            this.twPassbook.Location = new System.Drawing.Point(6, 13);
            this.twPassbook.Name = "twPassbook";
            this.twPassbook.Size = new System.Drawing.Size(662, 155);
            this.twPassbook.TabIndex = 0;
            // 
            // colEffectiveDt
            // 
            this.colEffectiveDt.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Date;
            this.colEffectiveDt.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Date;
            this.colEffectiveDt.PhoenixUIControl.ObjectId = 78;
            this.colEffectiveDt.PhoenixUIControl.XmlTag = "EffectiveDt";
            this.colEffectiveDt.Title = "Date";
            this.colEffectiveDt.Width = 74;
            // 
            // colTCDescription
            // 
            this.colTCDescription.PhoenixUIControl.ObjectId = 79;
            this.colTCDescription.PhoenixUIControl.XmlTag = "PbDescShort";
            this.colTCDescription.Title = "Transaction Description";
            this.colTCDescription.Width = 228;
            // 
            // colDeposit
            // 
            this.colDeposit.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.colDeposit.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.colDeposit.PhoenixUIControl.ObjectId = 80;
            this.colDeposit.PhoenixUIControl.XmlTag = "PbCrAmt";
            this.colDeposit.Title = "Deposits";
            this.colDeposit.Width = 94;
            // 
            // colWithdrawal
            // 
            this.colWithdrawal.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.colWithdrawal.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.colWithdrawal.PhoenixUIControl.ObjectId = 81;
            this.colWithdrawal.PhoenixUIControl.XmlTag = "PbDrAmt";
            this.colWithdrawal.Title = "Withdrawls";
            this.colWithdrawal.Width = 94;
            // 
            // colPbBalance
            // 
            this.colPbBalance.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.colPbBalance.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.colPbBalance.PhoenixUIControl.ObjectId = 82;
            this.colPbBalance.PhoenixUIControl.XmlTag = "PbRunBal";
            this.colPbBalance.Title = "Ending Balance";
            this.colPbBalance.Width = 166;
            // 
            // gbAccountInfo
            // 
            this.gbAccountInfo.Controls.Add(this.lbPbAcctType);
            this.gbAccountInfo.Controls.Add(this.dfEndingBalance);
            this.gbAccountInfo.Controls.Add(this.lblEndingBalance);
            this.gbAccountInfo.Controls.Add(this.dfUnbookedWithdrawals);
            this.gbAccountInfo.Controls.Add(this.lblUnbookedWithdrawals);
            this.gbAccountInfo.Controls.Add(this.dfUnbookedDeposits);
            this.gbAccountInfo.Controls.Add(this.lblUnbookedDeposits);
            this.gbAccountInfo.Controls.Add(this.dfPbBalance);
            this.gbAccountInfo.Controls.Add(this.lblPassbookBalance);
            this.gbAccountInfo.Controls.Add(this.dfPbTitle2);
            this.gbAccountInfo.Controls.Add(this.lblPbTitle2);
            this.gbAccountInfo.Controls.Add(this.dfPbTitle1);
            this.gbAccountInfo.Controls.Add(this.lblPbTitle1);
            this.gbAccountInfo.Controls.Add(this.dfPbAcctNo);
            this.gbAccountInfo.Controls.Add(this.dfPbAcctType);
            this.gbAccountInfo.Controls.Add(this.lblPbAcctNo);
            this.gbAccountInfo.Location = new System.Drawing.Point(4, 0);
            this.gbAccountInfo.Name = "gbAccountInfo";
            this.gbAccountInfo.PhoenixUIControl.ObjectId = 75;
            this.gbAccountInfo.Size = new System.Drawing.Size(676, 121);
            this.gbAccountInfo.TabIndex = 2;
            this.gbAccountInfo.TabStop = false;
            this.gbAccountInfo.Text = "Account Info";
            // 
            // lbPbAcctType
            // 
            this.lbPbAcctType.AutoEllipsis = true;
            this.lbPbAcctType.Location = new System.Drawing.Point(152, 17);
            this.lbPbAcctType.Name = "lbPbAcctType";
            this.lbPbAcctType.Size = new System.Drawing.Size(12, 14);
            this.lbPbAcctType.TabIndex = 15;
            this.lbPbAcctType.Text = "-";
            // 
            // dfEndingBalance
            // 
            this.dfEndingBalance.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfEndingBalance.Location = new System.Drawing.Point(556, 95);
            this.dfEndingBalance.Multiline = true;
            this.dfEndingBalance.Name = "dfEndingBalance";
            this.dfEndingBalance.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfEndingBalance.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfEndingBalance.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfEndingBalance.PhoenixUIControl.ObjectId = 169;
            this.dfEndingBalance.PreviousValue = null;
            this.dfEndingBalance.Size = new System.Drawing.Size(109, 14);
            this.dfEndingBalance.TabIndex = 0;
            // 
            // lblEndingBalance
            // 
            this.lblEndingBalance.AutoEllipsis = true;
            this.lblEndingBalance.Location = new System.Drawing.Point(348, 95);
            this.lblEndingBalance.Name = "lblEndingBalance";
            this.lblEndingBalance.PhoenixUIControl.ObjectId = 169;
            this.lblEndingBalance.Size = new System.Drawing.Size(119, 13);
            this.lblEndingBalance.TabIndex = 1;
            this.lblEndingBalance.Text = "Ending Balance:";
            // 
            // dfUnbookedWithdrawals
            // 
            this.dfUnbookedWithdrawals.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfUnbookedWithdrawals.Location = new System.Drawing.Point(556, 69);
            this.dfUnbookedWithdrawals.Multiline = true;
            this.dfUnbookedWithdrawals.Name = "dfUnbookedWithdrawals";
            this.dfUnbookedWithdrawals.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfUnbookedWithdrawals.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfUnbookedWithdrawals.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfUnbookedWithdrawals.PhoenixUIControl.ObjectId = 168;
            this.dfUnbookedWithdrawals.PreviousValue = null;
            this.dfUnbookedWithdrawals.Size = new System.Drawing.Size(109, 14);
            this.dfUnbookedWithdrawals.TabIndex = 2;
            // 
            // lblUnbookedWithdrawals
            // 
            this.lblUnbookedWithdrawals.AutoEllipsis = true;
            this.lblUnbookedWithdrawals.Location = new System.Drawing.Point(348, 69);
            this.lblUnbookedWithdrawals.Name = "lblUnbookedWithdrawals";
            this.lblUnbookedWithdrawals.PhoenixUIControl.ObjectId = 168;
            this.lblUnbookedWithdrawals.Size = new System.Drawing.Size(163, 13);
            this.lblUnbookedWithdrawals.TabIndex = 3;
            this.lblUnbookedWithdrawals.Text = "Unbooked Withdrawals:";
            // 
            // dfUnbookedDeposits
            // 
            this.dfUnbookedDeposits.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfUnbookedDeposits.Location = new System.Drawing.Point(556, 43);
            this.dfUnbookedDeposits.Multiline = true;
            this.dfUnbookedDeposits.Name = "dfUnbookedDeposits";
            this.dfUnbookedDeposits.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfUnbookedDeposits.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfUnbookedDeposits.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfUnbookedDeposits.PhoenixUIControl.ObjectId = 167;
            this.dfUnbookedDeposits.PreviousValue = null;
            this.dfUnbookedDeposits.Size = new System.Drawing.Size(109, 14);
            this.dfUnbookedDeposits.TabIndex = 4;
            // 
            // lblUnbookedDeposits
            // 
            this.lblUnbookedDeposits.AutoEllipsis = true;
            this.lblUnbookedDeposits.Location = new System.Drawing.Point(348, 43);
            this.lblUnbookedDeposits.Name = "lblUnbookedDeposits";
            this.lblUnbookedDeposits.PhoenixUIControl.ObjectId = 167;
            this.lblUnbookedDeposits.Size = new System.Drawing.Size(163, 13);
            this.lblUnbookedDeposits.TabIndex = 5;
            this.lblUnbookedDeposits.Text = "Unbooked Deposits:";
            // 
            // dfPbBalance
            // 
            this.dfPbBalance.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfPbBalance.Location = new System.Drawing.Point(556, 17);
            this.dfPbBalance.Multiline = true;
            this.dfPbBalance.Name = "dfPbBalance";
            this.dfPbBalance.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Decimal;
            this.dfPbBalance.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfPbBalance.PhoenixUIControl.FormatType = Phoenix.Windows.Forms.UIFieldFormat.Amount;
            this.dfPbBalance.PhoenixUIControl.ObjectId = 74;
            this.dfPbBalance.PreviousValue = null;
            this.dfPbBalance.Size = new System.Drawing.Size(109, 14);
            this.dfPbBalance.TabIndex = 6;
            // 
            // lblPassbookBalance
            // 
            this.lblPassbookBalance.AutoEllipsis = true;
            this.lblPassbookBalance.Location = new System.Drawing.Point(348, 17);
            this.lblPassbookBalance.Name = "lblPassbookBalance";
            this.lblPassbookBalance.PhoenixUIControl.ObjectId = 74;
            this.lblPassbookBalance.Size = new System.Drawing.Size(163, 13);
            this.lblPassbookBalance.TabIndex = 7;
            this.lblPassbookBalance.Text = "Passbook Balance:";
            // 
            // dfPbTitle2
            // 
            this.dfPbTitle2.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfPbTitle2.Location = new System.Drawing.Point(120, 69);
            this.dfPbTitle2.Name = "dfPbTitle2";
            this.dfPbTitle2.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfPbTitle2.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfPbTitle2.PhoenixUIControl.ObjectId = 166;
            this.dfPbTitle2.PreviousValue = null;
            this.dfPbTitle2.ReadOnly = true;
            this.dfPbTitle2.Size = new System.Drawing.Size(192, 13);
            this.dfPbTitle2.TabIndex = 8;
            this.dfPbTitle2.TabStop = false;
            // 
            // lblPbTitle2
            // 
            this.lblPbTitle2.AutoEllipsis = true;
            this.lblPbTitle2.Location = new System.Drawing.Point(4, 69);
            this.lblPbTitle2.Name = "lblPbTitle2";
            this.lblPbTitle2.PhoenixUIControl.ObjectId = 166;
            this.lblPbTitle2.Size = new System.Drawing.Size(94, 13);
            this.lblPbTitle2.TabIndex = 9;
            this.lblPbTitle2.Text = "Title 2:";
            // 
            // dfPbTitle1
            // 
            this.dfPbTitle1.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfPbTitle1.Location = new System.Drawing.Point(120, 43);
            this.dfPbTitle1.Name = "dfPbTitle1";
            this.dfPbTitle1.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfPbTitle1.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfPbTitle1.PhoenixUIControl.ObjectId = 165;
            this.dfPbTitle1.PreviousValue = null;
            this.dfPbTitle1.ReadOnly = true;
            this.dfPbTitle1.Size = new System.Drawing.Size(192, 13);
            this.dfPbTitle1.TabIndex = 10;
            this.dfPbTitle1.TabStop = false;
            // 
            // lblPbTitle1
            // 
            this.lblPbTitle1.AutoEllipsis = true;
            this.lblPbTitle1.Location = new System.Drawing.Point(4, 43);
            this.lblPbTitle1.Name = "lblPbTitle1";
            this.lblPbTitle1.PhoenixUIControl.ObjectId = 165;
            this.lblPbTitle1.Size = new System.Drawing.Size(94, 13);
            this.lblPbTitle1.TabIndex = 11;
            this.lblPbTitle1.Text = "Title 1:";
            // 
            // dfPbAcctNo
            // 
            this.dfPbAcctNo.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfPbAcctNo.Location = new System.Drawing.Point(168, 17);
            this.dfPbAcctNo.Name = "dfPbAcctNo";
            this.dfPbAcctNo.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfPbAcctNo.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfPbAcctNo.PhoenixUIControl.ObjectId = 72;
            this.dfPbAcctNo.PreviousValue = null;
            this.dfPbAcctNo.ReadOnly = true;
            this.dfPbAcctNo.Size = new System.Drawing.Size(144, 13);
            this.dfPbAcctNo.TabIndex = 12;
            this.dfPbAcctNo.TabStop = false;
            // 
            // dfPbAcctType
            // 
            this.dfPbAcctType.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfPbAcctType.Location = new System.Drawing.Point(120, 17);
            this.dfPbAcctType.Name = "dfPbAcctType";
            this.dfPbAcctType.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfPbAcctType.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfPbAcctType.PhoenixUIControl.ObjectId = 71;
            this.dfPbAcctType.PreviousValue = null;
            this.dfPbAcctType.ReadOnly = true;
            this.dfPbAcctType.Size = new System.Drawing.Size(28, 13);
            this.dfPbAcctType.TabIndex = 13;
            this.dfPbAcctType.TabStop = false;
            // 
            // lblPbAcctNo
            // 
            this.lblPbAcctNo.AutoEllipsis = true;
            this.lblPbAcctNo.Location = new System.Drawing.Point(4, 17);
            this.lblPbAcctNo.Name = "lblPbAcctNo";
            this.lblPbAcctNo.PhoenixUIControl.ObjectId = 71;
            this.lblPbAcctNo.Size = new System.Drawing.Size(94, 13);
            this.lblPbAcctNo.TabIndex = 14;
            this.lblPbAcctNo.Text = "Account:";
            // 
            // tabEasyCapture
            // 
            this.tabEasyCapture.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(255)))), ((int)(((byte)(255)))));
            this.tabEasyCapture.Location = new System.Drawing.Point(4, 22);
            this.tabEasyCapture.MLInfo = controlInfo6;
            this.tabEasyCapture.Name = "tabEasyCapture";
            this.tabEasyCapture.Size = new System.Drawing.Size(682, 422);
            this.tabEasyCapture.TabIndex = 5;
            this.tabEasyCapture.Text = "&Multi Transaction";
            this.tabEasyCapture.UseVisualStyleBackColor = true;
            // 
            // dfOnUsAlerts
            // 
            this.dfOnUsAlerts.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfOnUsAlerts.Location = new System.Drawing.Point(408, 240);
            this.dfOnUsAlerts.Name = "dfOnUsAlerts";
            this.dfOnUsAlerts.PhoenixUIControl.DataType = Phoenix.Windows.Forms.UIDataType.Text;
            this.dfOnUsAlerts.PhoenixUIControl.DisplayType = Phoenix.Windows.Forms.UIDisplayType.Display;
            this.dfOnUsAlerts.PhoenixUIControl.ObjectId = 192;
            this.dfOnUsAlerts.PreviousValue = null;
            this.dfOnUsAlerts.ReadOnly = true;
            this.dfOnUsAlerts.Size = new System.Drawing.Size(260, 13);
            this.dfOnUsAlerts.TabIndex = 68;
            this.dfOnUsAlerts.TabStop = false;
            // 
            // pbSelectTran
            // 
            this.pbSelectTran.LongText = "Select";
            this.pbSelectTran.Name = "Select";
            this.pbSelectTran.ObjectId = 62;
            this.pbSelectTran.ShortText = "Select";
            this.pbSelectTran.Tag = null;
            this.pbSelectTran.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbSelectTran_Click);
            // 
            // pbNOCHistory
            // 
            this.pbNOCHistory.LongText = "NOC History...";
            this.pbNOCHistory.Name = "NOC History...";
            this.pbNOCHistory.ObjectId = 219;
            this.pbNOCHistory.ShortText = "NOC History...";
            this.pbNOCHistory.Tag = null;
            this.pbNOCHistory.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbNOCHistory_Click);
            // 
            // pbLastAcct
            // 
            this.pbLastAcct.LongText = "Last Acct";
            this.pbLastAcct.Name = "Last Acct";
            this.pbLastAcct.ObjectId = 54;
            this.pbLastAcct.ShortText = "Last Acct";
            this.pbLastAcct.Tag = null;
            this.pbLastAcct.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbLastAcct_Click);
            // 
            // pbCashIn
            // 
            this.pbCashIn.LongText = "Cash In";
            this.pbCashIn.Name = "Cash In";
            this.pbCashIn.ObjectId = 172;
            this.pbCashIn.ShortText = "Cash In";
            this.pbCashIn.Tag = null;
            this.pbCashIn.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbCashIn_Click);
            // 
            // pbCashOut
            // 
            this.pbCashOut.LongText = "Cash Out";
            this.pbCashOut.Name = "Cash Out";
            this.pbCashOut.ObjectId = 173;
            this.pbCashOut.ShortText = "Cash Out";
            this.pbCashOut.Tag = null;
            this.pbCashOut.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbCashOut_Click);
            // 
            // pbTCDDenom
            // 
            this.pbTCDDenom.LongText = "View Denom";
            this.pbTCDDenom.Name = "View Denom";
            this.pbTCDDenom.ObjectId = 174;
            this.pbTCDDenom.ShortText = "View Denom";
            this.pbTCDDenom.Tag = null;
            // 
            // pbItemCapture
            // 
            this.pbItemCapture.LongText = "Item Capt";
            this.pbItemCapture.Name = "Item Capt";
            this.pbItemCapture.ObjectId = 55;
            this.pbItemCapture.ShortText = "Item Capt";
            this.pbItemCapture.Tag = null;
            this.pbItemCapture.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbItemCapture_Click);
            // 
            // pbFees
            // 
            this.pbFees.LongText = "Charges";
            this.pbFees.Name = "Charges";
            this.pbFees.ObjectId = 56;
            this.pbFees.ShortText = "Charges";
            this.pbFees.Tag = null;
            this.pbFees.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbFees_Click);
            // 
            // pbDisplay
            // 
            this.pbDisplay.LongText = "&Display...";
            this.pbDisplay.Name = "&Display";
            this.pbDisplay.ShortText = "&Display...";
            this.pbDisplay.Tag = null;
            this.pbDisplay.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbDisplay_Click);
            // 
            // pbHistory
            // 
            this.pbHistory.LongText = "History";
            this.pbHistory.Name = "History";
            this.pbHistory.ObjectId = 58;
            this.pbHistory.ShortText = "History";
            this.pbHistory.Tag = null;
            this.pbHistory.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbHistory_Click);
            // 
            // pbRestrictions
            // 
            this.pbRestrictions.LongText = "Restrictions";
            this.pbRestrictions.Name = "Restrictions";
            this.pbRestrictions.ObjectId = 59;
            this.pbRestrictions.ShortText = "Restrictions";
            this.pbRestrictions.Tag = null;
            this.pbRestrictions.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbRestrictions_Click);
            // 
            // pbGetGLAcct
            // 
            this.pbGetGLAcct.LongText = "Get GL Acct";
            this.pbGetGLAcct.Name = "Get GL Acct";
            this.pbGetGLAcct.ObjectId = 60;
            this.pbGetGLAcct.ShortText = "Get GL Acct";
            this.pbGetGLAcct.Tag = null;
            this.pbGetGLAcct.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbGetGLAcct_Click);
            // 
            // pbRemoveTran
            // 
            this.pbRemoveTran.LongText = "Remove";
            this.pbRemoveTran.Name = "Remove";
            this.pbRemoveTran.ObjectId = 61;
            this.pbRemoveTran.ShortText = "Remove";
            this.pbRemoveTran.Tag = null;
            this.pbRemoveTran.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbRemoveTran_Click);
            // 
            // pbSearch
            // 
            this.pbSearch.LongText = "Search";
            this.pbSearch.Name = "Search";
            this.pbSearch.ObjectId = 63;
            this.pbSearch.ShortText = "Search";
            this.pbSearch.Tag = null;
            this.pbSearch.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbSearch_Click);
            // 
            // pbSelectSearch
            // 
            this.pbSelectSearch.LongText = "Select";
            this.pbSelectSearch.Name = "Select";
            this.pbSelectSearch.ObjectId = 64;
            this.pbSelectSearch.ShortText = "Select";
            this.pbSelectSearch.Tag = null;
            this.pbSelectSearch.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbSelectSearch_Click);
            // 
            // pbSelectAcct
            // 
            this.pbSelectAcct.LongText = "Select";
            this.pbSelectAcct.Name = "Select";
            this.pbSelectAcct.ObjectId = 65;
            this.pbSelectAcct.ShortText = "Select";
            this.pbSelectAcct.Tag = null;
            this.pbSelectAcct.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbSelectAcct_Click);
            // 
            // pbSelectRIM
            // 
            this.pbSelectRIM.LongText = "Select RIM";
            this.pbSelectRIM.Name = "Select RIM";
            this.pbSelectRIM.ShortText = "Select RIM";
            this.pbSelectRIM.Tag = null;
            this.pbSelectRIM.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbSelectRIM_Click);
            // 
            // pbUpdatePB
            // 
            this.pbUpdatePB.LongText = "Update";
            this.pbUpdatePB.Name = "Update";
            this.pbUpdatePB.ObjectId = 86;
            this.pbUpdatePB.ShortText = "Update";
            this.pbUpdatePB.Tag = null;
            this.pbUpdatePB.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbUpdatePB_Click);
            // 
            // pbSkip
            // 
            this.pbSkip.LongText = "Skip";
            this.pbSkip.Name = "Skip";
            this.pbSkip.ObjectId = 87;
            this.pbSkip.ShortText = "Skip";
            this.pbSkip.Tag = null;
            this.pbSkip.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbSkip_Click);
            // 
            // pbClearAll
            // 
            this.pbClearAll.LongText = "Clear";
            this.pbClearAll.Name = "Clear";
            this.pbClearAll.ObjectId = 184;
            this.pbClearAll.ShortText = "Clear";
            this.pbClearAll.Tag = null;
            this.pbClearAll.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbClearAll_Click);
            // 
            // pbSeparator1
            // 
            this.pbSeparator1.IsSeperator = true;
            this.pbSeparator1.Name = null;
            this.pbSeparator1.SeperatorText = "";
            this.pbSeparator1.Tag = null;
            // 
            // iconSweep
            // 
            this.iconSweep.Name = null;
            this.iconSweep.Tag = null;
            // 
            // iconCaution
            // 
            this.iconCaution.Name = null;
            this.iconCaution.Tag = null;
            // 
            // iconHold
            // 
            this.iconHold.Name = null;
            this.iconHold.Tag = null;
            // 
            // iconRetirement
            // 
            this.iconRetirement.Name = null;
            this.iconRetirement.Tag = null;
            // 
            // iconStop
            // 
            this.iconStop.Name = null;
            this.iconStop.Tag = null;
            // 
            // iconNSF
            // 
            this.iconNSF.Name = null;
            this.iconNSF.Tag = null;
            // 
            // iconREJ
            // 
            this.iconREJ.Name = null;
            this.iconREJ.Tag = null;
            // 
            // iconUCF
            // 
            this.iconUCF.Name = null;
            this.iconUCF.Tag = null;
            // 
            // iconRealTime
            // 
            this.iconRealTime.Name = null;
            this.iconRealTime.Tag = null;
            // 
            // iconSigner
            // 
            this.iconSigner.Name = null;
            this.iconSigner.Shortcut = System.Windows.Forms.Keys.F7;
            this.iconSigner.Tag = null;
            this.iconSigner.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.iconSigner_Click);
            // 
            // iconOnUsSigner
            // 
            this.iconOnUsSigner.Name = null;
            this.iconOnUsSigner.Tag = null;
            // 
            // iconOnUsAnalysis
            // 
            this.iconOnUsAnalysis.Name = null;
            this.iconOnUsAnalysis.Tag = null;
            // 
            // iconOnUsCaution
            // 
            this.iconOnUsCaution.Name = null;
            this.iconOnUsCaution.Tag = null;
            // 
            // iconOnUsNotes
            // 
            this.iconOnUsNotes.Name = null;
            this.iconOnUsNotes.Tag = null;
            // 
            // iconOnUsStop
            // 
            this.iconOnUsStop.Name = null;
            this.iconOnUsStop.Tag = null;
            // 
            // iconOnUsSweep
            // 
            this.iconOnUsSweep.Name = null;
            this.iconOnUsSweep.Tag = null;
            // 
            // iconOnUsHold
            // 
            this.iconOnUsHold.Name = null;
            this.iconOnUsHold.Tag = null;
            // 
            // iconOnUsAcctRegD
            // 
            this.iconOnUsAcctRegD.Name = null;
            this.iconOnUsAcctRegD.Tag = null;
            // 
            // iconAnalysis
            // 
            this.iconAnalysis.Name = null;
            this.iconAnalysis.Tag = null;
            // 
            // pbMakeBreakStrap
            // 
            this.pbMakeBreakStrap.LongText = "Make/Break";
            this.pbMakeBreakStrap.Name = "Make/Break";
            this.pbMakeBreakStrap.ObjectId = 189;
            this.pbMakeBreakStrap.ShortText = "Make/Break";
            this.pbMakeBreakStrap.Tag = null;
            this.pbMakeBreakStrap.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbMakeBreakStrap_Click);
            // 
            // pbCDRedemp
            // 
            this.pbCDRedemp.LongText = "CD Redem...";
            this.pbCDRedemp.Name = "CD Redem...";
            this.pbCDRedemp.ObjectId = 221;
            this.pbCDRedemp.ShortText = "CD Redem...";
            this.pbCDRedemp.Tag = null;
            this.pbCDRedemp.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbCDRedemp_Click);
            // 
            // pbChkTCDStatus
            // 
            this.pbChkTCDStatus.LongText = "Ch&k Status";
            this.pbChkTCDStatus.Name = "Ch&k Status";
            this.pbChkTCDStatus.ObjectId = 191;
            this.pbChkTCDStatus.ShortText = "Ch&k Status";
            this.pbChkTCDStatus.Tag = null;
            this.pbChkTCDStatus.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbChkTCDStatus_Click);
            // 
            // pbOnUsDisplay
            // 
            this.pbOnUsDisplay.LongText = "&On-Us Display...";
            this.pbOnUsDisplay.Name = "&On-Us Display...";
            this.pbOnUsDisplay.ObjectId = 194;
            this.pbOnUsDisplay.ShortText = "&On-Us Display...";
            this.pbOnUsDisplay.Tag = null;
            this.pbOnUsDisplay.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbOnUsDisplay_Click);
            // 
            // pbOnUsSig
            // 
            this.pbOnUsSig.LongText = "O&n-Us Sig...";
            this.pbOnUsSig.Name = "O&n-Us Sig...";
            this.pbOnUsSig.ObjectId = 195;
            this.pbOnUsSig.ShortText = "O&n-Us Sig...";
            this.pbOnUsSig.Tag = null;
            this.pbOnUsSig.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbOnUsSig_Click);
            // 
            // pbPrintMailer
            // 
            this.pbPrintMailer.LongText = "Print Mailer...";
            this.pbPrintMailer.Name = "Print Mailer...";
            this.pbPrintMailer.ObjectId = 217;
            this.pbPrintMailer.ShortText = "Print Mailer...";
            this.pbPrintMailer.Tag = null;
            this.pbPrintMailer.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbPrintMailer_Click);
            // 
            // pbOnUs
            // 
            this.pbOnUs.LongText = "&On-Us...";
            this.pbOnUs.Name = "&On-Us...";
            this.pbOnUs.ObjectId = 216;
            this.pbOnUs.ShortText = "&On-Us...";
            this.pbOnUs.Tag = null;
            // 
            // picSignature
            // 
            this.picSignature.Location = new System.Drawing.Point(0, 0);
            this.picSignature.Name = "picSignature";
            this.picSignature.Size = new System.Drawing.Size(100, 50);
            this.picSignature.TabIndex = 0;
            this.picSignature.TabStop = false;
            // 
            // pbACHFut
            // 
            this.pbACHFut.Name = null;
            this.pbACHFut.ObjectId = 201;
            this.pbACHFut.Tag = null;
            this.pbACHFut.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbACHFut_Click);
            // 
            // pbBondPurchase
            // 
            this.pbBondPurchase.LongText = "Bond Pur...";
            this.pbBondPurchase.Name = "Bond Pur...";
            this.pbBondPurchase.ObjectId = 200;
            this.pbBondPurchase.ShortText = "Bond Pur...";
            this.pbBondPurchase.Tag = null;
            this.pbBondPurchase.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbBondPurchase_Click);
            // 
            // pbIrsRpt
            // 
            this.pbIrsRpt.LongText = "pbIrsRpt";
            this.pbIrsRpt.Name = "pbIrsRpt";
            this.pbIrsRpt.ObjectId = 204;
            this.pbIrsRpt.ShortText = "pbIrsRpt";
            this.pbIrsRpt.Tag = null;
            this.pbIrsRpt.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbIrsRpt_Click);
            // 
            // pbInstChkSrch
            // 
            this.pbInstChkSrch.LongText = "&Inst Checks";
            this.pbInstChkSrch.Name = "&Inst Checks";
            this.pbInstChkSrch.ShortText = "&Inst Checks";
            this.pbInstChkSrch.Tag = null;
            // 
            // pbReset
            // 
            this.pbReset.LongText = "&Reset";
            this.pbReset.Name = null;
            this.pbReset.ObjectId = 213;
            this.pbReset.Tag = null;
            this.pbReset.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbReset_Click);
            // 
            // pbAddNonCust
            // 
            this.pbAddNonCust.LongText = "non cust";
            this.pbAddNonCust.Name = "non cust";
            this.pbAddNonCust.NextScreenId = 2986;
            this.pbAddNonCust.ObjectId = 214;
            this.pbAddNonCust.ShortText = "non cust";
            this.pbAddNonCust.Tag = null;
            this.pbAddNonCust.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbAddNonCust_Click);
            // 
            // pbEditNonCust
            // 
            this.pbEditNonCust.Name = null;
            this.pbEditNonCust.NextScreenId = 2986;
            this.pbEditNonCust.ObjectId = 215;
            this.pbEditNonCust.Tag = null;
            this.pbEditNonCust.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbEditNonCust_Click);
            // 
            // pbGetAcct
            // 
            this.pbGetAcct.LongText = "Get Acct...";
            this.pbGetAcct.Name = "Get Acct...";
            this.pbGetAcct.ObjectId = 220;
            this.pbGetAcct.ShortText = "Get Acct...";
            this.pbGetAcct.Tag = null;
            this.pbGetAcct.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbGetAcct_Click);
            // 
            // pbInventory
            // 
            this.pbInventory.LongText = "&Inventory...";
            this.pbInventory.Name = null;
            this.pbInventory.ObjectId = 226;
            this.pbInventory.Tag = null;
            // 
            // pbPendingCC
            // 
            this.pbPendingCC.LongText = "pbPendingCC";
            this.pbPendingCC.MLInfo.StatusLine = "pbPendingCC";
            this.pbPendingCC.MLInfo.ToolTip = "pbPendingCC";
            this.pbPendingCC.Name = "pbPendingCC";
            this.pbPendingCC.ObjectId = 229;
            this.pbPendingCC.StatusText = "pbPendingCC";
            this.pbPendingCC.Tag = null;
            this.pbPendingCC.ToolTip = "pbPendingCC";
            this.pbPendingCC.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbPendingCC_Click);
            // 
            // pbVod
            // 
            this.pbVod.LongText = "&VOD...";
            this.pbVod.Name = "pbVod";
            this.pbVod.NextScreenId = 3408;
            this.pbVod.ObjectId = 230;
            this.pbVod.ShortText = "&VOD...";
            this.pbVod.Tag = null;
            this.pbVod.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbVod_Click);
            // 
            // pbRelationship
            // 
            this.pbRelationship.LongText = "Relationship";
            this.pbRelationship.Name = "pbRelationship";
            this.pbRelationship.ObjectId = 233;
            this.pbRelationship.ShortText = "Relationship";
            this.pbRelationship.Tag = null;
            this.pbRelationship.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbRelationship_Click);
            // 
            // pbOnUsMisc
            // 
            this.pbOnUsMisc.LongText = "On-Us...";
            this.pbOnUsMisc.MLInfo.StatusLine = "Select this pushbutton to display On Us options.";
            this.pbOnUsMisc.MLInfo.ToolTip = "Select this pushbutton to display On Us options.";
            this.pbOnUsMisc.Name = "On-Us...";
            this.pbOnUsMisc.ShortText = "On-Us...";
            this.pbOnUsMisc.StatusText = "Select this pushbutton to display On Us options.";
            this.pbOnUsMisc.Tag = null;
            this.pbOnUsMisc.ToolTip = "Select this pushbutton to display On Us options.";
            // 
            // pbInventoryMisc
            // 
            this.pbInventoryMisc.LongText = "Inventory...";
            this.pbInventoryMisc.MLInfo.StatusLine = "Click this button to view or select inventory items.";
            this.pbInventoryMisc.MLInfo.ToolTip = "Click this button to view or select inventory items.";
            this.pbInventoryMisc.Name = "Inventory...";
            this.pbInventoryMisc.ShortText = "Inventory...";
            this.pbInventoryMisc.StatusText = "Click this button to view or select inventory items.";
            this.pbInventoryMisc.Tag = null;
            this.pbInventoryMisc.ToolTip = "Click this button to view or select inventory items.";
            // 
            // pbeReceipt
            // 
            this.pbeReceipt.LongText = "eReceipt";
            this.pbeReceipt.Name = "pbeReceipt";
            this.pbeReceipt.ObjectId = 234;
            this.pbeReceipt.ShortText = "eReceipt";
            this.pbeReceipt.Tag = null;
            this.pbeReceipt.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbeReceipt_Click);
            // 
            // pbeReceiptMisc
            // 
            this.pbeReceiptMisc.LongText = "eReceipt...";
            this.pbeReceiptMisc.MLInfo.StatusLine = "Select this button to define eReceipt delivery preferences for a customer.";
            this.pbeReceiptMisc.MLInfo.ToolTip = "Select this button to define eReceipt delivery preferences for a customer.";
            this.pbeReceiptMisc.Name = "pbeReceipt";
            this.pbeReceiptMisc.ShortText = "eReceipt...";
            this.pbeReceiptMisc.StatusText = "Select this button to define eReceipt delivery preferences for a customer.";
            this.pbeReceiptMisc.Tag = null;
            this.pbeReceiptMisc.ToolTip = "Select this button to define eReceipt delivery preferences for a customer.";
            this.pbeReceiptMisc.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbeReceipt_Click);
            // 
            // pbPrintMailerMisc
            // 
            this.pbPrintMailerMisc.LongText = "Print Mailer...";
            this.pbPrintMailerMisc.MLInfo.StatusLine = "Click to print name and addres information.";
            this.pbPrintMailerMisc.MLInfo.ToolTip = "Click to print name and addres information.";
            this.pbPrintMailerMisc.Name = "Print Mailer...";
            this.pbPrintMailerMisc.ShortText = "Print Mailer...";
            this.pbPrintMailerMisc.StatusText = "Click to print name and addres information.";
            this.pbPrintMailerMisc.Tag = null;
            this.pbPrintMailerMisc.ToolTip = "Click to print name and addres information.";
            this.pbPrintMailerMisc.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbPrintMailer_Click);
            // 
            // pbNOCHistoryMisc
            // 
            this.pbNOCHistoryMisc.LongText = "NOC History...";
            this.pbNOCHistoryMisc.MLInfo.StatusLine = "Click to display the Notice of Change history under the customer record.";
            this.pbNOCHistoryMisc.MLInfo.ToolTip = "Click to display the Notice of Change history under the customer record.";
            this.pbNOCHistoryMisc.Name = "NOC History...";
            this.pbNOCHistoryMisc.ShortText = "NOC History...";
            this.pbNOCHistoryMisc.StatusText = "Click to display the Notice of Change history under the customer record.";
            this.pbNOCHistoryMisc.Tag = null;
            this.pbNOCHistoryMisc.ToolTip = "Click to display the Notice of Change history under the customer record.";
            this.pbNOCHistoryMisc.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbNOCHistory_Click);
            // 
            // pbSeperatorCust
            // 
            this.pbSeperatorCust.IsSeperator = true;
            this.pbSeperatorCust.Name = "pbSeperatorCust";
            this.pbSeperatorCust.SeperatorText = "Customer";
            this.pbSeperatorCust.Tag = null;
            // 
            // pbRim
            // 
            this.pbRim.LongText = "Edit Cust";
            this.pbRim.Name = "pbRim";
            this.pbRim.ObjectId = 236;
            this.pbRim.ShortText = "Edit Cust";
            this.pbRim.Tag = null;
            this.pbRim.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbRim_Click);
            // 
            // pbRimDisplay
            // 
            this.pbRimDisplay.LongText = "Display";
            this.pbRimDisplay.Name = "pbRimDisplay";
            this.pbRimDisplay.ObjectId = 239;
            this.pbRimDisplay.ShortText = "Display";
            this.pbRimDisplay.Tag = null;
            this.pbRimDisplay.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbRimDisplay_Click);
            // 
            // pbRimHistory
            // 
            this.pbRimHistory.LongText = "History";
            this.pbRimHistory.Name = "pbRimHistory";
            this.pbRimHistory.ObjectId = 240;
            this.pbRimHistory.ShortText = "History";
            this.pbRimHistory.Tag = null;
            this.pbRimHistory.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbRimHistory_Click);
            // 
            // pbRimAchFuture
            // 
            this.pbRimAchFuture.LongText = "ACH Future...";
            this.pbRimAchFuture.MLInfo.StatusLine = "Click this button to list future dated ACH transactions for this customer.";
            this.pbRimAchFuture.MLInfo.ToolTip = "Click this button to list future dated ACH transactions for this customer.";
            this.pbRimAchFuture.Name = "pbRimAchFuture";
            this.pbRimAchFuture.ObjectId = 242;
            this.pbRimAchFuture.ShortText = "ACH Future...";
            this.pbRimAchFuture.StatusText = "Click this button to list future dated ACH transactions for this customer.";
            this.pbRimAchFuture.Tag = null;
            this.pbRimAchFuture.ToolTip = "Click this button to list future dated ACH transactions for this customer.";
            this.pbRimAchFuture.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbRimAchFuture_Click);
            // 
            // pbPortfolio
            // 
            this.pbPortfolio.LongText = "Portfolio...";
            this.pbPortfolio.Name = "pbPortfolio";
            this.pbPortfolio.ObjectId = 237;
            this.pbPortfolio.ShortText = "Portfolio...";
            this.pbPortfolio.Tag = null;
            this.pbPortfolio.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbPortfolio_Click);
            // 
            // pbRimDirect
            // 
            this.pbRimDirect.LongText = "Direct";
            this.pbRimDirect.Name = "pbRimDirect";
            this.pbRimDirect.ObjectId = 241;
            this.pbRimDirect.ShortText = "Direct";
            this.pbRimDirect.Tag = null;
            this.pbRimDirect.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbRimDirect_Click);
            // 
            // pbSeperatorTeller
            // 
            this.pbSeperatorTeller.IsSeperator = true;
            this.pbSeperatorTeller.Name = "pbSeperatorTeller";
            this.pbSeperatorTeller.SeperatorText = "Teller";
            this.pbSeperatorTeller.Tag = null;
            // 
            // pbMisc
            // 
            this.pbMisc.LongText = "Direct...";
            this.pbMisc.Name = "pbMisc";
            this.pbMisc.ObjectId = 243;
            this.pbMisc.ShortText = "Direct...";
            this.pbMisc.Tag = null;
            this.pbMisc.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbMisc_Click);
            // 
            // pbSeperatorAcct
            // 
            this.pbSeperatorAcct.IsSeperator = true;
            this.pbSeperatorAcct.Name = "pbSeperatorAcct";
            this.pbSeperatorAcct.SeperatorText = "Account";
            this.pbSeperatorAcct.Tag = null;
            // 
            // pbEdit
            // 
            this.pbEdit.LongText = "Edit Acct";
            this.pbEdit.Name = "pbEdit";
            this.pbEdit.ShortText = "Edit Acct";
            this.pbEdit.Tag = null;
            this.pbEdit.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbEdit_Click);
            // 
            // pbDirectAcct
            // 
            this.pbDirectAcct.LongText = "Direct..";
            this.pbDirectAcct.Name = "pbDirectAcct";
            this.pbDirectAcct.ObjectId = 249;
            this.pbDirectAcct.ShortText = "Direct...";
            this.pbDirectAcct.Tag = null;
            this.pbDirectAcct.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbDirectAcct_Click);
            // 
            // miExHistory
            // 
            this.miExHistory.LongText = "History...";
            this.miExHistory.MLInfo.StatusLine = "Click to view history for the highlighted account.";
            this.miExHistory.MLInfo.ToolTip = "Click to view history for the highlighted account.";
            this.miExHistory.Name = "pbExHistory";
            this.miExHistory.ShortText = "History...";
            this.miExHistory.StatusText = "Click to view history for the highlighted account.";
            this.miExHistory.Tag = null;
            this.miExHistory.ToolTip = "Click to view history for the highlighted account.";
            this.miExHistory.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.miExHistory_Click);
            // 
            // miTcLog
            // 
            this.miTcLog.LongText = "TC Log...";
            this.miTcLog.MLInfo.StatusLine = "Click to access the Tran Code Log for this account.";
            this.miTcLog.MLInfo.ToolTip = "Click to access the Tran Code Log for this account.";
            this.miTcLog.Name = "pbTcLog";
            this.miTcLog.ShortText = "TC Log...";
            this.miTcLog.StatusText = "Click to access the Tran Code Log for this account.";
            this.miTcLog.Tag = null;
            this.miTcLog.ToolTip = "Click to access the Tran Code Log for this account.";
            this.miTcLog.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.miTcLog_Click);
            // 
            // pbUmbrella
            // 
            this.pbUmbrella.LongText = "Umbrella";
            this.pbUmbrella.Name = "pbUmbrella";
            this.pbUmbrella.ObjectId = 245;
            this.pbUmbrella.ShortText = "Umbrella";
            this.pbUmbrella.Tag = null;
            this.pbUmbrella.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbUmbrella_Click);
            // 
            // pbArchive
            // 
            this.pbArchive.LongText = "Archive";
            this.pbArchive.Name = "pbArchive";
            this.pbArchive.ObjectId = 246;
            this.pbArchive.ShortText = "Archive";
            this.pbArchive.Tag = null;
            this.pbArchive.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbArchive_Click);
            // 
            // pbNewAcct
            // 
            this.pbNewAcct.LongText = "New Acct";
            this.pbNewAcct.Name = "pbNewAcct";
            this.pbNewAcct.ObjectId = 248;
            this.pbNewAcct.ShortText = "New Acct";
            this.pbNewAcct.Tag = null;
            this.pbNewAcct.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbNewAcct_Click);
            // 
            // pbSeperatorServ
            // 
            this.pbSeperatorServ.IsSeperator = true;
            this.pbSeperatorServ.Name = "pbSeperatorServ";
            this.pbSeperatorServ.SeperatorText = "Servicing";
            this.pbSeperatorServ.Tag = null;
            // 
            // pbServicing
            // 
            this.pbServicing.LongText = "Servicing";
            this.pbServicing.Name = "pbServicing";
            this.pbServicing.ObjectId = 247;
            this.pbServicing.ShortText = "Servicing";
            this.pbServicing.Tag = null;
            this.pbServicing.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbServicing_Click);
            // 
            // pbEditService
            // 
            this.pbEditService.LongText = "Edit Service";
            this.pbEditService.Name = "pbEditService";
            this.pbEditService.ObjectId = 258;
            this.pbEditService.ShortText = "Edit Service";
            this.pbEditService.Tag = null;
            this.pbEditService.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbEditService_Click);
            // 
            // pbActionSeperator4
            // 
            this.pbActionSeperator4.IsSeperator = true;
            this.pbActionSeperator4.Name = "pbActionSeperator4";
            this.pbActionSeperator4.SeperatorText = "Services";
            this.pbActionSeperator4.Tag = null;
            // 
            // pbSales
            // 
            this.pbSales.LongText = "&Sales";
            this.pbSales.Name = "pbSales";
            this.pbSales.ObjectId = 259;
            this.pbSales.ShortText = "&Sales";
            this.pbSales.Tag = null;
            this.pbSales.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbSales_Click);
            // 
            // pActionSepNonCust
            // 
            this.pActionSepNonCust.IsSeperator = true;
            this.pActionSepNonCust.Name = "pActionSepNonCust";
            this.pActionSepNonCust.SeperatorText = "Non-Customer";
            this.pActionSepNonCust.Tag = null;
            // 
            // pActionSepSrchMisc
            // 
            this.pActionSepSrchMisc.IsSeperator = true;
            this.pActionSepSrchMisc.Name = "pActionSepSrchMisc";
            this.pActionSepSrchMisc.SeperatorText = "Misc";
            this.pActionSepSrchMisc.Tag = null;
            // 
            // pbAdvancedSep
            // 
            this.pbAdvancedSep.IsSeperator = true;
            this.pbAdvancedSep.Name = "pbAdvancedSep";
            this.pbAdvancedSep.Tag = null;
            // 
            // pbAdvancedView
            // 
            this.pbAdvancedView.LongText = "Advanced";
            this.pbAdvancedView.Name = "pbAdvancedView";
            this.pbAdvancedView.ObjectId = 260;
            this.pbAdvancedView.ShortText = "Advanced";
            this.pbAdvancedView.Tag = null;
            this.pbAdvancedView.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbAdvancedView_Click);
            // 
            // pbExceptionHold
            // 
            this.pbExceptionHold.LongText = "Exception Hold...";
            this.pbExceptionHold.Name = "pbExceptionHold";
            this.pbExceptionHold.ObjectId = 261;
            this.pbExceptionHold.ShortText = "Exception Hold...";
            this.pbExceptionHold.Tag = null;
            this.pbExceptionHold.Click += new Phoenix.Windows.Forms.PActionEventHandler(this.pbExceptionHold_Click); //Task #134375
            // 
            // frmTlTranCode
            // 
            this.ClientSize = new System.Drawing.Size(690, 448);
            this.Controls.Add(this.picTabs);
            this.Name = "frmTlTranCode";
            this.ScreenId = 10447;
            this.PInitBeginEvent += new Phoenix.Windows.Forms.FormInitBeginEventHandler(this.frmTlTranCode_PInitBeginEvent);
            this.PInitCompleteEvent += new Phoenix.Windows.Forms.FormInitCompleteEventHandler(this.frmTlTranCode_PInitCompleteEvent);
            this.PMdiPrintEvent += new System.EventHandler(this.frmTlTranCode_PMdiPrintEvent);
            this.Activated += new System.EventHandler(this.frmTlTranCode_Activated);
            this.Closed += new System.EventHandler(this.frmTlTranCode_Closed);
            this.Load += new System.EventHandler(this.frmTlTranCode_Load);
            this.GotFocus += new System.EventHandler(this.frmTlTranCode_GotFocus);
            this.LostFocus += new System.EventHandler(this.frmTlTranCode_LostFocus);
            this.picTabs.ResumeLayout(false);
            this.Name0.ResumeLayout(false);
            this.dfTransactionInformation.ResumeLayout(false);
            this.dfTransactionInformation.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picDrawer)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.picTCD)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.picMemo)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.picRealTime)).EndInit();
            this.gbAccountInformation.ResumeLayout(false);
            this.gbAccountInformation.PerformLayout();
            this.panelAvailBal.ResumeLayout(false);
            this.panelAvailBal.PerformLayout();
            this.Name1.ResumeLayout(false);
            this.gbTransactionSet.ResumeLayout(false);
            this.gbTransactionSet.PerformLayout();
            this.Name4.ResumeLayout(false);
            this.gbPrintOptions.ResumeLayout(false);
            this.gbPrintOptions.PerformLayout();
            this.gbUnbookedItems.ResumeLayout(false);
            this.gbAccountInfo.ResumeLayout(false);
            this.gbAccountInfo.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picSignature)).EndInit();
            this.ResumeLayout(false);

        }

        //Begin Bug#115682
        private void PicTabs_Leave(object sender, EventArgs e)
        {
            if (isTabAudit == false && isAudit == false)
            {
                CreateAuditViews();
                isAudit = true;
            }

        }

        //Begin #Bug#115201
        //private void PicTabs_Validated(object sender, EventArgs e)
        //{
        //    if (_adGbBankControl.ViewAudit.Value == "Y")
        //    {
        //        if (picTabs.SelectedIndex == (int)TAB.CustSummary && viewTimeIn != DateTime.MinValue)
        //        {
        //            PNotes note = new PNotes();
        //            note.ScreenId = Phoenix.Shared.Constants.ScreenId.TlTranCode;
        //            note.RimNo = frmGloAccountListRim._rmAcctPtid;
        //            _gbHelper.CreateViewAudit(note, GlobalVars.UserType, viewTimeIn, DateTime.Now);
        //        }
        //    }
        //}
        //End Bug#115201
        //End Bug#115682
        void dfCheckNo_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
        {
            //Begin #140772
            if (dfCheckNo.Enabled)
            {
                dfCheckNo.ScreenToObject();
                if (_tlTranSet.CurTran.TranCode.Value == 938 || _tlTranSet.CurTran.TranCode.Value == 939)
                {
                    if (dfCheckNo.UnFormattedValue != null && Convert.ToInt32(dfCheckNo.UnFormattedValue) > Convert.ToInt32(dfNoInvAvailable.UnFormattedValue))
                    {
                        //#13953 - The Number of Items value cannot exceed the Number of Available count.
                        PMessageBox.Show(13953, MessageType.Warning, MessageBoxButtons.OK, String.Empty);
                        dfCheckNo.Focus();
                        e.Cancel = true;
                    }

                    GetInventoryItemsByCount(); //#140772-#19537
                }
            }
            //End #140772
        }

        void dfInvSerialNo_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
        {
            if (processingSelectTran)
            {
                EnableDisableControls("InventoryItem");
            }
            else
            {
                dfInvSerialNo.ScreenToObject();
                if (_totalInventoryItems > 0)
                {
                    if (_tlTranSet.GetInventoryItems(_tlTranSet.CurTran.TranCode.Value,
                        (cmbInventoryType.CodeValue == null ? -1 : Convert.ToDecimal(cmbInventoryType.CodeValue)),
                        -2,  //23981: was defaulted to -1, we now pass -1 for 'All Packets'
                        _tlTranSet.TellerVars.BranchNo,
                        _tlTranSet.TellerVars.DrawerNo,
                        searchRimNo,
                        -1,
                        Convert.ToDecimal(dfInvSerialNo.UnFormattedValue),
                        (!_tlTranSet.CurTran.NonCust.IsNull && _tlTranSet.CurTran.NonCust.Value == "Y" ? true : false),
                        ref _totalInventoryItems,
                        _adGbInventoryType,
                        _tlTranSet.CurTran) == false)
                    {
                        if (_totalInventoryItems > 0)
                        {
                            //#13999 - The serial number of the inventory item does not exist in the system. Please enter a valid serial number.
                            PMessageBox.Show(13999, MessageType.Warning, MessageBoxButtons.OK, String.Empty);
                            dfInvSerialNo.Focus();
                            e.Cancel = true;
                        }
                    }
                    else
                    {
                        dfCheckNo.UnFormattedValue = 1;
                        dfCheckNo.ScreenToObject();
                        dfCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.DisableShowText);
                        GetInventoryItemsByCount(); //#140772-#19537
                    }
                }
                EnableDisableControls("InventoryItem");
            }
            //End #21274
        }

        void cmbInventoryType_Enter(object sender, EventArgs e)
        {
            Control_GotFocus(sender, e);
        }

        void cmbInventoryPacket_PhoenixUISelectedIndexChangedEvent(object sender, PEventArgs e)
        {
            if (processingSelectTran)
            {
                EnableDisableControls("InventoryItem");
                //CalcDefaultField(dfAmt);
            }
            else
            {
                if (!(_tlTranSet.CurTran.TranCode.Value == 938 || _tlTranSet.CurTran.TranCode.Value == 939))
                    return;

         
                cmbInventoryPacket.ScreenToObject();
                dfCheckNo.UnFormattedValue = null;
                dfCheckNo.ScreenToObject();
                _totalInventoryItems = 0;
                //if (_tlTranSet.CurTran.InventoryItems != null)
                //{
                //_tlTranSet.CurTran.InventoryItems.Clear();  //#21274
                ClearInventoryItems();
                dfNoInvAvailable.UnFormattedValue = null;
                dfNoInvAvailable.ScreenToObject();

               
                if (cmbInventoryPacket.CodeValue != null)  //#21085
                {
                    _tlTranSet.TellerVars.SetContextObject("AdGbInventoryPacketArray", Convert.ToString(cmbInventoryPacket.CodeValue));                    
                }


                //Begin #140772

                _tlTranSet.GetInventoryItems(_tlTranSet.CurTran.TranCode.Value,
                    (cmbInventoryType.CodeValue == null ? -1 : Convert.ToDecimal(cmbInventoryType.CodeValue)),
                    (cmbInventoryPacket.CodeValue == null ? -2 : Convert.ToDecimal(cmbInventoryPacket.CodeValue)),  // #23981: was defaulting to -1
                    _tlTranSet.TellerVars.BranchNo,
                    _tlTranSet.TellerVars.DrawerNo,
                    searchRimNo,
                    (dfCheckNo.UnFormattedValue == null ? -1 : Convert.ToInt32(dfCheckNo.UnFormattedValue)),
                    -1,
                    (!_tlTranSet.CurTran.NonCust.IsNull && _tlTranSet.CurTran.NonCust.Value == "Y" ? true : false),
                    ref _totalInventoryItems,
                    _adGbInventoryType,
                    _tlTranSet.CurTran);

                dfNoInvAvailable.UnFormattedValue = _totalInventoryItems;
                dfNoInvAvailable.ScreenToObject();

                if (cmbInventoryPacket.CodeValue != null)
                    _tlTranSet.CurTran.InvPacketDesc.Value = cmbInventoryPacket.Description;
                else
                    _tlTranSet.CurTran.InvPacketDesc.SetValueToNull();


                if (_tlTranSet.TellerVars.AdTlTc.EnableNumberItems.Value == GlobalVars.Instance.ML.Y)
                {
                    //#21085 - moved the following check# default code inside to validate EnableNumberItems value
                    if (_totalInventoryItems > 0)
                    {
                        if ((_adGbInventoryType.Class.Value == CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Packet") &&
                            _tlTranSet.TellerVars.AdGbInventoryPacket.SerialPacket.IsNull ||
                            (!_tlTranSet.TellerVars.AdGbInventoryPacket.SerialPacket.IsNull &&
                            _tlTranSet.TellerVars.AdGbInventoryPacket.SerialPacket.Value != "Y")) && Convert.ToDecimal(cmbInventoryPacket.CodeValue) != -1) //23981
                        {
                            dfCheckNo.UnFormattedValue = 1;
                            dfCheckNo.ScreenToObject();
                            GetInventoryItemsByCount(); //#140772-#19537
                        }
                    }
                }
                //End #140772
                EnableDisableControls("InventoryItem");
            }
        }

        void cmbInventoryType_PhoenixUISelectedIndexChangedEvent(object sender, PEventArgs e)
        {
            SetInventoryTypeField();
        }

        void cmbInventoryType_PhoenixUIEditedEvent(object sender, ValueEditedEventArgs e)
        {
            //SetInventoryTypeField();
        }

        void cmbInventoryType_Validating(object sender, CancelEventArgs e)
        {
            //SetInventoryTypeField();
        }

		void cmbRecalcPmtDt_PhoenixUISelectedIndexChangedEvent(object sender, PEventArgs e)
        {
            MoveMiscScreensToObject(miscTCFields);  //#76425
        }

        void cmbRecalcPmtDt_PhoenixUIEditedEvent(object sender, ValueEditedEventArgs e)
        {
            MoveMiscScreensToObject(miscTCFields);
            MoveAmtScreensToObject();
            dfRecalcPmt.UnFormattedValue = _tlTranSet.GetRecalcPmtAmt();
            dfRecalcPmt.ScreenToObject();
        }


        void cbWaiveSignature_PhoenixUICheckedChangedEvent(object sender, PEventArgs e)
        {
            if (_tlTranSet.Transactions.Count > 0 && !_isWaiveSigWarningShown) //transaction set
            {
                if (DialogResult.No == PMessageBox.Show(this, 361056, MessageType.Question, MessageBoxButtons.YesNo, string.Empty))
                {
                    _isWaiveSigWarningShown = true;
                    if (cbWaiveSignature.Checked)
                        cbWaiveSignature.Checked = false;
                    else
                        cbWaiveSignature.Checked = true;
                }
            }
            #region #12619
            if (cbWaiveSignature.Checked == false)
                ovrdSig = false;
            else
                ovrdSig = true;
            #endregion

            this.cbWaiveSignature.ScreenToObject();
        }
        //Begin #76055
        void pbACHFut_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("ACHFutDtTx");
        }
        //End #76055
		//Begin #9320
		void pbAddNonCust_Click(object sender, PActionEventArgs e)
		{
			CallOtherForms("AddNonCust");
		}
		//End #9320

        #region #80649
        /// <summary>
        /// Noc History button click action - invokes frmNOCDetailList
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        void pbNOCHistory_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("NOCHistoryClick");
        }
        #endregion

        void dfTranEffectiveDt_PhoenixUILeaveEvent(object sender, PEventArgs e)
        {
            //Begin #76043
            if (!_tlTranSet.CurTran.TranAcct.TranCode.IsNull && (_tlTranSet.CurTran.TranAcct.TranCode.Value == 301 ||
                _tlTranSet.CurTran.TranAcct.TranCode.Value == 345 || _tlTranSet.CurTran.TranCode.Value == 176)) /*77540 added tc176*/
            {
                if (_tlTranSet.TellerVars.IsTCDEnabled || _tlTranSet.TellerVars.IsTCDConnected)
                {
                    _tlTranSet.ValidateTlTrancode(cmbTranCode.CodeValue.ToString(), _tlTranSet.TellerVars.IsTCDEnabled, _tlTranSet.TellerVars.IsTCDConnected);
                }
                else
                    _tlTranSet.ValidateTlTrancode(cmbTranCode.CodeValue.ToString());
                //
                MoveAmtObjectsToScreen();
            }

            if (dfTranEffectiveDt.UnFormattedValue != null)
            {
                _tlTranSet.IsLoanTermChargesAvailable(); //#76043
                EnableDisableControls("TranEffectiveDt_Leave"); //#76425
            }
            //
            //End #76043
        }

        void cbDenominate_CheckedChanged(object sender, EventArgs e)
        {
            cbDenominate.ScreenToObject();
        }

        void pbInvisibleTCDPBox_Click(object sender, PActionEventArgs e)
        {
            TcdDrawerIconClick(picTCD, picDrawer);
        }

        void pbToggleTCDDrawer_Click(object sender, PActionEventArgs e)
        {
            TcdDrawerIconClick(picTCD, picDrawer);
        }

        void pbChkTCDStatus_Click(object sender, PActionEventArgs e)
        {

            try
            {
                dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(361051));
                //
                using (new WaitCursor())
                {
                    InitializeCashDispense();
                    //
                    if (cashDisp.WindowTitle != "TCD/TCR Status")
                    {
                        cashDisp.IsConnOpen = false;
                        cashDisp.WindowTitle = "TCD/TCR Status";
                    }
                    //
                    cashDisp.GetStatus(_tlTranSet.TellerVars.DrawerNo.ToString(), false, null);
                    return;
                }
            }
            finally
            {
                dlgInformation.Instance.HideInfo();
            }
        }

        void pbReset_Click(object sender, PActionEventArgs e)
        {
            ResetTcdTcrDevice(false);
        }

        //void picDrawer1_Click(object sender, EventArgs e)
        //{
        //    TcdDrawerIconClick(picTCD1, picDrawer1);
        //}

        //void picTCD1_Click(object sender, EventArgs e)
        //{
        //    picDrawer1.Visible = (_tlTranSet.TellerVars.IsTCDEnabled);
        //    _tlTranSet.TellerVars.IsTCDConnected = false;
        //    picTCD1.Visible = _tlTranSet.TellerVars.IsTCDConnected;
        //}

        void picDrawer_Click(object sender, EventArgs e)
        {
            TcdDrawerIconClick(picTCD, picDrawer);
        }

        void picTCD_Click(object sender, EventArgs e)
        {
            TcdDrawerIconClick(picTCD, picDrawer);
        }

        void pbVod_Click(object sender, PActionEventArgs e)         //WI#140785
        {
            CallOtherForms("VerificationOfDeposits");
        }
        #endregion


        #region #6656
        void WorkSpace_Close(object sender, CancelEventArgs e)
        {
            //Begin OOB-Fix, #40977
            if (_tellerCapture != null)
            {
                FormClosingEventArgs eventArg = new FormClosingEventArgs(CloseReason.UserClosing, e.Cancel);
                InternalFormClosingActivities(eventArg, false);
                if (eventArg.Cancel)
                    e.Cancel = true;

                return;
            }
            //End OOB-Fix, #40977

            InternalFormClosingActivities(new FormClosingEventArgs(CloseReason.UserClosing, e.Cancel), false);        //#32833- Do NOT CALL BASE FormClosing-It Leaks!!
            objAlert.CloseAlertForProductOffer(); //Task #65382
            return;
        }
        #endregion


        //Begin #TellerWF
        public override void OnCreateParameters()
        {
            if (Parameters.Count == 0)
            {
                Parameters.Add(new PString("TranSource"));
                Parameters.Add(new PString("TranSetJson"));
                //Parameters.Add(new PString("AcctType"));
                //Parameters.Add(new PString("AcctNo"));
                //Parameters.Add(new PString("TlTranCode"));
                //Parameters.Add(new PDecimal("Amount"));
                //Parameters.Add(new PDecimal("CashIn"));
                //Parameters.Add(new PDecimal("CashOut"));
                //Parameters.Add(new PDecimal("CheckNo"));
            }
            
        }
        //End #TellerWF

        public override void InitParameters(params object[] paramList)
        {
            //paramList[0] = new PString("TranSource", "Workflow");
            //paramList[1] = new PString("TranSetJson", Newtonsoft.Json.JsonConvert.SerializeObject(InputParamTranSet.GetSampleTranSet()));
            ////paramList[1] = new PString("AcctType", "DDA");
            ////paramList[2] = new PString("AcctNo", "03-252010");
            ////paramList[3] = new PString("TlTranCode", "101");
            ////paramList[4] = new PDecimal("Amount", 100);
            ////paramList[5] = new PDecimal("CashIn", 100);

            //Begin #TellerWF
            if (paramList != null && paramList.Length > 1 && paramList[0] is PBaseType)
            {
                base.InitParameters(paramList);
                if (Parameters.Contains("TranSource") && Parameters["TranSource"].StringValue == InputParamTranSet.TranSourceParamValue)
                {
                    _invokedByWorkflow = true;
                    string tranSetJsonParamName = "TranSetJson";
                    if (Parameters.Contains(tranSetJsonParamName) && !string.IsNullOrEmpty(Parameters[tranSetJsonParamName].StringValue))
                    {
                        CoreService.LogPublisher.LogDebug(Parameters[tranSetJsonParamName].StringValue);
                        _inputParamTranSet = Newtonsoft.Json.JsonConvert.DeserializeObject<InputParamTranSet>(Parameters[tranSetJsonParamName].StringValue);
                    }
                    //else
                    //{
                    //    _inputParamTranSet = new InputParamTranSet();
                    //    _inputParamTranSet.Transactions.Add(new InputParamTran(Parameters));
                    //}

                    drawerCombo = GlobalObjects.Instance["_MdiTeller.cmbDrawer"] as PComboBoxStandard;
                    bondAction = GlobalObjects.Instance["_MdiTeller.actionSavingsBond"] as PAction;
                    tcdAction = GlobalObjects.Instance["_MdiTeller.actionDummyTCD"]as PAction;
                    //TellerVars.Instance.TcdStationId = "1";
                    //TellerVars.Instance.IsTCDConnected = true;
                    //
                    if (drawerCombo == null )
                        drawerCombo = new PComboBoxStandard();
                    if ( bondAction == null)
                        bondAction = new PAction();
                    if ( tcdAction == null)
                        tcdAction = new PAction();  // - ?
                    return;
                }
            }
            //End #TellerWF
            if (paramList.Length >= 2)
            {
                if (paramList[0] != null)   //#79314
                    drawerCombo = paramList[0] as PComboBoxStandard;
                else //#79314
                    drawerCombo = new PComboBoxStandard();
                if (paramList[1] != null)   //#79314
                {
                    bondAction = paramList[1] as PAction;
                    //_isEnableBondAction = bondAction.Enabled;   //#140798   #29211
                }
                else //#79314
                    bondAction = new PAction();
                //
                if (paramList.Length > 2)
                {
                    if (paramList[2] != null)   //#79314
                    {
                        tcdAction = paramList[2] as PAction;
                        tcdAction.Visible = false; //#72916
                    }
                }

                //#76430 this parameter is passed from the calling form it's a hotkey operation
                if (!string.IsNullOrEmpty(paramList[3].ToString()))
                {
                    if (paramList[3] != null)   //#79314
                    {
                        isHotKey = true;
                        HK_RimNO = paramList[3].ToString();
                    }
                }


                //Begin #79510
                if (paramList.Length >= 5)
                {
                    if (paramList[4] != null)   //#79314
                        acquirerResponseXml = Convert.ToString(paramList[4]);
                }
                //End #79510

                //Begin #79314
                if (paramList.Length >= 6 && paramList[5] != null)
                {
                    _transForOverride = paramList[5] as ArrayList;
                    _isSupervisorViewOnlyMode = true;
                }
                //End #79314
                //Begin #111762. If call come from Define Relation anf Fav then this param will be "RmSum"
                if (paramList.Length >= 7 && paramList[6] != null)
                {
                    string paramvalue = Convert.ToString(paramList[6]);
                    if (!string.IsNullOrEmpty(paramvalue) && paramvalue == "RmSum")
                    {
                        isRmSumInvoked = true;
                    }
                }
                //End #111762
            }

            base.InitParameters(paramList); //#19058

        }

        #region #32833- Known Leak with OnClosing

        protected override void OnFormClosing(FormClosingEventArgs e)
        {
            InternalFormClosingActivities(e, true);
            if (_quickTranWindow != null && !e.Cancel) //Bug #107396
                _quickTranWindow.Destroy();//Bug#93072
            return;
        }

        private void InternalFormClosingActivities(FormClosingEventArgs e, bool callBaseFormClosing)
        {
            // Begin #18483
            if (Workspace != null)
            {
                Workspace.Variables["_StoredPrevNotesAcctNo"] = null;
                Workspace.Variables["_StoredPrevNotesAcctType"] = null;
                Workspace.Variables["_StoredPrevNotesRimNo"] = null;
                Workspace.Variables["_StoredPrevNocRimNo"] = null;     // #18483
                Workspace.Variables["_StoredPrevNocRimCount"] = null;
            }
            // End #18483

            //Begin #19415
            GbMemo.UseCaching(false);
            if (Workspace != null)
                ((Workspace as PwksWindow).WksExtension as WkspaceExtension).UseAlertCaching(false);
            //End #19415

            //Begin #79510
            if (_tlTranSet != null &&_tlTranSet.IsAcquirerTran) //Task #124027 - Added a null check for Workflow Wrapper window
            {
                if (_tcdConnBeforeAcquirerTranPosting != _tlTranSet.TellerVars.IsTCDConnected)   //#11655
                    _tlTranSet.TellerVars.IsTCDConnected = _tcdConnBeforeAcquirerTranPosting;
                HandleAcquirerWindowClosing(e);
                return;
            }
            //End #79510

            bool isFormDirty = false;
            // Begin Task#99061 - Change to use fields isHotKey and HK_RimNO that are set on form instead of TellerVars
            if (!isHotKey ||
                (dfAcctNo.UnFormattedValue != null && HK_RimNO != dfAcctNo.UnFormattedValue.ToString()))    //#10039
            {
                if (_tlTranSet != null &&!_tlTranSet.CurTran.AcctType.IsNull) //Task #124027 - Added Null Check for _tlTranset of Workflow
                    isFormDirty |= !string.IsNullOrEmpty(_tlTranSet.CurTran.AcctType.Value.ToString());
                if (_tlTranSet != null && !_tlTranSet.CurTran.AcctNo.IsNull) //Task #124027 - Added Null Check for _tlTranset of Workflow
                    isFormDirty |= !string.IsNullOrEmpty(_tlTranSet.CurTran.AcctNo.Value.ToString());
            }
            isFormDirty |= (_tlTranSet != null && _tlTranSet.CurTran.TranCode.Value != DbSmallInt.Null); //Task #124027 - Added Null Check for _tlTranset of Workflow

            // Begin #10039 - IsHotKey is in \shared\variables\phoenix.shared.variables.teller\TellerVars.cs
            // its set in \client\phoenix.client.teller\phoenix.client.teller.mdi\phoenix.client.teller.mdi\mditeller.cs
            // when coming from cusomer management etc, IsHotKey is set to true. we are ignoring the current form data, but not if someone has
            // pending transaction.
            //if (TellerVars.Instance.IsHotKey)
            //	isFormDirty = false;
            //End #10039
            if (_isSupervisorViewOnlyMode)  //#79314
            {
                closedWkspace = true;
                if (callBaseFormClosing)
                    base.OnFormClosing(e);      //#32833
                return;
            }
            else
            {
                bool doNotClose = ((ctwTranSet.Count > 0) || isFormDirty);
                if (doNotClose)
                {
                    if (_invokedByWorkflow == false)    // #TellerWF
                        doNotClose = PMessageBox.Show(11435, MessageType.Question, MessageBoxButtons.YesNo, MessageBoxDefaultButton.Button2, String.Empty) == DialogResult.No; // #8129
                    else
                        doNotClose = false;
                }

                if (doNotClose)
                {
                    e.Cancel = true;
                    return;
                }
                else
                {
                    #region #79574
                    _isForceDeviceReset = true; //#9142
                    ReverseDeviceDeposit(true);
                    #endregion

                    #region #140895
                    HandleCancelAVTCTransaction(false);
                    #endregion

                    //#29211
                    //if (bondAction != null) //#140798
                    //    bondAction.Enabled = _isEnableBondAction;
                    //base.OnClosing(e);
                    closedWkspace = true;
                    if (callBaseFormClosing)
                        base.OnFormClosing(e);  //#32833

                    return;
                }
            }

        }

        #endregion

		#region form related events
		private Phoenix.Windows.Forms.ReturnType frmTlTranCode_PInitBeginEvent()
        {
            //this.AppToolBarId = ToolbarType.TB_Processing;
            //this.MainBusinesObject = _tlTranSet.CurTran;
            //this.MainBusinesObject = this._acctSearchBusObj;//Bug#114796//Bug#115201
            InitializeTranSet();
            AvoidSave = true;
            IsUIPrefSet = false; //#142717
            acctTypeSrch = (_tlTranSet.TellerVars.AdTlControl.AcctTypeSearch.Value == GlobalVars.Instance.ML.Y);
            ctwTranSet.DoubleClickAction = pbSelectTran;
            ActionSave.ObjectId = 51;
            AttachEventForChildControls();
            SetTotalsFieldLocation();
            AddImages();
            ActionSave.NextScreenId = 0;
            ActionAddNext.NextScreenId = 0;
            SetNextScreenIds();
            _gbBondPurchase = new GbBondPurchase();  //#76047
            _isOvRunning = false; //Task#90007
            if (_tlTranSet.TellerVars.IsAppOnline) //Task#90007
                _isOvRunning = _gbHelper.IsOvRunning(); //#90001

            ShowNotes = false;
            _tlTranSet.IsAcquirerTran = !string.IsNullOrEmpty(acquirerResponseXml);//Begin #79510//End #79510
            
			//Begin #9320
            if (_pcCustomOptions.CheckCustomOptions(PcCustomOptions.CO_Constants.CO_FraudPrevention)) //75129
            {
                if (GlobalVars.UserType == "Combined" || GlobalVars.UserType == "Teller") //92056.For Teller and Combined. we are using this flat in Teller Transaction tab.hence created new flag for AcProc User
                {
                    isNonCustAllowed = true;
                    _bAcProcFraudEnabled = false;
                }
                else if (GlobalVars.UserType == "AcProc")
                {
                    _bAcProcFraudEnabled = true; //92056. Code for Actual Issue of this WI
                    isNonCustAllowed = false;
                }
            }
            //End #9320
            #region /* Create and load on us context menu */ #80620
            
            this.pbOnUs.ImageButton.Style = PImageButton.ButtonStyle.DropDown;
            cmOnUs.MenuItems.Clear();
            cmOnUs.MenuItems.Add("&Display...");
            cmOnUs.MenuItems.Add("&Signature...");
            cmOnUs.MenuItems.Add("&Restrictions...");
            cmOnUs.MenuItems.Add("&Notes...");

            cmOnUs.MenuItems[0].Click += new EventHandler(pbOnUsDisplayMenu_Click);
            cmOnUs.MenuItems[1].Click += new EventHandler(pbOnUsSigMenu_Click);
            cmOnUs.MenuItems[2].Click += new EventHandler(pbRestrictionsMenu_Click);
            cmOnUs.MenuItems[3].Click += new EventHandler(pbNotesMenu_Click);

            pbOnUs.ImageButton.DropDownMenu = cmOnUs;

            #region click events for On Us Alert Icons
            iconOnUsSigner.Click += new PActionEventHandler(pbOnUsSigMenu_Click);
            iconOnUsNotes.Click += new PActionEventHandler(pbNotesMenu_Click);
            iconOnUsCaution.Click += new PActionEventHandler(pbRestrictionsMenu_Click);
            iconOnUsHold.Click += new PActionEventHandler(pbRestrictionsMenu_Click);
            iconOnUsStop.Click += new PActionEventHandler(pbRestrictionsMenu_Click);
            iconOnUsAcctRegD.Click += new PActionEventHandler(pbOnUsAcctRegD_Click);        //140780-20052
            #endregion
            #endregion

            // #79370
            this.pbInstChkSrch.ObjectId = 207;
            this.pbInstChkSrch.Click += new PActionEventHandler(pbInstChkSrch_Click); //10504 moved here

            #region Cache Admin Business objects

            // #180274
            _adRmControl = GlobalObjects.Instance[Phoenix.Shared.Variables.GlobalObjectNames.AdRmControl] as Phoenix.BusObj.Admin.RIM.AdRmControl;

            if (_adRmControl == null && AppInfo.Instance.IsAppOnline)   //#39946
            {
                this.CallCDSProcess(_adRmControl);
            }

            #endregion

            #region Customer / Member translation #80615
            if (_adGbBankControl.InstitutionType.Value.ToUpper() == "CU")
            {
                this.pbSelectRIM.ShortText = "Select M&br...";
                this.pbSelectRIM.LongText = "Select M&br..";
                this.pbSeperatorCust.SeperatorText = "Member";  //60647
                this.pbUmbrella.ShortText = "&Umbrella...";  //60647
                this.pbUmbrella.LongText = "&Umbrella..."; //60647
            }
            else
            {
                this.pbSelectRIM.ShortText = "Select C&ust...";
                this.pbSelectRIM.LongText = "Select C&ust...";
                this.pbSeperatorCust.SeperatorText = "Customer"; //60647
                this.pbUmbrella.ShortText = "Um&brella..."; //60647
                this.pbUmbrella.LongText = "Um&brella..."; //60647
            }
            #endregion

            /* #140772 - Create and load inventory context menu */
            this.pbInventory.ImageButton.Style = PImageButton.ButtonStyle.DropDown;
            this.cmInventory = new ContextMenu();
            cmInventory.MenuItems.Clear();
            cmInventory.MenuItems.Add("&Purchase/Return...");
            cmInventory.MenuItems.Add("&Search...");
            cmInventory.MenuItems[0].Enabled = false;
            cmInventory.MenuItems[1].Enabled =
                ((GlobalVars.UserType == "Combined" ? CoreService.UIAccessProvider.GetScreenAccess(Phoenix.Shared.Constants.ScreenId.InventoryItemSearchBackOffice) : CoreService.UIAccessProvider.GetScreenAccess(Phoenix.Shared.Constants.ScreenId.InventoryItemSearchTeller) & AuthorizationType.Read) == AuthorizationType.Read
                && _tlTranSet.TellerVars.IsInventoryTrackingEnabled); //77062

            cmInventory.MenuItems[0].Click += new EventHandler(pbInventoryPurchaseReturn_Click);
            cmInventory.MenuItems[1].Click += new EventHandler(pbInventorySearch_Click);

            pbInventory.ImageButton.DropDownMenu = cmInventory;
            //End #140772

            picTabs.Selecting += new TabControlCancelEventHandler(picTabs_Selecting);       // #140895

            //140793, 26537
            //AutoCompleteStringCollection OffsetNickNameList = new AutoCompleteStringCollection();            
            //28160            
            //_gbHelper.GetAutoCompleteList(listName, emplId, out OffsetNickNameList);
            //dfTfrAcctNo.AutoCompleteCustomSource = OffsetNickNameList;
            this.dfTfrAcctNo.AutoCompleteMode = AutoCompleteMode.Suggest;
            this.dfTfrAcctNo.AutoCompleteSource = System.Windows.Forms.AutoCompleteSource.CustomSource;
            //dfAcctNo.AutoCompleteCustomSource = OffsetNickNameList;
            this.dfAcctNo.AutoCompleteMode = AutoCompleteMode.Suggest;
            this.dfAcctNo.AutoCompleteSource = System.Windows.Forms.AutoCompleteSource.CustomSource;


            //Begin #203301.User Story 01: 44600
            if (Workspace is PwksWindow && (Workspace as PwksWindow).IsHighResWorkspace)
            {
                (this.Extension as Phoenix.Shared.Windows.FormExtension).ResizeFormEnd -= new EventHandler(frmTlTranCode_ResizeFormEnd);
                (this.Extension as Phoenix.Shared.Windows.FormExtension).ResizeFormEnd += new EventHandler(frmTlTranCode_ResizeFormEnd);
            }
            //End #203301.User Story 01: 44600
            tellerCaptureMemo = (!_tlTranSet.TellerVars.AdTlControl.TellerCaptureMode.IsNull && _tlTranSet.TellerVars.AdTlControl.TellerCaptureMode.Value == "Memo");   //#50964
            #region Merged Application Code
            this.pbOnUsMisc.ImageButton.Style = PImageButton.ButtonStyle.DropDown; //#60578
            pbOnUsMisc.ImageButton.DropDownMenu = cmOnUs; //#60578

            this.pbInventoryMisc.ImageButton.Style = PImageButton.ButtonStyle.DropDown; //#60578
            pbInventoryMisc.ImageButton.DropDownMenu = cmInventory; //#60578

            pbRimDirect.Image = AcProcImages.QuickAccessSmall; //60620
            pbRim.Image = Phoenix.Windows.Forms.Images.Edit; //60620
            //Begin  #60647. Same as Cust RMS window
            pbNewAcct.Image = Phoenix.Windows.Forms.Images.New;
            pbDirectAcct.Image = AcProcImages.QuickAccessSmall;
            pbEdit.Image = Phoenix.Windows.Forms.Images.Edit;
            pbMisc.Image = AcProcImages.QuickAccessSmall; //61726
            pbEditService.Image = Phoenix.Windows.Forms.Images.Edit; //61240
            pbEditNonCust.Image = Phoenix.Windows.Forms.Images.Edit; //#60689
            pbSearch.Image = Phoenix.Windows.Forms.Images.Search; //65205          
            this.pbRim.NextScreenId = Phoenix.Shared.Constants.ScreenId.Rm;   
            this.pbPortfolio.NextScreenId = Phoenix.Shared.Constants.ScreenId.RmPortfolio;
            this.pbRimAchFuture.NextScreenId = Phoenix.Shared.Constants.ScreenId.OnRmEditFutDtTxView;
            this.pbUmbrella.NextScreenId = Phoenix.Shared.Constants.ScreenId.IraUmbrella;
            this.pbArchive.NextScreenId = Phoenix.Shared.Constants.ScreenId.ArchivedAccounts;
            //End  #60647
            this.pbSales.NextScreenId = Phoenix.Shared.Constants.ScreenId.SalesServiceRSMDetails;   //61240
            #endregion          
            return ReturnType.Success;

        }

        //Begin #140895
        void picTabs_Selecting(object sender, TabControlCancelEventArgs e)
        {
            if (e != null && e.Action == TabControlAction.Selecting && e.TabPageIndex == 0 && _tlTranSet != null && _tlTranSet.IsTellerCaptureTran)
            {
                //EnableDisableTellerCaptureTran("TabSelectingInputTransaction");
            }
        }
        //End #140895

        private void frmTlTranCode_PInitCompleteEvent()
        {
            //populate the acct type combo
            //ActionSave.Shortcut = Keys.F2;
            //74509 - map business obj properties before all loads/populates
            #region Merged Application Code
 			/*Begin Task#97343 - need to translate non-customer seperator text for credit union*/
            if (_adGbBankControl.InstitutionType.Value == "CU")
            {
                this.pActionSepNonCust.SeperatorText = CoreService.TranslateText(this.pActionSepNonCust.SeperatorText, Phoenix.FrameWork.Shared.Variables.GlobalVars.InstitutionType, this.FormSource);
            }
            /*End Task#97343*/            
            //Begin #60689. Make this setting initially on Tab_change. then later on with correct tab condition we can change it
            pActionSepNonCust.Visible = false;
            pActionSepSrchMisc.Visible = false;
            pbRestrictions.Visible = true;
            pbACHFut.Visible = true;
            pbIrsRpt.Visible = true;
            pbPendingCC.Visible = true;
            pbeReceipt.Visible = true;
            pbNOCHistory.Visible = true; 
            //End #60689
            pbSeperatorTeller.SeperatorText = ""; //#60578
            pbSeperatorCust.Visible = false;  //#60620
            pbSeperatorAcct.Visible = false;
            pbMisc.Visible = false;    //#60578
            pbSeperatorServ.Visible = false;
            bool rmDisplayEnabled = CoreService.UIAccessProvider.HasReadAcces(Shared.Constants.ScreenId.RmDisplay); //Bug #95565
            bool rmHistoryEnabled = CoreService.UIAccessProvider.HasReadAcces(Shared.Constants.ScreenId.RmHistory); //Bug #95565
            //Begin #60620. Hide Customer Action Grouping button in all tabs
            pbRim.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbRimDirect.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbRimDisplay.SetObjectStatus(VisibilityState.Hide, rmDisplayEnabled ? EnableState.Enable : EnableState.Disable); //Bug #95565
            pbRimHistory.SetObjectStatus(VisibilityState.Hide, rmHistoryEnabled ? EnableState.Enable : EnableState.Disable); //Bug #95565
            //End #60620
            //Begin 61240
            this.pbActionSeperator4.Visible = false;
            this.pbEditService.Visible = false;
            this.pbSales.Visible = false;
            //End 61240            
            //Begin  #60647
            pbNewAcct.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbDirectAcct.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbUmbrella.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbEdit.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbArchive.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbServicing.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            //End  #60647
            #endregion
            MapFieldToObject(); //#74509
            LoadAmtFields();
            LoadHiddenFields();
            LoadMiscTCFields();
            LoadMiscAcctFields();

            PopulateAcctTypeCombo(cmbAcctType, true, true);
            PopulateAcctTypeCombo(cmbRefAcctType, false, false);
            PopulateAcctTypeCombo(cmbTfrAcctType, false, true);     //140793

            PopulateTranCodeCombo(GlobalVars.Instance.ML.RM, null); //#76458 - added param value for acctType
            int _utilityId = _tlTranSet.CurTran.UtilityId.Value;    /* #126669 - utilityId stored to assign after reset */
            PopulateMiscCombos();

            EnableDisableControls("FormCreate");
            EnableDisableControls(EnumEnableDisable.DisableBondPurchase);  //#76047
            SetTabOrder("FormCreate");
            EnableDisableControls(EnumEnableDisable.CDRedemp);          //140782, 21033
            //MapFieldToObject(); //#74509 - moved this line up: Selva - Do not change it.
            SetDefaultValues();
            this.cmbUtility.PhoenixUIControl.BusObjectProperty.Value = _utilityId;  /* #126669 - utilityId value set */
            // hack
            cmbAcctType.CodeValue = null;
            cmbTfrAcctType.CodeValue = null;
            cmbRefAcctType.CodeValue = null;
            cmbTranCode.CodeValue = null;
            cmbUmbCode.CodeValue = null;
			cmbUtility.CodeValue = null;
            cmbInventoryType.CodeValue = null;  //#140772
            cmbInventoryPacket.CodeValue = null;    //#140772
			cmbLnEscrowAgent.CodeValue = null;	//#80617
            cmbRegCC.CodeValue = null;
            cmbRecalcPmtDt.CodeValue = null;    //#76425
			cmbChannel.CodeValue = null;    //#79506

            MoveAmtObjectsToScreen();
            enableAddNext = true;
            dfCheckNo.PhoenixUIControl.InputMask = "9999999999";
            dfTfrCheckNo.PhoenixUIControl.InputMask = dfCheckNo.PhoenixUIControl.InputMask;
            calcControl = null;
            // WI #10527 - The dfCheckNo Enable/Disable Is Now Controlled by isSqrCheckExisting - Moved to EnableDisableControls()
            //if (_tlTranSet.TellerVars.AdTlControl.TellerChkPrint.Value == "Y")
            //{
            //   dfCheckNo.Enabled = false;
            //    dfCheckNo.UnFormattedValue = 0;
            //}
            // End WI#10527

            #region On Us #80620
            pbOnUsSig.Enabled = true;
            onUsBar.Visible = false;
            onUsBar.Enabled = false;
            #endregion

            // hack
            picTabs.TabStop = false;
            focusAcctField = cmbAcctType;
            lastActiveControl = cmbAcctType;
            cmbAcctType.Focus();
            Workspace.ActionPanel.UpdateView();
            if (workSpaceWinCount <= 0)
            {
                workSpaceWinCount = Workspace.ContentCount + 1;
            }

            this.setLabels();   //#76048

            

            if (_tlTranSet.CurTran.TranAcct.RimNo.IsNotNull)
            {
                this.setTitleBarName(_tlTranSet.CurTran.TranAcct.RimNo.Value, true); //8497 this.setTitleBarName();
            }            

            //Begin #76041
            //if (_tlTranSet.TellerVars.IsAppOnline && _tlTranSet.AdTlControl.DisplayNicknames.Value == GlobalVars.Instance.ML.Y)    //#1968 - 2183
            if (_tlTranSet.TellerVars.IsAppOnline && _tlTranSet.AdTlControl.DisplayNicknames.Value == GlobalVars.Instance.ML.Y)    //#1968
            {
                this.colAcctNickname.Visible = true;
                //#3538this.cbShowAll.SetObjectStatus(NullabilityState.Null, VisibilityState.Show, EnableState.Default);
                this.dfAcctNickname.SetObjectStatus(NullabilityState.Null, VisibilityState.Show, EnableState.Default);

                //#3538
                //#3538if (_tlTranSet.AdGbRsm.ShowAllAcct.Value == GlobalVars.Instance.ML.Y)
                //#3538cbShowAll.Checked = true;
                //#3538else
                //#3538cbShowAll.Checked = false;
            }
            else
            {
                //#3538this.cbShowAll.SetObjectStatus(NullabilityState.Null, VisibilityState.Hide, EnableState.Default);
                this.dfAcctNickname.SetObjectStatus(NullabilityState.Null, VisibilityState.Hide, EnableState.Default);
                this.colAcctNickname.Visible = false;
            }
            //#3538cbShowAll.ScreenToObject();
            //this.setTitleBar();
            if (_tellerCapture == null || (_tellerCapture != null && !_tellerCapture.IsTransactionInProgress)) //#38295
                this.setTitleBar();
            //End #76041

			//Begin #79156
            if (!(_fromAddNext && isNonCust())) //#added for #9691
			{
                //75151. Added this.Workspace.Variables["FrmTlTrancodeSource"].ToString() == "actionSearch" in below condition
                if (((!_tlTranSet.TellerVars.AdTlControl.TellerTabDefault.IsNull &&
                    _tlTranSet.TellerVars.AdTlControl.TellerTabDefault.Value == "S") || (this.Workspace.Variables.Contains("FrmTlTrancodeSource") && this.Workspace.Variables["FrmTlTrancodeSource"].ToString() == "actionSearch"))
                    && _tlTranSet.TellerVars.IsAppOnline && !processingSelectTran &&
					!(_tlTranSet.TellerVars.AdTlControl.VltGlTranOnly.StringValue == "Y" && TellerVars.Instance.IsVaultDrawer))  //#79156-Selva// //#79619 - do not default to search window if VltGlTranOnly and Vault drawer.
				{

					#region Store Last RIM, default Search #8839,#8914
					// Push Last Rim No into search fields.
					if (_loadCustSummary)
					{
                        Name3.IsDisabled = !ScreenHasAccess("custSummary", false);      // WI#16236 passing isTfrAcct as false
						this.Workspace.Variables["RimNo"] = searchRimNo = _lastSearchRimNo;
						searchAcctType = "RIM";
						searchAcctNo = Convert.ToString(searchRimNo);

						#region Deleted Code WI#29068 the window will create when the tab index in chagned. all necessary code is there, this causes error if tab never selected
						//if (frmGloAccountListRim == null)
						//{
						//    CreateEmbeddedWindows("Summary");

						//    Workspace.ActionPanel.UpdateView();
						//}
						#endregion
					}
					#endregion #8839,#8914-End
                    // #140782 - added _fromDpRedempCalc
					if (!_fromDpRedempCalc && (!_fromAddNext || _loadCustSummary || (_fromAddNext && (_tlTranSet.TellerVars.AdTlControl.DisplayNicknames.IsNull || (!_tlTranSet.TellerVars.AdTlControl.DisplayNicknames.IsNull && _tlTranSet.TellerVars.AdTlControl.DisplayNicknames.Value != "Y")))))
					{
						picTabs.SelectedIndex = 2;
						if (frmTBarSearch == null)
						{
							CreateEmbeddedWindows("Search");

							Workspace.ActionPanel.UpdateView();
						}
						picTabs.IndexChanged(new EventArgs());
					}
					_loadCustSummary = false;
					_fromAddNext = false;
					_tranPostingAttempted = false;  //#9433
					_lastSearchRimNo = -1;
				}
                //Begin 89208
                else if ((!_tlTranSet.TellerVars.AdTlControl.TellerTabDefault.IsNull && _tlTranSet.TellerVars.AdTlControl.TellerTabDefault.Value == "Q") &&
                          _tlTranSet.TellerVars.IsAppOnline && !processingSelectTran &&
                          !(_tlTranSet.TellerVars.AdTlControl.VltGlTranOnly.StringValue == "Y" && TellerVars.Instance.IsVaultDrawer) &&
                          !_isOvRunning)
                {
                    //Begin 92498
                    if ((!_fromAddNext) && ((!_tabOnSave) || (_tabOnSave && _quickTabFocusedOnSave)))
                    {
                        picTabs.SelectedIndex = (int)TAB.QuickTran;
                        CreateEmbeddedWindows("QuickTran");

                        picTabs.IndexChanged(new EventArgs()); //87735

                        _quickTabFocusedOnSave = false;
                        _fromAddNext = false;
                    }
                    //End 92498
                }
                //End 89208

                _tabOnSave = false; // 92498
            }
            //End #79156

            //Begin #8942, #9102, moved here for #9442
            //#9775 - if condition changed cause in some scenario the rim info was not clearing out while posting multiple transactions.
            //if (!_fromAddNext && isNonCust())
            if (_tlTranSet.Transactions.Count < 1 && isNonCust())
			{
				this.Workspace.Variables["NonCust"] = null;
				this.Workspace.Variables["NonCustRimNo"] = null;
				dfAcctNo.Text = "";
				cmbAcctType.SelectedIndex = -1;
				dfAcctNo.Enabled = true;
				cmbAcctType.Enabled = true;
				//fraudTransactorCollected = false;	//#9191, #9449
                transactorWindowCalled = false;     //#found while testing #9288
				lblTlItemAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Enable);
				dfTlItemAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Enable);
				lblTlItemRoutingNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Enable);
				dfTlItemRoutingNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Enable);
				lblTlItemCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Enable);
				dfTlItemCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Enable);

				this.pbLastAcct.SetObjectStatus(VisibilityState.Default, EnableState.Default);
				this.pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Default);
				this.pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Default);
				this.lblNonCustomer.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
			}

			if (_fromAddNext && isNonCust())
			{
                dfQuickTranCode.Focus();    //#9691
			}
			//End #8942, #9102, moved here for #9442

			this.PShowCompletedEvent -= new EventHandler(frmTlTranCode_PShowCompletedEvent);    // #140895 - in case the event is attached multiple times
			this.PShowCompletedEvent += new EventHandler(frmTlTranCode_PShowCompletedEvent);

            #region #6656
            if (this.Workspace != null)
            {
                (this.Workspace as Form).FormClosing += new FormClosingEventHandler(frmTlTranCode_FormClosing);
            }
            #endregion

            #region #79619 - Force GL as default
            if (TellerVars.Instance.IsVaultDrawer && _tlTranSet.TellerVars.AdTlControl.VltGlTranOnly.StringValue == "Y")
            {
                cmbAcctType.Value = "GL";
            }
            #endregion


            //Begin #79510
            if (_tlTranSet.IsAcquirerTran)
                GetAcquirerTranSet();
            //End #79510

            //#9447
            if (!_isSupervisorViewOnlyMode) //#79314
            {
                if (!_tlTranSet.TranPostedStatus.IsNull && _tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.HasOverrides)
                {
                    if (_tlTranSet.CheckTcdVaultSellOverride())
                    {
                        ReverseDeviceDeposit(true);
                    }
                }
            }

            #region #80615
            if (MailerStatus == null)     //#19415 - if test
            {
                // Get Mailer Form info....
                _adTlForm.OutputTypeId.Value = 4;
                MailerForm = Phoenix.FrameWork.CDS.DataService.Instance.GetListViewObjects(_adTlForm);
                if (MailerForm != null && MailerForm.Count > 0)
                {
                    foreach (Phoenix.BusObj.Admin.Teller.AdTlForm adtlform in MailerForm)
                    {
                        MailerStatus = adtlform.Status.Value;
                    }
                }
                //Begin #19415
                if (MailerStatus == null)
                    MailerStatus = string.Empty;
                //End #19415
            }

            #endregion


            //Begin #79314
            if (_isSupervisorViewOnlyMode && !processingSelectTran)
            {
                //#122567 - Remote Supervisor View Only does not include MT Tran TCs caused Invalid TC problem
                _bIncQuickTCs = true;
                PopulateTranCodeCombo(GlobalVars.Instance.ML.RM, null);

                TlTransaction firstTran = null;
                foreach (TlTransaction tran in _transForOverride)
                {
                    _tlTranSet.CurTran = tran;
                    if (firstTran == null)
                        firstTran = _tlTranSet.CurTran;
                    //
                    if (!_tlTranSet.CurTran.AcctType.IsNull)    //#17229
                        LoadAcctDetails(_tlTranSet.CurTran.TranAcct, _tlTranSet.CurTran.AcctType.Value, _tlTranSet.CurTran.AcctNo.Value);
                    if (!_tlTranSet.CurTran.TfrAcctType.IsNull && !_tlTranSet.CurTran.TfrAcctNo.IsNull)
                        LoadAcctDetails(_tlTranSet.CurTran.TfrAcct, _tlTranSet.CurTran.TfrAcctType.Value, _tlTranSet.CurTran.TfrAcctNo.Value);
                    if (!_tlTranSet.CurTran.ReferenceAcctNo.IsNull && !_tlTranSet.CurTran.ReferenceAcctType.IsNull)
                        LoadAcctDetails(_tlTranSet.CurTran.RefAcct, _tlTranSet.CurTran.ReferenceAcctType.Value, _tlTranSet.CurTran.ReferenceAcctNo.Value);
                    //
                    if (_tlTranSet.CurTran.Items != null && _tlTranSet.CurTran.Items.Count > 0)
                    {
                        foreach (TlItemCapture item in _tlTranSet.CurTran.Items)
                        {
                            if (!item.AcctNo.IsNull)
                                LoadAcctDetails(item.ItemAcct, item.AcctType.Value, item.AcctNo.Value);
                        }
                    }
                    _tlTranSet.CurTran.TranIndex.Value = -1;
                    curTranIndex = _tlTranSet.AddTransaction();
                }
                PopulateTransetTable();
                SetTotalDebitsAndCredits();
                //
                if (firstTran != null)
                    _tlTranSet.CurTran = firstTran;
                if (_tlTranSet.CurTran.TranAcct != null && !_tlTranSet.CurTran.TranAcct.AcctType.IsNull && !_tlTranSet.CurTran.TranAcct.RimNo.IsNull)
                {
                    ResetFormForSupViewOnlyMode(string.Empty);
                    EnableDisableControls("AcctNoEnter");
                    //
                    #region handle account flags
                    if (_tlTranSet.CurTran.TranAcct.DepLoan.Value != GlobalVars.Instance.ML.GL)
                    {
                        //#8609 - replace searchRimNo only when the customer info not searched before
                        searchRimNo = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                        if (_holdRimNo != -1) // Reset It
                            _holdRimNo = searchRimNo; //#7054
                        searchAcctType = _tlTranSet.CurTran.TranAcct.AcctType.Value;
                        searchAcctNo = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
                        //
                        gotAccts = true;
                    }
                    #endregion
                }
            }
            //End #79314

            //#140895
            if (_tlTranSet.TellerVars.IsTellerCaptureEnabled && Phoenix.Client.Teller.TlHelper.TellerCaptureWrapper.IsXpediteRunning)
            {
                _tellerCapture = Phoenix.Client.Teller.TlHelper.TellerCaptureWrapper;
                //_tellerCapture.CurForm = this;
            }

            //Begin #19415
            GbMemo.ResetCache();
            if (Workspace != null)
                ((Workspace as PwksWindow).WksExtension as WkspaceExtension).ResetAlertCache();
            //End #19415
            #region Merged Application Code
            this.pbMisc.ImageButton.Style = PImageButton.ButtonStyle.DropDown;  //#60578
            //Begin 60647
            pbNewAcct.ImageButton.Style = PImageButton.ButtonStyle.DropDown;
            pbServicing.ImageButton.Style = PImageButton.ButtonStyle.DropDown;
            pbRimDirect.ImageButton.Style = PImageButton.ButtonStyle.DropDown;
            pbDirectAcct.ImageButton.Style = PImageButton.ButtonStyle.DropDown;
            //End //60647        

            //Begin #66693. Disable Transaction Tab if Drawer is Not Selected           
            if (TellerVars.Instance.DrawerNo <= 0  || (TellerVars.Instance.PostingDt != DateTime.MinValue && TellerVars.Instance.PostingDt < GlobalVars.SystemDate))
            {
                Name0.IsDisabled = true;
                this.tabEasyCapture.IsDisabled = true;  //Task#87717
                if (picTabs.SelectedIndex == (int)TAB.InputTran || picTabs.SelectedIndex == (int)TAB.QuickTran) //112736 
                {
                    picTabs.SelectedIndex = (int)TAB.Search;
                    picTabs_SelectedIndexChanged(null, null);
                }
            }
            else
            {
                if (_tlTranSet.TellerVars.AdTlControl.EnableQuickTranTab.Value == GlobalVars.Instance.ML.Y) //Task#88150
                {
                    this.tabEasyCapture.IsDisabled = _isOvRunning;
                }
                else
                {
                    this.tabEasyCapture.IsDisabled = true;
                    Name0.IsDisabled = false;
                }
            }
            //End #66693
            #endregion

            //begin #75604
            this.Workspace.Variables["AssumeDecimal"] = _tlTranSet.TellerVars.AdTlControl.AssumeDecimals.Value;
            if (picTabs.SelectedIndex == (int)TAB.InputTran || picTabs.SelectedIndex == (int)TAB.QuickTran)
            {
                PdfCurrency.ApplicationAssumeDecimal = (_tlTranSet.TellerVars.AdTlControl.AssumeDecimals.Value == GlobalVars.Instance.ML.Y);
                CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                this.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
            }
            //End #75604

            if (_inputParamTranSet != null && _inputParamTranSet.IsTranLoaded == false)     // #TellerWF
            {
                MapInputParamToTranSet(_inputParamTranSet);
                //picTabs.SelectedIndex = 0;
                //pbSelectTran_Click(null, null);
            }

        }        
		// #79370
		void pbInstChkSrch_Click(object sender, PActionEventArgs e)
        {
            #region Commented TempWin code and replaced with CallOtherForms - #9544
            //PfwStandard TempWin = CreateWindow("phoenix.client.checksearch", "Phoenix.Client.Checks", "frmInstitutionCheckSearch");
			//TempWin.Workspace = this.Workspace;
			//TempWin.Show();
            #endregion Commented code
            // Show window via CallOtherForms to allow control during tempwin_closed
            CallOtherForms("InstitutionChecksSearch"); // #9544
		}

        //1097
        private void frmTlTranCode_PShowCompletedEvent(object sender, EventArgs e)
        {
            //Begin #UI Refresh
            _isWindowShown = true;
            if (picTabs.SelectedIndex == 2 )
            {
                CreateEmbeddedWindows("Search");

                //WindowHelper.ResizeEmbeddedWinCntrls(frmTBarSearch);
                Workspace.ActionPanel.UpdateView();
            }
            //End #UI Refresh
            //#76430  if coming from hot key operation this code is processed
            if (isHotKey)
            {
                //Begin Bug #102824
                if (!tabEasyCapture.IsDisabled && _tlTranSet.TellerVars.AdTlControl.TellerTabDefault.Value == "Q")
                {
                    int rimNo = 0;
                    if (int.TryParse(HK_RimNO, out rimNo))
                    {
                        _quickTranWindow.SearchCustomer(rimNo);
                    }
                }
                //End Bug #102824
                else
                {
                SetAcctFields(GlobalVars.Instance.ML.RIM, HK_RimNO, dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct, dfQuickTranCode);
                picTabs.SelectedIndex = 3; // = Name2;
                    //Begin 111762. Reset back Once RMS loads
                    if (isRmSumInvoked)
                    {
                        isRmSumInvoked = false;
                    }
                    //End 111762
                    if (Extension != null)
                    Extension.Reset();
                }
            }
            if (_isSupervisorViewOnlyMode)  //#79314
            {
                if (_tlTranSet != null && _tlTranSet.Transactions.Count > 0)
                {
                    ctwTranSet.ContextRow = _tlTranSet.Transactions.Count - 1;
                    //curTranIndex = -1;
                    //SelectTran(-1);
                    //_tlTranSet.GetNotesList(ref showNotes, ref notesList);
                    showNotes = false;
                    //HandleNotes();
                    //picTabs.SelectedIndex = 1;
                    pbSelectTran_Click(pbSelectTran, new PActionEventArgs());
                }
            }

            //Begin #79510
            if (_tlTranSet.IsAcquirerTran)
            {
                if (closeFormOnComplete)
                {
                    this.Close();
                    return;
                }

                Application.DoEvents();
                Application.ThreadException += new ThreadExceptionEventHandler(Application_ThreadException);
                Workspace.Variables["IsAcquirerTran"] = true;

                //Begin #79510, #09614 #11103a-added && cond
                _tcdConnBeforeAcquirerTranPosting = _tlTranSet.TellerVars.IsTCDConnected;   //#11655
                if (_tlTranSet.ShowTCDOptionsForAcquirer(ref acquirerEnableTCR, ref acquirerEnableTCD) && _tlTranSet.TellerVars.IsTCDConnected)
                {
                    CallOtherForms("ShowTCDOptionsForAcquirer");
                    _isTcdToggleWarningShown = true;
                    if (Convert.ToBoolean(Workspace.Variables["IsAcquirerTranTCRCashIn"]))
                    {
                        if (!picTCD.Visible)
                        {
                            picDrawer.Visible = true;
                            TcdDrawerIconClick(picTCD, picDrawer);
                        }
                        foreach (TlTransaction tran in _tlTranSet.Transactions)
                        {
                            _tlTranSet.CurTran = tran;
                            if ( _tlTranSet.CurTran.CashIn.Value > 0)
                                DeviceDeposit(TlTransactionSet.UcmInterface.DeviceDeposit, false);
                        }
                        _tlTranSet.IsTcdConnected.Value = (_tlTranSet.TellerVars.IsTCDConnected ? Convert.ToInt32(1) : Convert.ToInt32(0));

                    }
                    if (Convert.ToBoolean(Workspace.Variables["IsAcquirerTranTCDCashOut"]) || Convert.ToBoolean(Workspace.Variables["IsAcquirerTranTCDDenomCashOut"]))
                    {
                        if (Convert.ToBoolean(Workspace.Variables["IsAcquirerTranTCDDenomCashOut"]))
                            cbDenominate.Checked = true;

                        if (!picTCD.Visible)
                        {
                            picDrawer.Visible = true;
                            TcdDrawerIconClick(picTCD, picDrawer);
                        }
                        foreach (TlTransaction tran in _tlTranSet.Transactions)
                        {
                            if (tran.CashOut.Value > 0 && Convert.ToBoolean(Workspace.Variables["IsAcquirerTranTCDDenomCashOut"]))
                                tran.TcdDenominate.Value = GlobalVars.Instance.ML.Y;
                        }

                        _tlTranSet.IsTcdConnected.Value = (_tlTranSet.TellerVars.IsTCDConnected ? Convert.ToInt32(1) : Convert.ToInt32(0));
                    }
                    else if (_tlTranSet.TellerVars.IsTCDConnected)  //#11655 - changed from elseif to if
                    {
                        _tlTranSet.TellerVars.IsTCDConnected = false;
                        _tlTranSet.IsTcdConnected.Value = 0;/*11205*/
                    }
                }
                if (_tlTranSet.ValidateTCDAndOvrdsForAcquirer())
                    ProcessResponses(null);
                //End #79510, #09614

                ProcessAcquirerTranSet("PShowCompletedEvent");

            }
            //if (_tlTranSet.IsAcquirerTran)
            //    ((this.Workspace.ContentWindow as PContentPanel).ContentManager as ContentManager).KeepPreviousWindowsVisible = false;
            //End #79510

            if (_inputParamTranSet != null && _inputParamTranSet.IsTranLoaded)     // #TellerWF
            {
                try
                {
                    if ( _invokedByWorkflow)
                    {
                        var extension = Extension as IFormExtension;
                        if ( extension != null)
                        {
                            //if this window launches another child window as part of transet population, the workflow task execution code 
                            //tries to kill this window itself. The flag below will instruct the workflow code not to do so.
                            extension.Variables["_WFSkipClosingWinOnLaunch"] = true;
                        }
                    }
                    dlgInformation.Instance.ShowInfo("Loading transaction...");
                    pbSelectTran_Click(null, null);
                    if (_invokedByWorkflow && Workspace != null)
                    {
                        Workspace.Variables[InputParamTranSet.WFTranStatusWkspaceVar] = WFTranStatus.Pending.ToString();
                    }
                }
                finally
                {
                    dlgInformation.Instance.Hide();
                }
            }
        }

        /*Begin #72214*/
        void cmbTfrAcctType_Enter(object sender, EventArgs e)
        {
			//73105 - Added validation to not go into cmbTfrAcctType if there is no ON US amount.
			if(lastFocussedField != null && lastFocussedField != dfOnUsChks && !dfOnUsChks.IsDirty)
				Control_GotFocus(sender, e);
        }
        /*End #72214*/
        private void frmTlTranCode_Closed(object sender, EventArgs e)
        {
            //#29211
            //bondAction.Enabled = true;    // #17178
            //bondAction.Enabled = _isEnableBondAction;   //#140798
            //Begin Bug#115682
            CreateAuditViews();
            //End Bug#115682
        }

        private void frmTlTranCode_Activated(object sender, EventArgs e)
        {

        }

        private void frmTlTranCode_GotFocus(object sender, EventArgs e)
        {
            formLostFocus = false;
            if ((picTabs.SelectedIndex == 0))
            {
                if (lastActiveControl != null)
                {
                    if (lastActiveControl is PImageButton)
                    {
                        if (prevLastActiveControl != null && !(prevLastActiveControl is PImageButton))
                            prevLastActiveControl.Focus();
                        else
                            lastActiveControl.Focus();
                    }
                    else
                    {
                        lastActiveControl.Focus();
                    }
                }
            }
            else if (picTabs.SelectedIndex == 3)
            {
                if (frmGloAccountListRim != null)
                    frmGloAccountListRim.gridAccountListSum.Focus();
            }

        }

        private void frmTlTranCode_LostFocus(object sender, EventArgs e)
        {
            formLostFocus = true;

        }
        #endregion

        #region MDI Related Events
        //		public override bool IsWkspaceActionEnabled(int globalActionId, ref bool isEnabled)
        //		{
        //			if( globalActionId == 33 )
        //			{
        //				this.Workspace.Variables["RimNo"] = searchRimNo;
        //				if (this.searchRimNo > 0)
        //					isEnabled = true;
        //				else
        //					isEnabled = false;
        //
        //				return true;
        //			}
        //			return base.IsWkspaceActionEnabled (globalActionId, ref isEnabled);
        //		}

        #endregion

        #region controls related event

        #region cmbAcctType
        private void cmbAcctType_SelectedIndexChanged(object sender, System.EventArgs e)
        {            
            /*
            if ( !supressClickEvent )
            {
                SetAcctNoField( null ) ;
                SetMask( cmbAcctType , dfAcctNo );
            }
            */
            //#16655 - Commented Out the changes added as part of WI#14486 to fix the problem.
            /* Begin WI-14486 */
            //cmbAcctType.CodeValue = null;
            //cmbTfrAcctType.CodeValue = null;
            //cmbRefAcctType.CodeValue = null;
            //cmbTranCode.CodeValue = null;
            //cmbUmbCode.CodeValue = null;
            //cmbUtility.CodeValue = null;
            //cmbLnEscrowAgent.CodeValue = null;	//#80617
            //cmbRegCC.CodeValue = null;
            //cmbRecalcPmtDt.CodeValue = null;    //#76425
            //cmbChannel.CodeValue = null;    //#79506
            //cbRegD.Checked = false;
            //cbPayrollTran.Checked = false;
            ////String sinfo = String.Empty;
            ////SetInfoField(sinfo); This method will not clear val since "if (pdfInfo.TextLength != 0)" will prevent it.
            //pdfInfo.UnFormattedValue = " ";
            //dfTitle1.Clear();
            //dfTitle2.Clear();
            //dfAvailBal.Clear();
            //dfCurBal.Clear();
            //dfColBal.Clear();
            //dfAcctNo.Clear();
            //dfQuickTranCode.Clear();
            //dfTranDescription.Clear();
            //dfReference.Clear();
            //dfCashIn.Clear();
            //dfChksAsCash.Clear();
            //dfOnUsChks.Clear();
            //dfTransitChks.Clear();
            //dfCashOut.Clear();
            //dfAmt.Clear();
            //dfTranEffectiveDt.Clear();
            //dfRefAcctNo.Clear();
            //dfTfrAcctNo.Clear();
            //dfTfrCheckNo.Clear();
            //dfTlItemAcctNo.Clear();
            //dfTlItemRoutingNo.Clear();
            //dfTlItemCheckNo.Clear();
            //dfPostingExchRate.Clear();
            //dfAmtEq.Clear();
            //dfCheckNo.Clear();
            //dfInterestPaid.Clear();
            //dfPenaltyAmt.Clear();
            //dfOnUsTitle1.Clear();
            //dfOnUsTitle2.Clear();
            //dfOnUsSignatures.Clear();
            //dfTotalDebits.Clear();
            //dfTotalCredits.Clear();
            //dfDifference.Clear();
            //dfOnUsSignatures.Clear();
            /* End WI-14486 */
        }

        private void cmbAcctType_PhoenixUIEditedEvent(object sender, Phoenix.Windows.Forms.ValueEditedEventArgs e)
        {
            SetAcctNoField(null, dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct);
            //Begin #76429
            //SetMask( cmbAcctType , dfAcctNo );
            ResetMask(cmbAcctType, dfAcctNo);
            //End #76429
            // Begin #76041
            //if (AcctIsModified(dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct))
            {
                this.EnableDisableControls("AcctTypeChanged");
            }
            // End #76041
        }

        private void cmbAcctType_Validating(object sender, System.ComponentModel.CancelEventArgs e)
        {   //9034 Reworked this method. Unecessary things were being done.

            //Skip the unwanted event getting triggerd when some other window is invoked.
            if (_tlTranSet != null && _tlTranSet.IsAcquirerTran || _isSupervisorViewOnlyMode)  //#79510   #79314 //Task #124027 - Added Null Check for _tlTranset for Workflow
                return;

            //140793,26537
            if ((cmbAcctType.CodeValue == null ? "" : cmbAcctType.CodeValue.ToString()) == "GL")
            {
                //28160
                OffsetNickNameList = _tlTranSet.TellerVars.OffsetNickNameList;
                this.dfAcctNo.AutoCompleteCustomSource = OffsetNickNameList;
            }
            else
            {
                this.dfAcctNo.AutoCompleteCustomSource = null;
            }


            if (_tlTranSet != null && AcctIsModified(dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct))  //Task #124027 - Added Null Check for _tlTranset for Workflow
            {
                // IMPORTANT FUNCTION CALL.
                // A lot of things happen in SetAcctNoField
                // Format masks, rim, account access

                SetAcctNoField(null, dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct);
                //9705 - if null set the search rim no.
                if (_tlTranSet.CurTran.TranAcct.RimNo.IsNull)
                    _myRim = searchRimNo;
                else
                    _myRim = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                myPostAccess = _tlTranSet.CurTran.TranAcct.PostAccess.Value;
                myEditAccess = _tlTranSet.CurTran.TranAcct.EditAccess.Value;

                string acctTypeCodeValue = (cmbAcctType.CodeValue == null) ? null : cmbAcctType.CodeValue.ToString();
                string applType = _tlTranSet.CurTran.TranAcct.ApplType.Value;
                string depLoan = _tlTranSet.CurTran.TranAcct.DepLoan.Value;
                string fmt = string.Empty;

                if (acctTypeCodeValue != null)
                {
                    GetAcctTypeDetails(cmbAcctType, ref applType, ref depLoan, ref fmt);

                    //_tlTranSet.CurTran.TranAcct.DepLoan.Value = depLoan;
                    //_tlTranSet.CurTran.TranAcct.ApplType.Value = applType;
                    //_tlTranSet.CurTran.TranAcct.AcctType.Value = acctTypeCodeValue;

                    if (applType == "BOX")// Task#116383 - Include mask for the SD box
                    {
                        SetMask(cmbAcctType, dfAcctNo);
                    }
                    if (acctTypeCodeValue != GlobalVars.Instance.ML.GL && applType != "BOX") // Task#116383
                    {
                        ResetMask(cmbAcctType, dfAcctNo);
                    }
                    else if (acctTypeCodeValue == GlobalVars.Instance.ML.GL)
                    {
                        SetMask(cmbAcctType, dfAcctNo);

                        _myRim = int.MinValue; // GL cannot have a Rim No //9034
                        _tlTranSet.CurTran.TranAcct.RimNo.Value = int.MinValue; //9034

                        // #9543 - Commented - _tlTranSet.CurTran.TranAcct.ApplType.Value = applType;
                        _tlTranSet.CurTran.TranAcct.AcctType.Value = acctTypeCodeValue;

                    }

                    //9034PopulateTranCodeCombo( GetDepLoan(cmbAcctType), (cmbAcctType.CodeValue != null ? cmbAcctType.CodeValue.ToString() : null));//#76458
                    PopulateTranCodeCombo(depLoan, acctTypeCodeValue);
                    if (cmbAcctType.CodeValue != null && cmbAcctType.CodeValue.ToString() == GlobalVars.Instance.ML.GL)
                    {
                        _tlTranSet.CurTran.TranAcct.AcctType.Value = GlobalVars.Instance.ML.GL;
                        _tlTranSet.CurTran.TranAcct.ApplType.Value = GlobalVars.Instance.ML.GL;
                    }

                }

                // Begin #76041
                this.EnableDisableControls("AcctTypeChanged");

                if (_tlTranSet.TellerVars.IsAppOnline)
                {

                    if (acctTypeCodeValue != null       // #1983 changed from code to description
                        && _myRim > 1
                        && (depLoan == GlobalVars.Instance.ML.DP
                            || depLoan == GlobalVars.Instance.ML.LN
                            || depLoan == GlobalVars.Instance.ML.EX
                            || depLoan == GlobalVars.Instance.ML.Ext)    //#2677
                         )
                    {
                        this.dfTitle1.UnFormattedValue = string.Empty;
                        this.dfTitle2.UnFormattedValue = string.Empty;

                        if (!processingSelectTran)  //#79156-Selva
                        {
                            #region #10495 - If coming from add next and security access is null, load it from cached variables....
                            if (myPostAccess == null && _fromAddNext)
                                myPostAccess = _myPostAccessAddNext;
                            if (myEditAccess == null && _fromAddNext)
                                myEditAccess = _myEditAccessAddNext;
                            #endregion
                            //#10049 - The following acct type assignment is required to handle account type filter for ownership accounts window.
                            _tlTranSet.CurTran.TranAcct.AcctType.Value = this.cmbAcctType.Text;
                            this.CallOtherForms("ShowAcctNicknamesList");
                        }
                    }

                    this.gotAccts = false;
                }
                // End #76041


            }
        }
        private void cmbAcctType_ValidatingOLD(object sender, System.ComponentModel.CancelEventArgs e)
        {
        //    #region #9034
        //    if (cmbAcctType.CodeValue != null && cmbAcctType.CodeValue.ToString() == GlobalVars.Instance.ML.GL)
        //    {
        //        _tlTranSet.CurTran.TranAcct.AcctType.Value = GlobalVars.Instance.ML.GL;
        //        //_tlTranSet.CurTran.TranAcct.ApplType.Value = GlobalVars.Instance.ML.GL; // #9109 - commented
        //        _tlTranSet.CurTran.TranAcct.RimNo.SetValueToNull();
        //        dfAcctNo.Text = "";
        //        SetAcctNoField(null, dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct);
        //    }

        //    #endregion

        //    //Begin #79510
        //    //skip the unwanted event getting triggerd when some other window is invoked.
        //    if (_tlTranSet.IsAcquirerTran)
        //        return;
        //    //End #79510

        //    // Begin #76041
        //    if (_tlTranSet.CurTran.TranAcct.RimNo.Value > 0)
        //    {
        //        _myRim = _tlTranSet.CurTran.TranAcct.RimNo.Value;
        //        if (!_tlTranSet.CurTran.TranAcct.PostAccess.IsNull) //#5700
        //            myPostAccess = _tlTranSet.CurTran.TranAcct.PostAccess.Value;
        //        if (!_tlTranSet.CurTran.TranAcct.EditAccess.IsNull) //#5700
        //            myEditAccess = _tlTranSet.CurTran.TranAcct.EditAccess.Value;
        //    }
        //    // End #76041
        //    //#8864
        //    if (AcctIsModified(dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct))
        //    {
        //        SetAcctNoField(null, dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct);
        //        /*begin wi 5220*/
        //        if (cmbAcctType.CodeValue != null && cmbAcctType.CodeValue.ToString() != GlobalVars.Instance.ML.GL)
        //        {
        //            //Begin #76429
        //            //SetMask( cmbAcctType , dfAcctNo );
        //            ResetMask(cmbAcctType, dfAcctNo);
        //        }
        //        else if (cmbAcctType.CodeValue != null && cmbAcctType.CodeValue.ToString() == GlobalVars.Instance.ML.GL)
        //            SetMask(cmbAcctType, dfAcctNo);
        //        /*end wi 5220*/
        //        //End #76429
        //        //Begin #76458
        //        PopulateTranCodeCombo(GetDepLoan(cmbAcctType), (cmbAcctType.CodeValue != null ? cmbAcctType.CodeValue.ToString() : null));
        //        //End #76458
        //        if (cmbAcctType.CodeValue != null && cmbAcctType.CodeValue.ToString() == GlobalVars.Instance.ML.GL)
        //        {
        //            _tlTranSet.CurTran.TranAcct.AcctType.Value = GlobalVars.Instance.ML.GL;
        //            _tlTranSet.CurTran.TranAcct.ApplType.Value = GlobalVars.Instance.ML.GL;
        //        }

        //        // Begin #76041
            //        this.EnableDisableControls("AcctTypeChanged");

        //        if (_tlTranSet.TellerVars.IsAppOnline)
        //        {
        //            if (_myRim > 0 && _tlTranSet.CurTran.TranAcct.RimNo.Value < 1)
        //            {
        //                _tlTranSet.CurTran.TranAcct.RimNo.Value = _myRim;
        //                _tlTranSet.CurTran.TranAcct.PostAccess.Value = myPostAccess;    //#5700
        //                _tlTranSet.CurTran.TranAcct.EditAccess.Value = myEditAccess;    //#5700
        //            }


        //            if ((cmbAcctType.Description != null)       // #1983 changed from code to description
        //                && (_tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP
        //                    || _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.LN ||
        //                    _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.EX ||
        //                    _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.Ext)    //#2677
        //                && _tlTranSet.CurTran.TranAcct.RimNo.Value > 1)
        //            {
        //                this.dfTitle1.UnFormattedValue = this.dfTitle2.UnFormattedValue = string.Empty;
        //                _tlTranSet.CurTran.TranAcct.AcctType.Value = this.cmbAcctType.Text;
        //                if (!processingSelectTran)  //#79156-Selva
        //                    this.CallOtherForms("ShowAcctNicknamesList");
        //            }

        //            this.gotAccts = false;
        //        }
        //        // End #76041
        //    }
        }

        private void cmbAcctType_PhoenixUILeaveEvent(object sender, PEventArgs e)
        {
            // hack
            picTabs.TabStop = true;
            this.dfAcctNickname.UnFormattedValue = string.Empty; //#76041
        }

        private void cmbAcctType_PhoenixUIEnterEvent(object sender, PEventArgs e)
        {
            focusAcctField = cmbAcctType;
        }

        #endregion

        #region dfAcctNo
        //void dfAcctNo_Validating(object sender, CancelEventArgs e)  //#4695
        //{
        //    // REAL HACK
        //    if (e.Cancel)
        //        dfAcctNo.ResetValidateFlags();
        //}

        private void dfAcctNo_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
        {
            bool fireSignature = false;
            //			CancelEventArgs eVal = null;
			//bool fraudChecked = true;		//#9568
			//Begin #11709 - if fraud check is +ve, override window is displayed which is triggering dfAcctNo_PhoenixUIValidateEvent again.
			if (dfAcctNo.Text == _tlTranSet.CurTran.TranAcct.AcctNo.Value)
			{
				dfQuickTranCode.Focus();
				return;
			}
			//End #11709

            //26537
            //140793
            //if (AcctIsModified(dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct))
            if (dfAcctNo.Text != "" && (cmbAcctType.Value != null && cmbAcctType.Value.ToString() == "GL"))
            {
                Regex rgx = new Regex(@"[a-zA-Z]");
                if (rgx.IsMatch(dfAcctNo.Text) ? true : false)
                {
                    PString listName = new PString("listName");
                    listName.Value = "OffsetNickName";
                    PInt emplId = new PInt("emplId");
                    emplId.Value = BusGlobalVars.EmployeeId;
                    PString offsetValue = new PString("offsetValue");
                    offsetValue.Value = dfAcctNo.Text;
                    GbHelper gbHelper = new GbHelper();
                    string selectedOffsetValue = gbHelper.GetAutoCompleteSelectedValue(listName, emplId, offsetValue);
                    if (selectedOffsetValue != null && selectedOffsetValue != "")
                    {
                        dfAcctNo.Value = selectedOffsetValue;
                    }
                }
            }

            //#38532
            if (!string.IsNullOrEmpty(dfAcctNo.Text) && (cmbAcctType.Value != null && cmbAcctType.Value.ToString() == "RIM"))
            {
                dfAcctNo.Value = dfAcctNo.Text.Trim();  // #39655
                if (dfAcctNo.Text.Trim() != Convert.ToInt32(dfAcctNo.Text).ToString())
                    dfAcctNo.Value = Convert.ToInt32(dfAcctNo.Text).ToString();
            }

            //Begin #10532
            //SetAcctNoField(dfAcctNo.Text, dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct);
            if (!SetAcctNoField(dfAcctNo.Text, dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct)) 
            {
                e.Cancel = false;
                return;
            }
            //End #10532

            if (AcctIsModified(dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct))
            {
				//Begin #9568
				//fraudChecked = false;
				if (isNonCustAllowed && !cmbTranCode.Enabled)
					cmbTranCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Enable);
				if (isNonCustAllowed && !dfQuickTranCode.Enabled)
					dfQuickTranCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Enable);
				//End #9568
                if (_jointRimsShownForCrossRef) //#38637
                {
                    if (_tlTranSet.CurTran.TranAcct.CrossReference.Value == "Y")
                        dfAcctNo.Text = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
                    _jointRimsShownForCrossRef = false;
                }

                if (!SetAcctNoField(dfAcctNo.Text, dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct))
                {
                    //					eVal = e as CancelEventArgs;
                    //					if ( eVal != null )
                    //						eVal.Cancel = true;
                    e.Cancel = false;   //#4695 - Do not change this value. Talk to Selva first.
                    return;
                }

                //Begin #76429:
                //SetMask(cmbAcctType, dfAcctNo); //#6917
                if (_tlTranSet.CurTran.TfrAcct.CrossReference.Value == "Y")
                {
                    dfTfrAcctNo.UnFormattedValue = _tlTranSet.CurTran.TfrAcct.AcctNo.Value;
                }

                if (_tlTranSet.CurTran.TranAcct.CrossReference.Value == "Y")
                {
                    dfAcctNo.UnFormattedValue = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
                }
                //End #76429

                // Begin #76041
                if (_tlTranSet.TellerVars.IsAppOnline)
                    dfAcctNickname.UnFormattedValue = _tlTranSet.CurTran.TranAcct.AcctNickname.Value;
                // End #76041

                if (cmbAcctType.Text.Trim() != string.Empty && this.dfAcctNo.Text.Trim() != string.Empty)
                    fireSignature = true;
                _isSwitchedToRim = false;
            }

            //Begin #140895
            if (_creatingTlCaptureTranSet)
                fireSignature = true;
            //End #140895

            //#Begin Enh# 69248
            if (this.cmbAcctType.Text.Trim() != string.Empty && this.dfAcctNo.Text.Trim() != string.Empty)
                CallOtherForms("Messenger");
            //#End Enh# 69248
            if (fireSignature)
            {
                string depLoan = string.Empty;
                if (!_tlTranSet.CurTran.TranAcct.DepLoan.IsNull)
                    depLoan = _tlTranSet.CurTran.TranAcct.DepLoan.StringValue;
                /* Begin - 76010 */
                if (_tlTranSet.AdGbRsm.ShowSigCard.Value == GlobalVars.Instance.ML.Y &&
                     depLoan != GlobalVars.Instance.ML.GL && depLoan != GlobalVars.Instance.ML.RM &&
                    _tlTranSet.TellerVars.IsAppOnline)
                /* End 76010*/
                {
                    // do signature card stuff
                    //
                    //Signers #71415
                    //&& _tlTranSet.CurTran.TranAcct.NoSignatures.Value > 0 - Incorrect Assertion
                    if ((picTabs.SelectedIndex == 0 || _creatingTlCaptureTranSet) && iconSigner.Enabled)  // #140895 - check for _creatingTlCaptureTranSet
                    {
                        CallOtherForms("Signers");
                    }
                }

                fireSignature = false;
            }

            // Begin #76041
            if (_tlTranSet.TellerVars.IsAppOnline)
            {
                gotAccts = false;
                dfQuickTranCode.Focus();
                _myRim = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                myPostAccess = _tlTranSet.CurTran.TranAcct.PostAccess.Value;    //#5700
                myEditAccess = _tlTranSet.CurTran.TranAcct.EditAccess.Value;    //#5700
               /* Begin #90671 */
                //if (_tlTranSet.CurTran.TranAcct.AcctNickname.Value == null)
                if (string.IsNullOrEmpty( _tlTranSet.CurTran.TranAcct.AcctNickname.Value ))
                /* End #90671 */
                {
                    //Begin #2031 - moved the following nickname collection logic under the deploan condition
                    if (!_tlTranSet.CurTran.TranAcct.DepLoan.IsNull
                        && (_tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP
                            || _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.LN
                            || _tlTranSet.CurTran.TranAcct.DepLoan.Value == "EX")
                        )
                    {
                        _tlTranSet.CurTran.TranAcct.GetAcctNoNicknameDetails();
                        //#3538 begin
                        for (int loop = 0; loop < _tlTranSet.CurTran.TranAcct.NicknameAcctList.Count; loop++)
                        {
                            if (_tlTranSet.CurTran.TranAcct.NicknameAcctList[loop] != null && _tlTranSet.CurTran.TranAcct.AcctNo.Value != null)   // #08656
                                if (_tlTranSet.CurTran.TranAcct.NicknameAcctList[loop].ToString() == _tlTranSet.CurTran.TranAcct.AcctNo.Value.ToString())
                                {
                                    _tlTranSet.CurTran.TranAcct.AcctNickname.Value = _tlTranSet.CurTran.TranAcct.NicknameAcctList[loop + 4].ToString();
                                    loop = _tlTranSet.CurTran.TranAcct.NicknameAcctList.Count;
                                }
                        }
                        //#3538 end
                    }
                    //End #2031
                }

                dfAcctNickname.UnFormattedValue = _tlTranSet.CurTran.TranAcct.AcctNickname.Value;   //#76041

                //8497this.setTitleBarName();

            }
            // End #76041
			this.setTitleBarName(_tlTranSet.CurTran.TranAcct.RimNo.Value, true);  //8497this.setTitleBarName();
			//Begin #9568, again for #9568 on 11.30.2010
			//if (!fraudChecked) due to some reason AcctIsModified is returning false all the time, fraudChecked in never false.
			CheckFraud();
			//End  #9568
            //Begin #21733
            if ((dfAcctNo.Value == null ? "" : dfAcctNo.Value.ToString().Trim()) != "" && AppInfo.Instance.IsAppOnline)     //#39946
            {// check whether the GL account status is closed
                if (cmbAcctType.Value != null && cmbAcctType.Value.ToString().Trim() == "GL")   //#24218
                {
                    if (_gbHelper.GetAcctStatus(cmbAcctType.Value.ToString(), dfAcctNo.Value.ToString()).Trim() == "Closed")
                    {
                        //14279 : Invalid status. Transactions cannot be posted against a general ledger account with a status of "Closed"
                        PMessageBox.Show(14279, MessageType.Warning, MessageBoxButtons.OK, String.Empty);
                        dfAcctNo.Value = "";
                        dfTitle1.Text = "";
                        _tlTranSet.CurTran.TranAcct.AcctNo.Value = null;
                        e.Cancel = true;
                    }
                }
            }
            //End #21733
        }
		//Begin #9539
		private void CheckTlJournal()
		{
			if (isNonCustAllowed && cmbAcctType.Text == "RIM" && dfAcctNo.Text != "")
			{
				TlNonRmAcct tlNonRmAcct = new TlNonRmAcct();
				tlNonRmAcct.CallTlJournalSrch(Convert.ToInt32(dfAcctNo.Text));
				if (!tlNonRmAcct.FraudLog.IsNull && tlNonRmAcct.FraudLog.Value != "")
				{
					ArrayList ovrds = new ArrayList();
					XmlDocument oXml = new XmlDocument();
					oXml.LoadXml(tlNonRmAcct.FraudLog.Value);
					foreach (XmlNode oNode in oXml.SelectNodes("//GB_FRAUD_LOG"))
					{
						GbFraudLog gbFraudLog = new GbFraudLog();
						BusObjSerializer.LoadFromXml(gbFraudLog, oNode.OuterXml);
						if (gbFraudLog.OvrdId.Value > 0)
						{
							ovrds.Add(gbFraudLog);
						}
					}
					if (ovrds.Count > 0)
					{
						PfwStandard tempWin = Helper.CreateWindow("phoenix.client.tloverride", "Phoenix.Windows.TlOverride", "dlgTlSupervisorOverride");
						tempWin.Workspace = this.Workspace;
						tempWin.InitParameters("FraudOfac", ovrds);
						//dlgInformation.Instance.HideInfo();
						tempWin.Show();
					}
				}
			}
		}
		//End #9539
		//Begin #9568
		public void CheckFraud()
		{
            Int32 rimNo = 0;

            if (isNonCustAllowed && ((this.Workspace.Variables["NonCustRimNo"] == null && cmbAcctType.Text == "RIM" && dfAcctNo.Text != "") || searchRimNo > 0))  //2010 #10763; 2011 #10764
			{
                if (picTabs.SelectedIndex == (int)TAB.QuickTran) //Task#97603
                    rimNo = searchRimNo;
                /* Begin
				 * 2010 #10763; 2011 #10764 - In Teller module, Pressing Select on the 10447 –
				 * frmTlTranCode window does NOT pop up a fraud match
				 */
                else if (cmbAcctType.Text == "RIM" && !string.IsNullOrEmpty(dfAcctNo.Text))
                {
                        rimNo = Convert.ToInt32(dfAcctNo.Text);
                        //tlNonRmAcct.CallFraudSrch(Convert.ToInt32(dfAcctNo.Text));
                }
				else
                    rimNo = searchRimNo;
                //tlNonRmAcct.CallFraudSrch(searchRimNo);
                // End 	2010 #10763; 2011 #10764

                if (rimNo != 0)
                {
                    TlNonRmAcct tlNonRmAcct = new TlNonRmAcct();
                    tlNonRmAcct.CallFraudSrch(rimNo);

                    if (!tlNonRmAcct.FraudLog.IsNull && tlNonRmAcct.FraudLog.Value != "")
                    {

                        ArrayList ovrds = new ArrayList();
                        XmlDocument oXml = new XmlDocument();
                        oXml.LoadXml(tlNonRmAcct.FraudLog.Value);

                        foreach (XmlNode oNode in oXml.SelectNodes("//GB_FRAUD_LOG"))
                        {
                            GbFraudLog gbFraudLog = new GbFraudLog();
                            BusObjSerializer.LoadFromXml(gbFraudLog, oNode.OuterXml);
                            if (gbFraudLog.OvrdId.Value > 0)
                            {
                                ovrds.Add(gbFraudLog);
                            }
                        }

                        if (ovrds.Count > 0)
                        {
                            PfwStandard tempWin = Helper.CreateWindow("phoenix.client.tloverride", "Phoenix.Windows.TlOverride", "dlgTlSupervisorOverride");
                            tempWin.Workspace = this.Workspace;
                            tempWin.InitParameters("FraudOfac", ovrds);
                            //dlgInformation.Instance.HideInfo();
                            tempWin.Show();
                        }
                    }
                }
			}
		}
		//End #9568

        private void dfAcctNo_LostFocus(object sender, System.EventArgs e)
        {
            EnableDisableControls("AcctNoLostFocus");
        }

        private void dfAcctNo_GotFocus(object sender, System.EventArgs e)
        {
            //140793
            if ((cmbAcctType.CodeValue == null ? "" : cmbAcctType.CodeValue.ToString()) == "GL" && dfAcctNo.Text == "")
            {
                this.dfAcctNo.PhoenixUIControl.InputMask = null;
            }
            focusAcctField = cmbAcctType;
            EnableDisableControls("AcctNoGotFocus");
        }

        #endregion

        #region dfCashIn
        private void dfCashIn_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
        {
            //#72916
            //if ( dfQuickTranCode.UnFormattedValue != null && dfQuickTranCode.UnFormattedValue.ToString() == "VLT" && ( Convert.ToDecimal( dfCashIn.UnFormattedValue ) % 1 != 0 ) )
            //{
            //    PMessageBox.Show( 318514, MessageType.Warning, MessageBoxButtons.OK, String.Empty );
            //    dfCashIn.Focus();
            //}
            #region #79574
            decimal devDeposit = 0;
            if (_tlTranSet.TellerVars.IsTCDConnected && _tlTranSet.TellerVars.IsRecycler &&
                dfCashIn.UnFormattedValue != null)
            {
                devDeposit = _tlTranSet.GetTotalTcrCashDeposited(_tlTranSet.CurTran);
                if (devDeposit > 0 && devDeposit > Convert.ToDecimal(dfCashIn.UnFormattedValue))
                {
                    PMessageBox.Show(11651, MessageType.Warning, MessageBoxButtons.OK, devDeposit.ToString("$#,#0.00"));
                    dfCashIn.Focus();
                    dfCashIn.UnFormattedValue = devDeposit;
                    e.Cancel = false;
                    return;
                }
            }
            #endregion
            CalcDefaultField(dfCashIn);
        }
        #endregion

        #region dfChksAsCash
        private void dfChksAsCash_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
        {
            CalcDefaultField(dfChksAsCash);
        }
        #endregion

        #region dfOnUsChks
        private void dfOnUsChks_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
        {			
			CalcDefaultField(dfOnUsChks);
            //SkipOnUsField();
        }
        //		private void dfOnUsChks_KeyUp( object sender, System.Windows.Forms.KeyEventArgs e)
        //		{
        //			if (  tabKeyPressed && !e.Shift )
        //			{
        //				if ( dfOnUsChks.UnFormattedValue == null || Convert.ToDecimal( dfOnUsChks.UnFormattedValue ) == 0  )
        //				{
        //					if ( focusControlAfterOnUs != null )
        //						focusControlAfterOnUs.Focus();
        //				}
        //			}
        //		}
        //		private void dfOnUsChks_KeyPress( object sender, System.Windows.Forms.KeyPressEventArgs e)
        //		{
        //			if (  e.KeyChar == 9  )
        //				tabKeyPressed = true;
        //			else
        //				tabKeyPressed = false;
        //		}

        #endregion

        #region dfTransitChks
        private void dfTransitChks_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
        {
            CalcDefaultField(dfTransitChks);
            EnableDisableControls("ExceptionHold");/* #126357 | 244510 */
        }
        #endregion

        #region dfCashOut
        private void dfCashOut_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
        {
            #region #79574
            decimal devDeposit = 0;
            if (_tlTranSet.TellerVars.IsTCDConnected && _tlTranSet.TellerVars.IsRecycler &&
                dfCashOut.UnFormattedValue != null && cmbTranCode.CodeValue != null && cmbTranCode.CodeValue.ToString() == "VLS")
            {
                devDeposit = _tlTranSet.GetTotalTcrCashDeposited(_tlTranSet.CurTran);
                if (devDeposit > 0 && devDeposit > Convert.ToDecimal(dfCashOut.UnFormattedValue))
                {
                    PMessageBox.Show(13194, MessageType.Warning, MessageBoxButtons.OK, devDeposit.ToString("$#,#0.00"));
                    dfCashOut.Focus();
                    dfCashOut.UnFormattedValue = devDeposit;
                    e.Cancel = false;
                    return;
                }
            }
            #endregion
            CalcDefaultField(dfCashOut);
        }
        #endregion

        #region dfAmt

        private void dfAmt_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
        {
            decimal netAmt = Convert.ToDecimal(dfAmt.UnFormattedValue);

            // trigger only when value Amt has changed 140782-3
            if (netAmt != _tlTranSet.CurTran.NetAmt.Value)
            {
                // Begin #76043, #2159
                if ((_tlTranSet.CurTran.TranCode.Value == 300 || _tlTranSet.CurTran.TranCode.Value == 304)
                    && _tlTranSet.CurTran.NetAmt.Value != Convert.ToDecimal(dfAmt.UnFormattedValue)) // #04953 - tabbing out of field without changing amount cleaned up the charges
                {
                    /* charge code was not being recalculated when amount was changed.
                    * also, if the amt is too low to add any charge then the previously
                    * calculated charge stayed there in the data field. */

            _tlTranSet.CurTran.Charges.Clear();
                    _tlTranSet.CurTran.CcAmt.SetValue(null, EventBehavior.None);	// #6615 - _tlTranSet.CurTran.CcAmt.SetValueToNull();
                    dfCCAmt.ObjectToScreen();
                }
                //end #76043, #2159

                // 140782-3 Commented. This is subsequently done again inside CalcDefaultField()
                // MoveMiscScreensToObject(miscTCFields); //#76425

                _tlTranSet.CurTran.XmlDpRedempCalc.SetValueToNull();    //21049

                CalcDefaultField(dfAmt);

            }
        }
        #endregion

        private void dfPenaltyAmt_PhoenixUIValidateEvent(object sender, PEventArgs e)
        {
            // 140782-3 begin

            // if(_tlTranSet.CurTran.TranCode.Value == 179)	//#13912
            //    return;

            if ((_tlTranSet.CurTran.TranCode.Value == 176
                || _tlTranSet.CurTran.TranCode.Value == 179
                || _tlTranSet.CurTran.TranCode.Value == 187)
                && string.IsNullOrEmpty(dfPenaltyAmt.Text.Trim()) == false)
            {
                decimal penaltyAmt = Convert.ToDecimal(dfPenaltyAmt.UnFormattedValue);


                if (penaltyAmt != _tlTranSet.CurTran.PenaltyAmt.Value)
                {
                    #region Update Penalty Calc record          #22488

                    // The purpose of this block is to create a dummy calculator record
                    // to keep track of modifed penalties - these need to appear on DPM/Y131
                    // If the Calculator window is used, the dummy record is replaced
                    // with a proper 'calculated' one.

                    if (_tlTranSet.CurTran.XmlDpRedempCalc.IsNull)
                    {
                        _dpRedempCalc = new DpRedempCalc();

                        // First time in, the BO contains the original default penalty.
                        decimal defaultPenaltyAmt = _tlTranSet.CurTran.PenaltyAmt.Value;

                        decimal withholdingAmt = (_tlTranSet.CurTran.FedWhAmt.IsNull ? 0 : _tlTranSet.CurTran.FedWhAmt.Value)
                            + (_tlTranSet.CurTran.StateWhAmt.IsNull ? 0 : _tlTranSet.CurTran.StateWhAmt.Value)
                            + (_tlTranSet.CurTran.OtherWhAmt.IsNull ? 0 : _tlTranSet.CurTran.OtherWhAmt.Value);

                        decimal intAmt = (_tlTranSet.CurTran.IntAmt.Value < 0) ? 0 : _tlTranSet.CurTran.IntAmt.Value;

                        _dpRedempCalc.SetBasicProperties(
                            _tlTranSet.CurTran.TranAcct.AcctType.Value,
                            _tlTranSet.CurTran.TranAcct.AcctNo.Value,
                            _tlTranSet.CurTran.TranCode.Value,
                            _tlTranSet.CurTran.NetAmt.Value,
                            penaltyAmt,
                            defaultPenaltyAmt,
                            intAmt,
                            withholdingAmt,
                            _tlTranSet.EffectiveDt.Value);
                    }
                    else
                    {
                        BusObjSerializer.LoadFromXml(_dpRedempCalc, _tlTranSet.CurTran.XmlDpRedempCalc.Value);

                        //  Update the modified penalty. This applies to both Dummy and Calculated record.
                        _dpRedempCalc.PenaltyTranAmt.Value = penaltyAmt;
                        if (penaltyAmt != _dpRedempCalc.DefPenaltyAmt.Value)
                        {
                            _dpRedempCalc.ManOvrdPenAmt.Value = penaltyAmt;
                        }
                        else if (penaltyAmt == _dpRedempCalc.DefPenaltyAmt.Value)
                        {
                            _dpRedempCalc.ManOvrdPenAmt.SetValueToNull();
                        }
                    }
                    _dpRedempCalc.ActionType = XmActionType.EnumOnly;
                    _tlTranSet.CurTran.XmlDpRedempCalc.Value = BusObjSerializer.SerializeToXml(_dpRedempCalc, false, false);

                    #endregion

                    CalcDefaultField(dfPenaltyAmt);
                }


                return;
            }
            else            //140782-3 end
            {
                if (dfPenaltyAmt.Text.Trim() == "")		// WI#12051 - check if the text is blank.
                {
                    bPenaltyIsNull = true;				// flag boolean as true, used to abort save (if user presses alt+P to save, form will save regardless of error message)

                    // "Penalty Amount" field must be greater than or equal to $0.00.
                    PMessageBox.Show(1011, MessageType.Error, null);
                }
                else
                {
                    bPenaltyIsNull = false;				// reset bool to false, in case user has returned to this field, edited it, and is pressing alt+P to save.
                }

                MoveAmtScreensToObject();

                if (cmbTranCode.CodeValue != null)	//#80617 - found while working on this enhancement.
                {
                    _tlTranSet.ValidateTlTrancode(cmbTranCode.CodeValue.ToString());
                }

                MoveAmtObjectsToScreen();

                if (bPenaltyIsNull)						// WI#12051
                {
                    dfPenaltyAmt.Focus();				// put focus back on the field to direct the user to fix the problem
                }
            }
        }


        #region cmbTranCode
        private void cmbTranCode_SelectedIndexChanged(object sender, System.EventArgs e)
        {
            //SetQuickTranCodeField( cmbTranCode.CodeValue.ToString() );
        }
        private void cmbTranCode_PhoenixUIEditedEvent(object sender, Phoenix.Windows.Forms.ValueEditedEventArgs e)
        {
            string tlTranCode = null;
            if (cmbTranCode.CodeValue != null)
                tlTranCode = cmbTranCode.CodeValue.ToString();
            SetQuickTranCodeField(tlTranCode, cmbTranCode);
        }

        private void cmbTranCode_Validating(object sender, CancelEventArgs e)
        {
            string tlTranCode = null;
            if (cmbTranCode.CodeValue != null)
                tlTranCode = cmbTranCode.CodeValue.ToString();
            SetQuickTranCodeField(tlTranCode, cmbTranCode);
        }
        #endregion

        #region dfQuickTranCode
        private void dfQuickTranCode_PhoenixUIEditedEvent(object sender, Phoenix.Windows.Forms.ValueEditedEventArgs e)
        {
            return;
        }
        private void dfQuickTranCode_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
        {
            if (dfQuickTranCode.Text.Length > 0 && dfQuickTranCode.Text.Length < 3)
            {
                SetQuickTranCodeField(dfQuickTranCode.Text, null);
            }
            //Begin #76429: If TC154 then do cross ref swap again and update dfAcctNo
            if (_tlTranSet.CurTran.TranAcct.CrossReference.Value == "Y")
            {
                dfAcctNo.UnFormattedValue = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
            }
            //End #76429
        }

        private void dfQuickTranCode_KeyUp(object sender, System.Windows.Forms.KeyEventArgs e)
        {
            if (dfQuickTranCode.Text.Length == 3)
            {
                SetQuickTranCodeField(dfQuickTranCode.Text, null);
            }
        }
        #endregion

        #region cmbRefAcctType
        private void cmbRefAcctType_PhoenixUIEditedEvent(object sender, Phoenix.Windows.Forms.ValueEditedEventArgs e)
        {
            SetAcctNoField(null, dfRefAcctNo, cmbRefAcctType, _tlTranSet.CurTran.RefAcct);
            SetMask(cmbRefAcctType, dfRefAcctNo);
        }

        private void cmbRefAcctType_Validating(object sender, CancelEventArgs e)
        {
            if (AcctIsModified(dfRefAcctNo, cmbRefAcctType, _tlTranSet.CurTran.RefAcct))
            {
                SetAcctNoField(null, dfRefAcctNo, cmbRefAcctType, _tlTranSet.CurTran.RefAcct);
                SetMask(cmbRefAcctType, dfRefAcctNo);
            }
        }
        #endregion

        #region dfRefAcctNo
        private void dfRefAcctNo_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
        {
            if (AcctIsModified(dfRefAcctNo, cmbRefAcctType, _tlTranSet.CurTran.RefAcct))
            {
                SetAcctNoField(dfRefAcctNo.Text, dfRefAcctNo, cmbRefAcctType, _tlTranSet.CurTran.RefAcct);
            }
        }
        #endregion

        #region cmbTfrAcctType
        //8837 Use cmbTfrAcctType_Validating
        //private void cmbTfrAcctType_PhoenixUIEditedEvent(object sender, Phoenix.Windows.Forms.ValueEditedEventArgs e)
        //{
        //    if (AcctIsModified(dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct))
        //    {
        //        SetAcctNoField(null, dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct);
        //        //Begin #76429: Remove the mask
        //        //SetMask( cmbTfrAcctType , dfTfrAcctNo );
        //        ResetMask(cmbTfrAcctType, dfTfrAcctNo);
        //        //End #76429
        //    }
        //}

        private void cmbTfrAcctType_Validating(object sender, CancelEventArgs e)
        {
            //140793,26537
            if ((cmbTfrAcctType.CodeValue == null ? "" : cmbTfrAcctType.CodeValue.ToString()) == "GL")
            {
                //28160
                OffsetNickNameList = _tlTranSet.TellerVars.OffsetNickNameList;
                this.dfTfrAcctNo.AutoCompleteCustomSource = OffsetNickNameList;
            }
            else
            {
                this.dfTfrAcctNo.AutoCompleteCustomSource = null;
            }

			// 9299 - Move these up here ...
            string applType = "", depLoan = "", fmt = "";  //8806
            GetAcctTypeDetails(cmbTfrAcctType, ref applType, ref depLoan, ref fmt);//8806

            if (AcctIsModified(dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct))
            {
                SetAcctNoField(null, dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct);


                //Begin #76429: Remove the mask
                //SetMask( cmbTfrAcctType , dfTfrAcctNo );
                ResetMask(cmbTfrAcctType, dfTfrAcctNo);
                //End #76429
            }

            PopulateOnUsCombo(depLoan, cmbTfrAcctType.Text, applType); // #9299 - Move this down here //8806 #10272
       }
        #endregion

        #region dfTfrAcctNo
        private void dfTfrAcctNo_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
        {
            //140793,26537
            if (dfTfrAcctNo.Text != "" && (cmbTfrAcctType.Value != null && cmbTfrAcctType.Value.ToString() == "GL"))
            {
                Regex rgx = new Regex(@"[a-zA-Z]");
                if (rgx.IsMatch(dfTfrAcctNo.Text) ? true : false)
                {
                    PString listName = new PString("listName");
                    listName.Value = "OffsetNickName";
                    PInt emplId = new PInt("emplId");
                    emplId.Value = BusGlobalVars.EmployeeId;
                    PString offsetValue = new PString("offsetValue");
                    offsetValue.Value = dfTfrAcctNo.Text;
                    GbHelper gbHelper = new GbHelper();
                    string selectedOffsetValue = gbHelper.GetAutoCompleteSelectedValue(listName, emplId, offsetValue);
                    if (selectedOffsetValue != null && selectedOffsetValue != "")
                    {
                        dfTfrAcctNo.Value = selectedOffsetValue;
                    }
                }
            }

            // Begin #74015
            bool fireSignature = false;
            _tlTranSet.IsRegDOnUsTfrAcct = false;  //#WI40789  Determine if TfrAcctNo is RegD
			if (AcctIsModified(dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct))
            {
                if (!SetAcctNoField(dfTfrAcctNo.Text, dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct))
                {
                    e.Cancel = false;    // 4695, do not change.
                    EnableDisableControls("ControlGotFocus");    // WI#16236 - Force Refresh Restrictions button
                    return;
                }
                //Begin #76429:
                //SetMask(cmbTfrAcctType, dfTfrAcctNo); //#6917
                if (_tlTranSet.CurTran.TfrAcct.CrossReference.Value == "Y")
                {
                    dfTfrAcctNo.UnFormattedValue = _tlTranSet.CurTran.TfrAcct.AcctNo.Value;
                }
                //End #76429
                if (cmbTfrAcctType.Text.Trim() != string.Empty && this.dfTfrAcctNo.Text.Trim() != string.Empty)
                {
                    fireSignature = true;

                    //Begin #12327: check app status and deploan
                    if (_tlTranSet.TellerVars.IsAppOnline)
                    {
                        string applType = "", depLoan = "", fmt = "";
                        GetAcctTypeDetails(cmbTfrAcctType, ref applType, ref depLoan, ref fmt);

                        if (depLoan == GlobalVars.Instance.ML.DP)
                        {
                            //Begin #80621
                            if (Phoenix.FrameWork.CDS.DataService.Instance.XmDbStatus != XmDbStatus.Day)
                            {
                                _dpDisplay = new DpDisplay();
                                _dpDisplay.AcctType.Value = cmbTfrAcctType.Text;
                                _dpDisplay.AcctNo.Value = dfTfrAcctNo.Text;
                                _dpDisplay.SelectAllFields = true;
                                _dpDisplay.ActionType = XmActionType.Select;
                                if (!PopulateDepositObjUsingAcctDetails(_dpDisplay, true))   // #19415 - if test
                                    CoreService.DataService.ProcessRequest(_dpDisplay);

                                if (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")
                                {
                                    _bRegDOnUsAcct = true;
                                }
                                else
                                {
                                    _bRegDOnUsAcct = false;
                                }
                            }
                            else
                            {
                                _dpAcct = new DpAcct();
                                _dpAcct.AcctType.Value = cmbTfrAcctType.Text;
                                _dpAcct.AcctNo.Value = dfTfrAcctNo.Text;
                                _dpAcct.SelectAllFields = true;
                                _dpAcct.ActionType = XmActionType.Select;
                                if (!PopulateDepositObjUsingAcctDetails(_dpAcct, true))   // #19415 - if test
                                    CoreService.DataService.ProcessRequest(_dpAcct);

                                if (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")
                                {
                                    _bRegDOnUsAcct = true;
                                }
                                else
                                {
                                    _bRegDOnUsAcct = false;
                                }
                            }

                            _tlTranSet.IsRegDOnUsTfrAcct = _bRegDOnUsAcct;  //#WI40789  Determine if TfrAcctNo is RegD

                            this.cmbOnUsTc.Items.Clear();
                            PopulateOnUsCombo(_tlTranSet.CurTran.TfrAcct.DepLoan.StringValue, cmbTfrAcctType.Text, applType);
                        }
                        //End #80621
                    }
                    //End #12327
                }
				// #79370
				//8806PopulateOnUsCombo(_tlTranSet.CurTran.TfrAcct.DepLoan.Value, _tlTranSet.CurTran.TfrAcct.AcctType.Value);
            }

            if (fireSignature)
            {
                string depLoan = string.Empty;

                if (!_tlTranSet.CurTran.TranAcct.DepLoan.IsNull)
                    depLoan = _tlTranSet.CurTran.TfrAcct.DepLoan.StringValue;

                if (_tlTranSet.AdGbRsm.ShowOnUsSigCard.Value == GlobalVars.Instance.ML.Y
                        && depLoan != GlobalVars.Instance.ML.GL
                        && depLoan != GlobalVars.Instance.ML.RM
                        && _tlTranSet.TellerVars.IsAppOnline)
                    CallOtherForms("OnUsSigners");

                fireSignature = false;
            }
            //End #74015
        }

        //140793
        private void dfTfrAcctNo_KeyUp(object sender, System.Windows.Forms.KeyEventArgs e)
        {
            if ((cmbTfrAcctType.CodeValue == null ? "" : cmbTfrAcctType.CodeValue.ToString()) != "GL")
            {
                this.dfTfrAcctNo.IsAutoCompleteOn = false;      //26537
                return;
            }
            if (dfTfrAcctNo.Text.Length == 1)
            {
                Regex rgx = new Regex(@"[a-zA-Z]");
                if (rgx.IsMatch(dfTfrAcctNo.Text) ? true : false)
                {
                    this.dfTfrAcctNo.IsAutoCompleteOn = true;       //26537
                    this.dfTfrAcctNo.PhoenixUIControl.InputMask = null;
                }
                else
                {
                    this.dfTfrAcctNo.IsAutoCompleteOn = false;      //26537
                    //this.dfOffsetAcctNo.AutoCompleteMode = System.Windows.Forms.AutoCompleteMode.None;
                    //this.dfOffsetAcctNo.AutoCompleteCustomSource = null;
                    this.dfTfrAcctNo.PhoenixUIControl.InputMask = _tlTranSet.TellerVars.XpControl.GlAcctNoFormat.Value;  //Phoenix.Shared.Variables.ApplicationVars.Instance.GLAcctFormat;
                }

            }
            else if (dfTfrAcctNo.Text.Length == 0)
            {
                this.dfTfrAcctNo.PhoenixUIControl.InputMask = null;
            }
        }
        //140793, 26537
        private void dfAcctNo_KeyUp(object sender, System.Windows.Forms.KeyEventArgs e)
        {
            if ((cmbAcctType.CodeValue == null ? "" : cmbAcctType.CodeValue.ToString()) != "GL")
            {
                this.dfAcctNo.IsAutoCompleteOn = false;
                //this.dfAcctNo.AutoCompleteCustomSource = null;
                return;
            }
            if (dfAcctNo.Text.Length == 1)
            {
                Regex rgx = new Regex(@"[a-zA-Z]");
                if (rgx.IsMatch(dfAcctNo.Text) ? true : false)
                {
                    this.dfAcctNo.IsAutoCompleteOn = true;
                    //this.dfAcctNo.AutoCompleteCustomSource = OffsetNickNameList;
                    this.dfAcctNo.PhoenixUIControl.InputMask = null;
                }
                else
                {
                    this.dfAcctNo.IsAutoCompleteOn = false;
                    //this.dfOffsetAcctNo.AutoCompleteMode = System.Windows.Forms.AutoCompleteMode.None;
                    //this.dfOffsetAcctNo.AutoCompleteCustomSource = null;
                    this.dfAcctNo.PhoenixUIControl.InputMask = _tlTranSet.TellerVars.XpControl.GlAcctNoFormat.Value;  //Phoenix.Shared.Variables.ApplicationVars.Instance.GLAcctFormat;
                }

            }
            else if (dfAcctNo.Text.Length == 0)
            {
                this.dfAcctNo.PhoenixUIControl.InputMask = null;
            }
        }
        private void dfTfrAcctNo_LostFocus(object sender, System.EventArgs e)
        {
            EnableDisableControls("TfrAcctNoLostFocus");
        }

        private void dfTfrAcctNo_GotFocus(object sender, System.EventArgs e)
        {
            EnableDisableControls("TfrAcctNoGotFocus");
        }
        #endregion

        #region pbSelectTran
        private void pbSelectTran_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
			panelAvailBal.Visible = false;	// WI#17285
            curTranIndex = -1;
            SelectTran(-1);
            this.dfAcctNickname.UnFormattedValue = colAcctNickname.Text;    //#76041
        }
        #endregion

        #region pbRemoveTran
        private void pbRemoveTran_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            bool isCurTran = false;
            int tranIndex = Convert.ToInt32(colTranIndex.UnFormattedValue);

            if (DialogResult.No == PMessageBox.Show(314686, MessageType.Question, MessageBoxButtons.YesNo, String.Empty))
                return;

            _tlTranSet.RemoveTransaction(tranIndex, ref isCurTran);
            //check if the current transaction is same one
            if (isCurTran)
            {
                frmTlTranCode_PInitCompleteEvent();
            }
            enableAddNext = _tlTranSet.AddNextAllowed();
            PopulateTransetTable();
            SetTotalDebitsAndCredits();
        }
        #endregion


        //Begin 89989
        public int GetQuickTranAccts()
        {
            int TranAcctsCnt = 0;

            foreach (AcctInfo accountInformation in _tlTranSet.TellerVars.LastAccts)
            {
                if (accountInformation.TabTranAcct == "Quick")
                {
                    TranAcctsCnt++;

                    if (TranAcctsCnt == 1)
                    {
                        quickAcctInfo = accountInformation;
                    }
                }
            }
            return TranAcctsCnt;
        }
        //End 89989

        #region pbLastAcct
        private void pbLastAcct_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            bool tfrField = (focusAcctField == cmbTfrAcctType);
            bool isOk = false; //#180274
            int QuickTranAccts = 0; //89989

            if (!CheckForPendingValidation(pbLastAcct.ImageButton))
                return;

            Phoenix.Shared.Variables.AcctInfo acctInfo = new Phoenix.Shared.Variables.AcctInfo();

            if (_tlTranSet.TellerVars.LastAccts.Count == 1)
            {
                acctInfo = _tlTranSet.TellerVars.LastAccts[0] as Phoenix.Shared.Variables.AcctInfo;
            }
            else
            {
                //Begin 89989
                if (picTabs.SelectedTab == tabEasyCapture)
                {
                    // Check if we only have one quick transaction account before calling _dlgLastAccts
                    QuickTranAccts = GetQuickTranAccts();
                }

                //No need to call _dlgLastAccts
                if (QuickTranAccts == 1)
                {
                    acctInfo = quickAcctInfo;
                }
                else
                {
                dlgLastAccts _dlgLastAccts = new dlgLastAccts();
                    string FocusedTab = (picTabs.SelectedTab == tabEasyCapture ? "Quick" : "Input");  //89989
                    _dlgLastAccts.InitParameters(acctInfo, FocusedTab);                               //89989
                _dlgLastAccts.ShowDialog(this);
            }
                //End 89989
            }

            //Begin 89989: Pass the selected account details to the Quick tab window, populate the grid and focus on the account
            if (picTabs.SelectedTab == tabEasyCapture)
            {
                if (acctInfo.AcctNo != null && acctInfo.AcctType != null)
                {
                    pbCashIn.Enabled = pbCashIn.Visible = true; //Bug #93430
                    pbItemCapture.Enabled = true;
                    _quickTranWindow.SetRMSInformation(acctInfo.RimNo, acctInfo.AcctType.Trim() + " - " + acctInfo.AcctNo.Trim());
                }

                return;
            }
            //End 89989


            if (acctInfo.AcctNo != null || acctInfo.AcctType != null)
            {
                //Begin #76458

                if (tfrField)
                {
                    isOk = SetAcctFields(acctInfo.AcctType, acctInfo.RealAcctNo, dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct, dfTfrCheckNo);
                }
                else
                {
                    isOk = SetAcctFields(acctInfo.AcctType, acctInfo.RealAcctNo, dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct, dfQuickTranCode);

                    if (!isOk)          //#180274
                    {
                        // If SetAcctFields is Cancelled some functions stop working because 
                        // CheckForPendingValidation() thinks there is an invalid account.
                        // But if we got this far, the account was valid, so clear the flags. 
                        invalidAcctNo = null;
                        vldnFailedCntrl = null; 
                        return;
                    }
                }

                //End #76458



                //Begin #5002

                if (acctInfo.RimNo == 0)                // #8107
                {
                    acctInfo.RimNo = searchRimNo;
                }
                else if (searchRimNo > 0)               //#180274.34747 
                {
                    // Select Secondary changed the way Last Acct window works. 
                    // There is a concept of the "Owner Executing Transaction".
                    // Last Acct previously returned the Primary Rim, but
                    // it can be any related Rim now. acctDetails is not 
                    // scoped here so need to use global variable searchRimNo #34747

                    acctInfo.RimNo = searchRimNo;
                }

                _holdRimNo = acctInfo.RimNo;

                #region Set Title Bar Name #8497

                #region old code
                //TlAcctDetails actd = new TlAcctDetails();
                //actd.AcctNo.Value = acctInfo.RimNo.ToString();
                //actd.RimNo.Value = acctInfo.RimNo;
                //actd.ApplType.Value = GlobalVars.Instance.ML.RIM;
                //actd.DepLoan.Value = GlobalVars.Instance.ML.RM;
                //actd.AcctType.Value = GlobalVars.Instance.ML.RIM;
                //try
                //{
                //    using (new WaitCursor())
                //    {
                //        actd.GetAcctDetails();
                //    }
                //}
                //catch (PhoenixException pe)
                //{
                //    PMessageBox.Show(pe, MessageBoxButtons.OK);
                //}
                //_tlTranSet.CurTran.TranAcct.RimFirstName.Value = actd.RimFirstName.Value;
                //_tlTranSet.CurTran.TranAcct.RimLastName.Value = actd.RimLastName.Value;
                //_tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = actd.RimMiddleInitial.Value;
                //setTitleBarName();
                #endregion

                setTitleBarName(acctInfo.RimNo, true); //16278 changed false to  true

                #endregion

                //End #5002
            }

            //Begin #76041
            if (_tlTranSet.TellerVars.IsAppOnline)
            {
                if (acctInfo.AcctNickname != null)
                {
                    dfAcctNickname.UnFormattedValue = acctInfo.AcctNickname;
                    _tlTranSet.CurTran.TranAcct.AcctNickname.Value = acctInfo.AcctNickname;
                }
            }
            //End #76041

            if (!_tlTranSet.TellerVars.AdTlCls.TlTranCode.IsNull && !_tlTranSet.CurTran.TlTranCode.IsNull)
            {
                if (!_tlTranSet.CurTran.TranAcct.DepLoan.IsNull && _tlTranSet.ValidateDefaultTc(_tlTranSet.CurTran.TranAcct.DepLoan.Value, _tlTranSet.TellerVars.AdTlCls.TlTranCode.Value))
                {
                    Control field = SetTabOrder("TranCodeSelect");
                    if (field != null && !processingSelectTran)
                        field.Focus();
                }
            }
        }
        #endregion

        #region pbClearAll
        private void pbClearAll_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {

            // Begin #140895 - Bulk Mode
            if (_tlCaptureBulkModePosting)
            {
                this.Close();
                return;
            }
            // End #140895 - Bulk Mode

            //Are you sure you wish to clear all data entered in the window?
            if (DialogResult.No == PMessageBox.Show(360166, MessageType.Question, MessageBoxButtons.YesNo, String.Empty))
                return;

            //#41417 Add HandleCancelAVTCTransaction to ClearAll
            ClearAll(); //#41417
            //The rest of to code was moved into the ClearAll method
            cmbAcctType.Focus(); //#41417 Want to focus here since we are on the input tab.
            //Begin Task #88995
            if (picTabs.SelectedIndex == (int)TAB.QuickTran)
            {
                QuickTranReverseDeviceDeposit();    //#89998
                QuickAccountSelectedRow = null; //Bug #93073
                _quickTranWindow.InitializeTranSet();
                //pbItemCapture.Enabled = false; //Bug #92023
                ResetFlagsAndInitializeTranSet("QuickTranClearAllClicked");  //#122359  //#122532
            }
            else
            {
                if (tabEasyCapture.IsDisabled)  //#122798
                {
                    tabEasyCapture.IsDisabled = (_tlTranSet.TellerVars.AdTlControl.EnableQuickTranTab.Value != GlobalVars.Instance.ML.Y || _tlTranSet.Transactions.Count > 0
                        || _isOvRunning);
                }
            }
            //End Task #88995
        }
        #endregion

        #region pbDisplay
        private void pbDisplay_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            if (!CheckForPendingValidation(pbDisplay.ImageButton))
                return;
            CallOtherForms("DisplayClick");
        }
        #endregion

        #region pbHistory
        private void pbHistory_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            if (!CheckForPendingValidation(pbHistory.ImageButton))
                return;
            //71470 - History object has many holes, I thought it is better to control here
            if (Phoenix.FrameWork.CDS.DataService.Instance.PrimaryDbAvailable)
            {
                CallOtherForms("HistoryClick");
            }
            else
            {
                //300084 -
                PMessageBox.Show(this, 300084, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
            }
        }
        #endregion

        #region pbRestrictions
        private void pbRestrictions_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            if (!CheckForPendingValidation(pbRestrictions.ImageButton))
                return;
            CallOtherForms("RestrictionsClick");
        }
        #endregion

        #region pbSearch
        private void pbSearch_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            if (frmTBarSearch != null)
            {
               // if (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabSearchResults) //73938
                if(!frmTBarSearch.IsGridFocused("grdCustLookup"))//73938
                {
                    frmTBarSearch.pbSearch_Click(sender, e);
                }

                EnableDisableControls("SearchClick");
                ClearAll();     //#41417
                if ((frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabSearchResults && frmTBarSearch.grdCustomerList.Count == 1) || (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabRecentCustLookup && frmTBarSearch.grdCustLookup.Count > 0 && pbSelectSearch.Enabled)) //73938 //92056. Added check if Select is enabled then only fire the click event of Select on Enter.
                {
                    pbSelectSearch_Click(sender, e);
                }
            }
        }
        #endregion

        #region pbSelectSearch
        private void pbSelectSearch_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
           short rimRestrictLevel = 0;
            bool recordFailedAccess = false;

            if (frmTBarSearch != null)
            {
                if ((frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabSearchResults && frmTBarSearch.grdCustomerList.Count == 0)
                    || (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabRecentCustLookup && frmTBarSearch.grdCustLookup.Count == 0)) //60686
                {
                    frmTBarSearch.DefaultAction = pbSearch;
                    return;
                }
                /* 60686. added code in condition. If Recent Lookup tab is seletc then set rimNo from recent lookup grid*/
                if (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabSearchResults)
                {
                    showDisplayWindow = true;//#75074
                    searchRimNo = Convert.ToInt32(frmTBarSearch.colRimNo.UnFormattedValue);

                    if (frmTBarSearch.rbAccount.Checked)
                    {
                        searchAcctType = frmTBarSearch.cmbAcctType.Text;
                        searchAcctNo = frmTBarSearch.dfAcctNo.Text;
                        this.Workspace.Variables["SearchAccountStatus"] = frmTBarSearch.colAcctStatus.UnFormattedValue == null ? string.Empty : Convert.ToString(frmTBarSearch.colAcctStatus.UnFormattedValue).Trim(); //77049. copied code from old CustMgt
                    }
                    else if (frmTBarSearch.rbAcctNoOnly.Checked)                /*27692 added else if*/
                    {
                        searchAcctNo = frmTBarSearch.colAcctNo.Text;
                        searchAcctType = frmTBarSearch.colAcctType.Text;
                        this.Workspace.Variables["SearchAccountStatus"] = frmTBarSearch.colStatus.UnFormattedValue == null ? string.Empty : Convert.ToString(frmTBarSearch.colStatus.UnFormattedValue).Trim(); //77049. copied code from old CustMgt
                        forceFetchRim = true;
                    }
                    else
                    {
                        searchAcctType = null;
                        searchAcctNo = null;
                    }
                }
                //Begin 60686
                else if (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabRecentCustLookup && !frmTBarSearch.IsGridFocused("grdCustomerList")) //73938
                {
                    searchRimNo = Convert.ToInt32(frmTBarSearch.colLookUpRimNo.UnFormattedValue);
                }
                //End 60686
                else
                {
                    searchAcctType = null;
                    searchAcctNo = null;
                }

				//Begin #9539
                if (frmTBarSearch.cbNonCust.Checked && !frmTBarSearch.IsGridFocused("grdCustLookup") && frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabSearchResults)//73938 //92056. Searching  the non Customer.
                {
					this.Workspace.Variables["NonCust"] = "Y";
					this.Workspace.Variables["NonCustRimNo"] = searchRimNo;
					PopulateNonCustName(searchRimNo);
					CallParent("NonCust");
					//cmbTranCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Default);
					//dfQuickTranCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Default);
					CheckTlJournal();
					return;
				}
                //92056. Selecting the Non Customer From recent Lookup table . in this case non Cust checkBox can be unchecked.
                else if (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabRecentCustLookup && frmTBarSearch.colLookUpNonCust != null &&
                    Convert.ToString(frmTBarSearch.colLookUpNonCust.UnFormattedValue).Trim() == Phoenix.FrameWork.Shared.Variables.GlobalVars.Instance.ML.Y
                    )//73938
                {
                    searchRimNo = Convert.ToInt32(frmTBarSearch.colLookUpRimNo.UnFormattedValue);
                    this.Workspace.Variables["NonCust"] = "Y";
                    this.Workspace.Variables["NonCustRimNo"] = searchRimNo;
                    PopulateNonCustName(searchRimNo);
                    CallParent("NonCust");
                    //cmbTranCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Default);
                    //dfQuickTranCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Default);
                    CheckTlJournal();
                    return;
                }
                //End 92056

				//Begin 2010 #14185; 2011 #14186
				else
				{
					this.lblNonCustomer.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
					this.Workspace.Variables["NonCust"] = null;
					this.Workspace.Variables["NonCustRimNo"] = null;
				}
				//End 2010 #14185; 2011 #14186
				//End #9539
                //60686. Added code in codition of selected tab
                if (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabSearchResults)
                {
                rimRestrictLevel = Convert.ToInt16(frmTBarSearch.colRestrictId.UnFormattedValue);
                }
                //Begin 60686
                else
                {
                    rimRestrictLevel = Convert.ToInt16(frmTBarSearch.colLookUpRestrictId.UnFormattedValue);
                }
                //End 60686

                // Begin WI#16236 Need To Handle Transfer Acct So We Dont Mess Up Tran Acct Security
                //_tlTranSet.VerifyEmplAccess(searchRimNo, rimRestrictLevel, _tlTranSet.TellerVars.EmplRestrictLevel,
                //    ref recordFailedAccess, ref acctHasPostAccessOnly, ref acctHasViewAcesssOnly);
                if (GlobalVars.UserType == "Teller") //WI#82863. This restriction message is teller specific functionality. Added condition of UserType "Teller" 
                {
                    if (this.focusAcctField.Name == "cmbTfrAcctType")
                    {
                        _tlTranSet.VerifyEmplAccess(searchRimNo, rimRestrictLevel, _tlTranSet.TellerVars.EmplRestrictLevel,
                            ref recordFailedAccess, ref tfracctHasPostAccessOnly, ref tfracctHasViewAcesssOnly);
                    }
                    else
                    {
                        _tlTranSet.VerifyEmplAccess(searchRimNo, rimRestrictLevel, _tlTranSet.TellerVars.EmplRestrictLevel,
                            ref recordFailedAccess, ref acctHasPostAccessOnly, ref acctHasViewAcesssOnly);
                    }
                }
                else
                {
                    //begin WI#82863. Copied this whole code from Existing CustMgt Search window.
                    if (!(!CoreService.UIAccessProvider.IsSecurityEnabled || rimRestrictLevel >= _tlTranSet.TellerVars.EmplRestrictLevel))
                    {

                        bool bEditAccess = false;
                        bool bPostAccess = false;
                        bool bRimAccess = Phoenix.Windows.Client.Helper.GetRimAccess(searchRimNo, ref bEditAccess, ref bPostAccess);
                        // RimEditAccess = bEditAccess;
                        // RimPostAccess = bPostAccess;

                        if (!bRimAccess)
                        {
                            //CTD:Call IntMLMessage( 983, MB_Warning, 0, gsaNull )
                            //#983 : Your restriction level does not permit you to view this RIM.
                            PMessageBox.Show(983, MessageType.Warning, MessageBoxButtons.OK, MessageBoxDefaultButton.Button1, null);

                            RecordFailedAccess(searchRimNo);

                            //CTD:Return FALSE
                            return;

                        }

                        /*Begin Task #43698 */
                        if (!bEditAccess && frmTBarSearch.cbDirectWindowAccess.Checked)
                        {
                            //Begin #84223
                            //string message = (!bEditAccess ? "Edit" : string.Empty);
                            //message += (!bEditAccess && !bPostAccess ? " and " : string.Empty);//  Commented the above code and removed !bEditAccess since its already checked in if condition and has no scope inside.(Coverity Fix- Dead code)
                            string message = "Edit";
                            message += (!bPostAccess ? " and " : string.Empty);
                            //End #84223
                            message += (!bPostAccess ? "Post" : string.Empty);
                            // Your security access do not permit you to %1! this account.
                            PMessageBox.Show(15422, MessageType.Error, MessageBoxButtons.OK, message);
                            RecordFailedAccess(searchRimNo);
                            return;

                        }
                        if (!LocHaveAccessToSummary(bEditAccess, bPostAccess, searchRimNo))
                        {
                            //#9014 : Your restriction level does not permit you to view this RIM.
                            PMessageBox.Show(9014, MessageType.Warning, MessageBoxButtons.OK, MessageBoxDefaultButton.Button1, null);

                            RecordFailedAccess(searchRimNo);

                            return;     //WI #32895 - Stop the navigaation to Customer Summary
                        }
                    }
                }
                // End WI#82863.
                if (recordFailedAccess)
                {
				  //WI#11021
				  this.Name3.IsDisabled = true;
				  //end WI#11021
				  RecordFailedAccess(searchRimNo);
                  isBlocked = true;     // WI#16237 - This was missing from US2011 and causing issues with Employee access fix
		        }
		        //WI#11021
		        else if (!recordFailedAccess)
                    isBlocked = false;

                if (GlobalVars.UserType == "Teller" && !ProcessResponses(null)) //WI#82863. Since Teller Restriction is processing only for teller user we should invoke this msg too only for teller User
                    return;

                // Begin WI#16236 - Handle When Selecting Tfr Acct
                //if (!ScreenHasAccess("custSummary"))
                //    return;
                if (this.focusAcctField.Name == "cmbTfrAcctType")
                {
                    this.isTfrAcct = true;
                }
                else
                {
                    this.isTfrAcct = false;
                }
                if (!ScreenHasAccess("custSummary", this.isTfrAcct))
                    return;
                // End WI#16236

                // Begin WI#16236 - Need To Handle Transfer Acct So We Dont Mess Up Tran Acct Security
                //if (acctHasPostAccessOnly) //#1437
                //    _tlTranSet.CurTran.TranAcct.bAcctHasPostAccessOnly.Value = true;
                //else
                //    _tlTranSet.CurTran.TranAcct.bAcctHasPostAccessOnly.Value = false;
                if (this.focusAcctField.Name == "cmbTfrAcctType")
                {
                    if (tfracctHasPostAccessOnly) //#1437
                        _tlTranSet.CurTran.TfrAcct.bAcctHasPostAccessOnly.Value = true;
                    else
                        _tlTranSet.CurTran.TfrAcct.bAcctHasPostAccessOnly.Value = false;
                }
                else
                {
                    if (acctHasPostAccessOnly)
                        _tlTranSet.CurTran.TranAcct.bAcctHasPostAccessOnly.Value = true;
                    else
                        _tlTranSet.CurTran.TranAcct.bAcctHasPostAccessOnly.Value = false;
                }
                // End WI#16236

                EnableDisableControls("SelectSearchClick");
                //Original Code
                //picTabs.SelectedIndex = 3;

                #region Select Secondary Owner #180274
                //Task#99220 - copied code from old customer management(frmTBarSearchCustMgmt.cs).
                // select secondary owner only when event happens from custmer search tab and not from recent customer lookup tab.
                if (AppInfo.Instance.IsAppOnline && _adRmControl.SelectSecondOwner.Value == "Y"
                    && (frmTBarSearch.rbAccount.Checked || frmTBarSearch.rbAcctNoOnly.Checked) //#39946
                    && (frmTBarSearch.cbDirectWindowAccess.Checked == false) //Task#99220
                    && (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabSearchResults)) //Task#99220
                {
                    string sOptions = "";
                    sOptions += "AcctType~" + searchAcctType + "~";
                    sOptions += "AcctNo~" + searchAcctNo + "~";
                    sOptions += "RimNo~" + Convert.ToString(searchRimNo) + "~";

                    Phoenix.Client.MsgBox.frmMsgBoxOption msgBox = new Phoenix.Client.MsgBox.frmMsgBoxOption();
                    msgBox.InitParameters(this.ScreenId, "SelectSecondaryOwner", sOptions);
                    msgBox.ShowDialog();
                    System.Windows.Forms.DialogResult result = msgBox.DialogResult;
                    string response = msgBox.DialogOptions;
                    msgBox.Dispose();
                    
                    if (result == System.Windows.Forms.DialogResult.OK)
                    {
                        string[] Response = response.Split("~".ToCharArray(), StringSplitOptions.None);

                        searchRimNo = Convert.ToInt32(Response[1]);

                        if (Response[3] == "Primary")
                        {
                            this.Workspace.Variables["RelationshipType"] = "Primary";
                        }
                        else
                        {
                            this.Workspace.Variables["RelationshipType"] = "All";
                        }

                    }
                    else if (result == System.Windows.Forms.DialogResult.Cancel)
                    {
                        // User Cancelled.
                        return;
                    }
 
                }
                #endregion  //end   #180274
                //Begin 60674.
                isDirectWindowAccess = frmTBarSearch.cbDirectWindowAccess.Checked;
                    if (isDirectWindowAccess)
                    {
                        picTabs.SelectedIndex = 2;
                        if (!frmTBarSearch.LocPerformDirectWindowAccess() && !frmTBarSearch._bCloseWindow)
                        {
                            return;
                        }

                    }
                //End 60674
                //60674. Call RMS Tab if and only if Direct Access window does not shown. _bCloseWindow will be true for Dormant and Escheated account on Direct Access
                if (!isDirectWindowAccess || frmTBarSearch._bCloseWindow)
                {

                //Begin Enh# 69248
                this.Workspace.Variables["RimNo"] = searchRimNo;
                this.UpdateToolBar();
                //End Enh# 69248
                #region #4603
                if (this.focusAcctField.Name == "cmbAcctType") //#5002
                {
                    #region Set Title Bar Name #8497

                    setTitleBarName(searchRimNo, true);

                    //_tlTranSet.CurTran.TranAcct.RimNo.Value = searchRimNo;
                    //TlAcctDetails actd = new TlAcctDetails();
                    //actd.AcctNo.Value = searchRimNo.ToString();
                    //actd.RimNo.Value = searchRimNo;
                    //actd.ApplType.Value = GlobalVars.Instance.ML.RIM;
                    //actd.DepLoan.Value = GlobalVars.Instance.ML.RM;
                    //actd.AcctType.Value = GlobalVars.Instance.ML.RIM;
                    //try
                    //{
                    //    using (new WaitCursor())
                    //    {
                    //        actd.GetAcctDetails();
                    //    }
                    //}
                    //catch (PhoenixException pe)
                    //{
                    //    PMessageBox.Show(pe, MessageBoxButtons.OK);
                    //}
                    //_tlTranSet.CurTran.TranAcct.RimFirstName.Value = actd.RimFirstName.Value;
                    //_tlTranSet.CurTran.TranAcct.RimLastName.Value = actd.RimLastName.Value;
                    //_tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = actd.RimMiddleInitial.Value;
                    //setTitleBarName();
                    #endregion
                }
                else
                {

                    #region Set Title Bar Name #8497

                    setTitleBarName(_tlTranSet.CurTran.TranAcct.RimNo.Value, false);

                    //TlAcctDetails actd = new TlAcctDetails();
                    //actd.AcctNo.Value = _tlTranSet.CurTran.TranAcct.RimNo.Value.ToString();
                    //actd.RimNo.Value = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                    //actd.ApplType.Value = GlobalVars.Instance.ML.RIM;
                    //actd.DepLoan.Value = GlobalVars.Instance.ML.RM;
                    //actd.AcctType.Value = GlobalVars.Instance.ML.RIM;
                    //try
                    //{
                    //    using (new WaitCursor())
                    //    {
                    //        actd.GetAcctDetails();
                    //    }
                    //}
                    //catch (PhoenixException pe)
                    //{
                    //    PMessageBox.Show(pe, MessageBoxButtons.OK);
                    //}
                    //_tlTranSet.CurTran.TranAcct.RimFirstName.Value = actd.RimFirstName.Value;
                    //_tlTranSet.CurTran.TranAcct.RimLastName.Value = actd.RimLastName.Value;
                    //_tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = actd.RimMiddleInitial.Value;
                    //setTitleBarName();

                    #endregion
                }
#endregion
                //Begin Enh# 69248
                CallOtherForms("Messenger");
                //End Enh# 69248
                //71231 - Move Down
                //360821 - Please wait while retriving customer information...
                dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(360821));
                picTabs.SelectedIndex = 3;
                //71231 - Move Down

                //#76430 HOTKEY captures the rim number
                HK_RimNO = this.Workspace.Variables["RimNo"].ToString();
                    } 
                //END #76430

                //Begin 60686. This code is to delete recent looked table on search of a new table.
                if (_acctSearchBusObj == null)
                {
                    _acctSearchBusObj = new CustomerSearch();
            }
                /*this BO method will call psp_cust_lookup SP*/
                if (_acctSearchBusObj.IntRmEmplAccess(searchRimNo, frmTBarSearch.cbNonCust.Checked))
                {
                    frmTBarSearch.grdCustLookup.PopulateTable();
        }
                //End 60686

            }
        }
        //Begin WI#82863
        //Copied Code from Exsiting CustmgtSearch Window
        private bool LocHaveAccessToSummary(bool pbRimEditAccess, bool pbRimPostAccess, decimal pnCurrRimNo)
        {
            bool rbHaveAccessToSummary = false;

            //CTD:If NOT ( pbRimEditAccess ) AND NOT ( pbRimPostAccess)
            if (!(pbRimEditAccess) && !(pbRimPostAccess))
            {
                //CTD:Set rbHaveAccessToSummary = TRUE
                rbHaveAccessToSummary = true;
            }
            //CTD:Else If ( pbRimEditAccess ) AND ( pbRimPostAccess)
            else if ((pbRimEditAccess) && (pbRimPostAccess))
            {
                //CTD:Set rbHaveAccessToSummary = TRUE
                rbHaveAccessToSummary = true;
            }
            //CTD:Else If NOT ( pbRimEditAccess ) AND ( pbRimPostAccess)
            else if (!(pbRimEditAccess) && (pbRimPostAccess))
            {
                //CTD:Set rbHaveAccessToSummary = FALSE
                rbHaveAccessToSummary = false;
            }
            //CTD:Else If ( pbRimEditAccess ) AND NOT ( pbRimPostAccess)
            else if ((pbRimEditAccess) && !(pbRimPostAccess))
            {
                //CTD:Set rbHaveAccessToSummary = TRUE
                rbHaveAccessToSummary = true;
            }

            //CTD:Return rbHaveAccessToSummary
            return rbHaveAccessToSummary;
        }
        //End  WI#82863
        #endregion

        private void pbRelationship_Click(object sender, PActionEventArgs e)
        {
            //#180274

            if ((frmGloAccountListRim != null && (frmGloAccountListRim.colAcctType.UnFormattedValue == null|| frmGloAccountListRim.colAcctNo.UnFormattedValue == null))
                || (picTabs.SelectedIndex == (int)TAB.QuickTran && QuickAccountSelectedRow == null)) //Task#87765
            {
                return;
            }

            //Begin Task#87765
            string acctType = "";
            string acctNo = "";
            string acctId = "";
            string rimNo = "";

            if (picTabs.SelectedIndex == (int)TAB.QuickTran)
            {
                rimNo = QuickAccountSelectedRow.GetIntValue("RimNo").ToString();
                acctNo = QuickAccountSelectedRow.GetStringValue("AcctNo").Trim();
                acctType = QuickAccountSelectedRow.GetStringValue("AcctType").Trim();
                acctId = QuickAccountSelectedRow.GetIntValue("AcctId").ToString();
            }
            else
            //End#87765
            {
                acctType = frmGloAccountListRim.colAcctType.UnFormattedValue.ToString();
                acctNo = frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString();
                acctId = frmGloAccountListRim.colAcctId.UnFormattedValue.ToString();
                rimNo = searchRimNo.ToString();
            }

            string sOptions = "";
            sOptions += "AcctType~" + acctType + "~";
            sOptions += "AcctNo~" + acctNo + "~";
            sOptions += "AcctId~" + acctId + "~";   // AcctId is needed to unique identify SDB accounts. 
            //sOptions += "RimNo~" + rimNo + "~";

            Phoenix.Client.MsgBox.frmMsgBoxOption msgBox = new Phoenix.Client.MsgBox.frmMsgBoxOption();
            msgBox.InitParameters(this.ScreenId, "SelectSecondaryOwner", sOptions);
            msgBox.ShowDialog();
            System.Windows.Forms.DialogResult result = msgBox.DialogResult;
            string response = msgBox.DialogOptions;
            msgBox.Dispose();

            if (result == System.Windows.Forms.DialogResult.OK)
            {
                string[] Response = response.Split("~".ToCharArray(), StringSplitOptions.None);

                searchRimNo = Convert.ToInt32(Response[1]);

                if (Response[3] == "Primary")
                {
                    this.Workspace.Variables["RelationshipType"] = "Primary";
                }
                else
                {
                    this.Workspace.Variables["RelationshipType"] = "All";
                }
            }
            else if (result == System.Windows.Forms.DialogResult.Cancel)
            {
                // User Cancelled.
                return;
            }

            #region Refresh window with new Rim.
            //Begin Task#87765
            if (picTabs.SelectedIndex == (int)TAB.QuickTran)
            {
                _quickTranWindow.SetRMSInformation(searchRimNo, null);
            }
            else
            //End Task#87765
            {
                //Duplicated from pbSelectSearch_Click().
                setTitleBarName(searchRimNo, true);
                CallOtherForms("Messenger");
                picTabs.SelectedIndex = (int)TAB.CustSummary;
                picTabs_SelectedIndexChanged(null, null);
            }

            this.Workspace.Variables["RimNo"] = searchRimNo;
            this.UpdateToolBar();
            HK_RimNO = this.Workspace.Variables["RimNo"].ToString();   // keep in sync

            #endregion

        }
        //begin #194535
        void pbeReceipt_Click(object sender, PActionEventArgs e)
        {
            this.TrackEvents("eReceipts - click", DateTime.Now, DateTime.Now);  //121712
            _eReceiptClick = true;  //#40787
            CallOtherForms("eReceipt");
        }
        //end   #194535
        #region #140782
        private void EnableDisableWithholding()
        {
            decimal whAmt = 0;
            whAmt = (_tlTranSet.CurTran.FedWhAmt.IsNull ? 0 : _tlTranSet.CurTran.FedWhAmt.Value)
                + (_tlTranSet.CurTran.StateWhAmt.IsNull ? 0 : _tlTranSet.CurTran.StateWhAmt.Value)
                + (_tlTranSet.CurTran.OtherWhAmt.IsNull ? 0 : _tlTranSet.CurTran.OtherWhAmt.Value);
            if (whAmt > 0)
            {
                dfWithholdingAmt.SetValue(whAmt);
                lblCalcWh.Visible = true;
                dfWithholdingAmt.Visible = true;
                dfWithholdingAmt.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Disable);
            }
            else
            {
                lblCalcWh.Visible = false;
                dfWithholdingAmt.Visible = false;
                dfWithholdingAmt.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
            }
        }
        #endregion

		#region #9539
		private void EnableDisableNonCust()
		{
			if (frmTBarSearch != null) /*10843*/
			{
                if (frmTBarSearch.grdCustomerList.Items.Count > 0 && frmTBarSearch.cbNonCust.Checked)   //2010 #10783; 2011 #10784
						pbEditNonCust.Enabled = true;
				else
						pbEditNonCust.Enabled = false;
			}
		}

        //Begin 92056.Common method to enable disbale Select and Edit non Customer.
        private void EnableDisableSelectSearch()
        {
            if (frmTBarSearch != null)
            {
                if (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabSearchResults)
                {
                    if (frmTBarSearch.grdCustomerList.Items.Count == 0)
                    {
                        pbSelectSearch.Enabled = false;
                    }
                    else
                    {
                        if (frmTBarSearch.cbNonCust.Checked && (isNonCustAllowed || (GlobalVars.UserType == "AcProc" && _bAcProcFraudEnabled)))
                        {
                            pbEditNonCust.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                        }
                        if (frmTBarSearch.cbNonCust.Checked && Name0.IsDisabled)//Teller Trnsaction Tab
                        {
                            pbSelectSearch.Enabled = false;
                        }
                        else
                        {
                            pbSelectSearch.Enabled = true;
                        }
                    }

                }
                else
                {
                    pbEditNonCust.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                    if ((frmTBarSearch.grdCustLookup.Count == Decimal.MinValue ? 0 : frmTBarSearch.grdCustLookup.Count) > 0)
                    {
                        if (Convert.ToString(frmTBarSearch.colLookUpNonCust.UnFormattedValue) == Phoenix.FrameWork.Shared.Variables.GlobalVars.Instance.ML.N)
                        {
                            pbSelectSearch.SetObjectStatus(VisibilityState.Default, EnableState.Enable);

                            pbEditNonCust.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                        }
                        else
                        {
                            if (Name0.IsDisabled)//Teller Trnsaction Tab
                            {
                                pbSelectSearch.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            }
                            else
                            {
                                pbSelectSearch.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                            }
                            if (isNonCustAllowed || (GlobalVars.UserType == "AcProc" && _bAcProcFraudEnabled))
                            {
                                pbEditNonCust.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                            }
                        }
                    }
                }
            }
        }
        //End 92056

        private string GetNonCustName(int rimNo)    //#140772
        {
            string nonCustName = string.Empty;

            TlNonRmAcct tlNonRmAcct = new TlNonRmAcct();
            tlNonRmAcct.SelectAllFields = false;
            tlNonRmAcct.RimNo.Value = rimNo;
            tlNonRmAcct.FirstName.Selected = true;
            tlNonRmAcct.LastName.Selected = true;
            tlNonRmAcct.CustType.Selected = true;
            tlNonRmAcct.MiddleInitial.Selected = true;
            tlNonRmAcct.ActionType = XmActionType.Select;
            CoreService.DataService.ProcessRequest(tlNonRmAcct);

            if (tlNonRmAcct.CustType.Value == "Personal")
            {
                if (tlNonRmAcct.MiddleInitial.IsNull)
                {
                    nonCustName = tlNonRmAcct.FirstName.Value + " " + tlNonRmAcct.LastName.Value;
                }
                else
                {
                    nonCustName = tlNonRmAcct.FirstName.Value + " " + tlNonRmAcct.MiddleInitial.Value + " " + tlNonRmAcct.LastName.Value;
                }
            }
            else
            {
                nonCustName = tlNonRmAcct.LastName.Value;
                if (!tlNonRmAcct.FirstName.IsNull)
                {
                    nonCustName += ", " + tlNonRmAcct.FirstName.Value;
                }
            }

            return nonCustName;
        }

        private void PopulateNonCustName(int rimNo) //#140772
		{
            //TlNonRmAcct tlNonRmAcct = new TlNonRmAcct();
            //tlNonRmAcct.SelectAllFields = false;
            //tlNonRmAcct.RimNo.Value = rimNo;
            //tlNonRmAcct.FirstName.Selected = true;
            //tlNonRmAcct.LastName.Selected = true;
            //tlNonRmAcct.CustType.Selected = true;
            //tlNonRmAcct.MiddleInitial.Selected = true;
            //tlNonRmAcct.ActionType = XmActionType.Select;
            //CoreService.DataService.ProcessRequest(tlNonRmAcct);

            //if (tlNonRmAcct.CustType.Value == "Personal")
            //{
            //    if (tlNonRmAcct.MiddleInitial.IsNull)
            //    {
            //        this.Workspace.Variables["NonCustName"] = tlNonRmAcct.FirstName.Value + " " + tlNonRmAcct.LastName.Value;
            //    }
            //    else
            //    {
            //        this.Workspace.Variables["NonCustName"] = tlNonRmAcct.FirstName.Value + " " + tlNonRmAcct.MiddleInitial.Value + " " + tlNonRmAcct.LastName.Value;
            //    }
            //}
            //else
            //{
            //    this.Workspace.Variables["NonCustName"] = tlNonRmAcct.LastName.Value;
            //    if (!tlNonRmAcct.FirstName.IsNull)
            //    {
            //        this.Workspace.Variables["NonCustName"] += ", " + tlNonRmAcct.FirstName.Value;
            //    }
            //}
            this.Workspace.Variables["NonCustName"] = GetNonCustName(rimNo);
		}
		void pbEditNonCust_Click(object sender, PActionEventArgs e)
		{
			PInt rimNo = new PInt("RimNo");
            ArrayList saParams = new ArrayList();//77062
            //92056. Consider Recent lookup also. if recent lookup then rim is from different column
            if ((frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabSearchResults && frmTBarSearch.grdCustomerList.SelectedIndicies.Count > 0)
                || (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabRecentCustLookup && frmTBarSearch.grdCustLookup.SelectedIndicies.Count > 0))
            {
				// WI#19204 - change to not depend on column being in set position for UI preferences
				//rimNo.Value = Convert.ToInt32(frmTBarSearch.grdCustomerList.Items[Convert.ToInt32(frmTBarSearch.grdCustomerList.SelectedIndicies[0])].Text);
                if (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabRecentCustLookup)
                {
                    rimNo.Value = Convert.ToInt32(frmTBarSearch.colLookUpRimNo.UnFormattedValue);
                }
                else
                {
                    rimNo.Value = Convert.ToInt32(frmTBarSearch.colRimNo.UnFormattedValue);
                }
                saParams.Add(rimNo.Value);
			}
			//MessageBox.Show(rimNo);
			PfwStandard tempWin = Helper.CreateWindow("phoenix.client.tlnonrmacct", "Phoenix.Client.TlNonRmAcct", "frmTlNonRmAcctEdit");
            //Begin 77062. On The basis of Module pActionSepNonCust.Visible = isNonCustAllowed  this window is getting rimNo in different way. So we are passing the rimNo accordingly to get rid of any exception.
            if (GlobalVars.UserType == "Teller")
            {
                tempWin.InitParameters(rimNo);
            }
            else
            {
                tempWin.InitParameters(saParams.ToArray());
            }
            //End 77062
            tempWin.Workspace = this.Workspace;
			tempWin.Show();
            //Begin 92056. Set RecentCustlookup on Edit.Done in Old CustMgt
            if (_acctSearchBusObj != null && _acctSearchBusObj.IntRmEmplAccess(rimNo.Value, frmTBarSearch.cbNonCust.Checked))
            {
                frmTBarSearch.grdCustLookup.PopulateTable();
            }
            //End 92056
		}
		#endregion
        #region pbSelectAcct
        private void pbSelectAcct_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            //Begin #66693.if Drawer is not selected should give error
            if (TellerVars.Instance.DrawerNo <= 0)
            {
                PMessageBox.Show(15743, MessageType.Error, MessageBoxButtons.OK, String.Empty);
                return;
            }
            else if (TellerVars.Instance.PostingDt != DateTime.MinValue && TellerVars.Instance.PostingDt < GlobalVars.SystemDate)
			{
				PMessageBox.Show(this, 314899, MessageType.Error, MessageBoxButtons.OK, string.Empty);
				return;
			}
            //End #66693
            string acctType = null;
            string acctNo = null;
            bool isAcctModified = false; //#72999
            _fromRelMgmtSummary = true; //#8609

            //			if ( !(focusAcctField == cmbTfrAcctType &&  focusAcctField.Visible) )
            //				focusAcctField = cmbAcctType;

            if (frmGloAccountListRim == null)
                return;
            if (focusAcctField == cmbAcctType || (_holdRimNo == -1 && focusAcctField == cmbTfrAcctType))  //#5002  #5959 - Added cmbTfrAcctType //#17149
                _holdRimNo = searchRimNo;

            //Begin Task#87725
            if (
                 _tlTranSet.TellerVars.AdTlControl.TellerTabDefault.Value == "Q" &&
                 !_isOvRunning &&
                 ((frmGloAccountListRim.colApplType.UnFormattedValue != null && 
                   frmGloAccountListRim.colApplType.UnFormattedValue.ToString().Trim() != "CD" && 
                   frmGloAccountListRim.colApplType.UnFormattedValue.ToString().Trim() != "CMT" &&
                   frmGloAccountListRim.colApplType.UnFormattedValue.ToString().Trim() != "BOX") ||  (sender == pbSelectRIM)) //Bug 104268 Added BOX
               || (QuickAccountSelectedRow != null)) //Bug 109821 
            {
                this.tabEasyCapture.IsDisabled = false;
                picTabs.SelectedIndex = (int)TAB.QuickTran;
                
                if (_quickTranWindow != null) 
                {
                    //pbCashIn.Enabled = pbCashIn.Visible = true; //Bug #93430
                    //pbItemCapture.Enabled = true;
                    if (sender == pbSelectRIM)
                    {
                        _quickTranWindow.SetRMSInformation(searchRimNo, null);
                    }
                    else
                    {
                        _quickTranWindow.SetRMSInformation(searchRimNo, frmGloAccountListRim.colAccount.UnFormattedValue.ToString().Trim());
                    }
                }

                return; 
            }
            //End Task#87725

            if (sender == pbSelectRIM)
            {
                if (focusAcctField == cmbTfrAcctType)
                    return;

                if (acctTypeSrch)
                    acctType = GlobalVars.Instance.ML.RIM;
                else
                    acctType = GlobalVars.Instance.ML.RM;

                //WI#11021 - Added the if condition for the access blocked scenario
                //16278 removed || searchRimNo > 0
                if (!isBlocked)
                    acctNo = searchRimNo.ToString();
                else
                    acctNo = _tlTranSet.CurTran.TranAcct.RimNo.Value.ToString();

                /* acctNo = searchRimNo.ToString();*/
                /*
                    Begin #3567 - pbSelectRIM_Click-pbSelectAcct_Click was called from actual button pbSelectRIM
                    click or pbSearch click. so that i can make a choice to display tab 0 or 3.
                    cant use sender cause pbSelectRIM_Click sender is hardcoded to pbSelectRIM. if i change that
                    i mess up "if ( sender == pbSelectRIM )" check (outer if). e.Param1 has true sender.
                */
                if (e.Param1 == pbSearch)
                    picTabs.SelectedIndex = 3; //#2462
                else
                    picTabs.SelectedIndex = 0; //#3567
                //end#3567
            }
            else
            {
                if (acctTypeSrch)
                    acctType = frmGloAccountListRim.colAcctType.UnFormattedValue.ToString();
                else
                    acctType = frmGloAccountListRim.colApplType.UnFormattedValue.ToString();

                acctNo = frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString();
                //Begin #76458
                if (frmGloAccountListRim.colAcctNoMask.UnFormattedValue == null)
                {
                    if (_tlTranSet != null && _tlTranSet.CurTran != null &&
                        _tlTranSet.CurTran.TranAcct != null && (_tlTranSet.CurTran.TranAcct.TranCode.Value == 520 ||
                        _tlTranSet.CurTran.TranAcct.TranCode.Value == 570))
                        _tlTranSet.TellerVars.DisplayAcctNos.SetMaskedAcctNo(acctType, acctNo,
                            string.Empty);
                }
                else
                {
                    if (frmGloAccountListRim.colAcctNoMask.UnFormattedValue.ToString() !=
                        frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString() &&
                        _tlTranSet != null &&
                        _tlTranSet.CurTran != null &&
                        _tlTranSet.CurTran.TranAcct != null &&
                        (_tlTranSet.CurTran.TranAcct.TranCode.Value == 520 ||
                        _tlTranSet.CurTran.TranAcct.TranCode.Value == 570))
                    {
                        _tlTranSet.TellerVars.DisplayAcctNos.SetMaskedAcctNo(
                                acctType,
                                acctNo,
                                frmGloAccountListRim.colAcctNoMask.UnFormattedValue.ToString());
                    }
                }
                //End #76458

                picTabs.SelectedIndex = 0; //#2462

            }

            //picTabs.SelectedIndex = 0; //#2462 Moved

            //#72999
            isAcctModified = AcctIsModified(dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct);
			isAcctModified = true;    // #4286, #4383 - cannot remove call to AcctIsModified, cause other things are being done there.

            if (focusAcctField == cmbTfrAcctType)
            {
                #region Set Title Bar Name #8497

                int rimz = -1;
                if (_tlTranSet.CurTran.TranAcct.RimNo.IsNull || _tlTranSet.CurTran.TranAcct.RimNo.Value < 0)
                {
                    rimz = _tlTranSet.CurTran.TranAcct.RimNo.PreviousValue;
                }
                //16278 commented this
                //Begin 14630
                /* else if (searchRimNo > 0)
                {
                    rimz = searchRimNo;
                }*/
                //End 14630
                else
                {
                    rimz = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                }

                //16278 added if else conditions
                /*17571 commenting this settitlebarname here and adding is after setacctfields*/
               /* if (!populateGridWithSavedRim)
                    setTitleBarName(rimz, false);
                else
                    setTitleBarName(_holdRimNo, true);*/

                SetAcctFields(acctType, acctNo, dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct, dfTfrCheckNo);
                cmbTfrAcctType_Validating(null, null);  // #9299

				/*17571*/
				if (!populateGridWithSavedRim)
					setTitleBarName(rimz, false);
				else
                  setTitleBarName(_holdRimNo, true);

                //#region #5002
                //TlAcctDetails actd = new TlAcctDetails();

                //if (_tlTranSet.CurTran.TranAcct.RimNo.IsNull || _tlTranSet.CurTran.TranAcct.RimNo.Value < 0)
                //{
                //    actd.AcctNo.Value = _tlTranSet.CurTran.TranAcct.RimNo.PreviousValue.ToString();
                //    actd.RimNo.Value = _tlTranSet.CurTran.TranAcct.RimNo.PreviousValue;
                //}
                //else
                //{
                //    actd.AcctNo.Value = _tlTranSet.CurTran.TranAcct.RimNo.Value.ToString();
                //    actd.RimNo.Value = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                //}

                //actd.ApplType.Value = GlobalVars.Instance.ML.RIM;
                //actd.DepLoan.Value = GlobalVars.Instance.ML.RM;
                //actd.AcctType.Value = GlobalVars.Instance.ML.RIM;
                //try
                //{
                //    using (new WaitCursor())
                //    {
                //        actd.GetAcctDetails();
                //    }
                //}
                //catch (PhoenixException pe)
                //{
                //    PMessageBox.Show(pe, MessageBoxButtons.OK);
                //}
                //_tlTranSet.CurTran.TranAcct.RimFirstName.Value = actd.RimFirstName.Value;
                //_tlTranSet.CurTran.TranAcct.RimLastName.Value = actd.RimLastName.Value;
                //_tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = actd.RimMiddleInitial.Value;
                //setTitleBarName();
                //SetAcctFields(acctType, acctNo, dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct, dfTfrCheckNo);
                //#endregion

                #endregion

            }
            else
            {
               /* _tlTranSet.CurTran.TranAcct.RimNo.Value = searchRimNo;*/
               //WI#11021 - Added the if condition
                if (!isBlocked)
                {
                    _tlTranSet.CurTran.TranAcct.RimNo.Value = searchRimNo;
                }
                else
                {
                    searchRimNo = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                }

                /*17571 commenting this settitlebarname here and adding is after setacctfields*/
                #region old code

                // setTitleBarName(searchRimNo, true); 

                //#region #5002
                //TlAcctDetails actd = new TlAcctDetails();
                //actd.AcctNo.Value = searchRimNo.ToString();
                //actd.RimNo.Value = searchRimNo;
                //actd.ApplType.Value = GlobalVars.Instance.ML.RIM;
                //actd.DepLoan.Value = GlobalVars.Instance.ML.RM;
                //actd.AcctType.Value = GlobalVars.Instance.ML.RIM;
                //try
                //{
                //    using (new WaitCursor())
                //    {
                //        actd.GetAcctDetails();
                //    }
                //}
                //catch (PhoenixException pe)
                //{
                //    PMessageBox.Show(pe, MessageBoxButtons.OK);
                //}
                //_tlTranSet.CurTran.TranAcct.RimFirstName.Value = actd.RimFirstName.Value;
                //_tlTranSet.CurTran.TranAcct.RimLastName.Value = actd.RimLastName.Value;
                //_tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = actd.RimMiddleInitial.Value;

                //setTitleBarName();
                //#endregion

                #endregion

                SetAcctFields(
                        acctType, 
                        acctNo, 
                        dfAcctNo, 
                        cmbAcctType, 
                        _tlTranSet.CurTran.TranAcct, 
                        dfQuickTranCode, 
                        searchRimNo);  //#180274

                
    			setTitleBarName(searchRimNo, true);         // #17571

                CheckFraud();            //#9568
            }
            //#72999

            // Begin #76041
            if (_tlTranSet.TellerVars.IsAppOnline)
            {
                //Begin #2031 - moved the following nickname collection logic under the deploan condition
                if (!_tlTranSet.CurTran.TranAcct.DepLoan.IsNull && (_tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP ||
                    _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.LN || _tlTranSet.CurTran.TranAcct.DepLoan.Value == "EX"))
                {
                    if (_tlTranSet.CurTran.TranAcct.AcctNickname.Value == null)
                    {
                        //if (_tlTranSet.CurTran.TranAcct.NicknameAcctList.Count <= 0)    //#10477
                        _tlTranSet.CurTran.TranAcct.GetAcctNoNicknameDetails();
                        //#3538 begin
                        for (int loop = 0; loop < _tlTranSet.CurTran.TranAcct.NicknameAcctList.Count; loop++)
                        {
                            if (_tlTranSet.CurTran.TranAcct.NicknameAcctList[loop] != null && _tlTranSet.CurTran.TranAcct.AcctNo.Value != null)   // #08656
                                if (_tlTranSet.CurTran.TranAcct.NicknameAcctList[loop].ToString() == _tlTranSet.CurTran.TranAcct.AcctNo.Value.ToString())
                                {
                                    _tlTranSet.CurTran.TranAcct.AcctNickname.Value = _tlTranSet.CurTran.TranAcct.NicknameAcctList[loop + 4].ToString();
                                    loop = _tlTranSet.CurTran.TranAcct.NicknameAcctList.Count;
                                }
                        }
                        //#3538 end
                    }
                }
                //#2031
                //#10477
                //dfAcctNickname.UnFormattedValue = _tlTranSet.CurTran.TranAcct.AcctNickname.Value;
                if (_fromRelMgmtSummary && frmGloAccountListRim != null &&
                                frmGloAccountListRim.colOwnership != null &&
                                frmGloAccountListRim.colOwnership.UnFormattedValue != null &&
                                frmGloAccountListRim.colOwnership.UnFormattedValue.ToString().Trim() == "Primary")
                {
                    dfAcctNickname.UnFormattedValue = _tlTranSet.CurTran.TranAcct.AcctNickname.Value;
                }
                else if (_fromRelMgmtSummary && frmGloAccountListRim != null &&
                                frmGloAccountListRim.colOwnership != null &&
                                frmGloAccountListRim.colOwnership.UnFormattedValue != null &&
                                frmGloAccountListRim.colOwnership.UnFormattedValue.ToString().Trim() != "Primary")
                
                {   //Begin #13182/#13183

                    //Begin #13269
                    //dfAcctNickname.UnFormattedValue = frmGloAccountListRim.colNickname.UnFormattedValue;
                    dfAcctNickname.UnFormattedValue = nickName;
                    //End #13269
                    populateGridWithSavedRim = true; 
                    
                    //End #13182/#13183
                }
               
                //
                _fromRelMgmtSummary = false;    //#10477
            }
            // End #76041

            /* Begin #76010 */
            string depLoan = string.Empty;
            if (!_tlTranSet.CurTran.TranAcct.DepLoan.IsNull)
            {
                depLoan = _tlTranSet.CurTran.TranAcct.DepLoan.StringValue;
            }

            // Begin - #4286, #4383
            if (focusAcctField == cmbTfrAcctType && _tlTranSet.AdGbRsm.ShowOnUsSigCard.Value == GlobalVars.Instance.ML.Y &&
                     depLoan != GlobalVars.Instance.ML.GL && _tlTranSet.TellerVars.IsAppOnline)
            {
                if (picTabs.SelectedIndex == 0 && iconSigner.Enabled)
                {
                    CallOtherForms("OnUsSigners");      //refix #4286, #4383 changed Signers to OnUsSigners to reflect correct on us acct instead of tx acct.
                }
            }
            else if (focusAcctField != cmbTfrAcctType
                    && _tlTranSet.AdGbRsm.ShowSigCard.Value == GlobalVars.Instance.ML.Y
                    && depLoan != GlobalVars.Instance.ML.GL
                    && depLoan != GlobalVars.Instance.ML.RM
                    && _tlTranSet.TellerVars.IsAppOnline)
            {
                /* End #76010 */
                if (isAcctModified && sender != pbSelectRIM)
                {
                    // do signature card stuff
                    if (picTabs.SelectedIndex == 0 && iconSigner.Enabled)
                    {
                        CallOtherForms("Signers");
                    }
                }
            }
            // End - #4286, #4383

            //8497 handled above
            //8497this.setTitleBarName(); // #76048
            //8497this.UpdateView();

            #region #7449
            _dpAcct = new DpAcct(); // #10129
            if (focusAcctField == cmbTfrAcctType)
            {
                _dpAcct.AcctType.Value = _tlTranSet.CurTran.TfrAcctType.Value;
                _dpAcct.AcctNo.Value = dfTfrAcctNo.Text; // #8502
            }
            else
            {
				// WI #11124 - replace "CurTran.AcctType" with "CurTran.TranAcct.AcctType"
                _dpAcct.AcctType.Value = _tlTranSet.CurTran.TranAcct.AcctType.Value;
                _dpAcct.AcctNo.Value = dfAcctNo.Text; // #8502

                // WI#16236 - To Stop Error: 300021:Unable to Identify the key to get the Data, we will make AcctType = "" instead of null
                if (_dpAcct.AcctType.IsNull)
                {
                    _dpAcct.AcctType.Value = string.Empty;
                }
                // End WI#16236
            }

            _dpAcct.SelectAllFields = true;

            _dpAcct.ActionType = XmActionType.Select;

            /* Begin 13677 */
            // CoreService.DataService.ProcessRequest(_dpAcct);

            if (!String.IsNullOrEmpty(_dpAcct.AcctType.Value) &&
                !String.IsNullOrEmpty(_dpAcct.AcctNo.Value))
            {
                if (!PopulateDepositObjUsingAcctDetails(_dpAcct, focusAcctField == cmbTfrAcctType))   // #19415 - if test
                    CoreService.DataService.ProcessRequest(_dpAcct);
            }

            /* End 13677 */

            #endregion

        }
        #endregion

        #region pbSelectRIM
        private void pbSelectRIM_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            pbSelectAcct_Click(pbSelectRIM, e);
        }
        #endregion

        #region pbFees
        private void pbFees_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            CallOtherForms("Charges");
        }
        #endregion

        #region pbItemCapture
        private void pbItemCapture_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {

            //Begin #87743
            if (picTabs.SelectedTab == tabEasyCapture)
            {
                if (_quickTranWindow.TranSet != null && _quickTranWindow.TranSet.ChecksTran != null &&
                        _quickTranWindow.TranSet.ChecksTran.MappedTranIndex > 0)
                {
                    _tlTranSet.SelectTransaction(_quickTranWindow.TranSet.ChecksTran.MappedTranIndex, false);
                }
                else
                {
                    _tlTranSet.CurTran = new TlTransaction();
                    foreach (var item in _quickTranWindow.TranSet.Checks)
                    {
                        _tlTranSet.CurTran.Items.Add(item);
                    }
                }

                CallOtherForms("ItemCapture");
                return;
            }
            //End #87743

            //Begin #79420
            if (!_tlTranSet.IsFirstTran() &&
                (_tlTranSet.TellerHelper.IsDepositTran(_tlTranSet.CurTran.TranCode.Value) ||
                _tlTranSet.TellerHelper.IsLoanTran(_tlTranSet.CurTran.TranCode.Value))
                )
            {
                //13493 - All items must be entered on the first transaction of the Add Next transaction set.
                PMessageBox.Show(13493, MessageType.Warning, MessageBoxButtons.OK, String.Empty);
                return;
            }
            //End #79420
            string focusFieldName = null;
            if (_tlTranSet.CurTran.Items.Count == 0 || _tlTranSet.GetOnUsItem() != null)   //#26116
            {
                MoveAmtScreensToObject();
                MoveMiscScreensToObject(miscTCFields);
                _tlTranSet.MoveOnUsToItems(ref focusFieldName);
                if (!ProcessResponses(null,focusFieldName))
                {
                    GetControlByXmlTag(focusFieldName, true);
                    return;
                }
                MoveAmtObjectsToScreen();
                MoveMiscObjectsToScreen(miscTCFields);
                MoveAcctObjectsToScreen(dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct);
                if (_tlTranSet.CurTran.Items.Count > 0)
                    EnableDisableControls("ItemCaptureClick");
            }
            CallOtherForms("ItemCapture");

        }
        #endregion

        #region pbCashIn
        private void pbCashIn_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            HandleCashInOutDenom("CashInDenom");
        }
        #endregion

        #region pbCashOut
        private void pbCashOut_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            HandleCashInOutDenom("CashOutDenom");
        }
        #endregion

        #region pbUpdatePB
        private void pbUpdatePB_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            int noLines = -1;
            int lastLine = 0;

            _tlTranSet.ValidatePbUpdate(passbookAcctDetails);
            if (!ProcessResponses(null))
                return;
            if (cmbPassbookType.CodeValue == null)
            {
                cmbPassbookType.Focus();
                return;
            }
            if (dfPbLines.UnFormattedValue != null)
                noLines = Convert.ToInt32(dfPbLines.UnFormattedValue);

           /*begin #26748*/
           /* if (!(noLines > 0 )&& noLines < 30))
            {
                dfPbLines.Focus();
                return;
            }*/

            if (noLines <= 0)
			{
			 dfPbLines.Focus();
			 return;
            }
            /*end  #26748*/

            if (twPassbook.Count <= 0)
                return;

            printInfoForm = new PrintInfo();
            for (int i = 0; i < twPassbook.Count; i++)
            {
                twPassbook.ContextRow = i;
                printInfoForm.AddPassbookDetails(Convert.ToDateTime(colEffectiveDt.UnFormattedValue),
                    colWithdrawal.Text == null || colWithdrawal.Text.Trim() == String.Empty ? DbDecimal.Null : Convert.ToDecimal(colWithdrawal.UnFormattedValue),
                    colDeposit.Text == null || colDeposit.Text.Trim() == String.Empty ? DbDecimal.Null : Convert.ToDecimal(colDeposit.UnFormattedValue),
                    Convert.ToDecimal(colPbBalance.UnFormattedValue), null,
                    Convert.ToString(colTCDescription.UnFormattedValue));
            }
            printInfoForm.PbLinesPerPage = noLines;
            printInfoForm.PbLastLine = passbookAcctDetails.PbLastLine.Value;

            formId = Convert.ToInt32(cmbPassbookType.CodeValue);
            canReprint = false;

            CallOtherForms("PrintForm");



            if (dialogResult == DialogResult.OK)
            {
                /* Begin #71242 */
                /*
                lastLine = printInfoForm.PbLastLine + twPassbook.Count;
                while ( lastLine > noLines )
                    lastLine = lastLine - noLines;
                */
                lastLine = printInfoForm.PbLastLine;
                /* End #71242 */
                passbookAcctDetails.PbLastLine.Value = (short)lastLine;

                try
                {
                    dlgInformation.Instance.ShowInfo("Updating Passbook...");
                    CallXMThruCDS("BookTransactions");
                    CallXMThruCDS("UpdatePbLastLine");
                }
                finally
                {
                    dlgInformation.Instance.HideInfo();
                }
                if (_accountHistory.Messages.ErrorCount > 0)
                {
                    if (!ProcessResponses(_accountHistory.Messages))
                        return;
                }
            }
            if (processingPrint)
                ProcessPassbookUpdates();
            else
                SetPassbookFields(true);
        }
        #endregion

        #region pbSkip
        private void pbSkip_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            _tlTranSet.ValidatePbSkip();
            if (!ProcessResponses(null))
                return;
            if (processingPrint)
                ProcessPassbookUpdates();
        }
        #endregion

        #region #80620
        private void pbOnUsDisplayMenu_Click(object sender, EventArgs e)
        {
            this.CallOtherForms("OnUsDisplayClick");
        }

        private void pbOnUsSigMenu_Click(object sender, EventArgs e)
        {
            this.CallOtherForms("OnUsSigners");
        }

        private void pbRestrictionsMenu_Click(object sender, EventArgs e)
        {
            if (!CheckForPendingValidation(pbRestrictions.ImageButton))
            {
                return;
            }
            CallOtherForms("OnUsRestrictionsClick");
        }

        private void pbOnUsAcctRegD_Click(object sender, EventArgs e)
        {   //140780-20052
            CallOtherForms("OnUsAcctRegD");
        }

        private void pbNotesMenu_Click(object sender, EventArgs e)
        {
            int[] notesList = null;
            int notesCount = 0;
            this.Workspace.Variables["IsNotesFromMDI"] = "false";
            if (Phoenix.FrameWork.CDS.DataService.Instance.PrimaryDbAvailable == true)
            {
                notesCount = _tlTranSet.GetOnUsNotesList(ref showNotes, ref notesList);
                SetNotesFlag();
            }
            else
                notesCount = 0;

            AcctAlerts acctAlerts = null;
            // Set alerts for On Us account....
            ((Workspace as PwksWindow).WksExtension as WkspaceExtension).SetAlertAccount(
    _tlTranSet.CurTran.TfrAcct.AcctType.Value, _tlTranSet.CurTran.TfrAcct.AcctNo.Value, _tlTranSet.CurTran.TfrAcct.AcctId.Value, !acctHasPostAccessOnly, acctAlerts);

            UpdateView();
            _isShowOnUsNotes = true;
            Extension.ShowNotes(this);
            _isShowOnUsNotes = false;
        }
        #endregion

        #region #140772
        private void pbInventoryPurchaseReturn_Click(object sender, EventArgs e)
        {
            this.CallOtherForms("InventoryPurchaseReturnClick");
        }

        private void pbInventorySearch_Click(object sender, EventArgs e)
        {
            this.CallOtherForms("InventorySearchClick");
        }
        #endregion #140772

        //Begin #74015
        #region pbOnUsDisplay
        private void pbOnUsDisplay_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            this.CallOtherForms("OnUsDisplayClick");
        }
        #endregion

        #region pbOnUsSig
        private void pbOnUsSig_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            this.CallOtherForms("OnUsSigners");
        }
        #endregion
        //End #74015

        #region #80615
        void pbPrintMailer_Click(object sender, PActionEventArgs e)
        {
            if (picTabs.SelectedTab == tabEasyCapture)  //#101468
            {
                var sourceTran = _quickTranWindow.TranSet.CashInTran;
                if (sourceTran == null)
                    sourceTran = _quickTranWindow.TranSet.CashOutTran;
                if (sourceTran == null)
                    sourceTran = _quickTranWindow.TranSet.ChecksTran;
                if (sourceTran == null)
                    sourceTran = _quickTranWindow.GetCurrentEasyCaptureTran();

                if (sourceTran != null && sourceTran.MappedTranIndex > 0)
                {
                    _tlTranSet.SelectTransaction(sourceTran.MappedTranIndex, false);
                }
                else
                {
                    if (_tlTranSet.CurTran == null)
                        _tlTranSet.CurTran = new TlTransaction();
                }
            }

            Helper.PrintMailer(searchRimNo, _tlTranSet);
            #region #12629
            if (picTabs.SelectedIndex == 0)
            {
                if (ActionSave.Visible == true && ActionSave.Enabled == true)
                    ActionSave.ImageButton.Focus();
            }
            else if (picTabs.SelectedIndex == 3)
            {
                if (pbSelectAcct.Visible == true && pbSelectAcct.Enabled == true)
                    pbSelectAcct.ImageButton.Focus();
            }
            #endregion
        }
        #endregion

        #region pbGetGLAcct
        private void pbGetGLAcct_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            gLSearchAcctNo = null;
            CallOtherForms("GetGLAcct");
        }
        #endregion

        #region cbRetirement
        private void cbRetirement_CheckedChanged(object sender, System.EventArgs e)
        {
            cbRetirement.ScreenToObject();
            PopulateTranCodeCombo(GetDepLoan(cmbAcctType), null);  //#76458 - added param value for acctType
            SetQuickTranCodeField(null, null);
        }
        #endregion

        #region cbPayrollTran
        private void cbPayrollTran_CheckedChanged(object sender, System.EventArgs e)
        {
            cbPayrollTran.ScreenToObject();
            PopulateTranCodeCombo(GetDepLoan(cmbAcctType), null);  //#76458 - added param value for acctType
            SetQuickTranCodeField(null, null);
        }
        #endregion

        #region picTabs

        bool _isCustSummNotes = false;
        private void picTabs_SelectedIndexChanged(object sender, System.EventArgs e)
        {
            isAudit = false;//Bug#115682
            this.panelAvailBal.Visible = false;	 // WI#17285
            pbCDRedemp.Enabled = false; // #140782
            pbCDRedemp.Visible = false; // #140782
            pbVod.Visible = true;   //WI#28556
            _myRim = _tlTranSet.CurTran.TranAcct.RimNo.Value;    //#29682

            #region Merged Application Code
            //Begin #60689. Make this setting initially on Tab_change. then later on with correct tab condition we can change it
            pActionSepNonCust.Visible = false; 
            pActionSepSrchMisc.Visible = false;
            pbRestrictions.Visible = true;
            pbACHFut.Visible = true;
            pbIrsRpt.Visible = true;
            pbPendingCC.Visible = true;
            pbeReceipt.Visible = true;
            pbNOCHistory.Visible = true;
            //End #60689
            pbSeperatorTeller.SeperatorText = ""; //#60578
            pbSeperatorCust.Visible = false;  //#60620
            pbSeperatorAcct.Visible = false;
            pbMisc.Visible = false;    //#60578
            pbSeperatorServ.Visible = false;
            //Begin #60620. Hid Customer Action Grouping button in all tabs
            bool rmDisplayEnabled = CoreService.UIAccessProvider.HasReadAcces(Shared.Constants.ScreenId.RmDisplay);//Bug #95565
            bool rmHistoryEnabled = CoreService.UIAccessProvider.HasReadAcces(Shared.Constants.ScreenId.RmHistory);//Bug #95565
            pbRim.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbRimDirect.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbRimDisplay.SetObjectStatus(VisibilityState.Hide, rmDisplayEnabled ? EnableState.Enable: EnableState.Disable);//Bug #95565
            pbRimHistory.SetObjectStatus(VisibilityState.Hide, rmHistoryEnabled? EnableState.Enable: EnableState.Disable);//Bug #95565
            //End #60620
            //Begin 61240
            this.pbActionSeperator4.Visible = false;
            this.pbEditService.Visible = false;
            this.pbSales.Visible = false;
            //End 61240            
            //Begin #60578
            pbOnUs.Visible = true;
            pbInventory.Visible = (picTabs.SelectedIndex != (int)TAB.QuickTran); //Task#87717
            pbeReceipt.Visible = true;
            //End #60578
            //Begin  #60647
            pbNewAcct.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbDirectAcct.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbUmbrella.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbEdit.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbArchive.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            pbServicing.SetObjectStatus(VisibilityState.Hide, EnableState.Default);
            //End  #60647
            #endregion

			//9136this.pbInstChkSrch.Visible = true;	// #79370
			//9136this.pbInstChkSrch.Enabled = false;	// #79370
            pbInstChkSrch.SetObjectStatus(VisibilityState.Hide, EnableState.Disable); //9136

            // 8497 this.setTitleBar();   // #76048
            this.EnableDisableControls(EnumEnableDisable.DisableBondPurchase); //#76047
            _isCustSummNotes = false;
            if (!CheckForPendingValidation(picTabs))
            {
                picTabs.SelectedIndex = prevTabSelection;
                return;
            }
            //Begin 9200.As a part of this fix. fixed issue with History For External Account history is flyout in RMS so reset it in this event. If it is RMS and EX account it will automatically add the flyout
            pbHistory.ImageButton.Style = PImageButton.ButtonStyle.Normal;
            pbHistory.ImageButton.Width = pbDisplay.ImageButton.Width;       // set it to standard width of a button
            RepaintButton(pbHistory.ImageButton);
            this.pbHistory.ImageButton.DropDownMenu = null;
            //End 9200
            lastActiveControl = null;
            Workspace.Variables["HideAlerts"] = null; //#60668. Show workspace Icon on Every Tab other than RMS
            //Begin #75604. If User Type is Teller then Assume Config Always
            if (GlobalVars.UserType == "Teller")
            {
                #region config
                PdfCurrency.ApplicationAssumeDecimal = (_tlTranSet.TellerVars.AdTlControl.AssumeDecimals.Value == GlobalVars.Instance.ML.Y);
                CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                this.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                #endregion
            }
            else
            {
                #region config
                PdfCurrency.ApplicationAssumeDecimal = false;
                CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                this.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                #endregion
            }
            //End #75604
            // 8497 begin - moved everything into a switch
            switch (picTabs.SelectedIndex)
            {
                case 0:

                    #region Input Transaction
                    showDisplayWindow = false; //#75074
                    //Begin #75604
                    PdfCurrency.ApplicationAssumeDecimal = (_tlTranSet.TellerVars.AdTlControl.AssumeDecimals.Value == GlobalVars.Instance.ML.Y);
                    CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                    this.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                    //End #75604
                    if (!string.IsNullOrEmpty(this.pbGetAcct.ShortText) && this.pbGetAcct.ShortText.StartsWith("&")) //#122727
                    {
                        string newShortText = this.pbGetAcct.ShortText.Replace("&G", "G");
                        pbGetAcct.ImageButton.Invalidate();
                        pbGetAcct.ImageButton.Text = pbGetAcct.ShortText = pbGetAcct.LongText = pbGetAcct.MLInfo.Label = newShortText;
                        pbGetAcct.ImageButton.Refresh();
                    }
                    pbExceptionHold.SetObjectStatus(VisibilityState.Show, EnableState.Default); //#134757
                    #region Set Title Bar Name #8497

                    // Using current transaction Rim No, not holdRimNo because it can have the Transfer Rim No
                    //begin #79572
                    if (!isNonCust())
                    {
                        //16278 added if and else conditions
                        // Begin WI#16236_2
                        //if((!populateGridWithSavedRim) &&( _myRim == _tlTranSet.CurTran.TranAcct.RimNo.Value || _myRim == -1))
                        //  setTitleBarName(_tlTranSet.CurTran.TranAcct.RimNo.Value, false);
                        //else
                        //  setTitleBarName(_holdRimNo, true);
                        int tmpRimNo;
                        bool recordFailedAccess = false;

                        if ((!populateGridWithSavedRim) && (_myRim == _tlTranSet.CurTran.TranAcct.RimNo.Value || _myRim == -1))
                        {
                            setTitleBarName(_tlTranSet.CurTran.TranAcct.RimNo.Value, false);
                            tmpRimNo = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                        }
                        else
                        {
                            setTitleBarName(_holdRimNo, true);
                            tmpRimNo = _holdRimNo;
                        }

                        if (tmpRimNo != -1)
                        {
                            if (_tlTranSet.TellerVars.IsAppOnline)  //#17958 - check rim restriction only when app is in online mode
                            {
                                // We Have To Get New Restriction Level Before Verify Employee Access Or It will Be Wrong
                                AdRmRestrict _adRmRestrict = new AdRmRestrict();
                                _RimRestrictLevel.Value = _adRmRestrict.GetRestrictLevel(tmpRimNo);

                                // Reverify Employee Access To Reset Flags Back beecause search window changed them
                                _tlTranSet.VerifyEmplAccess(tmpRimNo, _RimRestrictLevel.Value, _tlTranSet.TellerVars.EmplRestrictLevel,
                                ref recordFailedAccess, ref acctHasPostAccessOnly, ref acctHasViewAcesssOnly);
                            }

                            // Need To Disable Display/History Based on Acct No Field
                            EnableDisableControls("AcctNoEnter");

                            // If on TfrAcct Field Then Enable/Disable Controls For that
                            if (this.focusAcctField.Name == "cmbTfrAcctType")
                            {
                                EnableDisableControls("TfrAcctNoEnter");
                            }
                        }  // end WI#16236_2
                    }
					else
					{
						cmbAcctType.SetValue("RIM");
						_tlTranSet.CurTran.AcctType.Value = _tlTranSet.CurTran.TranAcct.AcctType.Value = "RIM";
						dfAcctNo.Text = _tlTranSet.CurTran.AcctNo.Value = _tlTranSet.CurTran.TranAcct.AcctNo.Value = this.Workspace.Variables["NonCustRimNo"].ToString();
						_tlTranSet.CurTran.TranAcct.RimNo.Value = Convert.ToInt32(this.Workspace.Variables["NonCustRimNo"]);

                        dfTitle1.Value = _tlTranSet.CurTran.TranAcct.Title1.Value = this.Workspace.Variables["NonCustRimNo"].ToString() + " - " + this.Workspace.Variables["NonCustName"].ToString();   //#9138
						this.TitleText = "Teller Transaction " + this.Workspace.Variables["NonCustName"].ToString() + " - " + this.Workspace.Variables["NonCustRimNo"].ToString();
                        this.UpdateView();  //#9138

						dfAcctNo.Enabled = false;
						cmbAcctType.Enabled = false;
						_tlTranSet.CurTran.NonCust.Value = "Y";
						//this.ActionAddNext.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
						this.pbLastAcct.SetObjectStatus(VisibilityState.Default, EnableState.DisableShowText);
						this.pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.DisableShowText);
						this.pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.DisableShowText);
						this.lblNonCustomer.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Default);
						if (IsDisplayTransitItemFields())
						{
							lblTlItemAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
							dfTlItemAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
							lblTlItemRoutingNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
							dfTlItemRoutingNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
							lblTlItemCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
							dfTlItemCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
						}
					}
                    if (dfTitle1.Text != "" && MailerForm.Count > 0 && MailerStatus != "Closed" && MailerStatus != "Inactive" && !isNonCust()) // #80615 // #12870
                    {
                        pbPrintMailer.SetObjectStatus(VisibilityState.Show, EnableState.Enable);
                        pbPrintMailerMisc.SetObjectStatus(VisibilityState.Show, EnableState.Enable); //#60578
                    }

					//End #79572
                    //#region #5002
                    //TlAcctDetails actd = new TlAcctDetails();
                    //actd.AcctNo.Value = _holdRimNo.ToString();
                    //actd.RimNo.Value = _holdRimNo;
                    //actd.ApplType.Value = GlobalVars.Instance.ML.RIM;
                    //actd.DepLoan.Value = GlobalVars.Instance.ML.RM;
                    //actd.AcctType.Value = GlobalVars.Instance.ML.RIM;
                    //try
                    //{
                    //    using (new WaitCursor())
                    //    {
                    //        actd.GetAcctDetails();
                    //    }
                    //}
                    //catch (PhoenixException pe)
                    //{
                    //    PMessageBox.Show(pe, MessageBoxButtons.OK);
                    //}
                    //_tlTranSet.CurTran.TranAcct.RimNo.Value = _holdRimNo;
                    //_tlTranSet.CurTran.TranAcct.RimFirstName.Value = actd.RimFirstName.Value;
                    //_tlTranSet.CurTran.TranAcct.RimLastName.Value = actd.RimLastName.Value;
                    //_tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = actd.RimMiddleInitial.Value;
                    //#endregion

                    //this.setTitleBarName();
                    #endregion

                    #endregion
                    break;

                case 1:

                    #region Transaction Summary
                    showDisplayWindow = false; //#75074
                    //Begin  #75604
                    PdfCurrency.ApplicationAssumeDecimal = (_tlTranSet.TellerVars.AdTlControl.AssumeDecimals.Value == GlobalVars.Instance.ML.Y);
                    CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                    this.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                    //End  #75604
                    if (ctwTranSet.Count > 0)
                    {
                        isTranView = true;      //13697
                        //Begin #140895
                        //ctwTranSet.SelectRow(0, true);
                        if (!_tlTranSet.IsTellerCaptureTran || ctwTranSet.ContextRow < 0)
                            ctwTranSet.SelectRow(0, true);
                        ctwTranSet.Focus();
                        //End #140895
                    }

                    //begin #34465
                    //this.setTitleBar();
                    #region Set Title Bar Name

                    // Using current transaction Rim No, not holdRimNo because it can have the Transfer Rim No
                    if (!isNonCust())
                    {
                        if ((!populateGridWithSavedRim) && (_myRim == _tlTranSet.CurTran.TranAcct.RimNo.Value || _myRim == -1))
                        {
                            setTitleBarName(_tlTranSet.CurTran.TranAcct.RimNo.Value, false);
                        }
                        else
                        {
                            setTitleBarName(_holdRimNo, true);
                        }
                    }
                    else
                    {
                        cmbAcctType.SetValue("RIM");
                        _tlTranSet.CurTran.AcctType.Value = _tlTranSet.CurTran.TranAcct.AcctType.Value = "RIM";
                        dfAcctNo.Text = _tlTranSet.CurTran.AcctNo.Value = _tlTranSet.CurTran.TranAcct.AcctNo.Value = this.Workspace.Variables["NonCustRimNo"].ToString();
                        _tlTranSet.CurTran.TranAcct.RimNo.Value = Convert.ToInt32(this.Workspace.Variables["NonCustRimNo"]);

                        dfTitle1.Value = _tlTranSet.CurTran.TranAcct.Title1.Value = this.Workspace.Variables["NonCustRimNo"].ToString() + " - " + this.Workspace.Variables["NonCustName"].ToString();
                        this.TitleText = this.EditRecordTitle + " " + this.Workspace.Variables["NonCustName"].ToString() + " - " + this.Workspace.Variables["NonCustRimNo"].ToString();
                        this.UpdateView();
                    }
                    pbExceptionHold.SetObjectStatus(VisibilityState.Hide, EnableState.Default); //#134757
                    #endregion
                    //end   #34465

                    #endregion
                    break;

                case 2:

                    #region Search
                    showDisplayWindow = false; //#75074
                    IsUIPrefSet = false; //WI#20338
                    //Begin #60689

                    pActionSepNonCust.Visible = isNonCustAllowed || (GlobalVars.UserType == "AcProc" && _bAcProcFraudEnabled); //92056 Code for Actual Issue of this WI
                     pActionSepSrchMisc.Visible = true;
                     pbSeperatorTeller.SeperatorText = "Search";
                    //End #60689
                    CreateEmbeddedWindows("Search");
                    //frmTBarSearch.HighLightTheSearchField();   // #74043
                    if (_tlTranSet.TellerVars.AdTlControl.TellerChkPrint.Value == "Y"
                        || _adGbBankControl.EnableChkPrint.Value == "Y") //9136
                    {
                        this.pbInstChkSrch.SetObjectStatus(VisibilityState.Show, EnableState.Enable); // #79370

                    }
                    this.AppToolBarId = AppToolBarType.Search;	 //#65372
                    this.setTitleBar(); //#76048
                    //Begin 73938
                    if (frmTBarSearch != null && frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabRecentCustLookup)
                    {
                        //Begin Bug #100896
                        if (RefreshCustLookupGrid)
                        {
                            frmTBarSearch.grdCustLookup.ObjectToScreen();
                            RefreshCustLookupGrid = false;
                        }
                        //End Bug #100896
                        if (frmTBarSearch.grdCustLookup.Items.Count > 0)
                        {
                            frmTBarSearch.grdCustLookup.Focus();
                            frmTBarSearch.grdCustLookup.ContextRow = 0;
                            frmTBarSearch.grdCustLookup.SelectRow(0);                            
                        }
                    }
                    //End 73938
                    pbExceptionHold.SetObjectStatus(VisibilityState.Hide, EnableState.Default); //#134757
                    #endregion
                    break;

                case 3:

                    #region Customer Summary
                    Workspace.Variables["HideAlerts"] = "Y";   // #60668. Hide Icons in RMS Tab          
                    if (this.focusAcctField.Name != "cmbTfrAcctType")//wi#16236 added this if condition
                    {
                        if (!ScreenHasAccess("custSummary", false))    // WI#16236 added this.isTfrAcct //16236 changed this.isTfrAcct to false
                        {
                            picTabs.SelectedIndex = prevTabSelection;
                            FormExtension t = Extension as FormExtension;
                            if (Phoenix.FrameWork.CDS.DataService.Instance.PrimaryDbAvailable)
                            {
                                HandleNotes();
                                t.IsNotesAvailable = (t.NotesInfo.Count > 0);
                                _isCustSummNotes = (t.NotesInfo.Count > 0);
                                EnableDisableControls("AccountListSumClick");
                            }
                            else
                            {
                                _isCustSummNotes = false;
                                t.IsNotesAvailable = false;
                            }
                            return;
                        }
                    }
                    #region Merged Application Code
                    //Begin  #60647
                    pbSeperatorTeller.SeperatorText = "Teller"; //#60578
                    pbSeperatorCust.Visible = true;//#60578
                    pbSeperatorTeller.Visible = true;
                    pbSeperatorAcct.Visible = true;
                    pbSeperatorServ.Visible = true;
                    pbRim.SetObjectStatus(VisibilityState.Show, EnableState.Default);
                    pbRimDirect.SetObjectStatus(VisibilityState.Show, EnableState.Default);
                    pbRimDisplay.SetObjectStatus(VisibilityState.Show, rmDisplayEnabled ? EnableState.Enable: EnableState.Disable); //Bug #95565
                    pbRimHistory.SetObjectStatus(VisibilityState.Show, rmHistoryEnabled ? EnableState.Enable : EnableState.Disable); //Bug #95565
                    pbMisc.Visible = true;
                    pbNewAcct.SetObjectStatus(VisibilityState.Show, EnableState.Default);
                    pbDirectAcct.SetObjectStatus(VisibilityState.Show, EnableState.Default);
                    pbUmbrella.SetObjectStatus(VisibilityState.Show, EnableState.Default);
                    pbEdit.SetObjectStatus(VisibilityState.Show, EnableState.Default);
                    pbArchive.SetObjectStatus(VisibilityState.Show, EnableState.Default);
                    pbServicing.SetObjectStatus(VisibilityState.Show, EnableState.Default);
                    //End  #60647                     
                    #endregion
                    EnableDisableControls("TabClickedSetActions");	// #71892
                    IsUIPrefSet = false; //WI#20338
                    CreateEmbeddedWindows("Summary");
                    if (frmGloAccountListRim != null)
                    {
                        //71231
                        //					//360821 - Please wait while retriving customer information...71231
                        //					dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(360821));
                        #region Merged Application Code
                        //Begin #60578
                        bRenewal = true;
                        bSdVisit = true;                       
                        if (frmGloAccountListRim.dfStatus.Text.Trim() == GlobalVars.Instance.ML.Closed || frmGloAccountListRim.dfStatus.Text.Trim() == "Prospect")
                        {
                            this.pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            this.pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            this.pbPortfolio.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            bRenewal = false;
                            bSdVisit = false;
                        }
                        
                            pbMisc.Visible = true;                       
                            CreateRimDirectMenu();
                            CreateTellerMiscMenu();
                            CreateNewAcctMenu();
                            CreateLnDirectMenu();
                            CreateDpDirectMenu();
                            CreateAtmDirectMenu();
                            CreateServicingMenu();
                            this.pbMisc.ImageButton.DropDownMenu = cmTellerMiscMenu;
                            this.pbRimDirect.ImageButton.Style = PImageButton.ButtonStyle.DropDown;
                            this.pbNewAcct.ImageButton.Style = PImageButton.ButtonStyle.DropDown;
                            this.pbDirectAcct.ImageButton.Style = PImageButton.ButtonStyle.DropDown;
                            this.pbServicing.ImageButton.Style = PImageButton.ButtonStyle.DropDown;
                            //End #60578  
                        #endregion
                        frmGloAccountListRim.Visible = false; // FUN

                        //WI#11021
			            if (!isBlocked)
			                frmGloAccountListRim.ResetRim(searchRimNo, searchAcctType, searchAcctNo, forceFetchRim);
			            else
			            {
                            CurRimNo = (Convert.ToInt32(this.Workspace.Variables["RimNo"])); //WI #83060. this is not for this WI fix. but in General RImNo should be int32. So modifying code under this WI
			             frmGloAccountListRim.ResetRim(CurRimNo, searchAcctType, searchAcctNo, forceFetchRim);

			            }
                        //end WI#11021b
                        if (frmGloAccountListRim.sArchiveEnabled.Trim() == "Y")
                        {
                            pbArchive.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                        }
                        else
                        {
                            pbArchive.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                        }
                        /* frmGloAccountListRim.ResetRim(searchRimNo, searchAcctType, searchAcctNo, forceFetchRim);*/
                        if (frmGloAccountListRim.gridAccountListSum.SelectedIndicies.Count > 1)
                        {
                            int selectedRow = frmGloAccountListRim.gridAccountListSum.SelectedIndicies.Count - 1;
                            frmGloAccountListRim.gridAccountListSum.SelectedIndicies.Clear();
                            //140788 frmGloAccountListRim.gridAccountListSum.Items.ClearSelection();
                            frmGloAccountListRim.gridAccountListSum.SelectRow(selectedRow, true);
                            frmGloAccountListRim.Focus();
                        }
                        forceFetchRim = false;
                        //71231
                        dlgInformation.Instance.HideInfo();
                        frmGloAccountListRim.Visible = true; // FUN
                        //71231

                        EnableDisableControls("AccountListSumClick");
                        frmGloAccountListRim.gridServListSum.DoubleClickAction = pbEditService; //61240                    

                        frmGloAccountListRim.gridAccountListSum.Focus(); //#71389

                        #region Set Title Bar Name
                        if (this.focusAcctField.Name != "cmbTfrAcctType") // #5002
                        {
                            // Begin #76048
                            try
                            {
                                using (new WaitCursor())
                                {
                                    #region Reset RIM No #2902

                                    if (_tlTranSet != null &&
                                        _tlTranSet.CurTran != null &&
                                        _tlTranSet.CurTran.TranAcct != null &&
                                        !_tlTranSet.CurTran.TranAcct.RimNo.IsNull &&
                                        _tlTranSet.CurTran.TranAcct.RimNo.Value != searchRimNo)
                                    {
                                        _tlTranSet.CurTran.TranAcct.RimNo.Value = -1;
                                    }

                                    #endregion

                                    #region Set Title Bar Name #8497

                                     //WI#11021
				//setTitleBarName(searchRimNo, true);
                                     this.AppToolBarId = AppToolBarType.Rim; //#65372
				if (isBlocked)
				{
                    setTitleBarName(Convert.ToInt32(this.Workspace.Variables["RimNo"]), true); //WI #83060. this is not for this WI fix. but in General RImNo should be int32. So modifying code under this WI
				}
				else
                                   setTitleBarName(searchRimNo, true);

                                    //#region #5002
                                    //TlAcctDetails actd = new TlAcctDetails();
                                    //actd.AcctNo.Value = searchRimNo.ToString();
                                    //actd.RimNo.Value = searchRimNo;
                                    //actd.ApplType.Value = GlobalVars.Instance.ML.RIM;
                                    //actd.DepLoan.Value = GlobalVars.Instance.ML.RM;
                                    //actd.AcctType.Value = GlobalVars.Instance.ML.RIM;
                                    //try
                                    //{
                                    //    using (new WaitCursor())
                                    //    {
                                    //        actd.GetAcctDetails();
                                    //    }
                                    //}
                                    //catch (PhoenixException pe)
                                    //{
                                    //    PMessageBox.Show(pe, MessageBoxButtons.OK);
                                    //}
                                    //_tlTranSet.CurTran.TranAcct.RimNo.Value = searchRimNo;
                                    //_tlTranSet.CurTran.TranAcct.RimFirstName.Value = actd.RimFirstName.Value;
                                    //_tlTranSet.CurTran.TranAcct.RimLastName.Value = actd.RimLastName.Value;
                                    //_tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = actd.RimMiddleInitial.Value;

                                    //this.setTitleBarName();

                                    //#endregion
                                    #endregion
                                }
                            }
                            catch (PhoenixException pe)
                            {
                                PMessageBox.Show(pe, MessageBoxButtons.OK);
                            }
                        }
                        else
                        {
                            #region Set Title Bar Name #8497

                            //16278 - added if else
                            if (isBlocked)
                                setTitleBarName(Convert.ToInt32(this.Workspace.Variables["RimNo"]), false); //WI #83060. this is not for this WI fix. but in General RImNo should be int32. So modifying code under this WI
                            else
                                setTitleBarName(searchRimNo, false);    // Code below sets CurTran, this is wrong. Using false.

                            //#region #5002
                            //TlAcctDetails actd = new TlAcctDetails();
                            //actd.AcctNo.Value = searchRimNo.ToString();
                            //actd.RimNo.Value = searchRimNo;
                            //actd.ApplType.Value = GlobalVars.Instance.ML.RIM;
                            //actd.DepLoan.Value = GlobalVars.Instance.ML.RM;
                            //actd.AcctType.Value = GlobalVars.Instance.ML.RIM;
                            //try
                            //{
                            //    using (new WaitCursor())
                            //    {
                            //        actd.GetAcctDetails();
                            //    }
                            //}
                            //catch (PhoenixException pe)
                            //{
                            //    PMessageBox.Show(pe, MessageBoxButtons.OK);
                            //}
                            //_tlTranSet.CurTran.TranAcct.RimNo.Value = searchRimNo;
                            //_tlTranSet.CurTran.TranAcct.RimFirstName.Value = actd.RimFirstName.Value;
                            //_tlTranSet.CurTran.TranAcct.RimLastName.Value = actd.RimLastName.Value;
                            //_tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = actd.RimMiddleInitial.Value;

                            //this.setTitleBarName();

                            //#endregion #5002
                            #endregion
                        }
                        //End #76048

                        #endregion
                    }

                    #endregion
                    UpdateView(); //Bug #95957
                    //// Begin Task#113424 //Begin Bug#114796
                    //if (picTabs.SelectedIndex == (int)TAB.CustSummary )
                    //{
                    //    this.MainBusinesObject = this._acctSearchBusObj;
                    //}
                    ////End Task#113424 //End Bug#114796
                    break;

                case 4:

                    #region Passbook
                    showDisplayWindow = false; //#75074
                    if (!processingPrint)
                    {
                        if ((focusAcctField == cmbTfrAcctType || _tlTranSet.CurTran.TranAcct.AcctHasPassbook.Value != GlobalVars.Instance.ML.Y)
                             && _tlTranSet.CurTran.TfrAcct.AcctHasPassbook.Value == GlobalVars.Instance.ML.Y)
                        {
                            passbookAcctDetails = _tlTranSet.CurTran.TfrAcct;
                        }
                        else if (_tlTranSet.CurTran.TranAcct.AcctHasPassbook.Value == GlobalVars.Instance.ML.Y)
                        {
                            passbookAcctDetails = _tlTranSet.CurTran.TranAcct;
                        }
                        else
                            passbookAcctDetails = null;
                    }
                    if (passbookAcctDetails != null || _refreshPassbook > 0)
                    {
                        if (_refreshPassbook > 0)
                            SetPassbookFields(true);
                        else
                            SetPassbookFields(false);
                    }

                    this.setTitleBarName(_tlTranSet.CurTran.TranAcct.RimNo.Value, false); //8497 this.setTitleBarName( );
                    pbExceptionHold.SetObjectStatus(VisibilityState.Hide, EnableState.Default); //#134757
                    #endregion
                    break;
                //Begin #Task#87717
                case 5:
                    CreateEmbeddedWindows("QuickTran");
                    Workspace.Variables["HideAlerts"] = "Y"; //Bug#90201
                    //EnableDisableQuickButtons(true); //Task 90007 //Bug#108569 Moved down
                    if (!string.IsNullOrEmpty(this.pbGetAcct.ShortText) && !this.pbGetAcct.ShortText.StartsWith("&"))   //#122727
                    {
                        string newShortText1 = this.pbGetAcct.ShortText.Replace("G", "&G");
                        pbGetAcct.ImageButton.Invalidate();
                        pbGetAcct.ImageButton.Text = pbGetAcct.ShortText = pbGetAcct.LongText = pbGetAcct.MLInfo.Label = newShortText1;
                        pbGetAcct.ImageButton.Refresh();
                    }
                    pbExceptionHold.SetObjectStatus(VisibilityState.Hide, EnableState.Default); //#134757
                    _quickTranWindow.FocusInitialField(); //Bug #114526
                    break;
               //End #EASYCAP
            }


            #region 8497 moved into Switch
            //if (picTabs.SelectedIndex == 3)
            //{

            //    //

            //    if (!ScreenHasAccess("custSummary"))
            //    {
            //        picTabs.SelectedIndex = prevTabSelection;
            //        FormExtension t = Extension as FormExtension;
            //        if (Phoenix.FrameWork.CDS.DataService.Instance.PrimaryDbAvailable)
            //        {
            //            HandleNotes();
            //            t.IsNotesAvailable = (t.NotesInfo.Count > 0);
            //            _isCustSummNotes = (t.NotesInfo.Count > 0);
            //        }
            //        else
            //        {
            //            _isCustSummNotes = false;
            //            t.IsNotesAvailable = false;
            //        }
            //        return;
            //    }
            //    EnableDisableControls("TabClickedSetActions");	// #71892
            //    CreateEmbeddedWindows("Summary");
            //    if (frmGloAccountListRim != null)
            //    {
            //        //71231
            //        //					//360821 - Please wait while retriving customer information...71231
            //        //					dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(360821));
            //        frmGloAccountListRim.Visible = false; // FUN
            //        //71231
            //        frmGloAccountListRim.ResetRim(searchRimNo, searchAcctType, searchAcctNo, forceFetchRim);
            //        if (frmGloAccountListRim.gridAccountListSum.SelectedIndicies.Count > 1)
            //        {
            //            int selectedRow = frmGloAccountListRim.gridAccountListSum.SelectedIndicies.Count - 1;
            //            frmGloAccountListRim.gridAccountListSum.SelectedIndicies.Clear();
            //            frmGloAccountListRim.gridAccountListSum.Items.ClearSelection();
            //            frmGloAccountListRim.gridAccountListSum.SelectRow(selectedRow, true);
            //            frmGloAccountListRim.Focus();
            //        }
            //        forceFetchRim = false;
            //        //71231
            //        dlgInformation.Instance.HideInfo();
            //        frmGloAccountListRim.Visible = true; // FUN
            //        //71231
            //        EnableDisableControls("AccountListSumClick");
            //        FormExtension t = Extension as FormExtension;
            //        if (Phoenix.FrameWork.CDS.DataService.Instance.PrimaryDbAvailable)
            //        {
            //            //Begin 71907 - Repopulate the Notes
            //            INotesInfo note = GetNotesInfo();
            //            t.GetNotes(note);
            //            //End 71907
            //            HandleNotes();
            //            t.IsNotesAvailable = (t.NotesInfo.Count > 0);
            //            _isCustSummNotes = (t.NotesInfo.Count > 0);
            //        }
            //        else
            //        {
            //            _isCustSummNotes = false;
            //            t.IsNotesAvailable = false;
            //        }
            //        frmGloAccountListRim.gridAccountListSum.Focus(); //#71389

            //        if (this.focusAcctField.Name != "cmbTfrAcctType") // #5002
            //        {
            //            // Begin #76048
            //            try
            //            {
            //                using (new WaitCursor())
            //                {
            //                    // Commented this out for WI 2028
            //                    //_tlTranSet.CurTran.TranAcct.AcctNo.Value = searchRimNo.ToString();
            //                    //_tlTranSet.CurTran.TranAcct.ApplType.Value = GlobalVars.Instance.ML.RM;;
            //                    //_tlTranSet.CurTran.TranAcct.DepLoan.Value = GlobalVars.Instance.ML.RM;
            //                    //Begin #2902
            //                    if (_tlTranSet != null &&
            //                        _tlTranSet.CurTran != null &&
            //                        _tlTranSet.CurTran.TranAcct != null &&
            //                        !_tlTranSet.CurTran.TranAcct.RimNo.IsNull &&
            //                        _tlTranSet.CurTran.TranAcct.RimNo.Value != searchRimNo)
            //                        _tlTranSet.CurTran.TranAcct.RimNo.Value = -1; //let's reset it
            //                    //End #2902
            //                    #region #5002
            //                    TlAcctDetails actd = new TlAcctDetails();
            //                    actd.AcctNo.Value = searchRimNo.ToString();
            //                    actd.RimNo.Value = searchRimNo;
            //                    actd.ApplType.Value = GlobalVars.Instance.ML.RIM;
            //                    actd.DepLoan.Value = GlobalVars.Instance.ML.RM;
            //                    actd.AcctType.Value = GlobalVars.Instance.ML.RIM;
            //                    try
            //                    {
            //                        using (new WaitCursor())
            //                        {
            //                            actd.GetAcctDetails();
            //                        }
            //                    }
            //                    catch (PhoenixException pe)
            //                    {
            //                        PMessageBox.Show(pe, MessageBoxButtons.OK);
            //                    }
            //                    _tlTranSet.CurTran.TranAcct.RimNo.Value = searchRimNo;
            //                    _tlTranSet.CurTran.TranAcct.RimFirstName.Value = actd.RimFirstName.Value;
            //                    _tlTranSet.CurTran.TranAcct.RimLastName.Value = actd.RimLastName.Value;
            //                    _tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = actd.RimMiddleInitial.Value;
            //                    this.setTitleBarName();
            //                    #endregion
            //                }
            //            }
            //            catch (PhoenixException pe)
            //            {
            //                PMessageBox.Show(pe, MessageBoxButtons.OK);
            //            }
            //        }
            //        else
            //        {
            //            #region #5002
            //            TlAcctDetails actd = new TlAcctDetails();
            //            actd.AcctNo.Value = searchRimNo.ToString();
            //            actd.RimNo.Value = searchRimNo;
            //            actd.ApplType.Value = GlobalVars.Instance.ML.RIM;
            //            actd.DepLoan.Value = GlobalVars.Instance.ML.RM;
            //            actd.AcctType.Value = GlobalVars.Instance.ML.RIM;
            //            try
            //            {
            //                using (new WaitCursor())
            //                {
            //                    actd.GetAcctDetails();
            //                }
            //            }
            //            catch (PhoenixException pe)
            //            {
            //                PMessageBox.Show(pe, MessageBoxButtons.OK);
            //            }
            //            _tlTranSet.CurTran.TranAcct.RimNo.Value = searchRimNo;
            //            _tlTranSet.CurTran.TranAcct.RimFirstName.Value = actd.RimFirstName.Value;
            //            _tlTranSet.CurTran.TranAcct.RimLastName.Value = actd.RimLastName.Value;
            //            _tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = actd.RimMiddleInitial.Value;
            //            this.setTitleBarName();
            //            #endregion #5002
            //        }
            //        //End #76048
            //    }
            //}
            //else if (picTabs.SelectedIndex == 2)
            //{
            //    CreateEmbeddedWindows("Search");
            //    //frmTBarSearch.HighLightTheSearchField();   // #74043
            //    this.setTitleBar(); //#76048

            //    this.pbInstChkSrch.Visible = true;	// #79370
            //    this.pbInstChkSrch.Enabled = true;	// #79370
            //}
            //else if (picTabs.SelectedIndex == 4)
            //{
            //    if (!processingPrint)
            //    {
            //        if ((focusAcctField == cmbTfrAcctType || _tlTranSet.CurTran.TranAcct.AcctHasPassbook.Value != GlobalVars.Instance.ML.Y) &&
            //            _tlTranSet.CurTran.TfrAcct.AcctHasPassbook.Value == GlobalVars.Instance.ML.Y)
            //            passbookAcctDetails = _tlTranSet.CurTran.TfrAcct;
            //        else if (_tlTranSet.CurTran.TranAcct.AcctHasPassbook.Value == GlobalVars.Instance.ML.Y)
            //            passbookAcctDetails = _tlTranSet.CurTran.TranAcct;
            //        else
            //            passbookAcctDetails = null;
            //    }
            //    if (passbookAcctDetails != null || _refreshPassbook > 0)
            //    {
            //        if (_refreshPassbook > 0)
            //            SetPassbookFields(true);
            //        else
            //            SetPassbookFields(false);
            //    }
            //    this.setTitleBarName();
            //}
            //else if (picTabs.SelectedIndex == 1) //#71366
            //{
            //    if (ctwTranSet.Count > 0)
            //    {
            //        ctwTranSet.SelectRow(0, true);
            //    }
            //    this.setTitleBar();
            //}
            #endregion

            #region 8497 moved into switch
            // Begin #76048
            //if (picTabs.SelectedIndex == 0)
            //{
            //    #region #5002
            //    TlAcctDetails actd = new TlAcctDetails();
            //    actd.AcctNo.Value = _holdRimNo.ToString();
            //    actd.RimNo.Value = _holdRimNo;
            //    actd.ApplType.Value = GlobalVars.Instance.ML.RIM;
            //    actd.DepLoan.Value = GlobalVars.Instance.ML.RM;
            //    actd.AcctType.Value = GlobalVars.Instance.ML.RIM;
            //    try
            //    {
            //        using (new WaitCursor())
            //        {
            //            actd.GetAcctDetails();
            //        }
            //    }
            //    catch (PhoenixException pe)
            //    {
            //        PMessageBox.Show(pe, MessageBoxButtons.OK);
            //    }
            //    _tlTranSet.CurTran.TranAcct.RimNo.Value = _holdRimNo;
            //    _tlTranSet.CurTran.TranAcct.RimFirstName.Value = actd.RimFirstName.Value;
            //    _tlTranSet.CurTran.TranAcct.RimLastName.Value = actd.RimLastName.Value;
            //    _tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = actd.RimMiddleInitial.Value;
            //    #endregion
            //    this.setTitleBarName();
            //}
            // End #76048
            #endregion

            SetNotesFlag();
            EnableDisableControls("TabClicked");
            prevTabSelection = picTabs.SelectedIndex;
            //Begin #60578.Since we are clonning it . Set enable Logic same as existing Inventory and On_us button. 
            pbInventoryMisc.Enabled = pbInventory.Enabled;
            pbOnUsMisc.Enabled = pbOnUs.Enabled;
            pbeReceiptMisc.Enabled = pbeReceipt.Enabled;
            pbPrintMailerMisc.Enabled = pbPrintMailer.Enabled;
            pbNOCHistoryMisc.Enabled = pbNOCHistory.Enabled;
            //End #60578             
            this.UpdateView();
            // 8497 end
            //We need to Call UpdateView before Display or notes window.Else On Notes and Dispaly Window UpdateView of frmTlTrancode will be called.
            if (picTabs.SelectedIndex == (int)TAB.CustSummary)
            {
                viewTimeIn = DateTime.Now;//Bug#115201
                //Begin 60671. Show notes only if no Disply window shown
                FormExtension t = Extension as FormExtension;
                isCreateDisplayWindow = false;
                if (!launchDisplay())
                {

                    if (Phoenix.FrameWork.CDS.DataService.Instance.PrimaryDbAvailable)
                    {
                        //Begin 71907 - Repopulate the Notes
                        INotesInfo note = GetNotesInfo();
                        t.GetNotes(note);
                        //End 71907
                        HandleNotes();
                        t.IsNotesAvailable = (t.NotesInfo.Count > 0);
                        _isCustSummNotes = (t.NotesInfo.Count > 0);
                    }
                    else
                    {
                        _isCustSummNotes = false;
                        t.IsNotesAvailable = false;
                    }
                }
                else
                {
                    _isCustSummNotes = false;
                    t.IsNotesAvailable = false;
                }
                //end 60671                                          
            }

        }

        #endregion

        #region ctwTranSet
        private void ctwTranSet_Click(object sender, System.EventArgs e)
        {
            //			EnableDisableControls( "TranSetClick" );
        }

        private void ctwTranSet_SelectedIndexChanged(object source, GridClickEventArgs e)
        {

            //Begin #140895-ReadOnly
            if (!_tranSetPopulating && _tlTranSet.IsTellerCaptureTran)
            {
                int tranIndex = Convert.ToInt32(colTranIndex.UnFormattedValue);
                _tlTranSet.SelectTransaction(tranIndex, false);
            }
            //End #140895-ReadOnly
            EnableDisableControls("TranSetClick");
        }

        #endregion

        #region gridAccountListSum
        private void gridAccountListSum_SelectedIndexChanged(object source, GridClickEventArgs e)
        {
            acctChanged = true; //113992 - 114236
            if (!populatePending)
                EnableDisableControls("AccountListSumClick");

            //Begin #13269
            if (frmGloAccountListRim.colNickname != null)
            {
                if (frmGloAccountListRim.colNickname.FormattedValue != null)
                {
                    nickName = frmGloAccountListRim.colNickname.FormattedValue.ToString();
                }
            }
            //End #13269

            SetAdapterFields();   // End Task#115610
        }
        private void gridAccountListSum_Click(object sender, EventArgs e)
        {
            //140788 frmGloAccountListRim.gridAccountListSum.Invalidate();
            gridAccountListSum_SelectedIndexChanged(sender, null);

        }
        private void gridAccountListSum_BeforePopulate(object source, GridPopulateArgs e)
        {
            populatePending = true;
        }
        private void gridAccountListSum_AfterPopulate(object source, GridPopulateArgs e)
        {
            populatePending = false;
            //Begin #13182/#13183
            if (populateGridWithSavedRim)
            {
                populateGridWithSavedRim = false;
            }
            //End #13182/#13183
            if (frmGloAccountListRim.Visible)		// #71892
                EnableDisableControls("AccountListSumClick");
        }
        private void gridAccountListSum_DoubleClick(object sender, EventArgs e)
        {
            if (_tellerCapture != null && _tellerCapture.IsTransactionInProgress)   //#27375 #33451
                return;  
            //Begin  #62740
            if (TellerVars.Instance.DrawerNo > 0)
            {
            pbSelectAcct_Click(sender, null);
        }
            else
            {
                pbDisplay_Click(sender, null);
            }
            //End #62740
        }

        // 140788 private void gridAccountListSum_RowClicked(object source, GridClickEventArgs e)
        private void gridAccountListSum_CellClick(object source, DataGridViewCellEventArgs e) // 140788
        {
            //Begin WI#35646 - Commented the following codes
            //this.Focus();
            //frmGloAccountListRim.gridAccountListSum.Focus();
            //End WI#35646        
        }
        #endregion

        #region grdCustomerList
        private void grdCustomerList_GotFocus(object sender, EventArgs e)
        {
            if (frmTBarSearch != null)
            {
                if (frmTBarSearch.grdCustomerList.Count > 0)
                    frmTBarSearch.DefaultAction = pbSelectSearch;
                else
                    frmTBarSearch.DefaultAction = pbSearch;
                Workspace.ActionPanel.UpdateView();
            }
        }
        private void grdCustomerList_Leave(object sender, EventArgs e)
        {
            if (frmTBarSearch != null)
            {
                frmTBarSearch.DefaultAction = pbSearch;
                Workspace.ActionPanel.UpdateView();
            }
        }
        #endregion

        #region iconSigner
        private void iconSigner_Click(object sender, Phoenix.Windows.Forms.PActionEventArgs e)
        {
            CallOtherForms("Signers");
        }
        #endregion

        //Begin 87757
        public void GetTfrAcctTypes(ref ArrayList TfrAcctTypes)
        {
            if (_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbAcctType"] != null)  
            {
                TfrAcctTypes = _tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbAcctType"];
            }
        }

        public void ActionRequest(string req, string value, ref string reqResultStr)  
        {
            bool tcFound = false;  //#122798

            if (req == "FormatTfrAcctNo")
            {
                string tfrAcctNo = reqResultStr;

                string[] acctDesc = null;
                acctDesc = value.Split("~".ToCharArray());

                string applType = acctDesc[0];
                string depLoan = acctDesc[1];
                string format = acctDesc[2];
                string acctType = acctDesc[3];

                if (format != null && format != String.Empty)  
                {
                    reqResultStr = _tlTranSet.TellerHelper.FormatAccount(tfrAcctNo, format);

                    if (_tlTranSet.TellerVars.IsAppOnline) //Task#90007
                    {
                        //*** Validate the formatted account ***
                        //Begin 87761
                        if (!_gbHelper.ValidateAccount(acctType, reqResultStr))
                        {
                            reqResultStr = string.Empty;  //invalid account
                        }
                        //End 87761
                    }
                }
            }

            if (req == "EnableDisableGetAcct")
            {
                if (value == "true")
                    EnableDisableControls(EnumEnableDisable.EnableGetAcct);
                else
                    EnableDisableControls(EnumEnableDisable.DisableGetAcct);
            }

            //Begin #122798
            if (req == "GetTC163RegDValue" || req == "GetTC164RegDValue" || req == "GetTC102RegDValue" ||
               req == "GetDescValue" || req == "GetEnableDescRefFlags" || req == "GetEnableCheckNoFlags")   //#124295
            {
                tcFound = _tlTranSet.TellerVars.SetContextObject("AdTlTcArray", value);
                if (tcFound)
                {
                    _adtlTc.RegD.Value = _tlTranSet.TellerVars.AdTlTc.RegD.Value;
                    _adtlTc.AutoSelectRegd.Value = _tlTranSet.TellerVars.AdTlTc.AutoSelectRegd.Value;
                    _adtlTc.UseDescription.Value = _tlTranSet.TellerVars.AdTlTc.UseDescription.Value;
                    _adtlTc.AutoSelectUseDesc.Value = _tlTranSet.TellerVars.AdTlTc.AutoSelectUseDesc.Value;
                    _adtlTc.DescriptionEnable.Value = _tlTranSet.TellerVars.AdTlTc.DescriptionEnable.Value;
                    _adtlTc.ReferenceEnable.Value = _tlTranSet.TellerVars.AdTlTc.ReferenceEnable.Value;
                    _adtlTc.TranCode.Value = _tlTranSet.TellerVars.AdTlTc.TranCode.Value;   //#124295
                }
            }
            //End #122798

            //Begin 87757-2
            if (req == "GetTC163RegDValue" || req == "GetTC164RegDValue" || req == "GetTC102RegDValue") //87759
            {
                //Begin Bug #109871
                if (!TellerVars.Instance.IsAppOnline)
                {
                    reqResultStr = "N~N";
                    return;
                }
                //End Bug #109871
                //    _adtlTc.TlTranCode.Value = value;
                //    _adtlTc.SelectAllFields = false;
                //    _adtlTc.RegD.Selected = true;
                //    _adtlTc.AutoSelectRegd.Selected = true;
                //    Phoenix.FrameWork.CDS.DataService.Instance.ProcessRequest(XmActionType.Select, _adtlTc);


                //_dpAcct = new DpAcct();
                //_dpAcct.AcctType.Value = reqResultStr.Split("~".ToCharArray())[0];
                //_dpAcct.AcctNo.Value = reqResultStr.Split("~".ToCharArray())[1];
                //_dpAcct.SelectAllFields = false;
                //_dpAcct.SvRegd.Selected = true;
                //_dpAcct.Mmda.Selected = true;
                //Phoenix.FrameWork.CDS.DataService.Instance.ProcessRequest(XmActionType.Select, _dpAcct);

                //Begin 122798
                /*
                string acctType = reqResultStr.Split("~".ToCharArray())[0];
                string acctNo = reqResultStr.Split("~".ToCharArray())[1];
                int resultIndex = -1;
                string tempInfo = string.Empty;
                if (!string.IsNullOrEmpty(acctType) && !string.IsNullOrEmpty(acctNo))
                {
                    acctType = acctType.Trim();
                    acctNo = acctNo.Trim();
                    if (_myCachedMTAcctInfo != null)
                    {
                        foreach (var mtAcctInfo in _myCachedMTAcctInfo)
                        {
                            tempInfo = Convert.ToString(mtAcctInfo);
                            if (tempInfo.StartsWith(string.Format(@"{0}^{1}", acctType, acctNo)))
                            {
                                resultIndex = _myCachedMTAcctInfo.IndexOf(mtAcctInfo);
                                break;
                            }
                        }
                    }
                    if (resultIndex >= 0)
                        reqResultStr = Convert.ToString(_myCachedMTAcctInfo[resultIndex]).Split("^".ToCharArray())[2];
                    else
                    {
                        _dpAcct = new DpAcct();
                        _dpAcct.AcctType.Value = reqResultStr.Split("~".ToCharArray())[0];
                        _dpAcct.AcctNo.Value = reqResultStr.Split("~".ToCharArray())[1];
                        _dpAcct.SelectAllFields = false;
                        _dpAcct.SvRegd.Selected = true;
                        _dpAcct.Mmda.Selected = true;
                        Phoenix.FrameWork.CDS.DataService.Instance.ProcessRequest(XmActionType.Select, _dpAcct);


                        string acctRegD = (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y" ? "Y" : "N");

                        reqResultStr =
                        (_adtlTc.RegD.Value == "Y" && acctRegD == "Y" ? "Y" : "N") + "~" +
                        (_adtlTc.RegD.Value == "Y" && _adtlTc.AutoSelectRegd.Value == "Y" && acctRegD == "Y" ? "Y" : "N");

                        if (_myCachedMTAcctInfo == null)
                            _myCachedMTAcctInfo = new ArrayList();

                        if (!_dpAcct.AcctType.IsNull && !_dpAcct.AcctNo.IsNull)
                        {
                            _myCachedMTAcctInfo.Add(string.Format(@"{0}^{1}^{2}", _dpAcct.AcctType.Value.Trim(), _dpAcct.AcctNo.Value.Trim(), reqResultStr.Trim()));
                        }
                    }
                }
                */

                //if (QuickAccountSelectedRow != null)
                //{
                //string acctRegD = QuickAccountSelectedRow.GetStringValue("IsRegDAccount").Trim();

                string acctRegD = reqResultStr;

                reqResultStr =
                    (_adtlTc.RegD.Value == "Y" && acctRegD == "Y" ? "Y" : "N") + "~" +
                    (_adtlTc.RegD.Value == "Y" && _adtlTc.AutoSelectRegd.Value == "Y" && acctRegD == "Y" ? "Y" : "N");
                //}
                //else
                //{
                //reqResultStr = "N~N";
                //}
                //End 122798
            }
            //End 87757-2

            /* Begin 95598 */
            if (req == "GetDescValue")
            {
                //Begin 122798
                /*
                _adtlTc.TlTranCode.Value = value;
                _adtlTc.SelectAllFields = false;
                _adtlTc.UseDescription.Selected = true;
                _adtlTc.AutoSelectUseDesc.Selected = true;
                Phoenix.FrameWork.CDS.DataService.Instance.ProcessRequest(XmActionType.Select, _adtlTc);
                */
                //End 122798

                reqResultStr = (_adtlTc.UseDescription.Value == "Y" ? "Y" : "N") + "~" + (_adtlTc.AutoSelectUseDesc.Value == "Y" ? "Y" : "N");
            }
            /* End 95598 */

            /* Begin 104267 */
            if (req == "GetEnableDescRefFlags")
            {
                //Begin 122798
                /*
                _adtlTc.TlTranCode.Value = value;
                _adtlTc.SelectAllFields = false;
                _adtlTc.DescriptionEnable.Selected = true;
                _adtlTc.ReferenceEnable.Selected = true;
                Phoenix.FrameWork.CDS.DataService.Instance.ProcessRequest(XmActionType.Select, _adtlTc);
                */
                //End 122798

                reqResultStr = (_adtlTc.DescriptionEnable.Value == "Y" ? "Y" : "N") + "~" + (_adtlTc.ReferenceEnable.Value == "Y" ? "Y" : "N");
            }
            /* End 104267 */

            if (req == "GetEnableCheckNoFlags")  //#124295
            {
                string enableCheckNo = reqResultStr;

                if (_adtlTc.TranCode.Value == 154 || _adtlTc.TranCode.Value == 350 || _adtlTc.TranCode.Value == 900)
                {
                    enableCheckNo = "Y";
                }
                reqResultStr = (enableCheckNo + "~" + enableCheckNo);
            }


            //Begin Task#90007
            if (_tlTranSet != null && _tlTranSet.TellerVars != null && !_tlTranSet.TellerVars.IsAppOnline && req == "FormatAcctNo") 
            {
                string acctNo = reqResultStr;

                string[] acctDesc = null;
                acctDesc = value.Split("~".ToCharArray());

                string format = acctDesc[2];
                string acctType = acctDesc[3];

                if (!string.IsNullOrEmpty(format))
                {
                    reqResultStr = _tlTranSet.TellerHelper.FormatAccount(acctNo, format);
                }
            }
            //End Task#90007
        }
        //End 87757

        #region common controls
        //Begin Bug#108569
        //Begin Task#89976
        public void EnableDisableQuickButtons(bool enableButtons)
        {
            
            if (_tlTranSet == null || _tlTranSet.TellerVars.AdTlControl.EnableQuickTranTab.Value != GlobalVars.Instance.ML.Y) 
                return;

            #region Offline Enable/Disble (Exit code if Offline)
            if (!TellerVars.Instance.IsAppOnline)
            {
                //Begin Bug# 109838
                Name0.IsDisabled = isTransactionGridPopulated;

                
                pbClearAll.Visible = true;
                pbSeparator1.Visible = true;
                pbSeparator1.Enabled = true;

                pbAdvancedView.Enabled = isTransactionGridPopulated;
                pbFees.Enabled = isTransactionGridPopulated;

                pbMakeBreakStrap.Visible = true;
                pbMakeBreakStrap.Enabled = true;
                //End Bug# 109838

                pbItemCapture.Visible = true;
                pbCashIn.Visible = true;

                pbItemCapture.Enabled = true;
                pbCashIn.Enabled = true;

                pbFees.Visible = true;

                pbeReceipt.Visible = false;

                //Begin Task# 114935
                pbSeperatorCust.Visible = true;

                pbRimDisplay.Visible = true;
                pbRimHistory.Visible = true;

                pbSeperatorAcct.Visible = true;

                pbRimDisplay.Enabled = false;
                pbRimHistory.Enabled = false;


                //End Task 114935
                pbDisplay.Enabled = false;
                pbHistory.Enabled = false;
                pbRelationship.Enabled = false;
                pbRestrictions.Enabled = false;
                pbPrintMailer.Visible = false;

                pbLastAcct.Visible = false; //Bug #109821

                return;
            }
            #endregion

            Name0.IsDisabled = (QuickAccountSelectedRow != null); //Bug #109821

            #region Set Push buttons Visivility

            //Always visible in quick tran
            bool visible = true;
            pbClearAll.Visible = visible;
             pbSeparator1.Visible = visible;
            pbSeparator1.Enabled = visible;
            pbLastAcct.Visible = visible;
            pbAdvancedView.Visible = visible;
            pbItemCapture.Visible = visible;
            pbCashIn.Visible = visible;
            pbCashOut.Visible = visible;
            pbFees.Visible = visible;
            pbRelationship.Visible = visible;
            pbRestrictions.Visible = visible;
            pbeReceipt.Visible = visible;
            pbMakeBreakStrap.Visible = visible;
            //Begin Task# 114935
            pbSeperatorCust.Visible = visible; //Bug 115299

            pbRimDisplay.Visible = visible;
            pbRimHistory.Visible = visible;

            pbSeperatorAcct.Visible = visible;
            //End Task 114935

            pbGetAcct.Visible = visible;         //122355-#5

            visible = false;
            pbOnUs.Visible = visible;
            pbInventory.Visible = visible;
            pbPendingCC.Visible = visible;
            ActionAddNext.Visible = visible;
          //pbGetAcct.Visible = visible;       //122355-#5
            pbGetGLAcct.Visible = visible;//Bug #109821

            pbChkTCDStatus.Visible = (_tlTranSet.TellerVars.IsTCDEnabled || _tlTranSet.TellerVars.IsTCDConnected);  //#101468
            pbReset.Visible = (_tlTranSet.TellerVars.IsTCDEnabled && _tlTranSet.TellerVars.IsTCDConnected);  //#101468
           if (MailerForm.Count > 0 && MailerStatus != "Closed" && MailerStatus != "Inactive" && !isNonCust()) // #12870
                pbPrintMailer.Visible = true;
            else
                pbPrintMailer.Visible = false;
            #endregion

            #region Set Push buttons Enable/Disable 
            pbClearAll.Enabled = true; 

            pbLastAcct.Enabled = _tlTranSet.TellerVars.LastAccts.Count > 0 && GetQuickTranAccts() > 0;
            pbLastAcct.Enabled = _tlTranSet != null && _tlTranSet.TellerVars != null && _tlTranSet.TellerVars.LastAccts.Count > 0;

            //Do this part if QuickTran tab is being intialize, reset(after Clear All) or if search returns no results
            if (enableButtons == false || QuickAccountSelectedRow == null)
            {
                pbDisplay.Enabled = false;
                pbHistory.Enabled = false;
                //Begin Task# 114935
                pbRimDisplay.Enabled = false;
                pbRimHistory.Enabled = false;
                //End Task 114935
                pbRelationship.Enabled = false;  //Task#87765
                pbCashOut.Enabled = false;
                pbItemCapture.Enabled = false;
                pbCashIn.Enabled = false;
                pbPrintMailer.Enabled = false;
                pbFees.Enabled = false;
                pbRestrictions.Enabled = false;
                pbeReceipt.Enabled = false;
                pbAdvancedView.Enabled = false; //Bug #109821


                pbMakeBreakStrap.Enabled = true;

                pbGetAcct.Enabled = false;      //122355-#5

                return;
            }
            else
            {

                if (QuickAccountSelectedRow != null) //If QuickTab search has results.
                {
                    string colDepLoan = (!string.IsNullOrEmpty(QuickAccountSelectedRow.GetStringValue("DepLoan")) ? QuickAccountSelectedRow.GetStringValue("DepLoan").Trim() : "");

                    pbAdvancedView.Enabled = isTransactionGridPopulated; //Bug #109821

                    #region Enable/Disable pbDisplay, pbHistory, pbRelatiosnhip
                    //Begin Bug #95565
                    
                    if (colDepLoan == GlobalVars.Instance.ML.RM) //Bug 115299
                    {
                        pbDisplay.Enabled = false;
                        pbHistory.Enabled = false;
                    }
                    else
                    {
                        bool displayEnabled = ScreenHasAccess("display", false);
                        bool displayHistoryEnabled = ScreenHasAccess("history", false);
                        pbDisplay.Enabled = displayEnabled ? enableButtons : false;
                        pbHistory.Enabled = displayHistoryEnabled ? enableButtons : false;
                    }
                    //End Bug #95565

                    //Begin Task# 114935
                    bool rmDisplayEnabled = CoreService.UIAccessProvider.HasReadAcces(Shared.Constants.ScreenId.RmDisplay); //Bug #95565
                    bool rmHistoryEnabled = CoreService.UIAccessProvider.HasReadAcces(Shared.Constants.ScreenId.RmHistory); //Bug #95565

                    pbRimDisplay.Enabled = rmDisplayEnabled ? enableButtons : false;
                    pbRimHistory.Enabled = rmDisplayEnabled ? enableButtons : false;
                    //End Task# 114935

                    //Begin Task 94607/94608
                    //If Rim row selected in the quick transaction grid
                    if (colDepLoan == GlobalVars.Instance.ML.RM)
                    {
                        pbRelationship.Enabled = false;  //Task#87765
                        SetWorkspaceAccountVariables("RIM", _quickTranWindow.GetCurrentRim().ToString(), _quickTranWindow.GetCurrentRim().ToString(), colDepLoan);
                    }
                    //End Task 94607/94608

                    else
                    {
                        //Task#87765
                        int ownerCount = QuickAccountSelectedRow.GetIntValue("OwnerCount");
                        pbRelationship.Enabled = (ownerCount > 1) && GlobalVars.UserType != "AcProc"; //#75588
                                                                                                      //Task#87765

                        string colOwnership = QuickAccountSelectedRow.GetStringValue("Ownership").Trim();
                        int colRestrictId = QuickAccountSelectedRow.GetIntValue("RestrictId");
                        string colStatus = QuickAccountSelectedRow.GetStringValue("Status").Trim();
                        string colAdapter = QuickAccountSelectedRow.GetStringValue("Adapter").Trim();
                        //string colAdapterType = QuickAccountSelectedRow.GetStringValue("AdapterType").Trim(); // Task#115614
                        string colDisplaySupport = QuickAccountSelectedRow.GetStringValue("DisplaySupport").Trim();


                        SetQuickWorkSpaceVariable(); //Bug#92482/Bug#92483/Bug#92484

                        colHistorySupport = "";
                        colAdapterType = "";
                        colCrTcSupport = "";
                        colDrTcSupport = "";

                        if (colDepLoan == GlobalVars.Instance.ML.Ext || colDepLoan == "EX")
                        {
                            // Begin Task#115614
                            //colHistorySupport = QuickAccountSelectedRow.GetStringValue("HistorySupport").Trim();
                            //colAdapterType = QuickAccountSelectedRow.GetStringValue("AdapterType").Trim();
                            //colCrTcSupport = QuickAccountSelectedRow.GetStringValue("CrTcSupport").Trim();
                            //colDrTcSupport = QuickAccountSelectedRow.GetStringValue("DrTcSupport").Trim();
                            SetAdapterFields();
                            // End Task#115614
                        }

                        Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 216);   // pbrelationacct and pbimage needs to be enabled
                        Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 224);   // enable tc post

                        //Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "ViewDormant", true);  
                        bRenewal = true;
                        bSdVisit = true;

                        pbHistory.ImageButton.Style = PImageButton.ButtonStyle.Normal;
                        pbHistory.ImageButton.Width = pbDisplay.ImageButton.Width;       // set it to standard width of a button
                        RepaintButton(pbHistory.ImageButton);
                        this.pbHistory.ImageButton.DropDownMenu = null;

                        #region RestrictId/OwnerShip
                        if (colOwnership == GlobalVars.Instance.ML.Secondary)
                        {
                            if (!(!CoreService.UIAccessProvider.IsSecurityEnabled || (colRestrictId >= EmpRestrictId)))       /*WI #39021 - Rewrite the logic as per Centura code*/
                            {
                                if (!(Phoenix.Windows.Client.Helper.GetRimAccess(searchRimNo, ref bRimEditAccess, ref bRimPostAccess)))
                                {
                                    pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                    pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);

                                    bRenewal = false;
                                    bSdVisit = false;

                                    Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 225);   // pbtransactions needs to be disabled

                                    return;
                                }
                                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "RimEditAccess", bRimEditAccess);
                                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "RimPostAccess", bRimPostAccess);
                            }
                        }
                        #endregion

                        #region Status
                        if (colStatus == GlobalVars.Instance.ML.Dormant)
                        {

                            if ((_adGbRsm.AllowViewDormant != null && _adGbRsm.AllowViewDormant.Value == "N") && (_adGbRsm.DormantAccess != null && _adGbRsm.DormantAccess.Value == "N"))
                            {
                                pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);

                                Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 215);   // pbrelationacct and pbimage needs to be disabled

                                bRenewal = false;
                                bSdVisit = false;
                                return;
                            }
                        }
                        else if (colStatus == GlobalVars.Instance.ML.Escheated)
                        {
                            if (_adGbRsm.EscheatedAccess.Value == "N" && _adGbRsm.AllowViewEscheat.Value == "N")
                            {
                                pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);

                                Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 215);   // pbrelationacct and pbimage needs to be disabled

                                bRenewal = false;
                                bSdVisit = false;

                                return;
                            }
                        }
                        #endregion

                        #region Display/History Acct
                        //Acct
                        if (CoreService.UIAccessProvider.IsSecurityEnabled)
                        {
                            if (
                                    (colDepLoan == GlobalVars.Instance.ML.DP && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpDisplay)) ||
                                    (colDepLoan == GlobalVars.Instance.ML.LN && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnDisplay)) ||
                                    (colDepLoan == GlobalVars.Instance.ML.SD && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.SdDepositDisplay)) ||
                                    (colDepLoan == GlobalVars.Instance.ML.Ext && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OnExAcctDisp1)) ||
                                    (colDepLoan == GlobalVars.Instance.ML.Atm && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OnATMAcctDisplay)) ||
                                    (colDepLoan == GlobalVars.Instance.ML.CM && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnUmbDisplay))
                            )

                            {
                                pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            }

                            else if (colDepLoan == GlobalVars.Instance.ML.Ext && colAdapter == "Y")
                            {
                                if (colDisplaySupport != "Y")
                                {
                                    pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                }
                                else if (
                                           (colAdapterType == "Insurance" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InsExAccountDisplay)) ||
                                           (colAdapterType == "Brokerage" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.BrkExAccountDisplay)) ||
                                           (colAdapterType == "Credit Card" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountDisplay)) ||
                                           (colAdapterType == "Student Loan" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.StuLnExAccountDisplay)) ||
                                           (colAdapterType == "Other" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OtherExAccountDisplay))
                                       )
                                {
                                    pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                }

                            }

                            //History
                            if (
                                       (colDepLoan == GlobalVars.Instance.ML.DP && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpTCHistory)) ||
                                       (colDepLoan == GlobalVars.Instance.ML.LN && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnTCHistory)) ||
                                       (colDepLoan == GlobalVars.Instance.ML.SD && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.SdTCHistory)) ||
                                       (colDepLoan == GlobalVars.Instance.ML.CM && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CmtTCHistory)) ||
                                   (colDepLoan == GlobalVars.Instance.ML.Atm && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.AtmTcHistory)) ||
                                   (colDepLoan == GlobalVars.Instance.ML.Ext && (
                                                                   !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InsExAccountHistory) ||
                                                                   !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.BrkExAccountHistory) ||
                                                                   !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountHistory) ||
                                                                   !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.StuLnExAccountHistory) ||
                                                               !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OtherExAccountHistory))
                                                                              )
                               )
                            {
                                pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            }
                            else if (colDepLoan == GlobalVars.Instance.ML.Ext && colAdapter == "Y")
                            {
                                if (!(colHistorySupport == "Y" && (colCrTcSupport == "Y" || colDrTcSupport == "Y")))
                                {
                                    pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                }
                                else if ((colAdapterType == "Insurance" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InsExAccountHistory)) ||
                                        (colAdapterType == "Brokerage" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.BrkExAccountHistory)) ||
                                        (colAdapterType == "Credit Card" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountHistory)) ||
                                        (colAdapterType == "Student Loan" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.StuLnExAccountHistory)) ||
                                        (colAdapterType == "Other" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OtherExAccountHistory))
                                    )
                                {
                                    pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                }
                                else     //36862
                                {
                                    pbHistory.ImageButton.Style = PImageButton.ButtonStyle.DropDown;
                                    // ExHistoryMenuCreated = false;
                                    pbHistory.ImageButton.Width = pbHistory.ImageButton.Width - 9; // framework is increasing the width
                                    RepaintButton(pbHistory.ImageButton);
                                    CreateExHistoryMenu();
                                }
                            }
                        }

                        #endregion
                        //End Bug#92189

                        #endregion
                    }
                    pbCashOut.Enabled = (_tlTranSet.TellerVars.AdTlControl.DenomCashOut.Value != GlobalVars.Instance.ML.Y);

                    #region commented out code
                    //string tranFocusedColumn = _quickTranWindow.GetTransactionGridFocusedColumn();
                    //if ((tranFocusedColumn == "gridColTfrAcctType" || tranFocusedColumn == "gridColOffsetAccount"))
                    //{
                    //    EnableDisableControls(EnumEnableDisable.EnableGetAcct);
                    //}
                    //else
                    //{
                    //    EnableDisableControls(EnumEnableDisable.DisableGetAcct);
                    //}
                    #endregion

                    //Restrictions
                    if (colDepLoan == GlobalVars.Instance.ML.DP)
                    {
                        pbRestrictions.Enabled = ScreenHasAccess("restriction", false);
                    }
                    else if (colDepLoan == GlobalVars.Instance.ML.LN)
                    {
                        string advanceType = (!string.IsNullOrEmpty(QuickAccountSelectedRow.GetStringValue("AdvanceType")) ? QuickAccountSelectedRow.GetStringValue("AdvanceType").Trim() : "");
                        if (!string.IsNullOrEmpty(advanceType) && (advanceType == "Multiple" || advanceType == "Revolving"))
                        {
                            pbRestrictions.Enabled = ScreenHasAccess("restriction", false);
                        }
                    }
                    else
                    {
                        pbRestrictions.Enabled = false;
                    }

                    //EReceipt
                    if (_tlTranSet.TellerVars.AdTlControl.EnableEreceipt.Value == "Y")
                        pbeReceipt.Enabled = true;
                    else
                        pbeReceipt.Enabled = false;


                    pbPrintMailer.Enabled = true;  //(pbPrintMailer.Visible && enableButtons );
                    pbItemCapture.Enabled = true;
                    pbCashIn.Enabled = true;
                    pbFees.Enabled = true;
                    pbMakeBreakStrap.Enabled = true;
                    #endregion
                }
            }
        }
        //End Bug#108569


        //Begin Bug#95957
        private void SetWorkspaceAccountVariables(string acctType, string acctNo, string rimNo,string colDepLoan = null, string colAcctId = null) //103714: Added colAcctId
        {
            this.Workspace.Variables["CurAcctNo"] = acctNo;
            this.Workspace.Variables["CurAcctType"] = acctType;
            this.Workspace.Variables["CurRimNo"] = rimNo;
            if (!string.IsNullOrEmpty(colDepLoan))
            {
                this.Workspace.Variables["DepLoan"] = colDepLoan;
                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "AcctDepLoan", colDepLoan);
            }

            //Begin 103714
            if (!string.IsNullOrEmpty(colAcctId))
            {
                this.Workspace.Variables["CurAcctId"] = colAcctId;
                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "AcctId", colAcctId);
            }
            //End 103714

            Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "CurRimNo", rimNo);
            Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "CurAcctNo", acctNo);
            Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "CurAcctType", acctType);
            this.UpdateView(); //Force Refresh
        }
        //End Bug#95957
        //End Task#89976
        
                 
        public string GetSelectSecondOwner() //Bug#97688
        {
            return (_adRmControl.SelectSecondOwner.Value ?? "").Trim(); //Task #113107
        }
        //Begin 89907
        public void SetCalcControl(object sender)
        {
            Control control = sender as Control;

            if (control != null)
                calcControl = control;
            else
                calcControl = null;

            lastFocussedField = control;

            try //Adding an empty try catch because when closing window sometimes Workspace.ContentCount throws an exception.
            {
                if (Workspace.ContentCount == workSpaceWinCount)
                {
                    prevLastActiveControl = lastActiveControl;
                    lastActiveControl = control;
                }
            }
            catch
            {
            }
        }
        //End 89907

        private void Control_GotFocus(object sender, System.EventArgs e)
        {
            Control control = sender as Control;
            Control newFocusControl = null;
            bool callEnableDisable = false;

            formLostFocus = false;
            if (control == cmbTfrAcctType || control == dfTfrAcctNo || control == dfTfrCheckNo || control == cmbOnUsTc)
                focusAcctField = cmbTfrAcctType;
            else if (control == cmbRefAcctType || control == dfRefAcctNo) //117726
                focusAcctField = cmbRefAcctType;
            else
                focusAcctField = cmbAcctType;

            if (amtFields.IndexOf(control) >= 0)
                calcControl = control;
            else
                calcControl = null;



            if ((control == dfTfrCheckNo || control == cmbOnUsTc) && SkipOnUsField())
            {
                if (lastFocussedField != dfOnUsChks)
                    newFocusControl = dfOnUsChks;
                else
                {
                    if (focusControlAfterOnUs != null)
                        newFocusControl = focusControlAfterOnUs;
                    else
                        newFocusControl = ActionSave.ImageButton;
                }
            }

            if (control == cmbTfrAcctType && SkipOnUsField())
            {
                if (focusControlAfterOnUs != null)
                    newFocusControl = focusControlAfterOnUs;
                else
                    newFocusControl = ActionSave.ImageButton;
            }

			//#79572
			if (control == dfTlItemCheckNo && SkipTransitField())
			{
				if (lastFocussedField != dfTransitChks)
					newFocusControl = dfTransitChks;
				else
				{
					if (focusControlAfterTransit != null)
						newFocusControl = focusControlAfterTransit;
					else
						newFocusControl = ActionSave.ImageButton;
				}
			}

			if (control == dfTlItemAcctNo && SkipTransitField())
			{
				if (focusControlAfterTransit != null)
					newFocusControl = focusControlAfterTransit;
				else
					newFocusControl = ActionSave.ImageButton;
			}
			//#79572

            lastFocussedField = control;

            if (Workspace.ContentCount == workSpaceWinCount)
            {
                prevLastActiveControl = lastActiveControl;
                lastActiveControl = control;
            }

            if (newFocusControl != null)
                newFocusControl.Focus();

            if ((control == dfOnUsChks || control == focusControlAfterOnUs) && SkipOnUsField())
                control.Focus();

			//#79572
			if ((control == dfTransitChks || control == focusControlAfterTransit) && SkipTransitField())
				control.Focus();
			//#79572

            if (control != dfAcctNo && control != dfTfrAcctNo && pbGetGLAcct.Enabled)
                callEnableDisable = true;

            if (!ScreenHasAccess("restriction", false))      // WI#16236 passing isTfrAcct as false
            {
                if ((focusAcctField != cmbTfrAcctType && pbRestrictions.Enabled) ||
                    (focusAcctField == cmbTfrAcctType && !pbRestrictions.Enabled))
                    callEnableDisable = true;
            }

            if (callEnableDisable)
                EnableDisableControls("ControlGotFocus");

            // Begin #17047
            bool offline = !_tlTranSet.TellerVars.IsAppOnline; //Bug 109838
            if ((control != dfAcctNo && control != dfTfrAcctNo && control != dfRefAcctNo && control != cmbAcctType && control != cmbTfrAcctType && control != cmbRefAcctType) || offline) //Bug 109838 //Task# 117726 - Enable Get Acct button if the focus is on charge acct fields.
                EnableDisableControls(EnumEnableDisable.DisableGetAcct);
            else
                EnableDisableControls(EnumEnableDisable.EnableGetAcct);
            // End #17047

            if (control == cmbInventoryType && cmbInventoryPacket.Enabled)
                newFocusControl = cmbInventoryPacket;
            else if (control == cmbInventoryType && dfInvSerialNo.Enabled)
                newFocusControl = dfInvSerialNo;

            //begin #86464
            this.Workspace.Variables["AssumeDecimal"] = _tlTranSet.TellerVars.AdTlControl.AssumeDecimals.Value;
            if (GlobalVars.UserType == "Teller" || picTabs.SelectedIndex == (int)TAB.InputTran || picTabs.SelectedIndex == (int)TAB.ViewTran)
            {
                PdfCurrency.ApplicationAssumeDecimal = (_tlTranSet.TellerVars.AdTlControl.AssumeDecimals.Value == GlobalVars.Instance.ML.Y);
                CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                this.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
            }
            else
            {
                #region config
                PdfCurrency.ApplicationAssumeDecimal = false;
                CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                #endregion
            }
            //End #86464

            //skipOnUsFields = false;
        }

        private void Action_GotFocus(object sender, EventArgs e)
        {
            Control control = sender as Control;

            if (Workspace.ContentCount == workSpaceWinCount && !formLostFocus)
            {
                prevLastActiveControl = lastActiveControl;
                lastActiveControl = control;
            }
        }

        private void SearchControl_Click(object sender, EventArgs e)
        {
            if (frmTBarSearch.grdCustomerList.Count == 0)
                frmTBarSearch.DefaultAction = pbSearch;

            EnableDisableControls("SearchControlClick");

        }

        #region #6656

        void frmTlTranCode_FormClosing(object sender, FormClosingEventArgs e)
        {
            if (!closedWkspace && !e.Cancel)
            {
                WorkSpace_Close(sender, e);
                if (!e.Cancel)
                    closedWkspace = true;
            }
        }
        #endregion

        #endregion

		#region pbPendingCC

		void pbPendingCC_Click(object sender, PActionEventArgs e) //#140792
		{
			CallOtherForms("PendingCC");
		}
		#endregion

		#endregion

		#region other helper methods
		private void SetMask(Phoenix.Windows.Forms.PComboBoxStandard acctTypeField, Phoenix.Windows.Forms.PdfStandard acctNoField)
        {
            string applType = null;
            string depLoan = null;
            string format = null;

            GetAcctTypeDetails(acctTypeField, ref applType, ref depLoan, ref format);
            //Begin #76458
            if (depLoan == GlobalVars.Instance.ML.GL || depLoan == "EX")
                acctNoField.MaxLength = 60;
            else
                acctNoField.MaxLength = 12;
            //End #76458

            if (depLoan == GlobalVars.Instance.ML.GL)
                acctNoField.MaxLength = 60;
            else
                acctNoField.MaxLength = 12;

            if (format != null && format != string.Empty)
            {
                acctNoField.PhoenixUIControl.InputMask = format;
                acctNoField.MaxLength = format.Length;
            }
            else
                acctNoField.PhoenixUIControl.InputMask = String.Empty;

        }

        //Begin #76429
        private void ResetMask(Phoenix.Windows.Forms.PComboBoxStandard acctTypeField, Phoenix.Windows.Forms.PdfStandard acctNoField)
        {
            acctNoField.MaxLength = 60;
            acctNoField.PhoenixUIControl.InputMask = String.Empty;
        }
        //End #76429

        private void GetAcctTypeDetails(Phoenix.Windows.Forms.PComboBoxStandard acctTypeField,
            ref string applType, ref string depLoan, ref string format)
        {

            string[] applDetails = null;
            // hack
            if (acctTypeField.PhoenixUIControl.BusObjectProperty == null)
                acctTypeField.PhoenixUIControl.BusObjectProperty = _tlTranSet.TellerHelper.AcctType;

            if (acctTypeField.CodeValue == null || acctTypeField.Text == null || acctTypeField.Text == String.Empty)
            {
                return;
            }

            applDetails = (acctTypeField.Description).Split("~".ToCharArray());
            applType = applDetails[0];
            depLoan = applDetails[1];
            format = applDetails[2];

        }

        private string GetDepLoan(Phoenix.Windows.Forms.PComboBoxStandard acctTypeField)
        {
            string applType = null;
            string depLoan = null;
            string format = null;

            GetAcctTypeDetails(acctTypeField, ref applType, ref depLoan, ref format);
            return depLoan;
        }

        private void MoveAcctDataToFields()
        {
            string depLoan = _tlTranSet.CurTran.TranAcct.DepLoan.Value;
            string info = String.Empty;

            pdfInfo.Text = "";  //#194535
            MoveMiscObjectsToScreen(miscAcctFields);

            dfTitle1.SetDefaultValue();
            dfTitle2.SetDefaultValue();
            dfAvailBal.SetDefaultValue();
            dfCurBal.SetDefaultValue();
            dfColBal.SetDefaultValue();
            if (this.Workspace != null)    //Task #124027 - Added Null Check for Workspace for Workflow
            {
                //Begin Enh# 69248
                this.Workspace.Variables["RimNo"] = (_tlTranSet.CurTran.TranAcct.RimNo.IsNull ? 0 : _tlTranSet.CurTran.TranAcct.RimNo.Value);
            }
            this.UpdateToolBar();
            //End EnH# 69248

            if (depLoan == null || depLoan == String.Empty || _tlTranSet.CurTran.TranAcct.SuspectAcct.Value == 1)
                return;

            //Begin #76048
            //if ( _tlTranSet.TellerVars.AdTlCls.ShowTitles.Value == GlobalVars.Instance.ML.Y )
            //{
            //    if ( depLoan == GlobalVars.Instance.ML.DP || depLoan == GlobalVars.Instance.ML.LN ||
            //        depLoan == GlobalVars.Instance.ML.SD || depLoan == GlobalVars.Instance.ML.CM )
            //    {
            //        this.dfTitle1.UnFormattedValue = _tlTranSet.CurTran.TranAcct.Title1.Value;
            //        this.dfTitle2.UnFormattedValue = _tlTranSet.CurTran.TranAcct.Title2.Value;
            //    }
            //    else if ( depLoan == GlobalVars.Instance.ML.GL )
            //    {
            //        this.dfTitle1.UnFormattedValue = _tlTranSet.CurTran.TranAcct.Title1.Value;
            //        this.dfTitle2.UnFormattedValue = String.Empty;
            //    }
            //    else
            //    {

            //        this.dfTitle1.UnFormattedValue = _gbHelper.ConcateNameX( _tlTranSet.CurTran.TranAcct.Title1.Value,
            //            _tlTranSet.CurTran.TranAcct.Title3.Value, _tlTranSet.CurTran.TranAcct.Title2.Value, false );
            //        this.dfTitle2.UnFormattedValue = String.Empty;
            //    }

            //}

            this.setTitles();

            //End #76048

            if (_tlTranSet.CurTran.TranAcct.NoSignatures.Value > 1)
            {
                //signatures required to withdraw funds
                info = _tlTranSet.CurTran.TranAcct.NoSignatures.Value.ToString() + " " + CoreService.Translation.GetUserMessageX(360006);
            }
            else if (_tlTranSet.CurTran.TranAcct.DelqAmt.Value > 0)
            {
                //Account is past due
                info = CoreService.Translation.GetUserMessageX(360007);
            }

            SetInfoField(info, Color.Red); //#194535
            info = String.Empty;

            //Begin #72717
            //			if ( _tlTranSet.CurTran.TranAcct.LastNSFDt.Value >= _tlTranSet.TellerVars.XpControl.LastBusDt.Value )
            //			{
            //				//Account has pending NSF items
            //				info = CoreService.Translation.GetUserMessageX(360008);
            //			}
            if (_tlTranSet.CurTran.TranAcct.LastNSFDt.Value > _tlTranSet.TellerVars.XpControl.LastFromDt.Value &&
                _tlTranSet.CurTran.TranAcct.LastNSFDt.Value < _tlTranSet.TellerVars.XpControl.CurBusDt.Value)
            {
                //Account has pending NSF items
                info = CoreService.Translation.GetUserMessageX(360008);
            }
            //End #72717

            else if (!_tlTranSet.CurTran.TranAcct.RegCCCode.IsNull && _tlTranSet.CurTran.TranAcct.RegCCCode.Value != CoreService.Translation.GetListItemX(ListId.RegCC, "C"))
            {
                this.cmbRegCC.CodeValue = _tlTranSet.CurTran.TranAcct.RegCCCode.Value;
                //Account is past due
                info = cmbRegCC.Description + " Under Reg CC";
            }

            SetInfoField(info, Color.Red);  //#194535
            info = String.Empty;

            if (!_tlTranSet.CurTran.TranAcct.BsaRiskCodeDesc.IsNull)
            {
                info = "BSA Risk: " + _tlTranSet.CurTran.TranAcct.BsaRiskCodeDesc.Value;
            }

            SetInfoField(info, Color.Red); //#194535

            //begin #194535
            if (_tlTranSet.TellerVars.AdTlControl.EnableEreceipt.Value == "Y" && !_tlTranSet.CurTran.TranAcct.ReceiptDelMethod.IsNull)  //#40223
            {
                info = "Customer Receipt Delivery Default: ";
                //begin #40275
                if (_adGbBankControl.InstitutionType.Value == "CU")
                {
                    info = CoreService.TranslateText("Customer Receipt Delivery Default: ", _adGbBankControl.InstitutionType.Value, FormSource);
                }
                //end   #40275
                SetInfoField(info, Color.Black);
                info = _tlTranSet.CurTran.TranAcct.ReceiptDelMethod.Value;
                if (_tlTranSet.CurTran.TranAcct.ReceiptDelMethod.Value == PRINT)
                {
                    SetInfoField(info, Color.Red);
                }
                else if (_tlTranSet.CurTran.TranAcct.ReceiptDelMethod.Value == EMAIL)
                {
                    SetInfoField(info, Color.Green);
                }
                else if (_tlTranSet.CurTran.TranAcct.ReceiptDelMethod.Value == PRINTANDEMAIL)
                {
                    SetInfoField(info, Color.Black);
                }
            }
            //end #194535

			//Begin #80630
			dfColBal.FormatAsConf =
			dfCurBal.FormatAsConf =
            dfAvailBal.FormatAsConf = !(this.Extension as FormExtension).VerifyConfAcctAccess(dfAvailBal, cmbAcctType.Text, dfAcctNo.Text, _tlTranSet.CurTran.TranAcct.Confidential.Value);   // #19415 - replaced lats para null
			//End #80630
            //Begin Task#85013
             if (_adGbBankControl.ConfAcctSecurity.Value == "Y"
            && (_adGbRsm.ConfAcctView.Value == "N" && _adGbRsm.ConfAcctIgnore.Value == "N")
            && _tlTranSet.CurTran.TranAcct.Confidential.Value == "Y")//Task# 91967 added account validation
            {
                dfColBal.FormatAsConf = dfCurBal.FormatAsConf = dfAvailBal.FormatAsConf = true;
            }
            else
            {
                dfColBal.FormatAsConf = dfCurBal.FormatAsConf = dfAvailBal.FormatAsConf = false;
            }
            //End Task#85013
            // move the balance info
            if (depLoan == GlobalVars.Instance.ML.DP)
            {
                dfAvailBal.UnFormattedValue = _tlTranSet.CurTran.TranAcct.GetAvailBalUsingGlobalDef(_tlTranSet.GlobalHelper);
                dfCurBal.UnFormattedValue = (_tlTranSet.CurTran.TranAcct.CurrentBalance.IsNull ? 0 : _tlTranSet.CurTran.TranAcct.CurrentBalance.Value);
                dfColBal.UnFormattedValue = _tlTranSet.CurTran.TranAcct.GetColBal(_tlTranSet.GlobalHelper, _tlTranSet.GlobalHelper.GetColBalDef(depLoan));
            }
            else if (depLoan == GlobalVars.Instance.ML.LN || depLoan == GlobalVars.Instance.ML.CM) /*70728 - Added CM*/
            {
                //dfAvailBal.UnFormattedValue = _tlTranSet.CurTran.TranAcct.Undisbursed.Value;
                dfAvailBal.UnFormattedValue = _tlTranSet.CurTran.TranAcct.GetAvailBalUsingGlobalDef(_tlTranSet.GlobalHelper);
                dfCurBal.UnFormattedValue = (_tlTranSet.CurTran.TranAcct.CurrentBalance.IsNull ? 0 : _tlTranSet.CurTran.TranAcct.CurrentBalance.Value);
            }
            else if (depLoan == "EX") /*76458 - Added case for EX */
            {
                //dfAvailBal.UnFormattedValue = _tlTranSet.CurTran.TranAcct.Undisbursed.Value;
                dfAvailBal.UnFormattedValue = _tlTranSet.CurTran.TranAcct.AvailBal.Value;
                dfCurBal.UnFormattedValue = (_tlTranSet.CurTran.TranAcct.CurrentBalance.IsNull ? 0 : _tlTranSet.CurTran.TranAcct.CurrentBalance.Value);
            }
        }

        // Begin #74015
        private void MoveTfrAcctDataToFields()
        {
            string onUsDepLoan = _tlTranSet.CurTran.TfrAcct.DepLoan.Value;
            string info = String.Empty;

            this.dfOnUsTitle1.SetDefaultValue();
            this.dfOnUsTitle2.SetDefaultValue();
            this.dfOnUsSignatures.SetDefaultValue();
            // #80620 - Commented this.dfOnUsAlerts.SetDefaultValue();

            // Begin #76048
            //if (_tlTranSet.TellerVars.AdTlCls.ShowTitles.Value == GlobalVars.Instance.ML.Y)
            //{
            //    if (onUsDepLoan == GlobalVars.Instance.ML.DP || onUsDepLoan == GlobalVars.Instance.ML.LN ||
            //        onUsDepLoan == GlobalVars.Instance.ML.SD || onUsDepLoan == GlobalVars.Instance.ML.CM)
            //    {
            //        this.dfOnUsTitle1.UnFormattedValue = _tlTranSet.CurTran.TfrAcct.Title1.Value;
            //        this.dfOnUsTitle2.UnFormattedValue = _tlTranSet.CurTran.TfrAcct.Title2.Value;
            //    }
            //    else if (onUsDepLoan == GlobalVars.Instance.ML.GL)
            //    {
            //        this.dfOnUsTitle1.UnFormattedValue = _tlTranSet.CurTran.TfrAcct.Title1.Value;
            //        this.dfOnUsTitle2.UnFormattedValue = String.Empty;
            //    }
            //    else
            //    {
            //        this.dfOnUsTitle1.UnFormattedValue = _gbHelper.ConcateNameX(_tlTranSet.CurTran.TfrAcct.Title1.Value,
            //            _tlTranSet.CurTran.TfrAcct.Title3.Value, _tlTranSet.CurTran.TfrAcct.Title2.Value, false);
            //        this.dfOnUsTitle2.UnFormattedValue = String.Empty;
            //    }
            //}

            this.setOnUsTitles();

            // End #76048

            if (_tlTranSet.CurTran.TfrAcct.NoSignatures.Value > 1)
            {
                // ? Signatures required to withdraw funds
                this.dfOnUsSignatures.UnFormattedValue = _tlTranSet.CurTran.TfrAcct.NoSignatures.Value.ToString() + " " + CoreService.Translation.GetUserMessageX(360006);
                this.dfOnUsSignatures.ForeColor = Color.Red;
            }

            #region #80620 - Commented code
            //if (_tlTranSet.CurTran.TfrAcct.Stops.Value == GlobalVars.Instance.ML.Y || _tlTranSet.CurTran.TfrAcct.HoldBal.Value > 0
            //    || _tlTranSet.CurTran.TfrAcct.Cautions.Value == GlobalVars.Instance.ML.Y || _tlTranSet.CurTran.TfrAcct.NSFCount.Value > 0
            //    || _tlTranSet.CurTran.TfrAcct.UCFCount.Value > 0 || _tlTranSet.CurTran.TfrAcct.REJCount.Value > 0
            //    || _tlTranSet.CurTran.TfrAcct.Analysis.Value == GlobalVars.Instance.ML.Y || _tlTranSet.CurTran.TfrAcct.AcctHasSweep.Value == 1)
            //{
            //    // Account has alerts
            //    // this.dfOnUsAlerts.UnFormattedValue = CoreService.Translation.GetUserMessageX(361103);
            //    // this.dfOnUsAlerts.ForeColor = Color.Red;
            //}
            #endregion
        }
        // End #74015

        private void SetInfoField(string info, Color color)  //#194535
        {
            //Color Color = new Color();
            if (pdfInfo.TextLength != 0)
            {
                pdfInfo.AppendText(@" ");   //#194535 Always use AppendText. pdfInfo.Text += " "; messes up colors

                //begin #194535
                if (info.Contains("Customer Receipt Delivery Default"))
                {
                    pdfInfo.AppendText(Environment.NewLine);    //Always use AppendText
                }
                //end #194535
            }

            //begin #194535;
            if (info != "")
            {
                int start = pdfInfo.TextLength;
                pdfInfo.AppendText(info);
                int end = pdfInfo.TextLength;

                pdfInfo.Select(pdfInfo.Text.Length, 0);
                pdfInfo.Select(start, end - start);
                pdfInfo.SelectionColor = color;
                pdfInfo.SelectionLength = 0;    //clears selection
            }
            //end #194535
        }

        private void PopulateAcctTypeCombo(PComboBoxStandard acctTypeField, bool appendRM, bool appendGL)
        {
            string codeValue = null;
            string desc = null;
            short cmbType = 0;    //#76458
            string depLoanFilter = "";    //#76458

            //Begin #76458
            if (acctTypeField == cmbTfrAcctType)
            {
                depLoanFilter = _tlTranSet.GetTfrAcctTypeDepLoanFilter(_tlTranSet.CurTran.TranAcct.TranCode.Value, out cmbType);
                if (_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbTfrAcctType" + cmbType.ToString()] == null)
                {
                    _tlTranSet.TellerHelper.FilterByDepLoan.Value = depLoanFilter;
                    _tlTranSet.TellerHelper.TlWhereClause.Value = (acctTypeSrch ? GlobalVars.Instance.ML.Y : GlobalVars.Instance.ML.N);
                    CallXMThruCDS("AcctTypePopulate");
                    _tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbTfrAcctType" + cmbType.ToString()] = _tlTranSet.TellerHelper.AcctType.Constraint.EnumValues.Clone() as ArrayList;
                }
                acctTypeField.Populate(_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbTfrAcctType" + cmbType.ToString()], null);
            }
            else if (acctTypeField == cmbAcctType && TellerVars.Instance.IsVaultDrawer && _tlTranSet.TellerVars.AdTlControl.VltGlTranOnly.StringValue == "Y") // #79619
            {
                appendRM = false;
            }
            else
            {
                if (_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbAcctType"] == null)
                {
                    _tlTranSet.TellerHelper.TlWhereClause.Value = (acctTypeSrch ? GlobalVars.Instance.ML.Y : GlobalVars.Instance.ML.N);
                    CallXMThruCDS("AcctTypePopulate");
                    _tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbAcctType"] = _tlTranSet.TellerHelper.AcctType.Constraint.EnumValues.Clone() as ArrayList; ;
                }
                acctTypeField.Populate(_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbAcctType"], null);
            }
            //End #76458

            if (appendRM)
            {
                if (acctTypeSrch)
                    codeValue = GlobalVars.Instance.ML.RIM;
                else
                    codeValue = GlobalVars.Instance.ML.RM;

                desc = GlobalVars.Instance.ML.RM + "~" + GlobalVars.Instance.ML.RM + "~";

                acctTypeField.Append(codeValue, desc);
            }

            if (appendGL && !acctTypeField.Items.Contains("GL")) // #8435 - Prevent multiple GL entries
            {
                codeValue = GlobalVars.Instance.ML.GL;
                desc = GlobalVars.Instance.ML.GL + "~" + GlobalVars.Instance.ML.GL + "~" + _tlTranSet.TellerVars.XpControl.GlAcctNoFormat.Value;

                acctTypeField.Append(codeValue, desc);
            }

        }

        private void PopulateTranCodeCombo(string depLoan, string acctType)   //#76458 - Added acctType
        {
            short cmbType = -1;
            string cmbName = "";
            //#79574 - replaced isTCDEnabled with isVaultBuy
            bool isVaultBuy = (_tlTranSet.TellerVars.IsTCDEnabled &&
                _tlTranSet.TellerVars.AdTlControl.TcdVaultBuy.Value == GlobalVars.Instance.ML.Y); //#72916*
            bool isVaultSell = (_tlTranSet.TellerVars.IsTCDEnabled && _tlTranSet.TellerVars.IsRecycler &&
                _tlTranSet.TellerVars.AdTlControl.TcrVaultSell.Value == GlobalVars.Instance.ML.Y);   //#79574

            //#72916 - modified parameter values for tcdconnected and tcddrawer
            //Begin #76458 - added value for parameter acctType
            //#79574 - modified the parameters to pass in vault buy and sell values

            //Begin #12327: Check app's status and deploan
            _bRegDOnUsAcct = false;

            if (_tlTranSet.TellerVars.IsAppOnline)
            {
                string applType = "", depositLoan = "", fmt = "";
                GetAcctTypeDetails(cmbAcctType, ref applType, ref depositLoan, ref fmt);

                /* Begin 13021 */
                /* if (depLoan == GlobalVars.Instance.ML.DP) */
                if (depLoan == GlobalVars.Instance.ML.DP && !String.IsNullOrEmpty(dfAcctNo.Text.Trim()))
                /* End 13021 */
                {
                    if (Phoenix.FrameWork.CDS.DataService.Instance.XmDbStatus != XmDbStatus.Day)
                    {
                        _dpDisplay = new DpDisplay();
                        _dpDisplay.AcctType.Value = cmbAcctType.Text;
                        _dpDisplay.AcctNo.Value = dfAcctNo.Text;
                        _dpDisplay.SelectAllFields = true;
                        _dpDisplay.ActionType = XmActionType.Select;
                        if (!PopulateDepositObjUsingAcctDetails(_dpDisplay, false))   // #19415 - if test
                            CoreService.DataService.ProcessRequest(_dpDisplay);

                        if (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")
                        {
                            _bRegDOnUsAcct = true;
                        }
                        else
                        {
                            _bRegDOnUsAcct = false;
                        }
                    }
                    else
                    {
                        //Begin #80621
                        _dpAcct = new DpAcct();
                        _dpAcct.AcctType.Value = cmbAcctType.Text;
                        _dpAcct.AcctNo.Value = dfAcctNo.Text;
                        _dpAcct.SelectAllFields = true;
                        _dpAcct.ActionType = XmActionType.Select;
                        if (!PopulateDepositObjUsingAcctDetails(_dpAcct, false))   // #19415 - if test
                            CoreService.DataService.ProcessRequest(_dpAcct);

                        if (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")
                        {
                            _bRegDOnUsAcct = true;
                        }
                        else
                        {
                            _bRegDOnUsAcct = false;
                        }
                        //End #80621
                    }
                }
            }
            //End #12327

            //#80621: Added RegD flag parameter
            string whereClause = _tlTranSet.GetTCWhereClause((cbPayrollTran.CodeValue == GlobalVars.Instance.ML.Y), depLoan, isVaultBuy, isVaultSell,
                (_tlTranSet.TellerVars.AdTlControl.BypassAcctVal.Value == GlobalVars.Instance.ML.Y),
                (_tlTranSet.CurTran.TranAcct.SuspectAcct.Value != 1 || (!_tlTranSet.TellerVars.IsAppOnline && !cbRetirement.Checked)),
                (cbRetirement.CodeValue == GlobalVars.Instance.ML.Y),
                (_tlTranSet.CurTran.TranAcct.IRA.Value == GlobalVars.Instance.ML.Y), acctType, ref cmbType,
                _bRegDOnUsAcct, _bIncQuickTCs);	//95645   //#12327 // ML


            cmbName = "frmTlTranCode.cmbTranCode" + cmbType.ToString();

            if (_tlTranSet.TellerVars.ComboCache[cmbName] == null)
            {
                _tlTranSet.TellerHelper.TlWhereClause.Value = whereClause;
                CallXMThruCDS("TranCodePopulate");
                _tlTranSet.TellerVars.ComboCache[cmbName] = _tlTranSet.TellerHelper.TlTranCode.Constraint.EnumValues.Clone() as ArrayList;
            }
            if (!_tlTranSet.CurTran.TlTranCode.IsNull)  // #8096 - tlTranCode is being nulled out during cmbTranCode.Populate
                holdTlTranCode = _tlTranSet.CurTran.TlTranCode.Value;
            cmbTranCode.Populate(_tlTranSet.TellerVars.ComboCache[cmbName], null);

			//8837_EnableOnUsTc = (_tlTranSet.TellerVars.AdTlControl.EnableOnUsTc.Value == GlobalVars.Instance.ML.Y && _tlTranSet.CurTran.TranAcct.DepLoan.Value == "RM");	// #79370

        }

        private void PopulateInventoryPacketCombo()    //#140772
        {
            CallXMThruCDS("InventoryPacketComboPopulate");
            _tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbInventoryPacket"] = _tlJournal.PacketId.Constraint.EnumValues;
            cmbInventoryPacket.Populate(_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbInventoryPacket"], null);
        }

        private void PopulateMiscCombos()
        {
            if (_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbUtility"] == null)
            {
                _tlTranSet.TellerHelper.TlWhereClause.Value = "Passbook";
                CallXMThruCDS("MiscComboPopulate");
                _tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbUtility"] = _tlJournal.UtilityId.Constraint.EnumValues;
                _tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbUmbCode"] = _tlJournal.UmbCode.Constraint.EnumValues;
                _tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbChannel"] = _tlJournal.ChannelId.Constraint.EnumValues; //#79506
                _tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbEndPoint"] = _tlJournal.Endpoint.Constraint.EnumValues;
                _tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbPassbookType"] = _tlTranSet.TellerHelper.FormId.Constraint.EnumValues.Clone() as ArrayList;
                _tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbInventoryType"] = _tlJournal.TypeId.Constraint.EnumValues;   //#140772
                _tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbUmbCode2"] = _tlJournal.UmbCode2.Constraint.EnumValues; //126205

            }

            cmbUtility.Populate(_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbUtility"], null);
            cmbUmbCode.Populate(_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbUmbCode"], null);
            cmbChannel.Populate(_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbChannel"], null);//79506
            cmbEndPoint.Populate(_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbEndPoint"], null);
            cmbPassbookType.Populate(_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbPassbookType"], null);
            cmbRegCC.Populate(_tlTranSet.TellerHelper.RegCC.Constraint.EnumValues, null);
            cmbInventoryType.Populate(_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbInventoryType"], null);//140772
        }

        private void SetTotalDebitsAndCredits()
        {
            _tlTranSet.CalculateDrCrForTranSet();
            dfTotalCredits.UnFormattedValue = _tlTranSet.TotalCredits.Value;
            dfTotalDebits.UnFormattedValue = _tlTranSet.TotalDebits.Value;
            dfDifference.UnFormattedValue = _tlTranSet.TotalDebits.Value - _tlTranSet.TotalCredits.Value;
            dfTotalCredits1.UnFormattedValue = dfTotalCredits.UnFormattedValue;
            dfTotalDebits1.UnFormattedValue = dfTotalDebits.UnFormattedValue;
            dfDifference1.UnFormattedValue = dfDifference.UnFormattedValue;
        }

        private void CalcDefaultField(PdfCurrency compField)
        {
            CalcDefaultField(compField, false);
        }

        private void CalcDefaultField(PdfCurrency compField, bool isInvItem)
        {
            if (!isInvItem) //#140772
            {
                if (compField.UnFormattedValue == null && compField.PhoenixUIControl.BusObjectProperty != null &&
                    compField.PhoenixUIControl.BusObjectProperty.Value == null)
                    return;
                // #29161 ver402 - In the below IF statement, extra condition is added to exclude tc176, 179, 187
                // #29161 ver403 - Extra condition removed
                if (compField.UnFormattedValue != null && compField.PhoenixUIControl.BusObjectProperty != null &&
                    compField.PhoenixUIControl.BusObjectProperty.Value != null &&
                    Convert.ToDecimal(compField.UnFormattedValue) == Convert.ToDecimal(compField.PhoenixUIControl.BusObjectProperty.Value))
                    return;
            }
            string xmlField = GetXmlTag(compField);
            MoveAmtScreensToObject();
            MoveMiscScreensToObject(miscTCFields);  //#76425

            _tlTranSet.CalculateDefaultField(xmlField);

            MoveAmtObjectsToScreen();
            MoveMiscObjectsToScreen(miscTCFields); //#76425

            if (_tlTranSet.TriggerCashInOut(xmlField, !_tlTranSet.IsTellerCaptureTran)) // #140895 - passed  IsTellerCaptureTran
            {
                HandleCashInOutDenom("CashInDenom");
            }
            EnableDisableWithholding(); // #140782
        }

        private void ClearAll() //#41417
        {
            //Clears the screen

            // Begin #76041
            //Begin #140895
            if (_tlTranSet.IsTellerCaptureTran || _tlTranSet.IsTellerCaptureCheckOnlyTran)  //#102719
            {
                if (_tellerCapture != null && _tellerCapture.IsTransactionInProgress)
                    HandleCancelAVTCTransaction(false);
                _tlCaptureTranXML = null;   //#102719
                if (picTabs.SelectedIndex != (int)TAB.QuickTran)    //#122532
                    ResetFlagsAndInitializeTranSet("ClearAllClicked");
                return;
            }
            //End #140895

            if (_tlTranSet.TellerVars.IsAppOnline)
            {
                this.dfAcctNickname.UnFormattedValue = string.Empty;
                _tlTranSet.CurTran.TranAcct.AcctNickname.Value = string.Empty;
                this._myRim = 0;
                myPostAccess = string.Empty;    //#5700
                myEditAccess = string.Empty;    //#5700
            }
            // End #76041

            cmbAcctType.CodeValue = null;
            SetAcctNoField(null, dfAcctNo, cmbAcctType,
                _tlTranSet.CurTran.TranAcct);
            SetQuickTranCodeField(null, null);
            _tlTranSet.CurTran.CleanUpValues();
            _tlTranSet.CurTran.TfrAcct.CleanUpValues(true);
            _tlTranSet.CurTran.RefAcct.CleanUpValues(true);
            dfAcctNickname.UnFormattedValue = string.Empty;     //#76041
            if (_tlTranSet.CurTran.TranAcct.AcctType.IsNull || _tlTranSet.CurTran.TranAcct.AcctNo.IsNull)
                setTitleBarName(_tlTranSet.CurTran.TranAcct.RimNo.Value, false);    //#8690
            MoveAmtObjectsToScreen();
            MoveAcctObjectsToScreen(dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct);
            MoveAcctObjectsToScreen(dfRefAcctNo, cmbRefAcctType, _tlTranSet.CurTran.RefAcct);
            MoveMiscObjectsToScreen(miscTCFields);
            //cmbAcctType.Focus();  //#41417 comment out

            // WI#14075 - clear out noncustomer scenario when "clear all" is clicked
            this.Workspace.Variables["NonCust"] = null;
            this.Workspace.Variables["NonCustRimNo"] = null;
            dfAcctNo.Enabled = true;
            cmbAcctType.Enabled = true;
            this.lblNonCustomer.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
            if (IsOnUsTCEnabled)    //#39025
                cmbOnUsTc.CodeValue = null;
            ResetWorkspaceVariables();//#99011
            UpdateView(); //Force refresh
        }

        //Begin Bug #99011
        private void ResetWorkspaceVariables()
        {
            this.Workspace.Variables["CurAcctNo"] = null;
            this.Workspace.Variables["CurAcctType"] = null;
            this.Workspace.Variables["CurRimNo"] = null;
            this.Workspace.Variables["DepLoan"] = null;
            this.Workspace.Variables["NonCust"] = null;
            this.Workspace.Variables["NonCustRimNo"] = null;
            this.Workspace.Variables["CurAcctId"] = null; //103714
        }
        //End Bug #99011

        private void CallXMThruCDS(string origin)
        {
            try
            {
                if (origin == "AcctTypePopulate")
                {
                    Phoenix.FrameWork.CDS.DataService.Instance.EnumValues(_tlTranSet.TellerHelper, _tlTranSet.TellerHelper.AcctType);
                }
                else if (origin == "MiscComboPopulate")
                {
                    if (_tlJournal == null)
                        _tlJournal = new TlJournal();

                    _tlJournal.OutputType.Value = 10; // #79506, #09318

                    Phoenix.FrameWork.CDS.DataService.Instance.EnumValues(_tlJournal, _tlJournal.UtilityId,
                        _tlJournal.UmbCode, _tlJournal.Endpoint, _tlJournal.ChannelId, _tlJournal.TypeId, _tlJournal.UmbCode2); //126205: Added _tlJournal.UmbCode2  //#79506 #140772 - added type and packet id
                    Phoenix.FrameWork.CDS.DataService.Instance.EnumValues(_tlTranSet.TellerHelper,
                        _tlTranSet.TellerHelper.FormId);
                }
                else if (origin == "InventoryPacketComboPopulate")
                {
                    if (_tlJournal == null)
                        _tlJournal = new TlJournal();

                    _tlJournal.OutputType.Value = 10; // #79506, #09318
                    _tlJournal.TypeId.Value = Convert.ToDecimal(cmbInventoryType.CodeValue);

                    Phoenix.FrameWork.CDS.DataService.Instance.EnumValues(_tlJournal, _tlJournal.PacketId);
                }
                else if (origin == "TranCodePopulate")
                {
                    Phoenix.FrameWork.CDS.DataService.Instance.EnumValues(_tlTranSet.TellerHelper,
                        _tlTranSet.TellerHelper.TlTranCode);
                }
                else if (origin == "RecordFailedAccess")
                {
                    Phoenix.FrameWork.CDS.DataService.Instance.ProcessRequest(_adGbRsmFailedAccess);
                }
                else if (origin == "BookTransactions")
                {
                    Phoenix.FrameWork.CDS.DataService.Instance.ProcessCustomAction(_accountHistory, "BookTransactions");
                }
                else if (origin == "UpdatePbLastLine")
                {
                    Phoenix.FrameWork.CDS.DataService.Instance.ProcessCustomAction(passbookAcctDetails, "UpdatePbLastLine");
                }
				//Begin #79510, 09218
				else if (origin == "GetAcqTranAddlInfo")
				{
					Phoenix.FrameWork.CDS.DataService.Instance.ProcessRequest(_tlJournalAddlInfo);
				}
				//End #79510, 09218
				//Begin #80617
				else if (origin == "EscrowAgent")
				{
                    if (!_tlTranSet.CurTran.TranAcct.AcctType.IsNull && !_tlTranSet.CurTran.TranAcct.AcctNo.IsNull)
					{
						if (_tlJournal == null)
							_tlJournal = new TlJournal();

						Int16 tempOutputType = _tlJournal.OutputType.Value;
						_tlJournal.OutputType.Value = 10;
						_tlJournal.AcctType.Value = _tlTranSet.CurTran.TranAcct.AcctType.Value;
						_tlJournal.AcctNo.Value = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
						Phoenix.Windows.Client.Helper.PopulateCombo(cmbLnEscrowAgent, _tlJournal, _tlJournal.Loan3rdPartyId);
						_tlJournal.OutputType.Value = tempOutputType;

						//Phoenix.FrameWork.CDS.DataService.Instance.EnumValues(_tlJournal, _tlJournal.LnEscrowAgent);
						//cmbLnEscrowAgent.Populate(_tlJournal.LnEscrowAgent.EnumValues);
						//cmbLnEscrowAgent.Refresh();
					}
				}
				//End #80617

            }
            catch (PhoenixException pe)
            {
                PMessageBox.Show(pe, MessageBoxButtons.OK);
            }
        }
        //#401 - removed string trancode signature
        //private void CallOtherForms(EnumCallOtherForms origin)  //#76047 added this overloaded fuction
        //{
        //    PfwStandard tempWin = null;

        //    #region BondPurchase
        //    // Begin #76047
        //    if (origin == EnumCallOtherForms.BondPurchase)
        //    {
        //        tempWin = Helper.CreateWindow("phoenix.client.bondpurchase", "Phoenix.Client.Global.GbBondPurchase", "frmGbBondPurchaseList");
        //        tempWin.InitParameters("J",     //! Valid values = R-Rim Hist  J-Journal  A-Auto Tfr  C-Customer/Rim
        //            "-2",
        //            _tlTranSet.CurTran.TranAcct.RimNo.Value,
        //            _tlTranSet.CurTran.TranAcct.TranCode.Value, //#3401 - replaced trancode with this
        //            -1,         //This is the join ID
        //            _tlTranSet);
        //    }
        //    // End #76047
        //    #endregion

        //    #region Call The Window
        //    // Begin #76047
        //    if (tempWin != null)
        //    {
        //        formLostFocus = true;
        //        tempWin.Closed += new EventHandler(tempWin_Closed);
        //        tempWin.Workspace = this.Workspace;
        //        tempWin.Show();
        //    }
        //    // End #76047
        //    #endregion
        //}
        //#3401 - Commented out
        //private void CallOtherForms(EnumCallOtherForms origin)  //#76047 added this overloaded fuction
        //{
        //    #region Bond Purchase
        //    // Begin #76047
        //    //By default use the current tran code
        //    CallOtherForms(origin, _tlTranSet.CurTran.TranAcct.TranCode.Value.ToString()); //#3401
        //    // End #76047
        //    #endregion
        //}


		ArrayList _imageData = new ArrayList();
		private void CallOtherForms(string origin)
        {
			string acctNo = null;
            string acctType = null;
            string depLoan = null;
            string depType = null;
            int rimNo = -1;
            int acctId = 0;
            int partCount = 0; //Bug#92188
            PfwStandard tempWin = null;
            PfwStandard tempDlg = null;
            string adapter = null;  // 76458
            int online = 0; //#60722
            string acctNoMask = null; //Task#115614

            //Begin Bug#92189
            colHistorySupport = "";
            colAdapterType = "";
            colCrTcSupport = "";
            colDrTcSupport = "";
            //End Bug#92189

            _tempExceptionHoldInfo = null; //Task #134375

            if (origin == "Messenger")
            {
                if (!_tlTranSet.TellerVars.IsAppOnline)
                    return;
            }

            if (Workspace.Screens[12094] != null)	// if cash count window is created , then do not create any other window
            {
                return;
            }

            //Begin  #75604. Before navigate to any other window reset the Decimal on the basis of userType. then new window will set decimal config on the basis of individual code written in them
            if (GlobalVars.UserType == "Teller")
            {
                #region config
                PdfCurrency.ApplicationAssumeDecimal = (_tlTranSet.TellerVars.AdTlControl.AssumeDecimals.Value == GlobalVars.Instance.ML.Y);
                CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                #endregion
            }
            else
            {
                #region config
                PdfCurrency.ApplicationAssumeDecimal = false;
                CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                #endregion
            }
            //End  #75604
            // if (picTabs.SelectedIndex == 0 || origin == "CheckInfo") // #74015
            if (((picTabs.SelectedIndex == 0 || _creatingTlCaptureTranSet || picTabs.SelectedIndex == (int)TAB.QuickTran) && origin != "OnUsSigners" && origin != "OnUsDisplayClick")    // #140895 - check for _creatingTlCaptureTranSet #87755
                || origin == "CheckInfo")                           // End #74015
            {
                #region CheckInfo
                acctNo = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
                acctType = _tlTranSet.CurTran.TranAcct.AcctType.Value;
                depLoan = _tlTranSet.CurTran.TranAcct.DepLoan.Value;
                rimNo = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                depType = _tlTranSet.CurTran.TranAcct.DepType.Value;
                acctId = _tlTranSet.CurTran.TranAcct.AcctId.Value;
                _holdRimNo = rimNo; // #8107
                #endregion
            }
            else if (picTabs.SelectedIndex == 3
                && frmGloAccountListRim != null && frmGloAccountListRim.gridAccountListSum.Count > 0)
            {
                #region frmGloAccountListRim
                acctType = Convert.ToString(frmGloAccountListRim.colAcctType.UnFormattedValue); //Bug #112698
                acctNo = Convert.ToString(frmGloAccountListRim.colAcctNo.UnFormattedValue); //Bug #112698
                depLoan = Convert.ToString(frmGloAccountListRim.colDepLoan.UnFormattedValue); //Bug #112698
                if (frmGloAccountListRim.colAdapter.UnFormattedValue != null)
                {
                    adapter = frmGloAccountListRim.colAdapter.UnFormattedValue.ToString();
                }
                if (frmGloAccountListRim.colDepType.UnFormattedValue != null)
                    depType = frmGloAccountListRim.colDepType.UnFormattedValue.ToString();
                if (frmGloAccountListRim.colAcctId.UnFormattedValue != null)
                    acctId = Convert.ToInt32(frmGloAccountListRim.colAcctId.UnFormattedValue);
                rimNo = searchRimNo;

                //Begin Bug#92188
                if (depLoan == GlobalVars.Instance.ML.LN)
                {
                    partCount = Convert.ToInt16(frmGloAccountListRim.colPartCount.UnFormattedValue);
                }
                //End Bug#92188

                acctNoMask = frmGloAccountListRim.colAcctNoMask.UnFormattedValue.ToString().Trim(); //Task#115614

                //Begin Bug#92189
                if (depLoan == GlobalVars.Instance.ML.Ext || depLoan == "EX")
                {
                    // Begin Task#115610 - Call Method to Set These Fields
                    //colHistorySupport = Convert.ToString(frmGloAccountListRim.colHistorySupport.UnFormattedValue).Trim(); //Bug #112463
                    //colAdapterType = Convert.ToString(frmGloAccountListRim.colAdapterType.UnFormattedValue).Trim(); //Bug #112463
                    //colCrTcSupport = Convert.ToString(frmGloAccountListRim.colCrTcSupport.UnFormattedValue).Trim(); //Bug #112463
                    //colDrTcSupport = Convert.ToString(frmGloAccountListRim.colDrTcSupport.UnFormattedValue).Trim(); //Bug #112463
                    SetAdapterFields();
                    // End Task#115610
                }
                //End Bug#92189

                #endregion
            }
            //Begin Task#89976
             if (picTabs.SelectedIndex == (int)TAB.QuickTran && QuickAccountSelectedRow != null) //#87749 //Task 94607/94608
            {
                depLoan = QuickAccountSelectedRow.GetStringValue("DepLoan").Trim();
                rimNo = QuickAccountSelectedRow.GetIntValue("RimNo");

                if (depLoan != GlobalVars.Instance.ML.RM)
                {
                    acctNo = QuickAccountSelectedRow.GetStringValue("AcctNo").Trim();
                    acctType = QuickAccountSelectedRow.GetStringValue("AcctType").Trim();
                    depLoan = QuickAccountSelectedRow.GetStringValue("DepLoan").Trim();
                    depType = QuickAccountSelectedRow.GetStringValue("DepType").Trim();
                    acctId = QuickAccountSelectedRow.GetIntValue("AcctId");
                    adapter = QuickAccountSelectedRow.GetStringValue("Adapter");

                    //Begin Bug#92188
                    if (depLoan == GlobalVars.Instance.ML.LN)
                    {
                        partCount = QuickAccountSelectedRow.GetIntValue("PartCount");
                    }
                    //End Bug#92188

                    //Begin Bug#92189
                    if (depLoan == GlobalVars.Instance.ML.Ext || depLoan == "EX")
                    {
                        // Begin Task#115610 - Call Method to Set These Fields
                        //colHistorySupport = QuickAccountSelectedRow.GetStringValue("HistorySupport").Trim();
                        //colAdapterType = QuickAccountSelectedRow.GetStringValue("AdapterType").Trim();
                        //colCrTcSupport = QuickAccountSelectedRow.GetStringValue("CrTcSupport").Trim();
                        //colDrTcSupport = QuickAccountSelectedRow.GetStringValue("DrTcSupport").Trim();
                        SetAdapterFields();
                        // End Task#115610
                    }
                    //End Bug#92189
                }

            }
            //End Task#89976

                //if (picTabs.SelectedIndex == 0 && focusAcctField == cmbTfrAcctType &&
                //    origin == "RestrictionsClick") // #80620 - changed to below:
                if ((picTabs.SelectedIndex == 0 || picTabs.SelectedIndex == (int)TAB.QuickTran) &&
                origin == "OnUsRestrictionsClick")  //#87755
            {
                #region CheckInfo
                acctNo = _tlTranSet.CurTran.TfrAcct.AcctNo.Value;
                acctType = _tlTranSet.CurTran.TfrAcct.AcctType.Value;
                depLoan = _tlTranSet.CurTran.TfrAcct.DepLoan.Value;
                rimNo = _tlTranSet.CurTran.TfrAcct.RimNo.Value;
                depType = _tlTranSet.CurTran.TfrAcct.DepType.Value;
                acctId = _tlTranSet.CurTran.TfrAcct.AcctId.Value;
                #endregion
            }

            try
            {
                if (origin == "DisplayClick")
                {
                    /*begin #63110*/
                    if (pbDisplay.Enabled)
                    {

                    #region Display Click
                    if (depLoan == GlobalVars.Instance.ML.DP)
                    {
                        if (depType == GlobalVars.Instance.ML.Tran)
                        {
                            tempWin = Helper.CreateWindow("phoenix.client.dpdisplay", "Phoenix.Client.Account.Dp", "frmDpDisplayTran");
                            //Begin #73908
                            if (picTabs.SelectedIndex == (int)TAB.InputTran)
                            {
                                tempWin.InitParameters(acctType, acctNo, "Teller");
                            }
                            //End #73908
                            else
                            {
                                tempWin.InitParameters(acctType, acctNo);
                            }
                        }
                        else
                        {
                            tempWin = Helper.CreateWindow("phoenix.client.dpdisplay", "Phoenix.Client.Account.Dp", "frmDpDisplayTime");
                            //Begin #73908
                            if (picTabs.SelectedIndex == (int)TAB.InputTran)
                            {
                                tempWin.InitParameters(acctType, acctNo, "Teller");
                            }
                            //End #73908
                            else
                            {
                                tempWin.InitParameters(acctType, acctNo);
                            }
                        }
                    }
                    else if (depLoan == GlobalVars.Instance.ML.LN)
                    {
                            //Begin 60647
                            //if (Convert.ToInt32(frmGloAccountListRim.colPartCount.UnFormattedValue) == -2)      // part display
                            //Bug#92188
                            if (partCount == -2)
                            {
                                tempWin = CreateWindow("Phoenix.Client.LnDisplayEdit", "Phoenix.Client.Loan", "frmLnPartDisplay");
                                tempWin.InitParameters(acctType, acctNo);
                            }
                            //End 60647
                            else
                            {
                        tempWin = Helper.CreateWindow("phoenix.client.lndisplay", "Phoenix.Client.Loan", "frmLnDisplay");
                        tempWin.InitParameters(acctType, acctNo);
                    }
                        }
                    else if (depLoan == GlobalVars.Instance.ML.SD)
                    {
                        tempWin = Helper.CreateWindow("phoenix.client.sddisplay", "Phoenix.Client.Sdb", "frmSdDisplay");
                        tempWin.InitParameters(acctType, acctNo, acctId);
                    }
                    else if (depLoan == GlobalVars.Instance.ML.CM)  /*Begin #7860*/
                    {
                        tempWin = Helper.CreateWindow("phoenix.client.cmtdisplay", "Phoenix.Client.Commitment", "frmIraLnCommitmentDisplay");
                        tempWin.InitParameters(acctType, acctNo, rimNo);
                    }       /*End #7860*/
                    else if (depLoan == GlobalVars.Instance.ML.Ext || depLoan == "EX")
                    {
                        //Begin #76458, DUT 47
                        if ((picTabs.SelectedIndex == 3 && frmGloAccountListRim != null && frmGloAccountListRim.gridAccountListSum.Count > 0) ||
                               (picTabs.SelectedIndex == (int)TAB.QuickTran && QuickAccountSelectedRow.RowState != DataRowState.Detached)) // Bug#92189

                        {
                            if (adapter == "Y")
                            {
                                ShowFormHelper.XAMLWindow(this, "ExAcctDisplay", acctType, acctNo, rimNo);
                            }
                            else
                            {
                                tempWin = Helper.CreateWindow("phoenix.client.exAcctdisplay", "Phoenix.Client.Ex", "frmOnExAcctDisp1");
                                tempWin.InitParameters(acctType, acctNo);
                            }
                        }
                        else if (_tlTranSet.IsExternalAdapterAcct(_tlTranSet.CurTran.TranAcct.AcctType.Value))
                        {
                            //Launch XAML Window
                            ShowFormHelper.XAMLWindow(this, "ExAcctDisplay", _tlTranSet.CurTran.TranAcct.AcctType.Value, _tlTranSet.CurTran.TranAcct.AcctNo.Value, _tlTranSet.CurTran.TranAcct.RimNo.Value);
                        }
                        else
                        {
                            tempWin = Helper.CreateWindow("phoenix.client.exAcctdisplay", "Phoenix.Client.Ex", "frmOnExAcctDisp1");
                            tempWin.InitParameters(acctType, acctNo);
                        }
                        //End #76458
                    }
                        //Begin  #60647
                        else if (depLoan == GlobalVars.Instance.ML.Atm)      // atm display
                        {
                            string sPanNo = string.Empty;
                            string cardExists = "N";
                            string supportMembers = "N";
                            CustomerSearch _atmMemberCountSearch;
                            _atmMemberCountSearch = new CustomerSearch();
                            _atmMemberCountSearch.GetAtmCardDetails(acctNo);


                            if (_atmMemberCountSearch.AtmMemberNoCountDAccess.Value > 1)
                            {
                                CallOtherForms("AtmCard");
                                return;
                            }
                            /*begin #104474 - If SupportMember was checked then display AtmAccountDisplay*/                           
                            _atmMemberCountSearch.GetAtmCardDetails(acctType,acctNo);
                            _atmMemberCountSearch.GetAtmInfo(frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), ref cardExists, ref supportMembers, ref atmMemberNo);
                            if (supportMembers == "Y")
                            {
                                CallOtherForms("AtmDisplay");
                            }
                            else
                            {
                                if (_atmMemberCountSearch.AtmMemberNoCountDAccess.IntValue > 1)
                                {
                                    CallOtherForms("AtmCard");
                                }
                                else
                                {
                                    CallOtherForms("AtmCardDisplay");
                                }
                            }
                            /*end #104474*/
                        }
                        //End #60647
                        else if (depLoan == GlobalVars.Instance.ML.RM)
                    {
                        tempWin = Helper.CreateWindow("phoenix.client.rmdisplay", "Phoenix.Client", "frmRmDisplay");
                        tempWin.InitParameters(rimNo);
                    }
                    #endregion
                }
                    /*end #63110*/
                        }
                        // Begin #74015
                        else if (origin == "OnUsDisplayClick")
                {
                    #region OnUsDisplayClick

                    if (_tlTranSet.CurTran.TfrAcct.DepLoan.Value == GlobalVars.Instance.ML.DP)
                    {
                        string timeTran = _tlTranSet.CurTran.TfrAcct.DepType.Value == GlobalVars.Instance.ML.Tran ? "frmDpDisplayTran" : "frmDpDisplayTime";
                        tempWin = Helper.CreateWindow("phoenix.client.dpdisplay", "Phoenix.Client.Account.Dp", timeTran);
                        tempWin.InitParameters(_tlTranSet.CurTran.TfrAcct.AcctType.Value, _tlTranSet.CurTran.TfrAcct.AcctNo.Value, "Teller"); //#73908. OnUsDisplay is Teller Specific Button
                    }
                    else if (_tlTranSet.CurTran.TfrAcct.DepLoan.Value == GlobalVars.Instance.ML.LN)
                    {
                        tempWin = Helper.CreateWindow("phoenix.client.lndisplay", "Phoenix.Client.Loan", "frmLnDisplay");
                        tempWin.InitParameters(_tlTranSet.CurTran.TfrAcct.AcctType.Value, _tlTranSet.CurTran.TfrAcct.AcctNo.Value);
                    }
                    else if (_tlTranSet.CurTran.TfrAcct.DepLoan.Value == GlobalVars.Instance.ML.SD)
                    {
                        tempWin = Helper.CreateWindow("phoenix.client.sddisplay", "Phoenix.Client.Sdb", "frmSdDisplay");
                        tempWin.InitParameters(_tlTranSet.CurTran.TfrAcct.AcctType.Value, _tlTranSet.CurTran.TfrAcct.AcctNo.Value, _tlTranSet.CurTran.TfrAcct.AcctId);
                    }
                    #endregion
                }
                // End #74015
                else if (origin == "RestrictionsClick" || origin == "OnUsRestrictionsClick") // #80620
                {
                    #region Restrictions Click
                    tempWin = Helper.CreateWindow("Phoenix.Client.GbHoldStop", "Phoenix.Client.HoldStop", "frmGbStopHold");
                    //Begin #83857 - Pass parameter as Teller to identify that the window is accessed from Teller window
                    _pbIsTeller = true;
                    tempWin.InitParameters(acctType, acctNo, depLoan, rimNo,null,null,null,null,null,null,null,null,_pbIsTeller);
                    //End #83857
                    #endregion
                }
                else if (origin == "HistoryClick")
                {
                    #region History Click

                    if (depLoan == GlobalVars.Instance.ML.RM)
                    {
                        //pbHistory.NextScreenId = Phoenix.Shared.Constants.ScreenId.RmHistory;
                        tempWin = Helper.CreateWindow("phoenix.client.rmhistory", "Phoenix.Client", "frmRmHistory");
                        tempWin.InitParameters(rimNo);
                    }
                    else if (depLoan == "EX" || depLoan == "EXT") //#2677 - Added EXT
                    {
                        //Begin #76458
                        if (_tlTranSet.IsExternalAdapterAcct(acctType))
                        {
                            //Launch XAML Window
                            // ShowFormHelper.XAMLWindow(this, "ExAcctHistory", acctType, acctNo, rimNo); //60647
                            //Begin #60647
                            if (picTabs.SelectedIndex == (int)TAB.CustSummary)
                            {
                                CreateExHistoryMenu();
                                pbHistory.ImageButton.DropDownMenu.Show(pbHistory.ImageButton as Control, new Point(0, pbHistory.ImageButton.Height));
                            }
                            else
                            {
                                ShowFormHelper.XAMLWindow(this, "ExAcctHistory", acctType, acctNo, rimNo);//This is original Teller Histroy so it should remain same
                            }
                            //End 60647
                        }
                        //End #76458
                    }
                    //Begin 60647
                    else if (depLoan == GlobalVars.Instance.ML.Atm)
                    {
                        atmPanNo = "";
                        //Bug#92189
                        //if (_acctSearchBusObj.GetAtmCardPan(frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), ref atmPanNo, ref atmMemberNo))
                        if (_acctSearchBusObj.GetAtmCardPan(acctNo, acctType, ref atmPanNo, ref atmMemberNo))
                        {
                            tempWin = CreateWindow("phoenix.client.atmtchistory", "Phoenix.Client.AtmTcHistory", "frmAtmTcHistory");
                            tempWin.InitParameters(atmPanNo);
                        }
                    }
                    //End 60647
                    else
                    {
                        //pbHistory.NextScreenId = Phoenix.Shared.Constants.ScreenId.DpTCHistory;
                        /*Begin #102380*/
                        //tempWin = Helper.CreateWindow("phoenix.client.dplntchistory", "Phoenix.Windows.Client", "frmDpLnTCHistory");
                        if (depLoan == GlobalVars.Instance.ML.SD)
                        {
                            tempWin = CreateWindow("phoenix.client.sdhistory", "Phoenix.Client.SD", "frmSdTCHistory");      // #99017
                            tempWin.InitParameters(UserConstants.SD_Online, acctType, acctNo, acctId);                      // #99017
                           // #99017 tempWin.InitParameters(acctType, acctNo, depLoan, "N", acctId);
                        }
                        else
                        {
                            tempWin = Helper.CreateWindow("phoenix.client.dplntchistory", "Phoenix.Windows.Client", "frmDpLnTCHistory");	// #99017 - moved to else
                            /*End #102380*/
                            //Begin #73908
                            if (picTabs.SelectedIndex == (int)TAB.InputTran)
                            {
                                tempWin.InitParameters(acctType, acctNo, depLoan, "N", "Teller");
                            }
                            //End #73908
                            else
                            {
                                tempWin.InitParameters(acctType, acctNo, depLoan, "N");
                            }

                        }
                    }

                    #endregion
                }
                //Begin 60647
                else if (origin == "ExHistory")
                {
                    //Bug#92189
                    //tempWin = Phoenix.Windows.Client.ShowFormHelper.XAMLWindow(this, "ExAcctHistory", frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), Convert.ToInt32(frmGloAccountListRim.colRimNo.UnFormattedValue));
                    tempWin = Phoenix.Windows.Client.ShowFormHelper.XAMLWindow(this, "ExAcctHistory", acctType, acctNo, rimNo);
                    
                }
                else if (origin == "TcLog")
                {
                    if (frmGloAccountListRim != null || QuickAccountSelectedRow != null)// 9200 Task#115614
                    {
                        tempWin = CreateWindow("phoenix.client.exAcctdisplay", "phoenix.client.exAcctdisplay", "frmExAcctTCLog");
                        //Begin Task#115614
                        //tempWin.InitParameters(frmGloAccountListRim.colAcctType.UnFormattedValue.ToString().Trim(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString().Trim(), frmGloAccountListRim.colAcctNoMask.UnFormattedValue.ToString().Trim(), frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim());
                        tempWin.InitParameters(acctType, acctNo, acctNoMask, colAdapterType);
                        //End Task#115614
                    }

                }
                // End 60647
                else if (origin == "ItemCapture")
                {
                    if (_tlTranSet.EnableChecksOnlyTran && !_tlTranSet.CaptureAllCheckTranItems)    //#102719
                        LoadChecksOnlyItems(true);   //#110046
                    else
                        LoadChecksOnlyItems(false);   //#110046

                    #region ItemCapture
                    tempWin = Helper.CreateWindow("phoenix.client.tlcaptureditems", "Phoenix.Client.TlCapturedItems", "frmTlCapturedItems");
                    tempWin.InitParameters(false, null, null, null, null, null, _tlTranSet);
                    #endregion
                }
                else if (origin == "Charges")
                {
                    //Begin #92886
                    if (picTabs.SelectedTab == tabEasyCapture)
                    {
                        var tran = (_quickTranWindow.CurTranId > 0 ? _quickTranWindow.GetCurrentEasyCaptureTran(_quickTranWindow.CurTranId) : _quickTranWindow.GetCurrentEasyCaptureTran());
                        if (tran != null && tran.MappedTranIndex > 0)
                        {
                            _tlTranSet.SelectTransaction(tran.MappedTranIndex, false);
                        }
                        else
                        {
                            return;
                        }

                    }
                    //End #92886

                    #region Charges
                    tempWin = Helper.CreateWindow("phoenix.client.tlcaptureditems", "Phoenix.Client.TlCapturedItems", "frmTlCharges");
                    tempWin.InitParameters(-1, _tlTranSet);
                    #endregion
                }
                else if (origin == "OdCcOverride")
                {

                    tempDlg = Helper.CreateWindow("phoenix.client.tloverride", "Phoenix.Windows.TlOverride", "dlgTlWaivePostOdCC");
                    tempDlg.InitParameters("TranCodePost", _tlTranSet.GetTranSetOdCcOvrdsCollection());

                }

                else if (origin == "Override" || origin == "CTROverride" || origin == "SharePrimAcctOvr")	//#76029
                {
                    #region Overrides
                    tempWin = Helper.CreateWindow("phoenix.client.tloverride", "Phoenix.Windows.TlOverride", "dlgTlSupervisorOverride");
                    if (origin == "Override")
                    {
                        tempWin.InitParameters("TranCodePost", _tlTranSet.GetTranSetOvrdsCollection(), _tlTranSet); //#79314
                        dlgInformation.Instance.HideInfo();
                    }
                    else
                        tempWin.InitParameters("TranCodeCTR", _tlJournalOvrd);
                    //tempWin.Closed +=new EventHandler(tempWin_Closed);
                    #endregion
                }
                else if (origin == "CashInDenom" || origin == "CashOutDenom" || origin == "PostCashOutDenom")
                {
                    //Begin #87731
                    ArrayList sourceList;
                    ArrayList targetList;

                    if (picTabs.SelectedTab == tabEasyCapture && (origin == "CashInDenom" || origin == "CashOutDenom"))
                    {

                        var sourceTran = cashDenomCallType == "CashInDenom" ? _quickTranWindow.TranSet.CashInTran : _quickTranWindow.TranSet.CashOutTran;

                        if (sourceTran != null && sourceTran.MappedTranIndex > 0)
                        {
                            _tlTranSet.SelectTransaction(sourceTran.MappedTranIndex, false);
                        }
                        else
                        {
                            _tlTranSet.CurTran = new TlTransaction();
                            sourceList = cashDenomCallType == "CashInDenom" ? _quickTranWindow.TranSet.CashIns : _quickTranWindow.TranSet.CashOuts;
                            targetList = cashDenomCallType == "CashInDenom" ? _tlTranSet.CurTran.CashInDenoms : _tlTranSet.CurTran.CashOutDenoms;

                            foreach (var denom in sourceList)
                            {
                                targetList.Add(denom);
                            }
                        }

                        if (cashDenomCallType == "CashInDenom")
                        {
                            //if (_quickTranWindow.TranSet.CashIns.Count > 0 && _tlTranSet.CurTran.CashInDenoms.Count == 0)
                            if (_quickTranWindow.TranSet.CashIns.Count > 0)
                            {
                                targetList = _tlTranSet.CurTran.CashInDenoms;
                                sourceList = _quickTranWindow.TranSet.CashIns;
                            }
                            else
                            {
                                targetList = _quickTranWindow.TranSet.CashIns;
                                sourceList = _tlTranSet.CurTran.CashInDenoms;
                            }
                        }
                        else
                        {
                            sourceList = _quickTranWindow.TranSet.CashOuts;
                            targetList = _tlTranSet.CurTran.CashOutDenoms;
                        }
                        targetList.Clear();
                            foreach (var denom in sourceList)
                            {
                                targetList.Add(denom);
                            }

                        if (cashDenomCallType == "CashInDenom")
                        _tlTranSet.CurTran.CashIn.Value = _quickTranWindow.TranSet.CashIn;
                        else
                            _tlTranSet.CurTran.CashOut.Value = _quickTranWindow.TranSet.CashOut;
                    }
                    //End #87731

                    #region Denoms
                    tempWin = Helper.CreateWindow("phoenix.client.tlcashcount", "Phoenix.Client.TlCashCount", "dlgTlCashCount");
                    if (origin == "CashInDenom")
                    {
                        if (picTabs.SelectedTab == tabEasyCapture)
                        {
                            tempWin.InitParameters(picTabs.SelectedTab == tabEasyCapture ? _quickTranWindow.TranSet.CashIn : _tlTranSet.CurTran.CashIn.Value, CoreService.Translation.GetListItemX(ListId.DENOMTRANTYPE, "I"), (_tlTranSet.CurTran.TranCode.Value > 0),
                                _quickTranWindow.TranSet.CashIns, _tlTranSet.TellerVars.BranchNo, _tlTranSet.TellerVars.DrawerNo, _tlTranSet.TellerVars.PostingDt,
                                _tlTranSet);
                        }
                        else
                        {
                            tempWin.InitParameters(picTabs.SelectedTab == tabEasyCapture ? _quickTranWindow.TranSet.CashIn : _tlTranSet.CurTran.CashIn.Value, CoreService.Translation.GetListItemX(ListId.DENOMTRANTYPE, "I"), (_tlTranSet.CurTran.TranCode.Value > 0),
                            _tlTranSet.CurTran.CashInDenoms, _tlTranSet.TellerVars.BranchNo, _tlTranSet.TellerVars.DrawerNo, _tlTranSet.TellerVars.PostingDt,
                            _tlTranSet);
                    }
                    }
                    else if (origin == "CashOutDenom")
                        tempWin.InitParameters(picTabs.SelectedTab == tabEasyCapture ? _quickTranWindow.TranSet.CashOut : _tlTranSet.CurTran.CashOut.Value, CoreService.Translation.GetListItemX(ListId.DENOMTRANTYPE, "O"), (_tlTranSet.CurTran.TranCode.Value > 0),
                            _tlTranSet.CurTran.CashOutDenoms, _tlTranSet.TellerVars.BranchNo, _tlTranSet.TellerVars.DrawerNo, _tlTranSet.TellerVars.PostingDt,
                            _tlTranSet);
                    else
                    {
                        //Begin #72916
                        //tempWin.InitParameters(_tlTranSet.TranSetTotalCashOut, CoreService.Translation.GetListItemX(ListId.DENOMTRANTYPE, "O"), true,
                        //    _tlTranSet.CashOutDenoms, _tlTranSet.TellerVars.BranchNo, _tlTranSet.TellerVars.DrawerNo, _tlTranSet.TellerVars.PostingDt,
                        //    _tlTranSet);

                        tempWin.InitParameters(_totalCashOutAmount, CoreService.Translation.GetListItemX(ListId.DENOMTRANTYPE, "O"), true,
                            _tlTranSet.CashOutDenoms, _tlTranSet.TellerVars.BranchNo, _tlTranSet.TellerVars.DrawerNo, _tlTranSet.TellerVars.PostingDt,
                            _tlTranSet);
                        //End #72916
                    }
                    //tempWin.Closed +=new EventHandler(tempWin_Closed);
                    #endregion
                }
                else if (origin == "Signers")
                {
                    #region Signers
                    tempWin = Helper.CreateWindow("Phoenix.Client.DpLnSigners", "Phoenix.Client", "frmDpLnSigners");
                    tempWin.InitParameters(acctType, acctNo, rimNo, acctId);
                    #endregion
                }
                #region #9544
                else if (origin == "InstitutionChecksSearch")
                {
                    tempWin = CreateWindow("phoenix.client.checksearch", "Phoenix.Client.Checks", "frmInstitutionCheckSearch");
                    tempWin.Workspace = this.Workspace;
                }
                #endregion
                // Begin #74015
                else if (origin == "OnUsSigners")
                {
                    #region OnUsSigners
                    tempWin = Helper.CreateWindow("Phoenix.Client.DpLnSigners", "Phoenix.Client", "frmDpLnSigners");
                    tempWin.InitParameters(_tlTranSet.CurTran.TfrAcct.AcctType.Value,
                                            _tlTranSet.CurTran.TfrAcct.AcctNo.Value,
                                            _tlTranSet.CurTran.TfrAcct.RimNo.Value,
                                            _tlTranSet.CurTran.TfrAcct.AcctId.Value);
                    #endregion
                }
                // End #74015
                else if (origin == "CTRTransactor")
                {
                    #region CTR Transactor
                    tempWin = Helper.CreateWindow("phoenix.client.ctrtransactorSearch", "Phoenix.Client.CtrCashTransactorSearch", "frmTlCashTransactorSearch");
                    tempWin.Workspace = this.Workspace;	//#79572
                    tempWin.InitParameters(rimNo, acctType, acctNo, _tlTranSet.CurTran.TransactorNos.Value, ScreenId);
                    #endregion
                }
                else if (origin == "CTRTransactions")
                {
                    #region CTR Transactions
                    tempWin = Helper.CreateWindow("phoenix.client.ctrtransactions", "Phoenix.Client.CtrTransactions", "frmTLCTRTransactions");
                    tempWin.InitParameters(_tlTranSet.TellerVars.BranchNo, Shared.Constants.UserConstants.OLD, cTRPTID, ScreenId);
                    #endregion
                }
                else if (origin == "GetGLAcct")
                {
                    #region GL Acct
                    tempWin = Helper.CreateWindow("phoenix.client.glacctsearch", "Phoenix.Client.GlAcctSearch", "frmGlAccountSearch");
                    tempWin.InitParameters(ScreenId, Phoenix.Shared.Constants.UserConstants.ORIGIN_GetAcct, 1, "Teller", false,
                        null, null, null, null, null, null,true); //#73905 - Pass paremeter to GLAccount which sets'Teller' flag to true.
                    //tempWin.Closed +=new EventHandler(tempWin_Closed);
                    #endregion
                }
                // Begin #17047
                else if (origin == "GetAcct")
                {
                    #region Acct
                    tempWin = Helper.CreateWindow("phoenix.client.acctsearch", "Phoenix.Client.Search", "frmGloAccountList");
                    
                    //Begin 87757
                    if (picTabs.SelectedTab == tabEasyCapture)
                    {
                        tempWin.InitParameters(ScreenId, RmAcctPtid, 1, Phoenix.Shared.Constants.UserConstants.ORIGIN_GetAcct, string.Empty, "ALL");
                    }
                    else
                    {
                    tempWin.InitParameters(ScreenId, (searchRimNo > 0 ? searchRimNo : -1), 1, Phoenix.Shared.Constants.UserConstants.ORIGIN_GetAcct, string.Empty, "ALL");
                    }
                    //End 87757
                    //tempWin.Closed +=new EventHandler(tempWin_Closed);
                    #endregion
                }
                // End #17047
                else if (origin == "CheckInfo")
                {
                    #region CheckInfo
                    #region #9723 - Check to see if we have a relevant check printer set up....
                    if (_tlTranSet.TellerVars.AdTlControl.TellerChkPrint.Value == "Y" && _tlTranSet.TellerVars.IsAppOnline && (_tlTranSet.CurTran.TranCode.Value == 902 || _tlTranSet.CurTran.TranCode.Value == 910))   //#82433
					{
						PhoenixException printerException = new PhoenixException(13280, 13280);
						bool checkPrinterExists = false;
						Phoenix.BusObj.Admin.Checks.AdChkType adChkType = new BusObj.Admin.Checks.AdChkType();
                        adChkType.ChkType.Value = (_tlTranSet.CurTran.TranCode.Value == 902 ? "TLC600" : "TLC605");
						adChkType.PopulatePrinterInfo();
						checkPrinterExists = (adChkType.PrinterInfo.EnumValues.Count > 0);

						#region Deleted Code #140791
						//ArrayList CheckPrinters = null;
						//string CheckType = null;
						//bool checkPrinterExists = false;
						//PhoenixException printerException = new PhoenixException(13280, 13280);
						//if (TellerVars.Instance.TlChkPrinterArray != null && TellerVars.Instance.TlChkPrinterArray.Count > 0)
						//{
						//    CheckPrinters = TellerVars.Instance.TlChkPrinterArray;

						//    switch (_tlTranSet.CurTran.TranCode.Value)
						//    {
						//        case 902:
						//            CheckType = "CashiersCheck";
						//            break;

						//        case 910:
						//            CheckType = "MoneyOrder";
						//            break;
						//    }

						//    foreach (TlChkPrinter Printer in CheckPrinters)
						//    {
						//        if (Printer.CheckType.Value == CheckType)
						//        {
						//            checkPrinterExists = true;
						//            break;
						//        }
						//    }
						//}
						#endregion

                        if (!checkPrinterExists)
                        {
                            _hadCheckPrintingError = true;
                            throw printerException;
                        }
                    }
                    #endregion
                    tempDlg = Helper.CreateWindow("phoenix.client.tlprinting", "Phoenix.Client.TlPrinting", "dlgCheckInfo");
                    tempDlg.InitParameters(rimNo, printInfoForm, _tlTranSet); // #79621 - Added _tlTranSet to the params ... // tempDlg.InitParameters(rimNo, printInfoForm, _tlTranSet.CurTran.TranCode.Value);	// #79370 - add the TranCode to the param list ...

                    if (_tlTranSet.IsCheckPrintAvailable(false, -1, false))
                    {
                        //9591 DONT NEED ANY OF THIS. ALREADY done in Window

                        //PInt branchNo = new PInt("brNo");
                        //PInt tranCode = new PInt("tranCode");
                        //branchNo.Value = Convert.ToInt16(_tlTranSet.TellerVars.BranchNo);
                        //tranCode.Value = _tlTranSet.CurTran.TranCode.Value;
                        //string printerInfo = _tlTranSet.GetPrinterInfo(branchNo, tranCode);
                        //string[] printerInfoArray = new string[2];
                        //printerInfoArray = printerInfo.Split('^');
                        //string[] descArray = new string[20];
                        //string convStr = printerInfoArray[2].Replace(@"\", "/");
                        //descArray = convStr.Split('/');
                        //string printerName = descArray[descArray.Length - 1];
                        //printInfoForm.CheckPrinterID = printerInfoArray[2];
                        //printInfoForm.CheckPrinterName = printerName;

                        printInfoForm.ShowPrintInfo = true;


                    }
                    #endregion
                }
                else if (origin == "PrintForm")
                {
                    #region Print Form
					//#157637 imagedata arraylist reference is passed to dlgPrintForms to populate with printed data and upon returning from dialog processed in handleprinting()
					_imageData.Clear();
					tempDlg = Helper.CreateWindow("phoenix.client.tlprinting", "Phoenix.Client.TlPrinting", "dlgPrintForms");
                    tempDlg.InitParameters(formId, (canReprint ? 0 : 1), (passbookAcctDetails == null ? (short)-1 : passbookAcctDetails.PbLastLine.Value),
                        printInfoForm, null, showItemField, _imageData);
                    #endregion
                }
                #region #79502 us2011
                else if (origin == "PrintBalPrompt")
                {
                    bool isMt = false;
                    if (_mtTranCount >= 1 && _tlTranSet.TellerVars.AdTlControl.EnableMtPrint.Value == "Y")
                        isMt = true;
                    #region Print Prompt
                    tempDlg = Helper.CreateWindow("phoenix.client.tlprinting", "phoenix.client.tlprinting", "dlgPrintBalPrompt");
                    tempDlg.InitParameters(_tlTranSet, isMt, !TellerVars.Instance.IsAppOnline);
                    //tempDlg.InitParameters(_tlTranSet);
                    _balancesAlreadyPrompted = true;
                    #endregion
                }
                #endregion
                //Begin Enh# 69248
                else if (origin == "Messenger")
                {
                    #region Messenger
                    tempWin = null;

                    int nAcctRimNo = int.MinValue;

                    if (picTabs.SelectedIndex == (int)TAB.InputTran)
                    {
                        //Begin #19415
                        string tranAcctType = _tlTranSet.CurTran.TranAcct.AcctType.Value;
                        string tranAcctNo = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
                        if (tranAcctType != null)
                            tranAcctType = tranAcctType.Trim();
                        if (tranAcctNo != null)
                            tranAcctNo = tranAcctNo.Trim();
                        if (tranAcctType == this.cmbAcctType.Text.Trim() && tranAcctNo == this.dfAcctNo.Text.Trim() &&
                            !_tlTranSet.CurTran.TranAcct.RimNo.IsNull)
                            nAcctRimNo = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                        //End #19415

                        if (nAcctRimNo <= 0)  // #19415 - if test
                            nAcctRimNo = this._gbHelper.GetRimNo(this.cmbAcctType.Text.Trim(), this.dfAcctNo.Text.Trim());
                        this.msgrPopped = ScanAcctTracker("Acct", nAcctRimNo);
                    }
                    else if (picTabs.SelectedIndex == (int)TAB.Search)    /*#15978 - Changed SelectedIndex from 3 to 2 as the "Search" tab is the 3rd tab*/
                    {
                        nAcctRimNo = searchRimNo;
                        this.msgrPopped = ScanAcctTracker("RIM", nAcctRimNo);
                    }

                    CoreService.LogPublisher.LogDebug("Before check for messenger:  msgrPopped = " + msgrPopped.ToString() + " RimNo = " + _tlTranSet.CurTran.TranAcct.RimNo.Value.ToString() + " AcctType = " + this.cmbAcctType.Text.Trim() + " AcctNo = " + this.dfAcctNo.Text.Trim() + " AcctId = " + this.dfAcctId.Text.Trim());
                    if (!this.msgrPopped)
                    {
                        if (picTabs.SelectedIndex == (int)TAB.Search && frmTBarSearch != null)//#65382
                        {
                            frmTltrn = frmTBarSearch.Parent.FindForm();
                            curWkspace = (frmTltrn as PfwStandard).Workspace;
                            // dlgInformation.Instance.ShowInfo("Checking for Product Offers...");
                            #region #15828 - Commented messengerInvoker and call window directly
                            //Phoenix.Client.WorkQueue.messengerinvoker _msgrInvoker = new Phoenix.Client.WorkQueue.messengerinvoker(nAcctRimNo, this.cmbAcctType.Text.Trim(), this.dfAcctNo.Text.Trim(), (this.dfAcctId.Text.Trim() == string.Empty ? Convert.ToString(0) : this.dfAcctId.Text.Trim()));
                            //_msgrInvoker.InvokeToucheMsgr();
                            /*Begin Task- 63936 -Addition of New Product offer and BI window for invision */
                            string isExists = _gbHelper.CustAnalysisExists(searchRimNo);
                           // if (isExists == "Y")
                           // {
                                /*Begin Task #65382*/
                                objAlert.ShowAlertTeller(searchRimNo, Convert.ToString(frmTBarSearch.colFirstName.UnFormattedValue) + " " + Convert.ToString(frmTBarSearch.colLastName.UnFormattedValue),isExists,frmTltrn, frmTltrn as IPhoenixForm); //#83779- Changed ToString() to Convert.ToString() since it throws error if first or lastname is null.
                                /*End Task #65382*/
                            //}
                            /*Begin Task- 63936 -Addition of New Product offer and BI window for invision */
                            //else
                            //{
                            //    tempDlg = Helper.CreateWindow("phoenix.client.messenger", "Phoenix.Client.WorkQueue", "frmOnMessenger");
                            //    tempDlg.InitParameters(_tlTranSet.CurTran.TranAcct.RimNo.Value, this.cmbAcctType.Text.Trim(), this.dfAcctNo.Text.Trim(), (this.dfAcctId.Text.Trim() == string.Empty ? Convert.ToString(0) : this.dfAcctId.Text.Trim()));
                            //}
                            #endregion #15828

                            this.msgrPopped = true;
                            dlgInformation.Instance.HideInfo();
                        }
                    }
                    else
                        tempDlg = null;
                    #endregion
                }
                //End Enh# 69248
                //#71893
                else if (origin == "MakeBreakStraps")
                {
                    cashDenomCallType = "MakeBreakStraps";
                    tempWin = Helper.CreateWindow("phoenix.client.tlcashcount", "Phoenix.Client.TlCashCount", "dlgTlCashCount");
                    tempWin.InitParameters(0, "MB", null, null, _tlTranSet.TellerVars.BranchNo, _tlTranSet.TellerVars.DrawerNo,
                        _tlTranSet.TellerVars.PostingDt, null);
                }
                // Begin #74014
                else if (origin == "Services")
                {
                    #region Services

                    if ((_tlTranSet.CurTran.TranCode.Value == 176 || _tlTranSet.CurTran.TranCode.Value == 177
                        || _tlTranSet.CurTran.TranCode.Value == 178 || _tlTranSet.CurTran.TranCode.Value == 131
                        || _tlTranSet.CurTran.TranCode.Value == 193 || _tlTranSet.CurTran.TranCode.Value == 333
                        || _tlTranSet.CurTran.TranCode.Value == 334 || _tlTranSet.CurTran.TranCode.Value == 345)
                        && !_tlTranSet.CurTran.IsClosingServicesDisplayed) // #8562
                    {

                        // See if any services exist  #8562 begin
                        PString servicesExist = new PString();
                        Phoenix.BusObj.Xapi.XpRmSvcsAcct xpRmSvcsAcct = new Phoenix.BusObj.Xapi.XpRmSvcsAcct();

                        servicesExist.Value = xpRmSvcsAcct.DoServicesExist(
                                                _tlTranSet.CurTran.TranAcct.AcctType.Value,
                                                _tlTranSet.CurTran.TranAcct.AcctNo.Value);

                        if (servicesExist.Value == "Y")
                        {
                            _tlTranSet.CurTran.IsClosingServicesDisplayed = true; // #8562
                            tempWin = Helper.CreateWindow("Phoenix.Client.Svcs.RemoveSvcs", "Phoenix.Client.Svcs.RemoveSvcs", "frmRemoveAcctSvcs");
                            tempWin.InitParameters(_tlTranSet.CurTran.TranAcct.AcctType.Value,
                                                    _tlTranSet.CurTran.TranAcct.AcctNo.Value,
                                                    _tlTranSet.CurTran.Reversal.Value.ToString());
                        }
                        //#8562 end
                    }
                    #endregion

                }
                // End #74014
                // Begin #76029
                else if (origin == "SharePrimAcct")
                {
                    tempWin = Helper.CreateWindow("phoenix.client.dpaltprimaccts", "Phoenix.Client.Deposit", "frmAlternatePrimAccts");
                    tempWin.InitParameters(_tlTranSet.CurTran.TranAcct.AcctType.Value,
                                    _tlTranSet.CurTran.TranAcct.AcctNo.Value);
                }
                // End #76029
                // Begin #79225
                else if (origin == "IrsReporting")
                {
                    string sIrsTin = string.Empty;
                    string sIrsTinType = string.Empty;

                    tempWin = CreateWindow("phoenix.client.IRSReporting", "Phoenix.Client.Misc", "frmIRSReporting");
                    tempWin.InitParameters(rimNo, sIrsTin, sIrsTinType);
                }
                // End #79225

                // Begin #76055
                else if (origin == "ACHFutDtTx")
                {
                    tempWin = Helper.CreateWindow("Phoenix.Client.FutureDatedTransactions", "Phoenix.Client.Overnight", "frmFutureDatedTransactions");
                    if (picTabs.SelectedIndex == 3)
                    {
                        tempWin.InitParameters(frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(),
                                                frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(),
                                                this.ScreenId);
                    }
                    else if (picTabs.SelectedIndex == 0)
                    {
                        tempWin.InitParameters(_tlTranSet.CurTran.TranAcct.AcctType.Value,
                                                _tlTranSet.CurTran.TranAcct.AcctNo.Value,
                                                this.ScreenId);
                    }
                }
                // End #76055
                // Begin #76041
                // #9691 - dont invoke account ownership window for non customer.
                else if (origin == "ShowAcctNicknamesList" && _tlTranSet.TellerVars.IsAppOnline
                        && _tlTranSet.TellerVars.AdTlControl.DisplayNicknames.Value == "Y" && !isNonCust() //#2325 Added DisplayNicknames check
                        && !_tlTranSet.IsTellerCaptureTran)        // #140895 - check for IsTellerCaptureTran
                {
                    #region ShowAcctNicknamesList

                    if (_myRim > 0 && _tlTranSet.CurTran.TranAcct.RimNo.Value < 0)
                    {
                        _tlTranSet.CurTran.TranAcct.RimNo.Value = _myRim;
                        _tlTranSet.CurTran.TranAcct.PostAccess.Value = myPostAccess;    //#5700
                        _tlTranSet.CurTran.TranAcct.EditAccess.Value = myEditAccess;    //#5700
                    }

                    #region #5700
                    bool recordFailedAccess = false;

                    /*begin 11396*/

                    #region #14251
                    AdRmRestrict _adRmRestrict = new AdRmRestrict();
                    _RimRestrictLevel.Value = _adRmRestrict.GetRestrictLevel(_myRim);
                    #endregion

                    /* _tlTranSet.VerifyEmplAccess(_tlTranSet.CurTran.TranAcct.PostAccess.Value,
			           _tlTranSet.CurTran.TranAcct.EditAccess.Value, _tlTranSet.CurTran.TranAcct.Status.Value,
			           ref recordFailedAccess, ref acctHasPostAccessOnly, ref acctHasViewAcesssOnly);*/

			         _tlTranSet.VerifyEmplAccess(_myRim, _RimRestrictLevel.Value, _tlTranSet.TellerVars.EmplRestrictLevel,
			         ref recordFailedAccess, ref acctHasPostAccessOnly, ref acctHasViewAcesssOnly);
                       /* end 11396*/

                    if (recordFailedAccess && !acctHasPostAccessOnly)
                    {
                        //Your restriction level does not allow you to access this customer.
                        PMessageBox.Show(360733, MessageType.Error, MessageBoxButtons.OK, String.Empty);
                        return;
                    }
                    #endregion

                    _tlTranSet.CurTran.TranAcct.GetAcctNoNicknameDetails();

                    //#3538 ArrayList currentList = (cbShowAll.Checked == true ? _tlTranSet.CurTran.TranAcct.AllCustNicknameList : _tlTranSet.CurTran.TranAcct.SingleCustNicknameList);
                    string relationship; //#3538
                    if (_tlTranSet.AdGbRsm.ShowAllAcct.Value == GlobalVars.Instance.ML.Y) //#3538
                        relationship = "All";
                    else
                        relationship = "Primary";

                    Phoenix.Shared.Variables.AcctInfo acctInfo = new Phoenix.Shared.Variables.AcctInfo();

                    dlgAcctNicknames _dlgAcctNicknames = new dlgAcctNicknames();
                    _dlgAcctNicknames.InitParameters(
                                    _tlTranSet.CurTran.TranAcct.NicknameAcctList,
                                    acctInfo,
                                    relationship,
                                    "Y",
                                    ((acctHasPostAccessOnly || recordFailedAccess) ? 0 : 1));  //#3538 #5700 - added value for showbalance
                    DialogResult result = _dlgAcctNicknames.ShowDialog(this);

                    if (result == DialogResult.OK)
                    {
						 /* begin 17571*/
							int RimForPrinting = -1;
							RimForPrinting = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                        /*end 17571*/

                        //Begin #76458
                            this.SetAcctFields(acctInfo.AcctType, acctInfo.RealAcctNo, this.dfAcctNo, this.cmbAcctType, _tlTranSet.CurTran.TranAcct, dfQuickTranCode);
                        this.dfAcctNickname.UnFormattedValue = acctInfo.AcctNickname;
                        //End #76458

                         /*17571*/
                         setTitleBarName(RimForPrinting, true);

                    }
                    else if (result == DialogResult.Ignore) // #8639 Added else
                    {
                        this.EnableDisableControls("AcctNoCleanUp");
                        _tlTranSet.CurTran.TranAcct.AcctNo.Value = "";
                        _tlTranSet.CurTran.TranAcct.AcctType.Value = "";
                        _tlTranSet.CurTran.TranAcct.AcctNickname.Value = "";
                        _tlTranSet.CurTran.TranAcct.RimNo.Value = -1;
                        this._myRim = -1;
                        myPostAccess = string.Empty;    //#5700
                        myEditAccess = string.Empty;    //#5700
                        frmTlTranCode_PInitCompleteEvent();
                        SetFocusOnControl(cmbAcctType);
                        gotAccts = false;
                        #region #8639 - Default to search tab if teller_tab_default = 'S'
                        if (!_tlTranSet.TellerVars.AdTlControl.TellerTabDefault.IsNull &&
                            _tlTranSet.TellerVars.AdTlControl.TellerTabDefault.Value == "S" &&
                            _tlTranSet.TellerVars.IsAppOnline && !processingSelectTran &&
                            !(_tlTranSet.TellerVars.AdTlControl.VltGlTranOnly.StringValue == "Y" && TellerVars.Instance.IsVaultDrawer))  //#79156-Selva// //#79619 - do not default to search window if VltGlTranOnly and Vault drawer.
                        {
                            picTabs.SelectedIndex = 2;
                        }
                        #endregion
                    }
                    else if (result == DialogResult.Cancel)  //#2902 //#3032 - added more null validation // #8639 Added else
                    {
                        //#9985 - added additional conditions to satisfy cmbAcctType not null and dfAcctNo null conditions
                        if (!_tlTranSet.CurTran.TranAcct.AcctType.IsNull &&
                            !_tlTranSet.CurTran.TranAcct.AcctNo.IsNull &&
                            !string.IsNullOrEmpty(_tlTranSet.CurTran.TranAcct.AcctType.Value) &&
                            !string.IsNullOrEmpty(_tlTranSet.CurTran.TranAcct.AcctNo.Value))
                            SetFocusOnControl(dfQuickTranCode);
                        else if (!_tlTranSet.CurTran.TranAcct.AcctType.IsNull &&
                            !string.IsNullOrEmpty(_tlTranSet.CurTran.TranAcct.AcctType.Value) &&
                            _tlTranSet.CurTran.TranAcct.AcctNo.IsNull)
                        {
                            _tlTranSet.CurTran.TranAcct.AcctNo.Value = "";
                            _tlTranSet.CurTran.TranAcct.AcctNickname.Value = "";
                            this.setTitleBar();
                            SetFocusOnControl(dfAcctNo);
                        }
                        else if (cmbAcctType.CodeValue != null && dfAcctNo.UnFormattedValue != null &&
                            !string.IsNullOrEmpty(cmbAcctType.CodeValue.ToString()) &&
                            !string.IsNullOrEmpty(dfAcctNo.UnFormattedValue.ToString()))
                        {
                            SetFocusOnControl(dfQuickTranCode);
                        }
                        else if (cmbAcctType.CodeValue != null &&
                            !string.IsNullOrEmpty(cmbAcctType.CodeValue.ToString()))
                        {
                            _tlTranSet.CurTran.TranAcct.AcctNo.Value = "";
                            _tlTranSet.CurTran.TranAcct.AcctNickname.Value = "";
                            this.setTitleBar();
                            SetFocusOnControl(dfAcctNo);
                        }
                        else
                        {
                            //this.EnableDisableControls("AcctNoCleanUp");
                            _tlTranSet.CurTran.TranAcct.AcctNo.Value = "";
                            _tlTranSet.CurTran.TranAcct.AcctType.Value = "";
                            _tlTranSet.CurTran.TranAcct.AcctNickname.Value = "";
                            this.setTitleBar();
                            SetFocusOnControl(cmbAcctType);
                        }
                    }
                    else
                    {
                        SetFocusOnControl(dfQuickTranCode);
                    }
                    gotAccts = true;
                    #endregion
                }
                // End #76041
                else if (origin == "GbBondPurchase")
                {
                    #region BondPurchase
                    // Begin #76047
                    if (origin == "GbBondPurchase")
                    {
                        tempWin = Helper.CreateWindow("phoenix.client.bondpurchase", "Phoenix.Client.Global.GbBondPurchase", "frmGbBondPurchaseList");
                        tempWin.InitParameters("J",     //! Valid values = R-Rim Hist  J-Journal  A-Auto Tfr  C-Customer/Rim
                            "-2",
                            _tlTranSet.CurTran.TranAcct.RimNo.Value,
                            _tlTranSet.CurTran.TranCode.Value, //#3401 - replaced trancode with this // #8953 - TranAcct.TranCode was null
                            -1,         //This is the join ID
                            _tlTranSet,
                            this.ScreenId); //#77358                        
                    }
                    // End #76047
                    #endregion
                }
                else if (origin == "NOCHistoryClick")
                {
                    #region   frmNOCDetailList #80649 -
                    tempWin = CreateWindow("Phoenix.Client.AchNotificationOfChange", "Phoenix.Client.Misc", "frmNOCDetailList");

                    tempWin.InitParameters(null, null, rimNo, null, this.ScreenId);
                    #endregion
                }
                else if (origin == "LoanPmtRecalc") //#76425
                {
                    tempWin = Helper.CreateWindow("phoenix.client.lnpmtrecalc", "phoenix.client.lnpmtrecalc", "frmLnPmtRecalcHist");
                    tempWin.InitParameters(_tlTranSet.CurTran.TranAcct.AcctType.Value,
                        _tlTranSet.CurTran.TranAcct.AcctNo.Value,
                        _historyPtid);
                }
                else if (origin == "AddNonCust") //#9320
                {
                    tempWin = Helper.CreateWindow("phoenix.client.tlnonrmacct", "Phoenix.Client.TlNonRmAcct", "frmTlNonRmAcctEdit");
                }
                else if (origin == "CDRedemp") // #140782, 140782-3
                {
                    #region Early Withdrawal Calculator, aka CD Redemp

                    decimal netAmt = 0;
                    decimal penaltyAmt = 0;
                    decimal withholdingAmt = 0;

                    tempWin = CreateWindow("phoenix.client.dpredempcalc", "phoenix.client.dpredempcalc", "frmDpRedempCalc");

                    if (picTabs.SelectedIndex == (int)TAB.CustSummary)
                    {
                        //netAmt = Convert.ToDecimal(frmGloAccountListRim.colAvailableBalance.Text.Replace("$", ""));

                        tempWin.InitParameters(
                                    frmGloAccountListRim.colAcctType.Text,
                                    frmGloAccountListRim.colAcctNo.Text,
                                    _tlTranSet.TellerVars.PostingDt,
                                    frmGloAccountListRim.ScreenId,
                                    null,
                                    null,
                                    null,
                                    null,
                                    null,
                                    null,
                                    null,
                                    null);
                    }
                    else
                    {

                       #region Get values to pass as params

                        if (_tlTranSet.CurTran.TranCode.Value == 176
                            && string.IsNullOrEmpty(dfAvailBal.Text.Trim()) == false)
                        {
                            // Closing transaction, use entire Available Bal.
                            netAmt = Convert.ToDecimal(dfAvailBal.UnFormattedValue.ToString());
                        }
                        else if (string.IsNullOrEmpty(dfAmt.Text.Trim()) == false)
                        {
                            netAmt = Convert.ToDecimal(dfAmt.UnFormattedValue.ToString());
                        }

                        if (string.IsNullOrEmpty(dfPenaltyAmt.Text.Trim()) == false)
                        {
                            penaltyAmt = Convert.ToDecimal(dfPenaltyAmt.UnFormattedValue.ToString());
                        }

                        if (string.IsNullOrEmpty(dfWithholdingAmt.Text.Trim()) == false)
                        {
                            withholdingAmt = Convert.ToDecimal(dfWithholdingAmt.UnFormattedValue.ToString());
                        }

                        if (!_tlTranSet.CurTran.XmlDpRedempCalc.IsNull)
                        {
                            // If WithholdingTaxes were added to NetAmt by the calculator,
                            // need to adjust and get back to the "Base Amount" used by the calculator.

                            _dpRedempCalc = new DpRedempCalc();
                            BusObjSerializer.LoadFromXml(_dpRedempCalc, _tlTranSet.CurTran.XmlDpRedempCalc.Value);

                            // If NetAmt has not changed, then set to the Base Amount
                            if (netAmt == _dpRedempCalc.InclTaxTranAmt.Value)
                            {
                                netAmt = _dpRedempCalc.Amt.Value;
                            }

                            _tlTranSet.CurTran.CalcPtid.Value = (_dpRedempCalc.Ptid.Value > 0) ? Convert.ToInt32(_dpRedempCalc.Ptid.Value) : int.MinValue;
                        }
                        #endregion

                        tempWin.InitParameters(
                                    _tlTranSet.CurTran.TranAcct.AcctType.Value,
                                    _tlTranSet.CurTran.TranAcct.AcctNo.Value,
                                    _tlTranSet.EffectiveDt.Value,
                                    this.ScreenId,
                                    _historyPtid,
                                    null,
                                    _tlTranSet.CurTran.CalcPtid.Value,
                                    (_tlTranSet.CurTran.TranCode.IsNull ? _tlTranSet.CurTran.TlTranCode.IntValue : _tlTranSet.CurTran.TranCode.Value),
                                    netAmt,
                                    penaltyAmt,
                                    _tlTranSet.CurTran.UmbCode.Value,
                                    _tlTranSet.CurTran.XmlDpRedempCalc.Value, /*140782-3*/
                                    true); //#37585 - replaced _tlTranSet.CurTran.TlTranCode.IntValue with _tlTranSet.CurTran.TranCode.Value//#73908
                    }
                    #endregion
                }
                //Begin #79510, #09614
                else if (origin == "ShowTCDOptionsForAcquirer")
                {
                    tempDlg = Helper.CreateWindow("phoenix.client.tltrancode", "Phoenix.Client.Teller", "dlgShBranchTCDOptions");
                    tempDlg.InitParameters(acquirerEnableTCR, acquirerEnableTCD);
                }
                //End #79510, #09614
                else if (origin == "InventoryPurchaseReturnClick")  //#140772
                {
                    if (isNonCust())
                    {
                        //_tlTranSet.CurTran.TranAcct.RimNo.Value = Convert.ToInt32(this.Workspace.Variables["NonCustRimNo"]);
                        _tlTranSet.CurTran.NonCust.Value = "Y";
                    }
                    tempWin = CreateWindow("phoenix.client.tltrancode", "Phoenix.Client.Teller", "frmInventoryItemPurchaseReturnDetail");
                    tempWin.InitParameters(GetCustomerName(searchRimNo, isNonCust()), _tlTranSet);
                }
                else if (origin == "InventorySearchClick")  //#140772
                {
                    tempWin = CreateWindow("phoenix.client.gbinventoryitem", "Phoenix.Client.Global", "frmInventoryItemSearch");
                    /*Begin #73903 - Setting parameter and pass it to Inventory form to show Inventory is called from tlTrancode*/
                    _pbIsTeller = true; 
                    tempWin.InitParameters(null,null,null,null,null,null,null,null,null,null, _pbIsTeller);
                    /* End #73903 */
                }
                else if (origin == "ReqSignatureForInventoryItem")  //#140772
                {
                    tempWin = CreateWindow("Phoenix.Client.GbInventoryVerification", "Phoenix.Client.Global", "frmInventoryVerificationRequired");
                    tempWin.InitParameters("Purchase", cmbInventoryType.Description,
                        (_adGbInventoryType.UseDrawerLevel.StringValue == "Y" ? "Drawer" : "Branch"),
                        _adGbInventoryType.SigRequiredPurchase.IntValue,
                        _adGbInventoryType.Class.StringValue,
                        (dfCheckNo.UnFormattedValue == null ? 0 : Convert.ToInt32(dfCheckNo.UnFormattedValue)));
                }
                else if (origin == "OnUsAcctRegD")          //140780-20052
                {
                    tempWin = CreateWindow("Phoenix.Client.DpDisplayRegDD", "Phoenix.Client.Deposit", "frmDpDisplayRegDDisplay");
                    tempWin.InitParameters(_tlTranSet.CurTran.TfrAcct.AcctNo.Value, _tlTranSet.CurTran.TfrAcct.AcctType.Value);
                }
                else if (origin == "SavingsBond")   //#140798 actionSavingsBond - F9
                {
                    #region SavingsBond
                    tempWin = Helper.CreateWindow("phoenix.client.tlredemption", "Phoenix.Windows.TlRedemption", "frmCalcRedemption");
                    tempWin.InitParameters(null, this.ScreenId,
                        (_tlTranSet.CurTran == null ? null : _tlTranSet.CurTran.SavingsBonds),
                        null,
                        (!_tlTranSet.TellerVars.AdTlControl.ReqSerialNoBondRedempt.IsNull &&
                        _tlTranSet.TellerVars.AdTlControl.ReqSerialNoBondRedempt.Value == "Y"),
                        _tlTranSet.CurTran.TranAcct.RimNo.Value);
                    #endregion
                }
				else if (origin == "PendingCC") //#140792
				{
					tempWin = CreateWindow("Phoenix.Client.CCPendingDisplay", "Phoenix.Client.Charges", "frmPendingDisplay");
					tempWin.InitParameters(_tlTranSet.CurTran.TranAcct.AcctType.Value, _tlTranSet.CurTran.TranAcct.AcctNo.Value, _tlTranSet.CurTran.TranAcct.ClassCode.Value, _tlTranSet.CurTran.TranAcct.DepLoan.Value);
				}
                else if (origin == "VerificationOfDeposits") //WI#140785
                {
                    tempWin = CreateWindow("Phoenix.Client.VerificationOfDeposit", "Phoenix.Client.VerificationOfDeposit", "frmVerificationOfDeposits");
                    tempWin.InitParameters(_tlTranSet.CurTran.TranAcct.RimNo.Value);
                }
                else if (origin == "frmTlCaptureBulkTran")  //#30227
                {
                    tempWin = CreateWindow("Phoenix.Client.TlTranCode", "Phoenix.Client.Teller", "frmTlCaptureBulkTran");
                    tempWin.InitParameters(_tlCaptureTranXML, _tlTranSet.TellerVars.BranchNo, _tlTranSet.TellerVars.DrawerNo, null, "Post");
                }
                #region WI#29312 Reversed pbService button
                //Begin 61240
                else if (origin == "EditViewServices")  //WI#28477
                {
                    #region EditViewServices
                    if (frmGloAccountListRim != null)//9200.Since we are using grid column of this window check null condition
                    {
                        string svcsDesc = frmGloAccountListRim.colSvcsDescription.Text;

                        if (svcsDesc == "Account Analysis")
                        {
                            tempWin = CreateWindow("phoenix.client.dpacctanalbase", "Phoenix.Client.Deposit", "frmAccountAnalysis");
                            tempWin.InitParameters(_tlTranSet.CurTran.TranAcct.RimNo.Value);
                        }
                        else if (svcsDesc == "ACH Company Charge Back Processing" ||
                                svcsDesc == "ACH Company Other ACH Payment Files" ||
                                svcsDesc == "ACH Company Payroll Files" ||
                                svcsDesc == "ACH Company Tax Files" ||
                                svcsDesc == "ACH Company Paper Payroll Files")
                        {
                            tempWin = CreateWindow("phoenix.client.rmachcompany", "Phoenix.Client.RIM", "frmRmACHCompanyList");
                            tempWin.InitParameters(_tlTranSet.CurTran.TranAcct.RimNo.Value, "N");
                        }
                        else if (svcsDesc == "Bill Payment" || svcsDesc == "ACH Direct Deposit")
                        {
                            //string svcsAcctType, svcaAcctNo, svcsEffectiveDate, svcshistPtid;
                            //svcsAcctType = frmGloAccountListRim.colSvcsStringFilter1.FormattedValue;
                            //svcaAcctNo = frmGloAccountListRim.colSvcsStringFilter2.FormattedValue;
                            //svcsEffectiveDate = frmGloAccountListRim.colSvcsLastAccessDt.FormattedValue;
                            //svcshistPtid = frmGloAccountListRim.colSvcsIntegerFilter2.FormattedValue;
                            BillPaymentAcctNo = "";
                            BillPaymentAcctType = "";
                            gnTemp = 0;
                            if (svcsDesc == "Bill Payment")
                                gnTemp = 194;
                            else
                                gnTemp = 106;
                            _acctSearchBusObj.GetBillPayInfo(searchRimNo, Convert.ToInt32(frmGloAccountListRim.colSvcsIntegerFilter1.UnFormattedValue), gnTemp, Convert.ToDateTime(frmGloAccountListRim.colSvcsLastAccessDt.UnFormattedValue), ref BillPaymentAcctNo, ref BillPaymentAcctType, ref historyPtid);

                            tempWin = CreateWindow("phoenix.client.dptchistorydisplay", "Phoenix.Client.Deposit", "frmDpTCHistoryDisplay");
                            tempWin.InitParameters(BillPaymentAcctType, BillPaymentAcctNo, Convert.ToDateTime(frmGloAccountListRim.colSvcsLastAccessDt.UnFormattedValue), historyPtid, null, null);
                        }
                        else if (svcsDesc == "E Statements")
                        {
                            tempWin = CreateWindow("phoenix.client.gbcombstmt", "Phoenix.Client.Global", "frmStatement");
                            tempWin.InitParameters(searchRimNo, null, null, "1", Convert.ToString(frmGloAccountListRim.nRimClassCode));

                        }
                        else if (svcsDesc == "Payroll Distributions")
                        {
                            tempWin = CreateWindow("phoenix.client.rmpayrolldistlist", "Phoenix.Client.Rim", "frmRmPayrollDistList");
                            tempWin.InitParameters(_tlTranSet.CurTran.TranAcct.RimNo.Value);
                        }
                        else if (svcsDesc == "Sweep Family")
                        {
                            tempWin = CreateWindow("Phoenix.Client.RmSweepFamily", "Phoenix.Client.RIM", "frmRmSweepFamilyList");
                            tempWin.InitParameters(_tlTranSet.CurTran.TranAcct.RimNo.Value);
                        }
                        else if (svcsDesc == "Positive Pay" || svcsDesc == "Account Reconciliation")
                        {
                            //14750 - "This feature is not available in Teller" //WI#29198
                            // PMessageBox.Show(14750, MessageType.Warning, string.Empty);
                            tempWin = Phoenix.Windows.Client.ShowFormHelper.dfwDeposit(this,
                                                                            "hWndNULL",
                                                                           Convert.ToString(searchRimNo),
                                                                           Convert.ToString(frmGloAccountListRim.colSvcsStringFilter1.UnFormattedValue),
                                                                           Convert.ToString(frmGloAccountListRim.colSvcsStringFilter2.UnFormattedValue),
                                                                           Convert.ToString(frmGloAccountListRim.colSvcsStringFilter3.UnFormattedValue),
                                                                           "USD",
                                                                           Convert.ToString(frmGloAccountListRim.nRimClassCode),
                                                                           Convert.ToString(searchRimNo),
                                                                           "cbRecon");
                        }
                        else
                        {
                            tempWin = CreateWindow("phoenix.client.xprmsvcsacct", "Phoenix.Client.Global", "frmGbSvcsList");
                            tempWin.InitParameters("RM", null, null, _tlTranSet.CurTran.TranAcct.RimNo.Value);  //WI#29180
                        }
                    }
                    #endregion
                }
                //End 61240
                #endregion

                // Begin #180277
                else if (origin == "ShowLnOverPmtOptions")
                {
                    tempDlg = Helper.CreateWindow("phoenix.client.trancode", "Phoenix.Client.Misc", "dlgLnOverPaymentOptions");
                    tempDlg.InitParameters(_tlTranSet.CurTran.LnAcctPrepaySetup, _tlTranSet.CurTran.LnPrePayOption, 
                        _tlTranSet.CurTran.LnMaxNoPrepay, _tlTranSet.CurTran.LnPartialPriority);
                }
                // End #180277

                else if (origin == "eReceipt")  //begin #194535
                {
                    string sConfig = "";    //#42567, #43143
                    string sXmlTlTransaction = "";  //#40787
                    string sXmlTlAcctDetail = "";   //#40787
                    string sUpdateData = "";    //#40276
                    int nTransaction = 0;       //#40787
                    bool isFloatCheck = false;  //#43143 - Shelved/Ported
                    string tempFromMTForms = string.Empty;  //90021
                    phoenix.client.tlprinting.dlgRecieptInfo dlgReceipt = new phoenix.client.tlprinting.dlgRecieptInfo();
                    TlTransaction myTlTransaction = new TlTransaction();        //#40787

                    if (picTabs.SelectedTab == tabEasyCapture)  //#101468
                    {
                        if (_tlTranSet.CurTran != null && _tlTranSet.CurTran.TranAcct != null)  //#90021
                            tempFromMTForms = _tlTranSet.CurTran.TranAcct.FromMTForms.Value;
                        var sourceTran = _quickTranWindow.TranSet.CashInTran;
                        if (sourceTran == null)
                            sourceTran = _quickTranWindow.TranSet.CashOutTran;
                        if (sourceTran == null)
                            sourceTran = _quickTranWindow.TranSet.ChecksTran;
                        if (sourceTran == null)
                            sourceTran = _quickTranWindow.GetCurrentEasyCaptureTran();

                        if (sourceTran != null && sourceTran.MappedTranIndex > 0)
                        {
                            _tlTranSet.SelectTransaction(sourceTran.MappedTranIndex, false);
                        }
                        else
                        {
                            if (_tlTranSet.CurTran == null)
                                _tlTranSet.CurTran = new TlTransaction();
                        }

                        if (_tlTranSet.Transactions.Count > 0 && !string.IsNullOrEmpty(tempFromMTForms))    //#90021
                            _tlTranSet.CurTran.TranAcct.FromMTForms.Value = tempFromMTForms;
                    }

                    if (_tlTranSet.Transactions.Count > 0)
                    {
                        if (_tlTranSet.CurTran.TranAcct.FromMTForms.Value == "Y")
                        {
                            myTlTransaction = (_tlTranSet.Transactions[0] as TlTransaction).Clone();    //clone the first one.  //#40787
                        }
                        else
                        {
                            myTlTransaction = _tlTranSet.CurTran.Clone();  //clone the current one //#40787
                        }
                    }
                    else
                    {
                        myTlTransaction = _tlTranSet.CurTran.Clone();   // I only have one transaction. //#40787
                    }
                    if (picTabs.SelectedIndex == (int)TAB.InputTran || picTabs.SelectedIndex == (int)TAB.QuickTran)
                    {
                        myTlTransaction.TranAcct.FromJournal.Value = "N";   //#40787
                        
                    }
                    else
                    {
                        myTlTransaction.TranAcct.FromJournal.Value = "1"; //picTabs.SelectedIndex == 3 Customer Management tab  //#40787
                    }
                    //begin #40254
                    if (_tlTranSet.CurTran.TranAcct.FromMTForms.Value == "Y")
                    {
                        myTlTransaction.TranAcct.FromMTForms.Value = "Y";   //#40787
                        //begin #43143
                        isPrintRequired = false;
                        if (!_tlTranSet.TellerVars.AdTlForm.PrintString.IsNull && _tlTranSet.TellerVars.AdTlForm.PrintString.Value.IndexOf("Float") >= 0)   //#54638 - added null validation
                        {
                            isFloatCheck = true;
                        }
                        //end  #43143
                    }
                    else
                    {
                        myTlTransaction.TranAcct.FromMTForms.Value = "N";   //#40787
                    }
                    //end   #40254
                    sXmlTlTransaction = BusObjSerializer.SerializeToXml(myTlTransaction, false, false);         //#40787
                    sXmlTlAcctDetail = BusObjSerializer.SerializeToXml(myTlTransaction.TranAcct, false, false); //#40787
                    //begin #40276
                    if (_tlTranSet.Transactions.Count > 0)
                    {
                        for (nTransaction = 0; nTransaction < _tlTranSet.Transactions.Count; nTransaction++)
                        {
                            if ((_tlTranSet.Transactions[nTransaction] as TlTransaction).TranAcct.UpdateEmailList != null)
                            {
                                sUpdateData = sUpdateData + (_tlTranSet.Transactions[nTransaction] as TlTransaction).TranAcct.UpdateEmailList.GetXMLFromObject((_tlTranSet.Transactions[nTransaction] as TlTransaction).TranAcct.UpdateEmailList) + "~";
                            }
                            if (isFloatCheck && !(_tlTranSet.Transactions[nTransaction] as TlTransaction).XpPtid.IsNull)    //#43143
                            {
                                foreach (TlItemCapture item in (_tlTranSet.Transactions[nTransaction] as TlTransaction).Items)
                                {
                                    if (item.FloatBal.Value > 0)
                                    {
                                        isPrintRequired = true;
                                    }
                                }
                            }
                        }
                    }
                    else
                    {
                        if ((_tlTranSet.CurTran as TlTransaction).TranAcct != null)
                        {
                        if ((_tlTranSet.CurTran as TlTransaction).TranAcct.UpdateEmailList != null)
                        {
                            sUpdateData = sUpdateData + (_tlTranSet.CurTran as TlTransaction).TranAcct.UpdateEmailList.GetXMLFromObject((_tlTranSet.CurTran as TlTransaction).TranAcct.UpdateEmailList) + "~";
                        }
                        }
                        if (isFloatCheck && !(_tlTranSet.CurTran as TlTransaction).XpPtid.IsNull)   //#43143
                        {
                            if (_tlTranSet.Transactions != null && _tlTranSet.Transactions.Count > 0 && (nTransaction <= _tlTranSet.Transactions.Count - 1))
                            {
                                TlTransaction tempTran = (_tlTranSet.Transactions[nTransaction] as TlTransaction);
                                if (tempTran.Items != null && tempTran.Items.Count > 0)
                                {
                                    foreach (TlItemCapture item in tempTran.Items)
                                    {
                                if (item.FloatBal.Value > 0)
                                {
                                    isPrintRequired = true;
                                }
                            }
                        }
                    }
                        }
                    }
                    isFloatCheck = false;   //#43143

                    if (isPrintRequired)  //#43143
                    {
                        sConfig += "PrintRequired" + "^";
                    }
                    if (isReadOnly)   //#42567
                    {
                        sConfig += "ReadOnly" + "^";
                    }

                    dlgReceipt.InitParameters(sXmlTlTransaction, sXmlTlAcctDetail, sUpdateData, sConfig,
                        formId, (canReprint ? 0 : 1), (passbookAcctDetails == null ? (short)-1 : passbookAcctDetails.PbLastLine.Value),
                        printInfoForm, _imageData); //#40787 #42567 #43143
                    //end   #40276
                    dlgReceipt.Workspace = this.Workspace;
                    dialogResult = dlgReceipt.ShowDialog(this);
                    string myXml = dlgReceipt.DialogOptions;    //XML instructions for receiptDelMethod and email address
                    myLogicalService = dlgReceipt.LogicalService;
                    Object myObject = new Object();
                    if (myXml != "" && dialogResult != DialogResult.Cancel && dialogResult != DialogResult.Ignore)
                    {
                        if (myInstruction == null)
                        {
                            myInstruction = new ReceiptDeliveryInstruction();
                        }
                        myObject = myInstruction.ObjectToXML(myXml);
                        myInstruction = (ReceiptDeliveryInstruction)myObject;

                        if (dialogResult == DialogResult.OK || dialogResult == DialogResult.Retry || dialogResult == DialogResult.No)
                        {
                            emailAddress = myInstruction.EmailAddress;
                        }
                        else
                        {
                            emailAddress = "";
                        }
                        //begin #40276
                        if (_tlTranSet.CurTran.TranAcct != null)
                        _tlTranSet.CurTran.TranAcct.UpdateEmailList = myInstruction;    //#40787
                        //end   #40276
                    }
                    else
                    {
                        myInstruction = null;
                        emailAddress = "";
                    }

                    if (_eReceiptClick && _tlTranSet.CurTran.TranAcct != null) //#40787
                    {
                        _tlTranSet.UpdateRimReceiptandEmail();
                        _eReceiptClick = false; //#40787
                        MoveAcctDataToFields();
                    }
                    AfterDialogClosed(origin);
                }
                //end   #194535
                else if (origin == "PEDSignatureCapture")   //#45778
                {
                    tempDlg = Helper.CreateWindow("phoenix.client.tltrancode", "Phoenix.Client.Teller", "dlgPEDSignatureCapture");
                    tempDlg.InitParameters(_tlTranSet.DisplaySummaryForPED.Value, pedSignature);
                }
                #region MergedApplication Code
                //Begin #60620
                else if (origin == "EditRim")
                {
                    tempWin = CreateWindow("phoenix.client.rmacct", "Phoenix.Client.RIM", "frmRmAcct");
                    tempWin.InitParameters(searchRimNo);

                }
                else if (origin == "RimDisplay")
                {
                    tempWin = CreateWindow("phoenix.client.rmdisplay", "Phoenix.Client", "frmRmDisplay");
                    tempWin.InitParameters(searchRimNo);
                }
                else if (origin == "RimHistory")
                {
                    tempWin = CreateWindow("phoenix.client.rmhistory", "Phoenix.Client", "frmRmHistory");
                    tempWin.InitParameters(searchRimNo);

                }
                else if (origin == "RimPortfolio")
                {
                    tempWin = CreateWindow("phoenix.client.RmPortfolio", "Phoenix.Client.Deposit", "frmRmPortfolio");
                    tempWin.InitParameters(searchRimNo);

                }
                else if (origin == "AchFuture")
                {
                    tempWin = CreateWindow("Phoenix.Client.FutureDatedTransactions", "Phoenix.Client.Overnight", "frmFutureDatedTransactions");
                    tempWin.InitParameters("RIM", searchRimNo, this.ScreenId);
                }
                //End #60620
                //Begin 60647
                else if (origin == "Umbrella")
                {
                    tempWin = CreateWindow("phoenix.client.iradplnretirementselect", "Phoenix.Client.Deposit", "frmIraUmbrella");
                    tempWin.InitParameters(searchRimNo);

                }
                else if (origin == "EditDP")
                {
                    tempWin = Phoenix.Windows.Client.ShowFormHelper.dfwDeposit(this,
                                                                        "hWndNULL",
                                                                        Convert.ToString(frmGloAccountListRim.colRimNo.UnFormattedValue == null ? searchRimNo : frmGloAccountListRim.colRimNo.UnFormattedValue),
                                                                       frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(),
                                                                       frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(),
                                                                       frmGloAccountListRim.colDepType.UnFormattedValue.ToString(),
                                                                       frmGloAccountListRim.colIsoCode.UnFormattedValue.ToString(),
                                                                       frmGloAccountListRim.colClassCode.UnFormattedValue.ToString(),
                                                                       Convert.ToString(searchRimNo));
                }

                else if (origin == "EditSD")
                {
                    tempWin = CreateWindow("phoenix.client.sdacct", "Phoenix.Client.SD", "frmSdAcct");
                    tempWin.InitParameters(frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), Convert.ToInt32(frmGloAccountListRim.colAcctId.UnFormattedValue), "FALSE", "", searchRimNo);
                }

                else if (origin == "EditEXT")
                {
                     tempWin = CreateWindow("phoenix.client.exacct", "Phoenix.Client.External", "dfwOnExAcctEdit");
                     tempWin.InitParameters(frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), (frmGloAccountListRim.colExtTin.UnFormattedValue == null ? "" : frmGloAccountListRim.colExtTin.UnFormattedValue.ToString()), null, Convert.ToInt32(frmGloAccountListRim.colRimNo.UnFormattedValue));       // maya get external tin
                }

                else if (origin == "ExtXaml")
                {
                    tempWin = Phoenix.Windows.Client.ShowFormHelper.XAMLWindow(this, "ExAcctEdit", frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), frmGloAccountListRim.colRimNo.UnFormattedValue ==null?searchRimNo : Convert.ToInt32(frmGloAccountListRim.colRimNo.UnFormattedValue));
                }

                else if (origin == "EditCM")
                {
                    tempWin = CreateWindow("phoenix.client.IraLnCommitment", "Phoenix.Client.Loan", "frmIraLnCommitmentEdit");
                    tempWin.InitParameters(searchRimNo, 0, frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), null, null, frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), this.ScreenId);
                }

                else if (origin == "AtmAcctEdit")
                {
                    tempWin = CreateWindow("phoenix.client.atmcard", "Phoenix.Client.Atm", "frmAtmCardEdit");
                    tempWin.InitParameters("", "", null, searchRimNo);
                }

                else if (origin == "AtmCard")
                {
                    tempWin = CreateWindow("phoenix.client.atmcard", "Phoenix.Client.Atm", "frmAtmCard");
                    tempWin.InitParameters(searchRimNo, frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString());
                }

                else if (origin == "AtmCardEdit")
                {
                    tempWin = CreateWindow("phoenix.client.atmcard", "Phoenix.Client.Atm", "frmAtmCardEdit");
                    tempWin.InitParameters(frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), atmMemberNo, frmGloAccountListRim.colRimNo.UnFormattedValue == null ? searchRimNo : Convert.ToInt32(frmGloAccountListRim.colRimNo.UnFormattedValue), "FALSE", "FALSE");
                }
                /*begin #104474*/
                else if (origin == "AtmCardDisplay")
                {
                    tempWin = CreateWindow("Phoenix.Client.AtmCardDisplay", "Phoenix.Client.Atm", "frmAtmCardDisplay");
                    tempWin.InitParameters(frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), this.atmMemberNo);
                }
                /*end   #104474*/
                else if (origin == "EditLN")
                {
                    tempWin = Phoenix.Windows.Client.ShowFormHelper.dfwLnLoan(this,
                                                                        "hWndNULL",
                                                                       Convert.ToString(frmGloAccountListRim.colRimNo.UnFormattedValue == null ? searchRimNo : Convert.ToInt32(frmGloAccountListRim.colRimNo.UnFormattedValue)),
                                                                       frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(),
                                                                       frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(),
                                                                       frmGloAccountListRim.colIsoCode.UnFormattedValue.ToString(),
                                                                       frmGloAccountListRim.sRimType,
                                                                       Convert.ToString(frmGloAccountListRim.nRimClassCode),
                                                                       Convert.ToString(searchRimNo));
                }
                else if (origin == "AtmHistory")
                {
                    tempWin = CreateWindow("phoenix.client.atmtchistory", "Phoenix.Client.AtmTcHistory", "frmAtmTcHistory");
                    tempWin.InitParameters(atmPanNo);
                }
                else if (origin == "ArchivedAccts")
                {
                    tempWin = CreateWindow("phoenix.client.archievedaccounts", "Phoenix.Client.Misc", "frmArchivedAccounts");
                    tempWin.InitParameters(searchRimNo);
                }
                else if (origin == "EditPartLn")
                {
                    tempWin = CreateWindow("phoenix.client.LnParticipations", "Phoenix.Client.Loan", "frmLnParticipationEdit");
                    tempWin.InitParameters(parentRimNo,
                                            frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(),
                                            frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(),
                                            parentAcctType,
                                            parentAcctNo,
                                            true);
                }
                else if (origin == "AtmDisplay")
                {
                    tempWin = CreateWindow("phoenix.client.atmacct", "Phoenix.Client.Atm", "frmAtmAcctDisplay");
                    //Bug#92186
                    //tempWin.InitParameters(frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), searchRimNo, 2);
                    tempWin.InitParameters(acctType, acctNo, rimNo, 2);


                }
                //End 60647

                //Begin 61240
                else if (origin == "SalesClick")
                {
                    tempWin = Helper.CreateWindow("Phoenix.Client.GbDataSvcs", "Phoenix.Client.Global", "frmSalesServiceRsm");
                    string sServiceDesc = frmGloAccountListRim.colSvcsDescription.UnFormattedValue.ToString().Trim();
                    //int nServiceId = GetServiceId(sServiceDesc);
                    string sAcctTypeNo = frmGloAccountListRim.colAcctType.Text.Trim() + "-" + frmGloAccountListRim.colAcctNo.Text.Trim(); //37466
                    //40178 - Changed colRim to _acctSearchBusObj.RimNo.Value
                    tempWin.InitParameters(searchRimNo, Convert.ToInt32(frmGloAccountListRim.colSvcsServiceId.UnFormattedValue), sServiceDesc, sAcctTypeNo); //37466 - Added account type and account no.
              }
                else if (origin == "XpRmSvcsEditClick")
                {
                    tempWin = Helper.CreateWindow("phoenix.client.xprmsvcs", "Phoenix.Client.Xapi", "frmXpRmSvcsEdit");
                    int nXpServiceId = Convert.ToInt32(frmGloAccountListRim.colSvcsServiceId.UnFormattedValue);
                    tempWin.InitParameters(searchRimNo, nXpServiceId, frmGloAccountListRim.colAcctType.Text.Trim(),
                                             frmGloAccountListRim.colAcctNo.Text.Trim(), null, false, GlobalVars.Instance.ML.RM);
                }


                else if (origin == "SalesServiceRSMDetails")
                {
                    tempWin = Helper.CreateWindow("Phoenix.Client.GbDataSvcs", "Phoenix.Client.Global", "frmSalesServiceRsmDetails");
                    //int nServiceIdDet = GetServiceId(colSvcsDescription.UnFormattedValue.ToString().Trim());
                    tempWin.InitParameters(searchRimNo, frmGloAccountListRim.colSvcsDescription.UnFormattedValue.ToString().Trim(), Convert.ToInt32(frmGloAccountListRim.colSvcsServiceId.UnFormattedValue), frmGloAccountListRim.dfName.Text);
                }
                //End 61240              
                #region OnlinePost
                /*begin #60716 - Need to call transaction window if we click Online post from account summary.*/
                else if (origin == "TransactionPost")
                {
                    PString sAcctNo = new PString("AcctNo");
                    PString sAcctType = new PString("AcctType");
                    PInt nRimNo = new PInt("RimNo");
                    PString sDepLoan = new PString("DepLoan");
                    PInt sClassCode = new PInt("ClassCode");
                    PInt nAcctId = new PInt("AcctId");              // #100754
                    if (frmGloAccountListRim != null)
                    {
                        sAcctNo.SetValue(frmGloAccountListRim.colAcctNo.UnFormattedValue);
                        sAcctType.SetValue(frmGloAccountListRim.colAcctType.UnFormattedValue);
                        /*Begin #92180*/
                        /*nRimNo.SetValue(frmGloAccountListRim.colRimNo.UnFormattedValue);*/
                        nRimNo.SetValue(searchRimNo);
                        /*End #92180*/
                        sDepLoan.SetValue(frmGloAccountListRim.colDepLoan.UnFormattedValue);
                        sClassCode.SetValue(frmGloAccountListRim.colClassCode.UnFormattedValue);
                        nAcctId.SetValue(frmGloAccountListRim.colAcctId.UnFormattedValue);          // #100754                        sName.SetValue(frmGloAccountListRim.dfName.Text);
                    }
                    else
                    {
                        nRimNo.SetValue(null);
                        sAcctType.SetValue(null);
                        sAcctNo.SetValue(null);
                        sDepLoan.SetValue(null);
                        sClassCode.SetValue(null);
                    }
                    tempWin = Phoenix.Windows.Client.ShowFormHelper.frmTranCode(this, Convert.ToInt32(nRimNo.Value), "", Convert.ToString(sAcctType.Value), Convert.ToString(sAcctNo.Value),
                                          Convert.ToInt32(nAcctId.Value), // #100754 
                                          Convert.ToString(sDepLoan.Value), Convert.ToInt32(sClassCode.Value));
                }
                /*end   #60716*/
                /*begin #60713*/
                else if (origin == "AutoTransfers")
                {
                    if (frmGloAccountListRim != null)
                    {
                        Phoenix.Windows.Client.ShowFormHelper.frmGbAutoTransfers(this, 1, Convert.ToInt32(frmGloAccountListRim.colRimNo.UnFormattedValue), frmGloAccountListRim.colAcctType.UnFormattedValue.ToString().Trim(),
                        frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString().Trim());//63385 - Get RimNo value from frmGloAccountListRim similar like account no.
                    }
                }
                /*end   #60713*/
                /*begin #63426*/
                else if (origin == "Images")
                {
                    if (frmGloAccountListRim != null && frmGloAccountListRim.colAcctType != null && frmGloAccountListRim.colAcctNo != null && frmGloAccountListRim.colAcctType.UnFormattedValue != null && frmGloAccountListRim.colAcctNo.UnFormattedValue != null) //76629
                    {
                        //Begin 103714
                        //tempWin = Phoenix.Windows.Client.ShowFormHelper.frmDpLnSigners(this, frmGloAccountListRim.colAcctType.UnFormattedValue.ToString().Trim(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString().Trim(), 0);
                        tempWin = Phoenix.Windows.Client.ShowFormHelper.frmDpLnSigners(this,
                                      frmGloAccountListRim.colAcctType.UnFormattedValue.ToString().Trim(),
                                      frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString().Trim(),
                                      Convert.ToInt32(frmGloAccountListRim.colAcctId.UnFormattedValue == null ? 0 : frmGloAccountListRim.colAcctId.UnFormattedValue));
                        //End 103714
                    }
                    else
                    {
                        tempWin = Phoenix.Windows.Client.ShowFormHelper.frmDpLnSigners(this, "", "", 0);                        
                    }
                }
                /*end   #63426*/
                //Begin #60722. Define Relation in Account Relation of MDI
                else if (origin == "Relations")
                {
                    if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP)
                        online = 1;
                    else if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN)
                        online = 3;
                    else if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.CM)
                        online = 12;
                    else if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.SD)
                        online = 6;
                    else if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Ext)
                        online = 9;
                    else
                        online = 0;

                    if (online != 0)
                        tempWin = Phoenix.Windows.Client.ShowFormHelper.frmDpLnRelation(this, online,
                                                                                        frmGloAccountListRim.colAcctType.UnFormattedValue.ToString().Trim(),
                                                                                        frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString().Trim(),
                                                            Convert.ToInt32(frmGloAccountListRim.colAcctId.UnFormattedValue == null ? 0 : frmGloAccountListRim.colAcctId.UnFormattedValue));
                }
                //End #60722
                #endregion
                //Begin 60698
                else if (origin == "HouseholdMember")
                {
                    tempWin = Helper.CreateWindow("phoenix.client.gbhousehold", "Phoenix.Client.Global", "frmNewEditHousehold");
                    tempWin.InitParameters(Convert.ToInt32(this.Workspace.Variables["HouseholdId"]));
                }
                else if (origin == "HouseholdSearch")
                {
                    tempWin = Helper.CreateWindow("phoenix.client.gbhouseholdsearch", "Phoenix.Client.Global", "frmHouseholdSearch");
                    tempWin.InitParameters();
                }
                //End 60698
                //Begin #134375
                else if (origin == "ExceptionHold")
                {
                    //Get the loan type
                    string depLoanValue = GetDepLoan(cmbAcctType);
                    _tempExceptionHoldInfo = GetCurrentExceptionHoldBalInfo();
                    bool _pbIsTeller = true;
                    tempWin = Helper.CreateWindow("Phoenix.Client.GbHoldStop", "Phoenix.Client.HoldStop", "frmGbStopHoldEdit");
                    tempWin.InitParameters(_tempExceptionHoldInfo, cmbAcctType.Value, dfAcctNo.Value, depLoanValue,
                        null, "new", ScreenId, rimNo , null , dfTransitChks.Value, _pbIsTeller, "Exception");
                }
                //End #134375
                #endregion
                if (tempWin != null)
                {
                    formLostFocus = true;
                    tempWin.Closed += new EventHandler(tempWin_Closed);
                    tempWin.Workspace = this.Workspace;
                    tempWin.Show();
                    //do not remove or comment out the following this fixes the focus problem for cash count window
                    if (origin == "CashInDenom" || origin == "CashOutDenom" || origin == "PostCashOutDenom" ||
                        origin == "LoanPmtRecalc")  //#76425
                        tempWin.Focus();
                }
				// #8910 - checkDetailsCaptured is not needed!   else if (tempDlg != null && !checkDetailsCaptured)	//#79572
				else if (tempDlg != null)
                {
                    tempDlg.Workspace = this.Workspace;
                    //tempDlg.Show();
                    tempDlg.Closed += new EventHandler(tempDlg_Closed); //Selva-ChkPrintFix
					//Begin #2327 - Do not comment or modify the dialogResult assignment PrintForm requires it
					dialogResult = tempDlg.ShowDialog(this); //#2327 - original code uncommeted
                    AfterDialogClosed(origin);  // #79510
					// #8910 - checkDetailsCaptured = true;	//#79572

                    //_resetEvent = new ManualResetEvent(false);
                    //_resetEvent.WaitOne();
                }
            }
            catch (PhoenixException pe)
            {
                PMessageBox.Show(pe, MessageBoxButtons.OK);
                return;
            }
            //			catch( Exception e )
            //			{
            //				MessageBox.Show( e.Message, "Exception", MessageBoxButtons.OK, MessageBoxIcon.Stop );
            //				return;
            //			}

        }

        private void EnableDisableControls(EnumEnableDisable CaseName)  //Added for #76047
        {
            switch (CaseName)
            {
                case EnumEnableDisable.EnableBondPurchase:
                    pbBondPurchase.Visible = pbBondPurchase.Enabled = _tlTranSet.TellerVars.IsAppOnline;        //#04620 - replaced true by online
                    break;
                case EnumEnableDisable.DisableBondPurchase:
                    pbBondPurchase.Visible = pbBondPurchase.Enabled = false;
                    break;
				case EnumEnableDisable.EnableOnUsTc:
                    // #79370 Begin
					break;
				case EnumEnableDisable.DisableOnUsTc:
					break;
                case EnumEnableDisable.ActionSavingsBond:
                    //#29211
                    //Begin #17178 - #140798 - permanently disable bondAction to pass the bond redemption data back and forth
                    if (bondAction != null)
                        bondAction.Enabled = _tlTranSet != null && (_tlTranSet.CurTran.TranCode.Value == 912 || _tlTranSet.CurTran.TranCode.Value == 915 || _tlTranSet.CurTran.TranCode.Value == 921);
                    //if ( bondAction != null )
                    //    bondAction.Enabled = _tlTranSet != null && (_tlTranSet.CurTran.TranCode.Value == 915);
                    break;
                    //End #17178
                case EnumEnableDisable.EnableGetAcct:
                    //Begin #17047
                    //    pbGetAcct.Enabled = ( CoreService.UIAccessProvider.GetScreenAccess(Phoenix.Shared.Constants.ScreenId.GbAccountListRim) &
                    //AuthorizationType.Read) == AuthorizationType.Read;
                    pbGetAcct.Enabled = true;
                    break;
                case EnumEnableDisable.DisableGetAcct:
                    pbGetAcct.Enabled = false;
                    break;
                    //End #17047
                case EnumEnableDisable.CDRedemp:
                    {
                        // 21347 begin
                        string depLoan = null;
                        string acctType = null;
                        string acctNo = null;
                        string ira = "N";
                        string depType = "";
                        bool isValidTrancode = true;

                        if (picTabs.SelectedIndex == (int)TAB.InputTran)
                        {
                            depLoan = _tlTranSet.CurTran.TranAcct.DepLoan.Value;
                            acctType = _tlTranSet.CurTran.TranAcct.AcctType.Value;
                            acctNo = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
                            ira = _tlTranSet.CurTran.TranAcct.IRA.Value;
                            depType = _tlTranSet.CurTran.TranAcct.DepType.Value;

                            if (cmbTranCode.CodeValue != null
                                && _tlTranSet.CurTran.TranCode.Value != 176
                                && _tlTranSet.CurTran.TranCode.Value != 179
                                && _tlTranSet.CurTran.TranCode.Value != 187)
                            {
                                isValidTrancode = false;
                            }
                        }
                        else        // 21347 if (picTabs.SelectedIndex == (int)TAB.CustSummary)
                        {
                            // #21347 Removing support for CD Redemp button on Cust Summary.
                            // Force it to disable.

                            depLoan = "Disable #21347";
                            //depLoan = frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString();
                            //acctType = frmGloAccountListRim.colAcctType.UnFormattedValue.ToString();
                            //acctNo = frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString();
                            //ira = frmGloAccountListRim.?.UnFormattedValue.ToString();
                            //depType = frmGloAccountListRim.colDepType.UnFormattedValue.ToString();
                        }

                        if (depLoan == "DP"
                        && string.IsNullOrEmpty(acctType) == false
                        && string.IsNullOrEmpty(acctNo) == false
                        && (ira == "Y" || depType == "Time")
                        && isValidTrancode)
                        {
                            pbCDRedemp.Visible = true;
                            pbCDRedemp.Enabled = true;
                        }
                        else
                        {
                            pbCDRedemp.Visible = false;
                            pbCDRedemp.Enabled = false;
                        }
                        // 21347 end

                        if (pbCDRedemp.Enabled == false)
                        {
                            _tlTranSet.CurTran.CalcPtid.SetValueToNull();
                            _tlTranSet.CurTran.XmlDpRedempCalc.SetValueToNull();
                        }

                        break;

                    }

            }
        }

        private void EnableDisableControls(string origin)
        {
            EnableState enableState = EnableState.Default;
            VisibilityState visibleState = VisibilityState.Default;
            bool visible = false;
            bool enable = false;
            bool setAlertAccount = false;
            ArrayList controlList = null;
            string depLoan = null;
            string acctType = null;
            string acctNo = null;
            int acctId = 0;
            bool multiSelection = picTabs.SelectedIndex == 3 && frmGloAccountListRim != null &&
                frmGloAccountListRim.gridAccountListSum.SelectedItems.Count != 1;

            AcctAlerts acctAlerts = null;

            if (picTabs.SelectedIndex == 3 && !multiSelection && frmGloAccountListRim != null && frmGloAccountListRim.gridAccountListSum.SelectedIndicies.Count == 1 &&
                frmGloAccountListRim.gridAccountListSum.ContextRow != Convert.ToInt32(frmGloAccountListRim.gridAccountListSum.SelectedIndicies[0]))
                frmGloAccountListRim.gridAccountListSum.ContextRow = Convert.ToInt32(frmGloAccountListRim.gridAccountListSum.SelectedIndicies[0]);



            #region FormCreate/ TranCodeCleanUp/AcctNoCleanUp
            if (origin == "FormCreate" || origin == "TranCodeCleanUp" || origin == "FormCreateTC")
            {
                #region show the controls realted to amt fields
                foreach (Control amtField in amtFields)
                {
                    controlList = GetAssocControls("EnableDisable", amtField);
                    foreach (Control control in controlList)
                    {
                        enableState = EnableState.Enable;
                        visibleState = VisibilityState.Show;

                        //if (amtField == dfPenaltyAmt
                        //    || amtField == dfInterestPaid
                        //    || amtField == dfCCAmt
                        //    || amtField == dfWithholdingAmt)
                        if (!IsPrimaryAmtField(amtField))
                        {
                            visibleState = VisibilityState.Hide;
                        }

                        if (control == cbTfrPbPresent)
                        {
                            if (!ShowPassbook(2, _tlTranSet.CurTran.TfrAcct.AcctHasPassbook.Value, cbTfrPbPresent))
                            {
                                visibleState = VisibilityState.Hide;
                            }
                            enableState = EnableState.Disable;
                        }

                        if (TellerVars.Instance.IsNonCashDrawer && (control == dfCashOut || control == dfCashIn)) //#79619 begin
                        {
                            enableState = EnableState.Disable;
                            control.Text = "";
                        }


                        if (control == cmbTfrAcctType || control == dfTfrAcctNo || control == dfTfrCheckNo || control == cmbOnUsTc) // #79370
                        {
                            enableState = EnableState.Disable;
                        }

                        (control as IPhoenixUI).SetObjectStatus(NullabilityState.Default, visibleState, enableState);
                    }
                }
                #endregion

                dfTranDescription.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
                lblDescription.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
                dfReference.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
                lblReference.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
                 //cmbChannel.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);//#79506
                //lblChannel.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);//#79506

				cmbUtility.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                cmbLnEscrowAgent.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);      //#80617
				lblLnEscrowAgent.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);		//#80617
                cmbChannel.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);//#79506
                lblChannel.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);//#79506
                cmbExchCrncy.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                cbPassDesc.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                dfTranEffectiveDt.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                cmbRegCC.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                cmbEndPoint.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                cmbUmbCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                dfUMBCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                cmbRefAcctType.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                dfRefAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                lblRefAccount.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblUtility.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblEffective.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                dfCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblItems.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblInventoryType.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);  //#140772 #21564
                cmbInventoryType.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);  //#140772 #21564
                lblPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#140772
                cmbInventoryPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);    //#140772
                lblNoInvAvailable.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);    //#140772
                dfNoInvAvailable.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);    //#140772
                dfInvSerialNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);    //#140772
                //iconRealTime.Visible = false;
                picRealTime.Visible = false;
                picMemo.Visible = false;
                bondAction.Enabled = false;
                picTCD.Visible = false; //#72916
                picDrawer.Visible = false; //#72916
                cbDenominate.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#72916
                cbWaiveSignature.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#76033
                cmbRecalcPmtDt.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#76425
                lblRecalcPmtDt.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#76425
                dfRecalcPmt.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#76425
                lblRecalcPmt.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#76425

				//#79572
				lblTlItemAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				dfTlItemAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				lblTlItemRoutingNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				dfTlItemRoutingNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				lblTlItemCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				dfTlItemCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				//#79572

                this.pbInstChkSrch.SetObjectStatus(VisibilityState.Hide, EnableState.Disable); // #79370
                this.pbEditNonCust.SetObjectStatus(VisibilityState.Default, EnableState.Disable);	//#9539

                EnableDisableControls(EnumEnableDisable.CDRedemp);          //140782, 21033
                EnableDisableControls("ExceptionHold");                     /* #126357 | 244510 */
                pbPendingCC.Enabled = false;	// #140792                
            }

            if (origin == "FormCreate" || origin == "AcctNoCleanUp")
            {
                cmbCrncy.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                lblCurrency.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                cbRetirement.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                cbPayrollTran.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                cbPbPresent.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                Name4.IsDisabled = true;
                panelAvailBal.Visible = false;
                //pbGetGLAcct.Enabled = false;
                pbHistory.Enabled = false;
                pbDisplay.Enabled = false;
                pbRestrictions.Enabled = false;
                pbFees.Enabled = false;
                //pbItemCapture.Enabled = picTabs.SelectedIndex == (int)TAB.QuickTran; //Bug #92022 #101468
                if (picTabs.SelectedIndex == (int)TAB.QuickTran)    //#101468
                {
                    //pbCashIn.Visible = true; //Bug #93430
                    //pbCashIn.Enabled = false; //Bug #93430
                }
                else
                {
                    pbItemCapture.Enabled = false; //Bug#108569
                    pbCashIn.Enabled = false; //Bug#108569 pbItemCapture.Enabled || _tlTranSet.IsCompVisible(_tlTranSet.CurTran.CashIn.XmlTag); //Bug #92190
                }
                pbCashOut.Enabled = (_tlTranSet.TellerVars.AdTlControl.DenomCashOut.Value !=
                    GlobalVars.Instance.ML.Y);
                pbInventory.Enabled = (GlobalVars.UserType == "Combined" ? CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InventoryItemSearchBackOffice) : CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InventoryItemSearchTeller)
                                        && _tlTranSet.TellerVars.IsInventoryTrackingEnabled);  //#140772 //77062
                if (!pbInventory.Enabled)
                {
                    pbInventory.Enabled = (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.InventoryPurchaseReturnDetail) && _tlTranSet.TellerVars.IsInventoryTrackingEnabled);  //#140772
                    //    pbInventory.Enabled = ((CoreService.UIAccessProvider.GetScreenAccess(Phoenix.Shared.Constants.ScreenId.InventoryPurchaseReturnDetail) & AuthorizationType.Read) == AuthorizationType.Read &&
                    //_tlTranSet.TellerVars.IsInventoryTrackingEnabled);  //#140772
                }

                foreach (PAction icon in iconFields)
                {
                    icon.Visible = false;
                }
                setAlertAccount = true;
                picRealTime.Visible = false;
                picMemo.Visible = false;
                Name3.IsDisabled = !_loadCustSummary;   //#8839
                picDrawer.Visible = false; //#72916
                picTCD.Visible = false; //#72916
                //picDrawer1.Visible = false; //#72916
                //picTCD1.Visible = false; //#72916
                cbDenominate.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#72916
                //cbDenominate1.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#72916
                //#74665 - always enable if TCD connection allows, do not depend on picTCD
                //pbChkTCDStatus.Visible = picTCD.Visible;
                //pbChkTCDStatus.Visible = _tlTranSet.TellerVars.IsTCDConnected;
                cmbRecalcPmtDt.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#76425
                lblRecalcPmtDt.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#76425
                dfRecalcPmt.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#76425
                lblRecalcPmt.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#76425
				//#79572
				lblTlItemAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				dfTlItemAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				lblTlItemRoutingNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				dfTlItemRoutingNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				lblTlItemCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				dfTlItemCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				//#79572
                EnableDisableControls(EnumEnableDisable.CDRedemp);          //140782, 21033
                lblPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#140772
                cmbInventoryPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);    //#140772
                lblNoInvAvailable.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);    //#140772
                dfNoInvAvailable.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);    //#140772
                dfInvSerialNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);    //#140772
                _jointRimsShownForCrossRef = false; //#38637
            }

            if (origin == "FormCreate")
            {
                dfAcctId.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                dfBatchID.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                dfTabTitle0.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                dfTabTitle4.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                dfTabTitle3.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                dfTabTitle1.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);

                cmbTCDDrawer.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblTCDDrawer.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                //cmbDispenseType.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                //lblDispenseType.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                dfAmtEq.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblForeignAmount.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                dfPostingExchRate.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblRate.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblTfrAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblRefAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblRefAccount.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblUtility.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblExchCurrency.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblDraweeBank.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblIRACategory.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                dfUMBCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lblUMBCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                lbl.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);

                pbRemoveTran.Enabled = ctwTranSet.Count > 0 && ctwTranSet.ContextRow >= 0;
                pbSelectTran.Enabled = pbRemoveTran.Enabled;
                pbGetGLAcct.Enabled = false;
                EnableDisableControls(EnumEnableDisable.DisableGetAcct); // #17047


                // Begin #74015
                // Begin #75349
                //pbOnUsDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                //pbOnUsSig.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                //Begin #75588
                if (GlobalVars.UserType == "AcProc")
                {
                    pbSelectAcct.Enabled = false;
                    pbRelationship.Enabled = false;
                    pbMisc.Enabled = false;
                }
                //End #75588
                if (picTabs.SelectedIndex == 0)
                {
                    pbOnUsDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                    pbOnUsSig.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                    pbOnUs.SetObjectStatus(VisibilityState.Default, EnableState.Disable); // #80620
                    #region #80615
                    if (dfTitle1.Text != "" && MailerForm.Count > 0 && MailerStatus != "Closed" && MailerStatus != "Inactive" && !isNonCust()) // #12870
                        pbPrintMailer.SetObjectStatus(VisibilityState.Show, EnableState.Enable);
                    else
                        pbPrintMailer.SetObjectStatus(VisibilityState.Hide, EnableState.Disable);
                    #endregion
                }
                else
                {
                    pbOnUsDisplay.SetObjectStatus(VisibilityState.Hide, EnableState.Disable);
                    pbOnUsSig.SetObjectStatus(VisibilityState.Hide, EnableState.Disable);
                    pbOnUs.SetObjectStatus(VisibilityState.Hide, EnableState.Disable); // #80620
                    #region #80615
                    if (picTabs.SelectedIndex != (int)TAB.QuickTran) //#87731
                        pbPrintMailer.SetObjectStatus(VisibilityState.Hide, EnableState.Disable);
                    #endregion
                }

                // End #75349
                // End #74015
                #region #79619
                if (TellerVars.Instance.IsNonCashDrawer)
                {
                    dfCashIn.Enabled = false;
                    dfCashOut.Enabled = false;
                    dfCashIn.Text = "";
                    dfCashOut.Text = "";
                }
                #endregion
            }

            //Begin #04677
            if (origin == "AcctNoCleanUp")
            {
                //pbItemCapture.Enabled = pbItemCapture.Visible = picTabs.SelectedIndex == (int)TAB.QuickTran; //Bug #92022
                pbFees.Enabled = pbFees.Visible = false;
                this.EnableDisableControls(EnumEnableDisable.DisableBondPurchase);
                _jointRimsShownForCrossRef = false; //#38637

                //Bug# 109821
                tabEasyCapture.IsDisabled = (_tlTranSet.TellerVars.AdTlControl.EnableQuickTranTab.Value != GlobalVars.Instance.ML.Y || _isSupervisorViewOnlyMode
                    || _isOvRunning);
            }
            //Begin #04677

            if (origin == "TfrAcctNoCleanUp")
            {
                cbTfrPbPresent.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                if (_tlTranSet.CurTran.TranAcct.AcctHasPassbook.Value != GlobalVars.Instance.ML.Y)
                    Name4.IsDisabled = true;
                // Begin #74015
                pbOnUsDisplay.Enabled = false;
                // #80620 - Commented pbOnUsSig.Enabled = false;
                // End #74015
                #region #80620
                pbOnUs.Enabled = false;
                onUsBar.Visible = false;
                onUsBar.Enabled = false;
                #endregion
            }
            #endregion

            #region AcctNoEnter
            if (origin == "AcctNoEnter")
            {
                if (ShowPassbook(1, _tlTranSet.CurTran.TranAcct.AcctHasPassbook.Value, cbPbPresent))
                    cbPbPresent.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Disable);
                if (_tlTranSet.CurTran.TranAcct.AcctHasPassbook.Value == GlobalVars.Instance.ML.Y && IsPbSupportedNow())
                    Name4.IsDisabled = false;
                if (_tlTranSet.CurTran.TranAcct.PayrollAcct.Value == 1)
                    cbPayrollTran.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
                if (showRetirement)
                    cbRetirement.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
                //enableState = ( ScreenHasAccess("display") ? EnableState.Enable : EnableState.Disable );
                if (!_tlTranSet.CurTran.TranAcct.SuspectAcct.IsNull && _tlTranSet.CurTran.TranAcct.SuspectAcct.Value != 1)
                {
                    /* 4252 */
                    if (picTabs.SelectedIndex == 3 && frmGloAccountListRim != null &&
                    frmGloAccountListRim.gridAccountListSum.ContextRow >= 0 && frmGloAccountListRim.colDepLoan.UnFormattedValue != null)
                    {
                        depLoan = frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString();
                    }
                    else
                    {
                        depLoan = null;
                    }

                    if (picTabs.SelectedIndex == 3)
                    {
                        if (depLoan != null && !multiSelection)
                        {
                            pbHistory.Enabled = ScreenHasAccess("history", false);     // WI#16236 passing isTfrAcct as false
                            pbDisplay.Enabled = ScreenHasAccess("display", false);     // WI#16236 passing isTfrAcct as false
                        }
                        else
                        {
                            pbHistory.Enabled = false;
                            pbDisplay.Enabled = false;
                        }
                        //Begin #60647
                        if (frmGloAccountListRim != null && frmGloAccountListRim.sArchiveEnabled == "Y")
                        {
                            pbArchive.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                        }
                        else
                        {
                            pbArchive.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                        }
                        //End #60647
                        
                    }
                    else
                    {
                        pbHistory.Enabled = ScreenHasAccess("history", false);     // WI#16236 passing isTfrAcct as false
                        pbDisplay.Enabled = ScreenHasAccess("display", false);     // WI#16236 added this.isTfrAcct
                    }
                    /* End 4252 */
                    if ((_tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP || _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.LN) && picTabs.SelectedIndex != (int)TAB.QuickTran)
                    {
                        if (_tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP)
                        {
                            pbRestrictions.Enabled = ScreenHasAccess("restriction", false);     // WI#16236 passing isTfrAcct as false
                        }
                        // #74024 enabled for deposits and loans ( loans with valid advance types.
                        if (_tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.LN &&
                            !_tlTranSet.CurTran.TranAcct.AdvanceType.IsNull &&
                            (_tlTranSet.CurTran.TranAcct.AdvanceType.Value.Trim() == "Multiple" || _tlTranSet.CurTran.TranAcct.AdvanceType.Value.Trim() == "Revolving"))    //#30969 - null validation added
                        {
                            pbRestrictions.Enabled = ScreenHasAccess("restriction", false);    // WI#16236 passing isTfrAcct as false
                        }
                    }
                    //				( Name3 as Control ).Enabled = ScreenHasAccess("custSummary");
                    if (_tlTranSet.CurTran.TranAcct.DepLoan.Value != GlobalVars.Instance.ML.GL)
                        Name3.IsDisabled = (!ScreenHasAccess("custSummary", false));        // WI#16236 passing isTfrAcct as false
                    else
                        Name3.IsDisabled = true;
                }
                else
                {
                    pbHistory.Enabled = false;
                    pbDisplay.Enabled = false;
                    pbRestrictions.Enabled = false;
                    Name3.IsDisabled = true;
                    iconSigner.Visible = false;
                }
                //71568 - flipping between accounts
                panelAvailBal.Visible = ((dfAcctNo.Text.Length > 0) && _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP ||
                    _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.LN ||
                    _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.CM ||
                    _tlTranSet.CurTran.TranAcct.DepLoan.Value == "EX") &&
                    _tlTranSet.CurTran.TranAcct.SuspectAcct.Value != 1 && ScreenHasAccess("custSummary", false); //#76458 - added EX, cas470002 - added false

                lblColBal.Visible = panelAvailBal.Visible && _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP;
                dfColBal.Visible = lblColBal.Visible;
                EnableDisableControls(EnumEnableDisable.CDRedemp);

                //Begin Bug #92171
                // Begin Story#119103 - Skip this code for AVTC becasue it was Added for QuickTran Window
                if (!_tlTranSet.IsTellerCaptureTran)
                {
                    string tranCode = cmbTranCode.CodeValue as string;
                    if (!string.IsNullOrEmpty(tranCode) && tranCode.Length == 3)
                    {
                        SetQuickTranCodeField(tranCode, null);
                        pbCashIn.Enabled = _tlTranSet.IsCompVisible(_tlTranSet.CurTran.CashIn.XmlTag);
                    }
                    else
                    {

                        pbItemCapture.Enabled = pbItemCapture.Visible = false;
                        pbCashIn.Enabled = pbCashIn.Visible = false;
                    }
                }
                //End Bug #92171
                //End Story#119103
            }
            #endregion

            #region TranCodeSelect
            if (origin == "TranCodeSelect")
            {
                ArrayList disableList = new ArrayList();
                ArrayList enableList = new ArrayList();
                Control baseControl = null;
                string xmlTag = null;
                //int xLoc = 0;
                //int yLoc = 0;
                // bool showTCD = false;
                // bool showDrawer = false;
                bool isBatchTran = (!_tlTranSet.CurTran.BatchId.IsNull && _tlTranSet.CurTran.BatchId.Value > 0);

                // Begin WI#10527 - Force BusObj To Set IsSqrFormExisting flag
                _tlTranSet.IsSqrFormExist();
                // End WI#10527

                #region Enable/Disable list
                // get the fields to be enabled/disabled based on admin setup and TC
                _tlTranSet.FieldStatus(enableList, disableList);

                #region Disable CashIn/Out for Non Cash Drawer - #79619
                if (TellerVars.Instance.IsNonCashDrawer)
                {
                    if (enableList.IndexOf("CashIn") >= 0)
                    {
                        enableList.RemoveAt(enableList.IndexOf("CashIn"));
                        disableList.Add("CashIn");
                    }
                    if (enableList.IndexOf("CashOut") >= 0)
                    {
                        enableList.RemoveAt(enableList.IndexOf("CashOut"));
                        disableList.Add("CashOut");
                    }
                }
                #endregion

                #region Disable Penalty Amt for non-Time accounts - #21599

                if (_tlTranSet.CurTran.TranAcct.DepLoan.Value == "DP"
                    && _tlTranSet.CurTran.TranAcct.DepType.Value != "Time"
                    && _tlTranSet.CurTran.TranCode.Value == 187)
                {
                    string penaltyTag = _tlTranSet.CurTran.PenaltyAmt.XmlTag;
                    if (enableList.IndexOf(penaltyTag) >= 0)
                    {
                        enableList.RemoveAt(enableList.IndexOf(penaltyTag));
                        disableList.Add(penaltyTag);
                    }
                }
                #endregion


                //Begin 126205-2
                if (_tlTranSet.CurTran.PostRealTime.Value == 1 && //Realtime mode  
                    _tlTranSet.CurTran.TranCode.Value == 145 &&
                    (!_tlTranSet.CurTran.TranAcct.IRA.IsNull) && (!_tlTranSet.CurTran.TranAcct.UmbType.IsNull) &&
                    _tlTranSet.CurTran.TranAcct.IRA.Value == "Y" &&
                    (_tlTranSet.CurTran.TranAcct.UmbType.Value == "IRA" || _tlTranSet.CurTran.TranAcct.UmbType.Value == "SEP" ||
                     _tlTranSet.CurTran.TranAcct.UmbType.Value == "SIMPLE" || _tlTranSet.CurTran.TranAcct.UmbType.Value == "Keogh" ||
                     _tlTranSet.CurTran.TranAcct.UmbType.Value == "Qualified")
                   )
                {
                    EnableUmbCode60 = true;

                    //Enable the UMB Code combo box
                    string sUmbCode = _tlTranSet.CurTran.UmbCode.XmlTag;
                    if (disableList.IndexOf(sUmbCode) >= 0)
                    {
                        disableList.RemoveAt(disableList.IndexOf(sUmbCode));
                        enableList.Add(sUmbCode);
                    }
                }
                else
                    EnableUmbCode60 = false;
                //End 126205-2           

                // now travel thru the form controls and enable/disable them
                EnableDisableControls("FormCreateTC");

                baseControl = this.GetNextControl(null, true);
                while (baseControl != null)
                {
                    xmlTag = GetXmlTag(baseControl);
                    if (xmlTag != null)
                    {
                        enableState = EnableState.Default;

                        if (enableList.IndexOf(xmlTag) >= 0)
                            enableState = EnableState.Enable;

                        if (disableList.IndexOf(xmlTag) >= 0)
                            enableState = EnableState.Disable;

                        #region enable/disable if required
                        if (enableState != EnableState.Default && baseControl is IPhoenixUI)
                        {
                            if (enableState == EnableState.Enable)
                                visibleState = VisibilityState.Show;
                            else
                            {
                                visibleState = (baseControl.Visible ? VisibilityState.Show : VisibilityState.Hide);
                                if (baseControl == dfTranDescription || baseControl == dfReference || baseControl == cmbInventoryType)  //#21564
                                    visibleState = VisibilityState.Hide;
                            }

                            if (xmlTag == _tlTranSet.CurTran.UmbCode.XmlTag)
                            {
                                //Begin 126205-2
                                if (EnableUmbCode60 == true)
                                {
                                    cmbUmbCode.Value = null;

                                    cmbUmbCode.Populate(_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbUmbCode2"]);

                                    cmbUmbCode.SetObjectStatus(NullabilityState.Default, visibleState, EnableState.Enable);
                                    lblUMBCode.SetObjectStatus(NullabilityState.Default, visibleState, EnableState.Enable);
                                }
                                else
                                {
                                    cmbUmbCode.Populate(_tlTranSet.TellerVars.ComboCache["frmTlTranCode.cmbUmbCode"]);

                                    if (!_tlTranSet.CurTran.UmbCode.IsNull)
                                    {
                                        dfUMBCode.UnFormattedValue = _tlTranSet.CurTran.TranAcct.UmbCode.Value.ToString() + "-" + _tlTranSet.CurTran.TranAcct.UmbDesc.Value;
                                    }

                                    cmbUmbCode.CodeValue = _tlTranSet.CurTran.UmbCode.IsNull ? _tlTranSet.CurTran.TranAcct.UmbCode.Value : _tlTranSet.CurTran.UmbCode.Value;

                                    dfUMBCode.SetObjectStatus(NullabilityState.Default, visibleState, EnableState.DisableShowText);
                                    lblUMBCode.SetObjectStatus(NullabilityState.Default, visibleState, EnableState.Enable);
                                }
                                //End 126205
                            }
                            /*Begin #79506*/
                            else
							   if (xmlTag == _tlTranSet.CurTran.ChannelId.XmlTag)
								{
									cmbChannel.SetObjectStatus(NullabilityState.Default,
										  visibleState, EnableState.Enable);
									lblChannel.SetObjectStatus(NullabilityState.Default,
										visibleState, EnableState.Enable);

									//Begin #9891
									cmbChannel.SetObjectStatus(NullabilityState.Default,
										  VisibilityState.Hide, EnableState.Enable);
									lblChannel.SetObjectStatus(NullabilityState.Default,
										VisibilityState.Hide, EnableState.Enable);
									//End #9891
								}
                            /*End #79506*/
                            else
                            {
                                if (xmlTag == _tlTranSet.CurTran.CcAmt.XmlTag)
                                    enableState = EnableState.Disable;

                                (baseControl as IPhoenixUI).SetObjectStatus(NullabilityState.Default,
                                    visibleState, enableState);

                                #region take care of associated labels with the fields
                                if (xmlTag == _tlTranSet.CurTran.ReferenceAcctType.XmlTag)
                                    lblRefAccount.SetObjectStatus(NullabilityState.Default,
                                        visibleState, enableState);
                                else if (xmlTag == _tlTranSet.CurTran.UtilityId.XmlTag)
                                    lblUtility.SetObjectStatus(NullabilityState.Default,
                                        visibleState, enableState);
                                else if (xmlTag == _tlTranSet.CurTran.CheckNo.XmlTag)
                                    lblItems.SetObjectStatus(NullabilityState.Default,
                                        visibleState, enableState);
                                else if (xmlTag == _tlTranSet.CurTran.PenaltyAmt.XmlTag)
                                    lblPenalty.SetObjectStatus(NullabilityState.Default,
                                        visibleState, enableState);
                                else if (xmlTag == _tlTranSet.CurTran.IntAmt.XmlTag)
                                    lblInterestPaid.SetObjectStatus(NullabilityState.Default,
                                        visibleState, enableState);
                                else if (xmlTag == _tlTranSet.CurTran.TranEffectiveDt.XmlTag)
                                    lblEffective.SetObjectStatus(NullabilityState.Default,
                                        visibleState, enableState);
                                else if (xmlTag == _tlTranSet.CurTran.CcAmt.XmlTag)
                                    lblFeeAmount.SetObjectStatus(NullabilityState.Default,
                                        visibleState, EnableState.Enable);
                                else if (xmlTag == _tlTranSet.CurTran.Description.XmlTag)
                                    lblDescription.SetObjectStatus(NullabilityState.Default,
                                        visibleState, EnableState.Enable);
                                else if (xmlTag == _tlTranSet.CurTran.Reference.XmlTag)
                                    lblReference.SetObjectStatus(NullabilityState.Default,
                                        visibleState, EnableState.Enable);
									//#79370
								else if (xmlTag == _tlTranSet.CurTran.OnUsTc.XmlTag)
									this.lblOnUsTc.SetObjectStatus(NullabilityState.Default,
										visibleState, EnableState.Enable);
                                else if (xmlTag == _tlTranSet.CurTran.TypeId.XmlTag)
                                    lblInventoryType.SetObjectStatus(NullabilityState.Default,
                                        visibleState, enableState); //#140772
                                else if (xmlTag == _tlTranSet.CurTran.PacketId.XmlTag)
                                    lblPacket.SetObjectStatus(NullabilityState.Default,
                                        visibleState, enableState); //#140772
                                else if (xmlTag == _tlTranSet.CurTran.NoInvAvailable.XmlTag)
                                    lblNoInvAvailable.SetObjectStatus(NullabilityState.Default,
                                        visibleState, enableState); //#140772
                                else if (xmlTag == _tlTranSet.CurTran.InvSerialNo.XmlTag)
                                    lblPacket.SetObjectStatus(NullabilityState.Default,
                                        visibleState, enableState); //#140772
                                #endregion
                            }

                        }
                        #endregion

                        #region check for amt field
                        if (amtFields.IndexOf(baseControl) >= 0)
                        {
                            if (!_tlTranSet.IsCompVisible(xmlTag))
                            {
                                controlList = GetAssocControls("EnableDisable", baseControl);
                                foreach (Control control in controlList)
                                {
                                    (control as IPhoenixUI).SetObjectStatus(NullabilityState.Default,
                                        VisibilityState.Hide, EnableState.Default);
                                }
                            }
                        }
                        #endregion

                    }
                    baseControl = this.GetNextControl(baseControl, true);

                }
                //Begin #79496
                if (!_tlTranSet.IsCompVisible(dfOnUsChks.XmlTag) && _tlTranSet.OnUsIsCustomOffset())
                {
                    //Begin #17716
                    //cmbTfrAcctType.SetObjectStatus(NullabilityState.Default,
                    //                    VisibilityState.Show, EnableState.Default);
                    //dfTfrAcctNo.SetObjectStatus(NullabilityState.Default,
                    //VisibilityState.Show, EnableState.Default);

                    controlList = GetCustomGLOffSetAcctFields();
                    foreach (Control control in controlList)
                    {
                        (control as IPhoenixUI).SetObjectStatus(NullabilityState.Default,
                            VisibilityState.Show, EnableState.Disable);
                    }
                    //End #17716
                }
                //End #79496
                #endregion

                // Begin - WI#10527 - The dfCheckNo Disable Is Now Controlled by isSqrCheckExisting
                #region Disable dfCheckNo Field is SQRForm
                if (_tlTranSet.IsSqrFormExisting.Value == "Y")
                {
                    if (_tlTranSet.TellerVars.AdTlControl.CheckNoRequire.Value == GlobalVars.Instance.ML.Y &&
                        (_tlTranSet.CurTran.TranCode.Value == 902 || _tlTranSet.CurTran.TranCode.Value == 910)) // #24110 - spatterson
                    {
                        dfCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                        lblItems.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                        dfCheckNo.UnFormattedValue = null;
                    }
                }
                #endregion
                // End - WI#10527 - The dfCheckNo Disable Is Now Controlled by isSqrCheckExisting

                #region disable other fields
                visibleState = (ShowPassbook(1, _tlTranSet.CurTran.TranAcct.AcctHasPassbook.Value, cbPbPresent) ?
                    VisibilityState.Show : VisibilityState.Hide);
                cbPbPresent.SetObjectStatus(NullabilityState.Default, visibleState, EnableState.Disable);
                //ActionAddNext.SetObjectStatus( NullabilityState.Default, VisibilityState.Default, ( enableAddNext ? EnableState.Enable : EnableState.Disable ) );
                ActionAddNext.Enabled = enableAddNext;
                pbFees.Enabled = _tlTranSet.IsCompVisible(_tlTranSet.CurTran.CcAmt.XmlTag);
                pbFees.Visible = pbFees.Enabled;
                pbItemCapture.Enabled = (_tlTranSet.AdTlTc.ItemCapture.Value == GlobalVars.Instance.ML.Y);
                pbItemCapture.Visible = pbItemCapture.Enabled;
                pbCashIn.Enabled = _tlTranSet.IsCompVisible(_tlTranSet.CurTran.CashIn.XmlTag);
                pbCashIn.Visible = pbCashIn.Enabled && _tlTranSet.CurTran.TlTranCode.Value != "VLT" && _tlTranSet.CurTran.TlTranCode.Value != "VLS"; //#72916 - suppress CashIn form    #79574
                pbCashOut.Enabled = (_tlTranSet.TellerVars.AdTlControl.DenomCashOut.Value !=
                    GlobalVars.Instance.ML.Y && (_tlTranSet.IsCompVisible(_tlTranSet.CurTran.CashOut.XmlTag) ||
                    isBatchTran));
                pbCashOut.Visible = pbCashOut.Enabled && _tlTranSet.CurTran.TlTranCode.Value != "VLT" && _tlTranSet.CurTran.TlTranCode.Value != "VLS";  //#79574

                #region #7449
                // #8868 - Added trancodes 152, 156 and 191.
                // #80621 - Added TC189
                bool offline = !_tlTranSet.TellerVars.IsAppOnline; // #8290
                if (_tlTranSet.CurTran.TranCode.Value == 938 || _tlTranSet.CurTran.TranCode.Value == 939)   //#140772
                {
                    cmInventory.MenuItems[0].Enabled = ((CoreService.UIAccessProvider.GetScreenAccess(Phoenix.Shared.Constants.ScreenId.InventoryPurchaseReturnDetail) & AuthorizationType.Read) == AuthorizationType.Read &&
                _tlTranSet.TellerVars.IsInventoryTrackingEnabled);
                    dfNoInvAvailable.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.DisableShowText);
                    if (!_tlTranSet.TellerVars.AdTlTc.TypeId.IsNull && !string.IsNullOrEmpty(_tlTranSet.TellerVars.AdTlTc.TypeId.StringValue))
                    {
                        cmbInventoryType.DefaultCodeValue = _tlTranSet.TellerVars.AdTlTc.TypeId.Value;
                        cmbInventoryType.InitialDisplayType = UIComboInitialDisplayType.DisplayDefault;
                        cmbInventoryType.SetDefaultValue();
                        cmbInventoryType.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.DisableShowText);
                    }
                }
                else
                    cmInventory.MenuItems[0].Enabled = false;
                pbInventory.Enabled = (GlobalVars.UserType == "Combined" ? CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InventoryItemSearchBackOffice) : CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InventoryItemSearchTeller) 
                                        && _tlTranSet.TellerVars.IsInventoryTrackingEnabled);  //#140772 //77062
                if (!pbInventory.Enabled)
                {
                    pbInventory.Enabled = (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.InventoryPurchaseReturnDetail) && _tlTranSet.TellerVars.IsInventoryTrackingEnabled);  //#140772
                    //    pbInventory.Enabled = ((CoreService.UIAccessProvider.GetScreenAccess(Phoenix.Shared.Constants.ScreenId.InventoryPurchaseReturnDetail) & AuthorizationType.Read) == AuthorizationType.Read &&
                    //_tlTranSet.TellerVars.IsInventoryTrackingEnabled);  //#140772
                }
                //#80617 - added TC150; #134650 added TC164
                if ((_tlTranSet.CurTran.TranCode.Value == 150 || _tlTranSet.CurTran.TranCode.Value == 102 || _tlTranSet.CurTran.TranCode.Value == 163 || _tlTranSet.CurTran.TranCode.Value == 164 || _tlTranSet.CurTran.TranCode.Value == 152 || _tlTranSet.CurTran.TranCode.Value == 156 || _tlTranSet.CurTran.TranCode.Value == 189 || _tlTranSet.CurTran.TranCode.Value == 191) && !offline)
                {
                    if (Phoenix.FrameWork.CDS.DataService.Instance.XmDbStatus != XmDbStatus.Day)
                    {
                        if (_tlTranSet.CurTran.TranCode.Value == 102 && cmbTfrAcctType.Text != "" && dfTfrAcctNo.UnFormattedValue != null && dfTfrAcctNo.Text != "")
                        {
                            _dpDisplay = new DpDisplay(); // #10129
                            _dpDisplay.AcctType.Value = cmbTfrAcctType.Text;
                            _dpDisplay.AcctNo.Value = dfTfrAcctNo.Text; // #8502
                            _dpDisplay.SelectAllFields = true;
                            _dpDisplay.ActionType = XmActionType.Select;
                            if (!PopulateDepositObjUsingAcctDetails(_dpDisplay, true))   // #19415 - if test
                                CoreService.DataService.ProcessRequest(_dpDisplay);
                            cbRegD.Enabled = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                            cbRegD.Checked = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                            cbRegD.Visible = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                        }
                        #region #10481 - Commented block
                        //else if (_tlTranSet.CurTran.TranCode.Value == 102 && cmbAcctType.Text != "" && dfAcctNo.UnFormattedValue != null && dfAcctNo.Text != "")
                        //{
                        //    _dpDisplay = new DpDisplay(); // #10129
                        //    _dpDisplay.AcctType.Value = cmbAcctType.Text;
                        //    _dpDisplay.AcctNo.Value = dfAcctNo.Text; // #8502
                        //    _dpDisplay.SelectAllFields = true;

                        //    _dpDisplay.ActionType = XmActionType.Select;
                        //    CoreService.DataService.ProcessRequest(_dpDisplay);
                        //    cbRegD.Enabled = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                        //    cbRegD.Checked = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                        //    cbRegD.Visible = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                        //}
                        #endregion

                        // #80621 - Added TC189, #80617 - Added TC150; #134650 added TC164
                        else if ((_tlTranSet.CurTran.TranCode.Value == 150 || _tlTranSet.CurTran.TranCode.Value == 163 || _tlTranSet.CurTran.TranCode.Value == 164 || _tlTranSet.CurTran.TranCode.Value == 152 || _tlTranSet.CurTran.TranCode.Value == 156 || _tlTranSet.CurTran.TranCode.Value == 189 || _tlTranSet.CurTran.TranCode.Value == 191) && cmbAcctType.Text != "" && dfAcctNo.UnFormattedValue != null && dfAcctNo.Text != "")
                        {
                            _dpDisplay = new DpDisplay(); // #10129
                            _dpDisplay.AcctType.Value = cmbAcctType.Text;
                            _dpDisplay.AcctNo.Value = dfAcctNo.Text; // #8502
                            _dpDisplay.SelectAllFields = true;
                            _dpDisplay.ActionType = XmActionType.Select;
                            if (!PopulateDepositObjUsingAcctDetails(_dpDisplay, false))   // #19415 - if test
                                CoreService.DataService.ProcessRequest(_dpDisplay);
                            cbRegD.Enabled = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                            if (isTranView != true || ((Phoenix.FrameWork.BusFrame.DbChar)(_tlTranSet.CurTran.ProcessAsRegD)).Value != "N")  //WI-13697
                            {
                                //#140780: Added _tlTranSet.AdTlTc.AutoSelectRegd.Value == "Y" to the condition below
                                cbRegD.Checked = (_tlTranSet.AdTlTc.RegD.Value == Phoenix.FrameWork.Shared.Variables.GlobalVars.Instance.ML.Y && _tlTranSet.AdTlTc.AutoSelectRegd.Value == "Y" && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                            }   //WI-13697
                            cbRegD.Visible = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449


                            // Begin #80621
                            // #140780: Added 191
                            if (_tlTranSet.CurTran.TranCode.Value == 189 || _tlTranSet.CurTran.TranCode.Value == 191)
                            {
                                cbRegD.Checked = true;    // #140780
                                cbRegD.Enabled = false;
                            }
                            // End #80621
                        }
                        else
                        {
                            cbRegD.Enabled = false;
                            cbRegD.Checked = false;
                            cbRegD.Visible = false;
                        }
                    }   //End of "if (Phoenix.FrameWork.CDS.DataService.Instance.XmDbStatus != XmDbStatus.Day)"
                    else
                    {
                        if (_tlTranSet.CurTran.TranCode.Value == 102 && cmbTfrAcctType.Text != "" && dfTfrAcctNo.UnFormattedValue != null && dfTfrAcctNo.Text != "")
                        {
                            _dpAcct = new DpAcct(); // #10129
                            _dpAcct.AcctType.Value = cmbTfrAcctType.Text;
                            _dpAcct.AcctNo.Value = dfTfrAcctNo.Text; // #8502
                            _dpAcct.SelectAllFields = true;

                            _dpAcct.ActionType = XmActionType.Select;
                            if (!PopulateDepositObjUsingAcctDetails(_dpAcct, true))   // #19415 - if test
                                CoreService.DataService.ProcessRequest(_dpAcct);
                            cbRegD.Enabled = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                            cbRegD.Checked = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                            cbRegD.Visible = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                        }
                        #region #10481 - Commented block
                        //else if (_tlTranSet.CurTran.TranCode.Value == 102 && cmbAcctType.Text != "" && dfAcctNo.UnFormattedValue != null && dfAcctNo.Text != "")
                        //{
                        //    _dpAcct = new DpAcct(); // #10129
                        //    _dpAcct.AcctType.Value = cmbAcctType.Text;
                        //    _dpAcct.AcctNo.Value = dfAcctNo.Text; // #8502
                        //    _dpAcct.SelectAllFields = true;

                        //    _dpAcct.ActionType = XmActionType.Select;
                        //    CoreService.DataService.ProcessRequest(_dpAcct);
                        //    cbRegD.Enabled = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                        //    cbRegD.Checked = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                        //    cbRegD.Visible = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                        //}
                        #endregion
                        // #80621 - Added TC189, #80617 - Added TC150; #134650 added TC164
                        else if ((_tlTranSet.CurTran.TranCode.Value == 150 || _tlTranSet.CurTran.TranCode.Value == 163 || _tlTranSet.CurTran.TranCode.Value == 164 || _tlTranSet.CurTran.TranCode.Value == 152 || _tlTranSet.CurTran.TranCode.Value == 156 || _tlTranSet.CurTran.TranCode.Value == 189 || _tlTranSet.CurTran.TranCode.Value == 191) && cmbAcctType.Text != "" && dfAcctNo.UnFormattedValue != null && dfAcctNo.Text != "")
                        {
                            _dpAcct = new DpAcct(); // #10129
                            _dpAcct.AcctType.Value = cmbAcctType.Text;
                            _dpAcct.AcctNo.Value = dfAcctNo.Text; // #8502
                            _dpAcct.SelectAllFields = true;
                            _dpAcct.ActionType = XmActionType.Select;
                            if (!PopulateDepositObjUsingAcctDetails(_dpAcct, false))   // #19415 - if test
                                CoreService.DataService.ProcessRequest(_dpAcct);
                            cbRegD.Enabled = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                            if (isTranView != true || ((Phoenix.FrameWork.BusFrame.DbChar)(_tlTranSet.CurTran.ProcessAsRegD)).Value != "N")  //WI-13697
                            {
                                //#140780: Added _tlTranSet.AdTlTc.AutoSelectRegd.Value == "Y" to the condition below
                                cbRegD.Checked = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && _tlTranSet.AdTlTc.AutoSelectRegd.Value == "Y" && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                            }   //WI-13697
                            cbRegD.Visible = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449

                            // Begin #80621
                            // #140780: Added 191
                            if (_tlTranSet.CurTran.TranCode.Value == 189 || _tlTranSet.CurTran.TranCode.Value == 191)
                            {
                                cbRegD.Checked = true;    // #140780
                                if (_tlTranSet.CurTran.TranCode.Value == 189)   // #56039
                                { 
                                    cbRegD.Enabled = false;
                                }
                                else //#56039
                                {
                                    cbRegD.Enabled = true;
                                }
                            }
                            // End #80621
                        }
                        else
                        {
                            cbRegD.Enabled = false;
                            cbRegD.Checked = false;
                            cbRegD.Visible = false;
                        }
                    }
                }  //End of "if ((_tlTranSet.CurTran.TranCode.Value == 150 || _tlTranSet.CurTran.TranCode.Value == 102 || _tlTranSet.CurTran.TranCode.Value == 163 || _tlTranSet.CurTran.TranCode.Value == 152 || _tlTranSet.CurTran.TranCode.Value == 156 || _tlTranSet.CurTran.TranCode.Value == 189 || _tlTranSet.CurTran.TranCode.Value == 191) && !offline)"
                else
                {
                    cbRegD.Enabled = false;
                    cbRegD.Checked = false;
                    cbRegD.Visible = false;
                }

                #endregion
                #endregion

                //}

                //#endregion

                //iconRealTime.Visible = ( _tlTranSet.AdTlTc.RealTimeEnable.Value == GlobalVars.Instance.ML.Y );
                picRealTime.Visible = (_tlTranSet.AdTlTc.RealTimeEnable.Value == GlobalVars.Instance.ML.Y);
                picMemo.Visible = !picRealTime.Visible;
                //Begin #17178
                //bondAction.Enabled = (_tlTranSet.CurTran.TranCode.Value == 912 || _tlTranSet.CurTran.TranCode.Value == 915 || _tlTranSet.CurTran.TranCode.Value == 921);
                EnableDisableControls(EnumEnableDisable.ActionSavingsBond);
                //End #17178
                //Begin #72916
                #region handle tcd picture icons

                #region disable tcd fields
                picTCD.Visible = false;
                cbDenominate.Visible = false;
                cbWaiveSignature.Visible = false; //#76033
                picDrawer.Visible = false;
                #endregion
                if (_tlTranSet.TellerVars.IsTCDEnabled || _tlTranSet.TellerVars.IsTCDConnected)
                {
                    if (!isBatchTran)
                    {
                        if (dfCashOut.Visible || (dfCashIn.Visible && (_tlTranSet.CurTran.TlTranCode.Value == "VLT" ||
                            _tlTranSet.TellerVars.IsRecycler))) //#72916  #79574
                        {
                            picTCD.Visible = (_tlTranSet.TellerVars.IsTCDConnected);
                            if (_tlTranSet.CurTran.TlTranCode.Value != "VLS")   //#79574
                            {
                                if (!picTCD.Visible)
                                {
                                    picDrawer.Visible = (_tlTranSet.TellerVars.IsTCDEnabled);
                                    cbDenominate.Visible = (picTCD.Visible);

                                }
                                else
                                {
                                    picDrawer.Visible = (!picTCD.Visible);
                                    cbDenominate.Visible = (picTCD.Visible); //#72916
                                }
                            }

                        }
                        //#72916*
                        if (_tlTranSet.CurTran.TlTranCode.Value == "VLT" || _tlTranSet.CurTran.TlTranCode.Value == "VLS")   //#79574
                        {
                            if (_tlTranSet.CurTran.TlTranCode.Value == "VLT")
                            {
                                cbDenominate.Checked = true;
                                cbDenominate.ScreenToObject();
                                cbDenominate.Enabled = false;
                            }
                            dfCheckNo.Text = _tlTranSet.TellerVars.TcdDrawerNo.ToString();
                            dfCheckNo.UnFormattedValue = _tlTranSet.TellerVars.TcdDrawerNo;
                            dfCheckNo.ScreenToObject();
                            dfCheckNo.Enabled = false;
                        }
                    }
                    else if (isBatchTran)
                    {
                        if (dfAmt.Visible)
                        {
                            picTCD.Visible = (_tlTranSet.TellerVars.IsTCDConnected);
                            if (!picTCD.Visible)
                            {
                                picDrawer.Visible = (_tlTranSet.TellerVars.IsTCDEnabled);
                                cbDenominate.Visible = (picTCD.Visible);

                            }
                            else
                            {
                                picDrawer.Visible = (!picTCD.Visible);
                                cbDenominate.Visible = (picTCD.Visible); //#72916
                            }
                        }
                    }
                    //#79574
                    if (picTCD.Visible)
                    {
                        if (_tlTranSet.CurTran.TlTranCode.Value != "VLT" &&
                        _tlTranSet.CurTran.TlTranCode.Value != "VLS" &&
                        _tlTranSet.TellerVars.TcdStationId.Trim() == "C")
                            picTCD.Visible = false;
                        if (_tlTranSet.TellerVars.AllowTcdTcrNonMonetaryOnly)
                            picTCD.Visible = false;
                        if (_tlTranSet.CurTran.TlTranCode.Value != "VLT" &&
                            _tlTranSet.CurTran.TlTranCode.Value != "VLS" &&
                            !_tlTranSet.CurTran.TranCode.IsNull && (_tlTranSet.CurTran.TranCode.Value == 505 ||
                            _tlTranSet.CurTran.TranCode.Value == 555))
                        {
                            picTCD.Visible = false;
                            _tlTranSet.TellerVars.IsTCDConnected = false;   //#9266
                        }
                    }
                    //
                    picDrawer.Visible = (!picTCD.Visible && _tlTranSet.TellerVars.IsTCDEnabled && ((!isBatchTran && (dfCashOut.Visible || dfCashIn.Visible)) || (isBatchTran && dfAmt.Visible))); //#9594
                    cbDenominate.Visible = (picTCD.Visible && _tlTranSet.CurTran.TlTranCode.Value != "VLS");
                }
                #endregion
                //End #72916
                //#9425
                //Begin #76033
                //if (_tlTranSet.IsHylandVoucherSvcAvailable())
                //{
                //    if (_tlTranSet.CurTran.BatchId.IsNull || _tlTranSet.CurTran.BatchId.Value <= 0)
                //    {
                //        if (dfCashOut.Visible)
                //            cbWaiveSignature.Visible = _tlTranSet.ShowWaiveSignatureBox();
                //    }
                //    else if (!_tlTranSet.CurTran.BatchId.IsNull && _tlTranSet.CurTran.BatchId.Value > 0)
                //    {
                //        if (dfAmt.Visible)
                //            cbWaiveSignature.Visible = _tlTranSet.ShowWaiveSignatureBox();
                //    }
                //}
                cbWaiveSignature.Visible = _tlTranSet.ShowWaiveSignatureBox();
                //End #76033

                //Begin #76425
                if (_tlTranSet.IsRecalcPmtRequired() && _tlTranSet.IsTrueRealtimeMode())
                {
                    cmbRecalcPmtDt.Visible = true;
                    lblRecalcPmtDt.Visible = true;
                    dfRecalcPmt.Visible = true;
                    lblRecalcPmt.Visible = true;
                    cmbRecalcPmtDt.PhoenixUIControl.BusObjectProperty.IsNullable = false;
                    this.dfRecalcPmt.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.RecalcPmtAmt; //#76425
                    this.cmbRecalcPmtDt.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.RecalcPmtDt; //#76425
                }
                else
                {
                    cmbRecalcPmtDt.Visible = false;
                    lblRecalcPmtDt.Visible = false;
                    dfRecalcPmt.Visible = false;
                    lblRecalcPmt.Visible = false;
                    cmbRecalcPmtDt.PhoenixUIControl.BusObjectProperty.IsNullable = true;
                }
                //End #76425

				//Begin #79572
				if (IsDisplayTransitItemFields())
				{
					dfTransitChks.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Enable);
					lblTlItemAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
					dfTlItemAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
					lblTlItemRoutingNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
					dfTlItemRoutingNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
					lblTlItemCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
					dfTlItemCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
				}
				else
				{
					lblTlItemAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Enable);
					dfTlItemAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Enable);
					lblTlItemRoutingNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Enable);
					dfTlItemRoutingNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Enable);
					lblTlItemCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Enable);
					dfTlItemCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Enable);
				}
				//End #79572

                //Begin #21564
                //if (!_tlTranSet.CurTran.PacketId.IsNull && _tlTranSet.CurTran.PacketId.Value > 0)
                //{
                //    lblPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Default);
                //    dfInvSerialNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                //    cmbInventoryPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Default);
                //    SetPacketSerialLabel();
                //}
                //else
                //{
                //    lblPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                //    cmbInventoryPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                //}
                //if (!_tlTranSet.CurTran.InvSerialNo.IsNull && _tlTranSet.CurTran.InvSerialNo.Value > 0)
                //{
                //    lblPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Default);
                //    cmbInventoryPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                //    dfInvSerialNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Default);
                //    SetPacketSerialLabel();
                //}
                //else
                //{
                //    lblPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                //    dfInvSerialNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                //}
                //if (!_tlTranSet.CurTran.TypeId.IsNull && _tlTranSet.CurTran.TypeId.Value > 0)
                //{
                //    SetInventoryTypeField();
                //}
                //End #21564

				//Begin #80617
				if (_tlTranSet.CurTran.TranCode.Value == 313)
				{
					CallXMThruCDS("EscrowAgent");
					cmbLnEscrowAgent.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Default);
                    if (cmbLnEscrowAgent.Items.Count > 0 && _tlJournal.Loan3rdPartyId.EnumValues.Count > 0)
						cmbLnEscrowAgent.SetValue((_tlJournal.Loan3rdPartyId.EnumValues[0] as EnumValue).CodeValue);

					lblLnEscrowAgent.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Default);
				}
				else
				{
					cmbLnEscrowAgent.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
					lblLnEscrowAgent.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
				}
				//End #80617

                EnableDisableControls(EnumEnableDisable.CDRedemp);   //140782-3,21347

                //Bug #109821
                //tabEasyCapture.IsDisabled = true;
                //Bug 109955 Only disable select tab is input tran
                if (picTabs.SelectedIndex == (int)TAB.InputTran)
                    tabEasyCapture.IsDisabled = true;


            }  //End of "if (origin == "TranCodeSelect")"
            #endregion

            if (origin == "AddNextClick" || origin == "RemoveTranClick")
            {
                pbRemoveTran.Enabled = ctwTranSet.Count > 0 && ctwTranSet.ContextRow >= 0;
                ActionAddNext.Enabled = enableAddNext;
                pbSelectTran.Enabled = pbRemoveTran.Enabled;
            }

            else if (origin == "TfrAcctNoEnter")
            {
                if (!_tlTranSet.CurTran.TfrAcct.SuspectAcct.IsNull && _tlTranSet.CurTran.TfrAcct.SuspectAcct.Value != 1)  //#13333
                {
                    if (ShowPassbook(2, _tlTranSet.CurTran.TfrAcct.AcctHasPassbook.Value, cbTfrPbPresent))
                        cbTfrPbPresent.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Disable);
                    if (_tlTranSet.CurTran.TfrAcct.AcctHasPassbook.Value == GlobalVars.Instance.ML.Y && IsPbSupportedNow())
                        Name4.IsDisabled = false;

                    // Begin #74015
                    pbOnUsDisplay.Enabled = ScreenHasAccess("display", true);       // WI#16236 passing isTfrAcct as true
                    pbOnUsDisplay.Enabled = !rimRestrictTfrAcct;	//74778
                    // #80620 - Commented pbOnUsSig.Enabled = (_tlTranSet.AdGbRsm.ShowOnUsSigCard.Value == GlobalVars.Instance.ML.Y);
                    // End #74015
                    //Begin #76458
                    pbOnUsDisplay.Enabled = pbOnUsDisplay.Enabled && !_tlTranSet.IsExternalAdapterAcct(_tlTranSet.CurTran.TfrAcct.AcctType.Value); //#76458
                    // #80620 - Commented pbOnUsSig.Enabled = pbOnUsSig.Enabled && !_tlTranSet.IsExternalAdapterAcct(_tlTranSet.CurTran.TfrAcct.AcctType.Value); //#76458
                    //End #76458
                    //pbOnUs.Enabled = ScreenHasAccess("display"); // #80620
                    //pbOnUs.Enabled = pbOnUs.Enabled && !_tlTranSet.IsExternalAdapterAcct(_tlTranSet.CurTran.TfrAcct.AcctType.Value); // #80620
                    #region #80620
                    pbOnUs.Enabled = true;
                    onUsBar.Visible = true;
                    onUsBar.Enabled = true;
                    #endregion
                }
            }

            else if (origin == "TranSetClick")
            {
                pbRemoveTran.Enabled = ctwTranSet.Count > 0 && ctwTranSet.ContextRow >= 0;
                pbSelectTran.Enabled = pbRemoveTran.Enabled;

            }

            else if (origin == "AcctNoGotFocus")
            {
                pbGetGLAcct.Enabled = _tlTranSet.TellerVars.IsAppOnline && (cmbAcctType.CodeValue != null &&
                    cmbAcctType.CodeValue.ToString() == GlobalVars.Instance.ML.GL);
            }
            else if (origin == "TfrAcctNoGotFocus")
            {
                pbGetGLAcct.Enabled = _tlTranSet.TellerVars.IsAppOnline && (cmbTfrAcctType.CodeValue != null &&
                    cmbTfrAcctType.CodeValue.ToString() == GlobalVars.Instance.ML.GL);
            }

            else if (origin == "AcctNoLostFocus" || origin == "TfrAcctNoLostFocus")
            {
                if (origin == "AcctNoLostFocus")
                {
                    EnableDisableControls(EnumEnableDisable.CDRedemp); //21033
                }
                //pbGetGLAcct.Enabled = false;
                #region #7449
                // #8868 - Added trancodes 152, 156 and 191.
                bool offline = !_tlTranSet.TellerVars.IsAppOnline; // #8290
                //#80617 - added TC150; #134650 added TC164
                if ((_tlTranSet.CurTran.TranCode.Value == 102 || _tlTranSet.CurTran.TranCode.Value == 150 || _tlTranSet.CurTran.TranCode.Value == 163 || _tlTranSet.CurTran.TranCode.Value == 164 || _tlTranSet.CurTran.TranCode.Value == 152 || _tlTranSet.CurTran.TranCode.Value == 156 || _tlTranSet.CurTran.TranCode.Value == 191) && !offline)
                {
                    if (Phoenix.FrameWork.CDS.DataService.Instance.XmDbStatus != XmDbStatus.Day)
                    {
                        if (_tlTranSet.CurTran.TranCode.Value == 102 && cmbTfrAcctType.Text != "" && dfTfrAcctNo.Text != null && dfTfrAcctNo.Text != "")
                        {
                            FmtAcctNoField(dfTfrAcctNo.Text, dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct);
                            _dpDisplay = new DpDisplay(); // #10129
                            _dpDisplay.AcctType.Value = cmbTfrAcctType.Text;
                            _dpDisplay.AcctNo.Value = dfTfrAcctNo.Text; // #8502
                            _dpDisplay.SelectAllFields = true;

                            _dpDisplay.ActionType = XmActionType.Select;
                            if (!PopulateDepositObjUsingAcctDetails(_dpDisplay, true))   // #19415 - if test
                                CoreService.DataService.ProcessRequest(_dpDisplay);
                            cbRegD.Enabled = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                            cbRegD.Checked = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y") && origin == "TfrAcctNoLostFocus"); // #7449 // #10481
                            cbRegD.Visible = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                        }
                        #region #10481 - Commented block
                        //else if (_tlTranSet.CurTran.TranCode.Value == 102 && cmbAcctType.Text != "" && dfAcctNo.Text != null && dfAcctNo.Text != "")
                        //{
                        //    _dpDisplay = new DpDisplay(); // #10129
                        //    _dpDisplay.AcctType.Value = cmbAcctType.Text;
                        //    _dpDisplay.AcctNo.Value = dfAcctNo.Text; // #8502
                        //    _dpDisplay.SelectAllFields = true;

                        //    _dpDisplay.ActionType = XmActionType.Select;
                        //    CoreService.DataService.ProcessRequest(_dpDisplay);
                        //    cbRegD.Enabled = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                        //    cbRegD.Checked = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                        //    cbRegD.Visible = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                        //}
                        #endregion
                        //#80617 - added TC150; #134650 added TC164
                        else if ((_tlTranSet.CurTran.TranCode.Value == 150 || _tlTranSet.CurTran.TranCode.Value == 163 || _tlTranSet.CurTran.TranCode.Value == 164 || _tlTranSet.CurTran.TranCode.Value == 152 || _tlTranSet.CurTran.TranCode.Value == 156 || _tlTranSet.CurTran.TranCode.Value == 191) && cmbAcctType.Text != "" && dfAcctNo.Text != null && dfAcctNo.Text != "")
                        {
                            _dpDisplay = new DpDisplay(); // #10129
                            _dpDisplay.AcctType.Value = cmbAcctType.Text;
                            _dpDisplay.AcctNo.Value = dfAcctNo.Text; // #8502
                            _dpDisplay.SelectAllFields = true;

                            _dpDisplay.ActionType = XmActionType.Select;
                            if (!PopulateDepositObjUsingAcctDetails(_dpDisplay, false))   // #19415 - if test
                                CoreService.DataService.ProcessRequest(_dpDisplay);
                            cbRegD.Enabled = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                            if (origin == "AcctNoLostFocus")
                                //#140780: Added _tlTranSet.AdTlTc.AutoSelectRegd.Value == "Y" to the condition below
                                cbRegD.Checked = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && _tlTranSet.AdTlTc.AutoSelectRegd.Value == "Y" && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449 // #10481
                            cbRegD.Visible = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpDisplay.MMDA.StringValue == "Y" || _dpDisplay.SvRegd.StringValue == "Y")); // #7449
                        }
                        else
                        {
                            cbRegD.Enabled = false;
                            cbRegD.Checked = false;
                            cbRegD.Visible = false;
                        }
                    }
                    else
                    {
                        if (_tlTranSet.CurTran.TranCode.Value == 102 && cmbTfrAcctType.Text != "" && dfTfrAcctNo.Text != null && dfTfrAcctNo.Text != "")
                        {
                            FmtAcctNoField(dfTfrAcctNo.Text, dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct);
                            _dpAcct = new DpAcct(); // #10129
                            _dpAcct.AcctType.Value = cmbTfrAcctType.Text;
                            _dpAcct.AcctNo.Value = dfTfrAcctNo.Text; // #8502
                            _dpAcct.SelectAllFields = true;
                            _dpAcct.ActionType = XmActionType.Select;
                            if (!PopulateDepositObjUsingAcctDetails(_dpAcct, true))   // #19415 - if test
                                CoreService.DataService.ProcessRequest(_dpAcct);
                            cbRegD.Enabled = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                            cbRegD.Checked = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y") && origin == "TfrAcctNoLostFocus"); // #7449 // #10481
                            cbRegD.Visible = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                        }
                        #region #10481 - Commented block
                        //else if (_tlTranSet.CurTran.TranCode.Value == 102 && cmbAcctType.Text != "" && dfAcctNo.Text != null && dfAcctNo.Text != "")
                        //{
                        //    _dpAcct = new DpAcct(); // #10129
                        //    _dpAcct.AcctType.Value = cmbAcctType.Text;
                        //    _dpAcct.AcctNo.Value = dfAcctNo.Text; // #8502
                        //    _dpAcct.SelectAllFields = true;

                        //    _dpAcct.ActionType = XmActionType.Select;
                        //    CoreService.DataService.ProcessRequest(_dpAcct);
                        //    cbRegD.Enabled = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                        //    cbRegD.Checked = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                        //    cbRegD.Visible = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                        //}
                        #endregion
                        //#80617 - added TC150; #134650 added TC164
                        else if ((_tlTranSet.CurTran.TranCode.Value == 150 || _tlTranSet.CurTran.TranCode.Value == 163 || _tlTranSet.CurTran.TranCode.Value == 164 || _tlTranSet.CurTran.TranCode.Value == 152 || _tlTranSet.CurTran.TranCode.Value == 156 || _tlTranSet.CurTran.TranCode.Value == 191) && cmbAcctType.Text != "" && dfAcctNo.Text != null && dfAcctNo.Text != "")
                        {
                            _dpAcct = new DpAcct(); // #10129
                            _dpAcct.AcctType.Value = cmbAcctType.Text;
                            _dpAcct.AcctNo.Value = dfAcctNo.Text; // #8502
                            _dpAcct.SelectAllFields = true;
                            _dpAcct.ActionType = XmActionType.Select;
                            if (!PopulateDepositObjUsingAcctDetails(_dpAcct, false))   // #19415 - if test
                                CoreService.DataService.ProcessRequest(_dpAcct);
                            cbRegD.Enabled = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                            if (origin == "AcctNoLostFocus")
                                // #140780: Added _tlTranSet.AdTlTc.AutoSelectRegd.Value == "Y" to the condition below
                                cbRegD.Checked = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && _tlTranSet.AdTlTc.AutoSelectRegd.Value == "Y" && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449 // #10481
                            cbRegD.Visible = (_tlTranSet.AdTlTc.RegD.Value == GlobalVars.Instance.ML.Y && (_dpAcct.Mmda.StringValue == "Y" || _dpAcct.SvRegd.StringValue == "Y")); // #7449
                        }
                        else
                        {
                            cbRegD.Enabled = false;
                            cbRegD.Checked = false;
                            cbRegD.Visible = false;
                        }
                    }
                }
                else
                {
                    cbRegD.Enabled = false;
                    cbRegD.Checked = false;
                    cbRegD.Visible = false;
                }

                #endregion
            }
            else if (origin == "ControlGotFocus")
            {
                pbGetGLAcct.Enabled = false;
                if (picTabs.SelectedIndex == 0)
                {
                    if (focusAcctField == cmbTfrAcctType)
                        pbRestrictions.Enabled = !_tlTranSet.CurTran.TfrAcct.AcctType.IsNull &&
                            !_tlTranSet.CurTran.TfrAcct.AcctNo.IsNull && _tlTranSet.CurTran.TfrAcct.SuspectAcct.Value != 1 && !_tlTranSet.IsExternalAdapterAcct(_tlTranSet.CurTran.TfrAcct.AcctType.Value); //#76458 - added ex account check
                    else
                        pbRestrictions.Enabled = ScreenHasAccess("restriction", false);     // WI#16236 passing isTfrAcct as false
                }
            }

            else if (origin == "InitializeTran")
            {
                _isOvRunning = false; //Task#90007
                if (_tlTranSet.TellerVars.IsAppOnline) //Task#90007
                    _isOvRunning = _gbHelper.IsOvRunning(); //#90001
                //				( Name3 as Control ).Enabled = false;
                Name0.IsDisabled = false;
                Name1.IsDisabled = false;
                Name2.IsDisabled = !_tlTranSet.TellerVars.IsAppOnline || _isSupervisorViewOnlyMode; //#79314
                Name3.IsDisabled = !_loadCustSummary && !_isSupervisorViewOnlyMode;   //#8839 #79314
                pbLastAcct.Enabled = (_tlTranSet.TellerVars.LastAccts.Count > 0);
                //Begin 89989
                if (picTabs.SelectedTab == tabEasyCapture && _tlTranSet.TellerVars.LastAccts.Count > 0)
                {
                    pbLastAcct.Enabled = GetQuickTranAccts() > 0;
                }
                //End 89989
                tabEasyCapture.IsDisabled = (_tlTranSet.TellerVars.AdTlControl.EnableQuickTranTab.Value != GlobalVars.Instance.ML.Y || _isSupervisorViewOnlyMode
                    || _isOvRunning);  // #88150
                
            }
            else if (origin == "TranEffectiveDt_Leave") //#76425
            {
                if (_tlTranSet.IsRecalcPmtRequired() && _tlTranSet.IsTrueRealtimeMode())
                {
                    cmbRecalcPmtDt.Visible = true;
                    lblRecalcPmtDt.Visible = true;
                    dfRecalcPmt.Visible = true;
                    lblRecalcPmt.Visible = true;
                    cmbRecalcPmtDt.PhoenixUIControl.BusObjectProperty.IsNullable = false;
                }
                else
                {
                    cmbRecalcPmtDt.Visible = false;
                    lblRecalcPmtDt.Visible = false;
                    dfRecalcPmt.Visible = false;
                    lblRecalcPmt.Visible = false;
                    cmbRecalcPmtDt.PhoenixUIControl.BusObjectProperty.IsNullable = true;
                }
            }

            if (origin == "SearchClick")
            {
            }

            if (origin == "SelectSearchClick")
            {
                //	( Name3 as Control ).Enabled = ScreenHasAccess("custSummary");
                // Begin WI#16236
                // Name3.IsDisabled = (!ScreenHasAccess("custSummary"));

                if (this.focusAcctField.Name == "cmbTfrAcctType")
                {
                    this.isTfrAcct = true;
                }
                else
                {
                    this.isTfrAcct = false;
                }
                Name3.IsDisabled = (!ScreenHasAccess("custSummary", this.isTfrAcct));
                // End WI#16236
            }

            if (origin == "SearchControlClick")
            {
                //	( Name3 as Control ).Enabled = ScreenHasAccess("custSummary");
                pbSelectSearch.Enabled = (frmTBarSearch != null && ((frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabSearchResults && frmTBarSearch.grdCustomerList.Count > 0
                    && frmTBarSearch.grdCustomerList.ContextRow >= 0) || (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabRecentCustLookup &&frmTBarSearch.grdCustLookup.Count > 0 && frmTBarSearch.grdCustLookup.ContextRow >= 0))); //60686. Enable button on Recent lookup grid
            }

            if (origin == "SwitchToRim")
            {
                cbRetirement.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                cbPayrollTran.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                cbPbPresent.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Disable);
                //#3538dfAcctNickname.Visible = cbShowAll.Visible = false;     // #76041
                dfAcctNickname.Visible = false;     // #76041
                //#3538cbShowAll.Visible = false; // #76041
            }
            //Begin #76041
            if (origin == "AcctTypeChanged")
            {
                dfAcctNickname.UnFormattedValue = string.Empty;
            }
            //End #76041

            #region Item Capture Click
            if (origin == "ItemCaptureClick")
            {
                controlList = GetAssocControls("EnableDisable", dfOnUsChks);
                foreach (Control control in controlList)
                {
                    if (control == lblOnUsChecks)		// || control == dfOnUsChks
                        continue;
                    if (!_tlTranSet.IsCompVisible(_tlTranSet.CurTran.OnUsChks.XmlTag))
                        continue;

                    enableState = EnableState.Disable;
                    visibleState = VisibilityState.Show;

                    //Begin #74015
                    //if ( control == cbTfrPbPresent )
                    if (control == cbTfrPbPresent || control == lblOnUsTitle1 || control == lblOnUsTitle2)
                        visibleState = VisibilityState.Hide;
                    //End #74015

                    (control as IPhoenixUI).SetObjectStatus(NullabilityState.Default, visibleState, enableState);
                }
                if (_tlTranSet.CurTran.TranAcct.AcctHasPassbook.Value != GlobalVars.Instance.ML.Y)
                    Name4.IsDisabled = true;
                EnableDisableControls("ExceptionHold"); //Task #134375
            }
            #endregion

            #region EnableOnUsFields
            // Begin WI#19027
            //Enable OnUs fields
            if (origin == "EnableOnUsFields")
			{
				controlList = GetAssocControls("EnableDisable", dfOnUsChks);
				foreach (Control control in controlList)
				{
					if (control == lblOnUsChecks)
						continue;
					if (!_tlTranSet.IsCompVisible(_tlTranSet.CurTran.OnUsChks.XmlTag))
						continue;

					//only enable cmbOnUsTc if specifically required
					enableState = ((control == cmbOnUsTc) && (!IsOnUsTCEnabled)) ? EnableState.Disable : EnableState.Enable;
					visibleState = VisibilityState.Show;

                    //Begin #30915
                    if (control == cbTfrPbPresent)
                        visibleState = VisibilityState.Hide;
                    //End #30915

					(control as IPhoenixUI).SetObjectStatus(NullabilityState.Default, visibleState, enableState);
				}
			}
			//End WI#19027
			#endregion

            if (origin == "AcctNoEnter" || origin == "TabClicked" || origin == "AccountListSumClick" ||
                (origin == "TranSetClick" && _tlTranSet.IsTellerCaptureTran))    // #140895-ReadOnly
            {
                if (ShowTranAcctAlertsOnCurTab())
                {
                    iconCaution.Visible = (_tlTranSet.CurTran.TranAcct.Cautions.Value == GlobalVars.Instance.ML.Y);
                    iconHold.Visible = (_tlTranSet.CurTran.TranAcct.HoldBal.Value > 0);
                    iconNSF.Visible = (_tlTranSet.CurTran.TranAcct.NSFCount.Value > 0);
                    iconREJ.Visible = (_tlTranSet.CurTran.TranAcct.REJCount.Value > 0);
                    iconUCF.Visible = (_tlTranSet.CurTran.TranAcct.UCFCount.Value > 0);
                    iconStop.Visible = (_tlTranSet.CurTran.TranAcct.Stops.Value == GlobalVars.Instance.ML.Y);
                    iconRetirement.Visible = (_tlTranSet.CurTran.TranAcct.IRA.Value == GlobalVars.Instance.ML.Y ||
                        (!_tlTranSet.CurTran.TranAcct.UmbNo.IsNull && _tlTranSet.CurTran.TranAcct.UmbNo.Value != String.Empty));
                    iconSweep.Visible = (_tlTranSet.CurTran.TranAcct.AcctHasSweep.Value == 1);
                    //iconRealTime.Visible = ( _tlTranSet.AdTlTc != null && _tlTranSet.AdTlTc.RealTimeEnable.Value == GlobalVars.Instance.ML.Y );
                    picRealTime.Visible = (cmbTranCode.CodeValue != null && _tlTranSet.AdTlTc != null && _tlTranSet.AdTlTc.RealTimeEnable.Value == GlobalVars.Instance.ML.Y);
                    picMemo.Visible = (cmbTranCode.CodeValue != null && _tlTranSet.AdTlTc != null && _tlTranSet.AdTlTc.RealTimeEnable.Value != GlobalVars.Instance.ML.Y);
                    iconSigner.Visible = (_tlTranSet.CurTran.TranAcct.DepLoan.Value != GlobalVars.Instance.ML.GL && _tlTranSet.CurTran.TranAcct.SuspectAcct.Value != 1);
                    iconAnalysis.Visible = (_tlTranSet.CurTran.TranAcct.Analysis.Value == GlobalVars.Instance.ML.Y); //67882

                    //					acctAlerts = new AcctAlerts();
                    //					acctAlerts.Analysis = iconAnalysis.Visible;
                    //					acctAlerts.Caution = iconCaution.Visible;
                    //					acctAlerts.Hold = iconHold.Visible;
                    //					acctAlerts.HouseHold = Visible;
                    //					acctAlerts.NSF = iconNSF.Visible;
                    //					acctAlerts.REJ = iconREJ.Visible;
                    //					acctAlerts.Retirement = iconRetirement.Visible;
                    //					acctAlerts.Signer = iconSigner.Visible;
                    //					acctAlerts.Stop = iconStop.Visible;
                    //					acctAlerts.Sweep = iconSweep.Visible;
                    //					acctAlerts.UCF = iconUCF.Visible;

                    if (_tlTranSet.CurTran.TranAcct.SuspectAcct.Value != 1)
                    {
                        acctType = _tlTranSet.CurTran.TranAcct.AcctType.Value;
                        acctNo = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
                        acctId = _tlTranSet.CurTran.TranAcct.AcctId.Value;
                    }
                }
                else
                {
                    foreach (PAction icon in iconFields)
                    {
                        icon.Visible = false;
                    }
                    picRealTime.Visible = false;
                    picMemo.Visible = false;
                }
                #region #80615
                if ((picTabs.SelectedIndex == 0 && dfTitle1.Text != "" && MailerForm.Count > 0 && MailerStatus != "Closed" && MailerStatus != "Inactive" && !isNonCust()) || (picTabs.SelectedIndex == 3 && frmGloAccountListRim != null && frmGloAccountListRim.CustomerInfo.Name.ToString() != "" && MailerForm.Count > 0 && MailerStatus != "Closed" && MailerStatus != "Inactive" && !isNonCust())) // #12870
                {
                    pbPrintMailer.SetObjectStatus(VisibilityState.Show, EnableState.Enable);
                    pbPrintMailerMisc.SetObjectStatus(VisibilityState.Show, EnableState.Enable); //#60578
                }
                else
                {
                    pbPrintMailer.SetObjectStatus(VisibilityState.Hide, EnableState.Disable);
                    pbPrintMailerMisc.SetObjectStatus(VisibilityState.Hide, EnableState.Enable);//#60578
                }
                #endregion

                if (picTabs.SelectedIndex == 3 && frmGloAccountListRim != null &&
                    frmGloAccountListRim.gridAccountListSum.Count > 0 &&
                    frmGloAccountListRim.gridAccountListSum.ContextRow >= 0 && !multiSelection)
                {
                    iconCaution.Visible = (Convert.ToString(frmGloAccountListRim.colCautions.UnFormattedValue) == GlobalVars.Instance.ML.Y);
                    iconHold.Visible = (Convert.ToDecimal(frmGloAccountListRim.colHoldBal.UnFormattedValue) > 0);
                    iconStop.Visible = (Convert.ToString(frmGloAccountListRim.colStops.UnFormattedValue) == GlobalVars.Instance.ML.Y);
                    iconSigner.Visible = (Convert.ToString(frmGloAccountListRim.colDepLoan.UnFormattedValue) != GlobalVars.Instance.ML.GL);
                    iconRetirement.Visible = (frmGloAccountListRim.colPlanNo.UnFormattedValue != null &&
                        Convert.ToString(frmGloAccountListRim.colPlanNo.UnFormattedValue) != String.Empty);
                    //frmGloAccountListRim.GetIconStatus( iconNSF, iconUCF, iconREJ, iconSweep, iconAnalysis ); //67882
                    acctType = Convert.ToString(frmGloAccountListRim.colAcctType.UnFormattedValue);
                    acctNo = Convert.ToString(frmGloAccountListRim.colAcctNo.UnFormattedValue);

                    //79225
                    pbIrsRpt.Visible = true;
                }
                //Begin 79225
                else
                {
                    pbIrsRpt.Visible = false;
                }
                //End 79225
                //Begin 60578
                if (picTabs.SelectedIndex == (int)TAB.CustSummary)
                {
                    if (frmGloAccountListRim != null)
                    {
                        pbRestrictions.Visible = false;
                        pbACHFut.Visible = false;
                        pbIrsRpt.Visible = false;
                        pbPendingCC.Visible = false;
                        pbVod.Visible = false;
                        pbeReceipt.Visible = false;
                        pbNOCHistory.Visible = false;
                        pbPrintMailer.Visible = false;
                    }   
                }
                
                //End 60578      
                setAlertAccount = true;

            }

            if (origin == "SearchClick" || origin == "TabClicked" || origin == "AccountListSumClick")
            {
                if (picTabs.SelectedIndex == 3 && frmGloAccountListRim != null &&
                    frmGloAccountListRim.gridAccountListSum.ContextRow >= 0 && frmGloAccountListRim.colDepLoan.UnFormattedValue != null)
                    depLoan = frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString();
                else
                    depLoan = null;

                //pbSelectSearch.Enabled = (frmTBarSearch != null && (((frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabSearchResults && frmTBarSearch.grdCustomerList.ContextRow >= 0) 
                //                                                        || (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabRecentCustLookup && frmTBarSearch.grdCustLookup.ContextRow >=0 )))); //60686 added recent lookpu up to enable select button
                EnableDisableSelectSearch();//92056
                pbSelectAcct.Enabled = !multiSelection && GlobalVars.UserType != "AcProc" && (depLoan == GlobalVars.Instance.ML.DP || depLoan == GlobalVars.Instance.ML.LN ||
                    depLoan == GlobalVars.Instance.ML.SD || depLoan == GlobalVars.Instance.ML.CM || ((depLoan == "EX" || depLoan == GlobalVars.Instance.ML.Ext) && _gbHelper.IsExternalAdapterAcct(acctType)));   //#2677 //#75588
                pbSelectRIM.Enabled = searchRimNo > 0 && GlobalVars.UserType != "AcProc"; //#75588
                pbVod.Enabled = searchRimNo > 0; //WI#140785


				//EnableDisableNonCust();	//#9539

                if (picTabs.SelectedIndex == (int)TAB.CustSummary && frmGloAccountListRim != null) //92056. Once got an exception. but could not able to replicate. but we can add this null checking if RMS Tab
                {

                    #region #14251
                    if (searchRimNo != int.MinValue)
                    {
                        _nOCRimNo.Value = searchRimNo;
                        _nOCDfiAcctNo.Value = null;
                        //Begin #18483
                        bool fetchNocCount = Workspace == null || Workspace.Variables["_UseStoredNOCInfo"] == null || Convert.ToBoolean(Workspace.Variables["_UseStoredNOCInfo"]) == false ||
                                _nOCRimNo.Value != Convert.ToInt32(Workspace.Variables["_StoredPrevNocRimNo"]);
                        //End #18483
                        if (fetchNocCount)      // #18483
                        {
                            _achNocHistory = new AchNocHistory();
                            CoreService.DataService.ProcessCustomAction(_achNocHistory, "GetNOCCount", _nOCRimNo, _nOCDfiAcctNo, _nOCCount);
                            if (Workspace != null)
                            {
                                Workspace.Variables["_StoredPrevNocRimNo"] = _nOCRimNo.Value;     // #18483
                                Workspace.Variables["_StoredPrevNocRimCount"] = _nOCCount.Value;    // #18483
                                //Workspace.Variables["_UseStoredNOCInfo"] = true;		// #18483
                            }
                        }
                        else      // #18483
                        {
                            _nOCCount.Value = Convert.ToInt32(Workspace.Variables["_StoredPrevNocRimCount"]);		// #18483
                        }
                    }
                    if (_nOCCount.Value <= 0)
                    {
                        pbNOCHistory.SetObjectStatus(VisibilityState.Hide, EnableState.Disable);
                        pbNOCHistoryMisc.SetObjectStatus(VisibilityState.Hide, EnableState.Disable);//#60578
                    }
                    else
                    {
                       // pbNOCHistory.SetObjectStatus(VisibilityState.Show, EnableState.Enable); // #80649
                        pbNOCHistoryMisc.SetObjectStatus(VisibilityState.Show, EnableState.Enable);//#60578
                    }
                    #endregion

                    #region pbRelation Enable #180274, 34406

                    int ownerCount = 0;
                    if (frmGloAccountListRim.gridAccountListSum.Count > 0)
                    {
                        int.TryParse(frmGloAccountListRim.colOwnerCount.UnFormattedValue.ToString(), out ownerCount);
                    }
                    pbRelationship.Enabled = (ownerCount > 1) && GlobalVars.UserType != "AcProc"; //#75588
                    #endregion

                    if (depLoan != null && !multiSelection)
                    {
                        // Begin WI#16236
                        if (this.focusAcctField.Name == "cmbTfrAcctType")
                        {
                            this.isTfrAcct = true;
                        }
                        else
                        {
                            this.isTfrAcct = false;
                        }
                        // End WI#16236
                        pbDisplay.Enabled = ScreenHasAccess("display", this.isTfrAcct);     // WI#16236 added this.isTfrAcct
                        pbHistory.Enabled = ScreenHasAccess("history", this.isTfrAcct);     // WI#16236 added this.isTfrAcct
                        //#74024 added code to enable or disable the Restrictions button
                        if (depLoan == GlobalVars.Instance.ML.DP)
                        {
                            pbRestrictions.Enabled = ScreenHasAccess("restriction", this.isTfrAcct);    // WI#16236 added this.isTfrAcct
                        }
                        else if ((depLoan == GlobalVars.Instance.ML.LN) && (frmGloAccountListRim.colAdvance.FormattedValue.Trim() == "Multiple" || frmGloAccountListRim.colAdvance.FormattedValue.Trim() == "Revolving"))
                        {
                            pbRestrictions.Enabled = ScreenHasAccess("restriction", this.isTfrAcct);    // WI#16236 added this.isTfrAcct
                        }
                        else
                        {
                            pbRestrictions.Enabled = false;
                        }
                        //Begin 60647
                        if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Atm && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.AtmTcHistory))
                            pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                        else
                            pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                        //End 60647
                        EnableDisableControls(EnumEnableDisable.CDRedemp); //140782,21033
                    }
                    else
                    {
                        pbDisplay.Enabled = false;
                        pbHistory.Enabled = false;
                        pbRestrictions.Enabled = false;
                        pbCDRedemp.Enabled = false; // #140782
                        //Begin 60647
                        pbDirectAcct.Enabled = false;
                        pbUmbrella.Enabled = false;
                        pbEdit.Enabled = false;
                        pbArchive.Enabled = false;
                        //End 60647
                    }

                    /*#Begin 23466*/
                    if (picTabs.SelectedIndex == 3 && frmGloAccountListRim != null &&
                                                        frmGloAccountListRim.gridAccountListSum.Count > 0)
                    {
                        #region Merged Application Code
                        Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "AcctType", frmGloAccountListRim.colAcctType.UnFormattedValue.ToString());
                        Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "AcctNo", frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString());
                        Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "AcctDepLoan", frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim()); //103714-2
                        Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "AcctId", Convert.ToString(frmGloAccountListRim.colAcctId.UnFormattedValue == null ? 0 : frmGloAccountListRim.colAcctId.UnFormattedValue)); //103714 
                        this.Workspace.Variables["CurAcctNo"] = frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString();
                        this.Workspace.Variables["CurAcctType"] = frmGloAccountListRim.colAcctType.UnFormattedValue.ToString();
                        this.Workspace.Variables["CurAcctId"] = Convert.ToString(frmGloAccountListRim.colAcctId.UnFormattedValue == null ? 0 : frmGloAccountListRim.colAcctId.UnFormattedValue); //103714
                        acctId = Convert.ToInt32(frmGloAccountListRim.colAcctId.UnFormattedValue == null ? 0 : frmGloAccountListRim.colAcctId.UnFormattedValue);                                 //103714 
                        this.Workspace.Variables["DepLoan"] = frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString(); // #60668.

                        if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP)
                            pbDirectAcct.ImageButton.DropDownMenu = cmDpDirectMenu;
                        else if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN)
                            pbDirectAcct.ImageButton.DropDownMenu = cmLnDirectMenu;
                        else if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Atm)
                            pbDirectAcct.ImageButton.DropDownMenu = cmAtmDirectMenu;
                        else
                            pbDirectAcct.ImageButton.DropDownMenu = null;

                        //36862
                        pbHistory.ImageButton.Style = PImageButton.ButtonStyle.Normal;
                        pbHistory.ImageButton.Width = pbDisplay.ImageButton.Width;       // set it to standard width of a button
                        RepaintButton(pbHistory.ImageButton);
                        this.pbHistory.ImageButton.DropDownMenu = null;

                        if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() != GlobalVars.Instance.ML.Ext && frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() != GlobalVars.Instance.ML.SD)
                        {
                            if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP || frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN || frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.CM)
                            {
                                if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP)
                                {
                                    Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "DepType", frmGloAccountListRim.colDepType.UnFormattedValue.ToString());
                                    pbDirectAcct.ImageButton.DropDownMenu = cmDpDirectMenu;
                                }
                                else
                                {
                                    if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN)
                                        pbDirectAcct.ImageButton.DropDownMenu = cmLnDirectMenu;
                                    else
                                        pbDirectAcct.ImageButton.DropDownMenu = null;
                                    Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "DepType", "");
                                    Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "PartCount", Convert.ToInt32(frmGloAccountListRim.colPartCount.UnFormattedValue));
                                }

                                pbDirectAcct.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 220);       // enable pbaccount

                            }
                            else
                            {
                                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "AcctType", "");
                                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "AcctNo", "");
                                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "DepType", "");
                                Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 221);       // disable  pbaccount
                                if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Atm)
                                {
                                    pbDirectAcct.ImageButton.DropDownMenu = cmAtmDirectMenu;
                                    pbDirectAcct.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                }
                                else
                                    pbDirectAcct.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            }
                        }
                        else
                            pbDirectAcct.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                        if (frmGloAccountListRim.colOwnership.UnFormattedValue.ToString() == GlobalVars.Instance.ML.Secondary)
                        {
                            if (!(!CoreService.UIAccessProvider.IsSecurityEnabled || (Convert.ToInt32(frmGloAccountListRim.colRestrictId.UnFormattedValue) >= EmpRestrictId)))       /*WI #39021 - Rewrite the logic as per Centura code*/
                            {
                                if (!(Phoenix.Windows.Client.Helper.GetRimAccess(searchRimNo, ref bRimEditAccess, ref bRimPostAccess)))
                                {
                                    pbRim.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                    pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                    pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                    pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                    pbPortfolio.SetObjectStatus(VisibilityState.Default, EnableState.Disable);

                                    bRenewal = false;
                                    bSdVisit = false;

                                    Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 225);   // pbtransactions needs to be disabled

                                    return;
                                }
                                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "RimEditAccess", bRimEditAccess);
                                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "RimPostAccess", bRimPostAccess);
                            }
                        }
                        #endregion
                        if (frmGloAccountListRim.colStatus.UnFormattedValue.ToString() == GlobalVars.Instance.ML.Dormant)
                        {

                            //Begin 60647
                            if (_adGbRsm.DormantAccess.Value == "N")
                                pbDirectAcct.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            else
                                pbDirectAcct.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                            //End 60647
                            if ((_adGbRsm.AllowViewDormant != null && _adGbRsm.AllowViewDormant.Value == "N")
                                &&
                                (_adGbRsm.DormantAccess != null && _adGbRsm.DormantAccess.Value == "N"))
                            {
                                //Begin 60647
                                pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                pbPortfolio.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                pbRim.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                

                                Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 215);   // pbrelationacct and pbimage needs to be disabled

                                bRenewal = false;
                                bSdVisit = false;
                                return;

                            }
                            else if (_adGbRsm.DormantAccess.Value == "N" && _adGbRsm.AllowViewDormant.Value == "Y")
                            {
                                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "ViewDormant", true);	// WI#34690 - fix typo
                                pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 17); //This.ScreenId = 10447()frmTLTranCode) and the tansalation is set against screen Id 889 (frmGloAccountListCustMgt)
                                pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                pbPortfolio.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                pbRim.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                pbRim.ImageButton.Text = CoreService.TranslateText("V&iew Cust..", GlobalVars.InstitutionType, this.FormSource);  
                                if (LocSetUmbrellaStatus())
                                    pbUmbrella.SetObjectStatus(VisibilityState.Default, EnableState.Enable);

                                Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 216);   // pbrelationacct and pbimage needs to be enabled

                                bRenewal = false;
                                bSdVisit = false;
                               // bRestrictions = true;

                                pbEdit.MLInfo.Label = pbEdit.ImageButton.Text;      //34423
                                pbRim.MLInfo.Label = pbRim.ImageButton.Text;        //34423
                                RepaintButton(pbEdit.ImageButton);
                                RepaintButton(pbRim.ImageButton);
                                return;
                            }
                            //End 60647

                            if ((_adGbRsm.AllowViewDormant != null && _adGbRsm.AllowViewDormant.Value == "Y")
                                ||
                                (_adGbRsm.DormantAccess != null && _adGbRsm.DormantAccess.Value == "Y"))
                            {
                                this.pbHistory.Enabled = true;
                                this.pbDisplay.Enabled = true;
                                this.pbRestrictions.Enabled = true;
                            }

                        }
                        #region Merged Application Code
                        //Begin 60647
                        else if (frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Escheated)
                        {
                            if (_adGbRsm.EscheatedAccess.Value == "N")
                                pbDirectAcct.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            else
                                pbDirectAcct.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                            if (_adGbRsm.EscheatedAccess.Value == "N" && _adGbRsm.AllowViewEscheat.Value == "N")
                            {
                                pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                pbPortfolio.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                pbRim.SetObjectStatus(VisibilityState.Default, EnableState.Disable);

                                Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 215);   // pbrelationacct and pbimage needs to be disabled

                                bRenewal = false;
                                bSdVisit = false;
                               // bRestrictions = false;

                                return;
                            }
                            else if (_adGbRsm.EscheatedAccess.Value == "N" && _adGbRsm.AllowViewEscheat.Value == "Y")
                            {

                                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "ViewEscheated", true);
                                pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                pbPortfolio.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                pbRim.SetObjectStatus(VisibilityState.Default, EnableState.Enable);

                                if (LocSetUmbrellaStatus())
                                    pbUmbrella.SetObjectStatus(VisibilityState.Default, EnableState.Enable);

                                bRenewal = false;
                                bSdVisit = false;
                               // bRestrictions = true;

                                Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 216);   // pbrelationacct and pbimage needs to be enabled

                                pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 17);
                                pbRim.ImageButton.Text = CoreService.TranslateText("V&iew Cust..", GlobalVars.InstitutionType, this.FormSource);    //33189CoreService.Translation.GetTranslateX(this.ScreenId, 19);

                                pbEdit.MLInfo.Label = pbEdit.ImageButton.Text;      //34423
                                pbRim.MLInfo.Label = pbRim.ImageButton.Text;        //34423
                                RepaintButton(pbEdit.ImageButton);
                                RepaintButton(pbRim.ImageButton);

                                return;
                            }
                        }
                        else
                        {
                            Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "ViewDormant", false);	// WI#34690 - fix typo
                            Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "ViewEscheated", false);
                            if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() != GlobalVars.Instance.ML.Ext && frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() != GlobalVars.Instance.ML.SD)  //34722
                                pbDirectAcct.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                        }
                        //End 60647
                        //Begin 60647
                        #region Rim Buttons

                        pbRim.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                        pbRim.ImageButton.Text = CoreService.TranslateText("Ed&it Cust..", GlobalVars.InstitutionType, this.FormSource);    //33189
                        pbRim.MLInfo.Label = pbRim.ImageButton.Text;        //34423
                        RepaintButton(pbRim.ImageButton);   //33189
                        if (frmGloAccountListRim.dfStatus.Text.Trim() != "Prospect")
                        {
                            if (LocSetUmbrellaStatus())
                                pbUmbrella.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                            pbPortfolio.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                            Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 218);   // pbrelationacct and pbautotfrs needs to be enabled

                        }
                        Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 217);   //  pbimage needs to be enabled
                        #endregion

                        #region Autotfrs

                        if (frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Unfunded ||
                            frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Incomplete ||
                            frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Locked ||
                            frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Closed ||
                            frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Matured ||
                            frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Dormant ||
                            frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.InActiveChargeOff ||
                            frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Escheated
                            )
                            Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 219);       // disable auto transfers


                        #endregion

                        #region EditAcct

                        if (frmGloAccountListRim.dfStatus.Text.Trim() != GlobalVars.Instance.ML.Closed && frmGloAccountListRim.dfStatus.Text.Trim() != "Prospect")
                        {

                            if (!CoreService.UIAccessProvider.IsSecurityEnabled ||
                                    (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpEdit)) ||
                                (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnEdit)) ||
                                (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.SD && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.SdBoxNewEdit)) ||
                                (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Ext && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.ExAcctEdit)) ||
                                (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Atm && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OnATMAcctEdit)) ||
                                (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.CM && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.IraLnEdit))
                                )
                            {
                                if (CoreService.UIAccessProvider.IsSecurityEnabled)
                                {
                                    if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP)
                                    {
                                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.DpEdit))
                                            pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 8);
                                        else
                                            pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 1);
                        }
                                    if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Atm)
                                    {
                                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.OnATMAcctEdit))
                                            pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 24);
                                        else
                                            pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 1);
                    }
                                    if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.SD)
                                    {
                                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.SdBoxNewEdit))
                                            pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 8);
                                        else
                                            pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 1);
                                    }
                                    if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN)
                                    {
                                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.LnEdit))
                                            pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 8);
                                        else
                                            pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 1);
                                    }
                                    if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Ext)
                                    {
                                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.ExAcctEdit))
                                            pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 8);
                                        else
                                            pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 1);
                                    }
                                    if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.CM)
                                    {
                                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.IraLnEdit))
                                            pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 8);
                                        else
                                            pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 1);
                                    }                                    
                                }
                                pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Enable);

                                if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Atm)
                                {
                                    pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 24);                                  
                                }
                                else
                                {
                                    pbEdit.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 8);                                   
                                }
                                pbEdit.MLInfo.Label = pbEdit.ImageButton.Text;      //XXXXX
                                RepaintButton(this.pbEdit.ImageButton);

                                if (CoreService.UIAccessProvider.IsSecurityEnabled && frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Ext && frmGloAccountListRim.colAdapter.UnFormattedValue.ToString().Trim() == "Y")
                                {
                                    if (frmGloAccountListRim.colEditSupport.UnFormattedValue.ToString().Trim() == "Y")
                                    {
                                        if ((frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Insurance" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InsExAccountEdit)) ||
                                            (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Brokerage" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.BrkExAccountEdit)) ||
                                            (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Credit Card" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountEdit)) ||
                                            (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Student Loan" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.StuLnExAccountEdit)) ||
                                            (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Other" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OtherExAccountEdit))
                                            )
                                        {
                                            pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                        }
                                        else if ((frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Insurance" && CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.InsExAccountEdit)) ||
                                            (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Brokerage" && CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.BrkExAccountEdit)) ||
                                            (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Credit Card" && CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountEdit)) ||
                                            (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Student Loan" && CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.StuLnExAccountEdit)) ||
                                            (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Other" && CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.OtherExAccountEdit))
                                            )
                                        {
                                            pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                                        }
                                        else
                                            pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Disable);

                                    }
                                    else
                                        pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Disable);

                                }
                            }
                            else
                                pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                        }                      
                        #endregion

                        #region Display Acct
                        if (!CoreService.UIAccessProvider.IsSecurityEnabled ||
                            ((frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpDisplay)) ||
                            (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnDisplay)) ||
                            (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.SD && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.SdDepositDisplay)) ||
                            (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Ext && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OnExAcctDisp1)) ||
                            (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Atm && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OnATMAcctDisplay)) ||
                            (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.CM && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnUmbDisplay))
                            )
                           )
                        {
                            pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Enable);

                            if (CoreService.UIAccessProvider.IsSecurityEnabled && frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Ext && frmGloAccountListRim.colAdapter.UnFormattedValue.ToString().Trim() == "Y")
                            {
                                if (frmGloAccountListRim.colDisplaySupport.UnFormattedValue.ToString().Trim() != "Y")
                                    pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                else
                                {
                                    if ((frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Insurance" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InsExAccountDisplay)) ||
                                        (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Brokerage" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.BrkExAccountDisplay)) ||
                                        (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Credit Card" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountDisplay)) ||
                                        (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Student Loan" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.StuLnExAccountDisplay)) ||
                                        (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Other" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OtherExAccountDisplay))
                                        )
                                        pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                }

                            }
                        }
                        else
                            pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                        #endregion

                        #region History

                        if (!CoreService.UIAccessProvider.IsSecurityEnabled ||
                                ((frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpTCHistory)) ||
                                  (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnTCHistory)) ||
                                  (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.SD && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.SdTCHistory)) ||
                                  (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.CM && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CmtTCHistory)) ||
                                  (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Atm && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.AtmTcHistory)) ||
                                  (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Ext && (CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InsExAccountHistory) ||
                                                                                                                CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.BrkExAccountHistory) ||
                                                                                                                CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountHistory) ||
                                                                                                                CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.StuLnExAccountHistory) ||
                                                                                                                CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OtherExAccountHistory)
                                                                                                                )
                                  )
                                )
                           )
                        {
                            pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Enable);

                            if (CoreService.UIAccessProvider.IsSecurityEnabled && frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Ext && frmGloAccountListRim.colAdapter.UnFormattedValue.ToString().Trim() == "Y")
                            {
                                if (!(frmGloAccountListRim.colHistorySupport.UnFormattedValue.ToString().Trim() == "Y" && (frmGloAccountListRim.colCrTcSupport.UnFormattedValue.ToString().Trim() == "Y" || frmGloAccountListRim.colDrTcSupport.UnFormattedValue.ToString().Trim() == "Y")))
                                    pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                else if ((frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Insurance" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InsExAccountHistory)) ||
                                        (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Brokerage" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.BrkExAccountHistory)) ||
                                        (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Credit Card" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountHistory)) ||
                                        (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Student Loan" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.StuLnExAccountHistory)) ||
                                        (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Other" && !CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OtherExAccountHistory))
                                        )
                                    pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                                else     //36862
                                {
                                    pbHistory.ImageButton.Style = PImageButton.ButtonStyle.DropDown;
                                   // ExHistoryMenuCreated = false;
                                    pbHistory.ImageButton.Width = pbHistory.ImageButton.Width - 9; // framework is increasing the width
                                    RepaintButton(pbHistory.ImageButton);
                                    CreateExHistoryMenu();
                                }
                            }
                        }
                        else
                            pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                      

                        #endregion

                        #region allow posting tc's
                        if (CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.TCPost) && Convert.ToBoolean(this.Workspace.Variables["RimPostAccess"]))
                        {
                            Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 224);       // enable tc post
                            if (CoreService.UIAccessProvider.IsSecurityEnabled)
                                if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Ext && (frmGloAccountListRim.colAdapter.UnFormattedValue.ToString().Trim() == "N" || (frmGloAccountListRim.colCrTcSupport.UnFormattedValue.ToString().Trim() == "N" && frmGloAccountListRim.colDrTcSupport.UnFormattedValue.ToString().Trim() == "N")))
                                    Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 225);       // disable tc post
                        }
                        else
                            Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 225);       // disable tc post

                        #endregion

                        if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP)
                        {
                            if (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.RenewalDisb2) || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.RenewalDisb2))
                            {
                                if (frmGloAccountListRim.colDepType.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Time && (frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.RenewPending || frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Matured))
                                    bRenewal = true;
                                else
                                    bRenewal = false;
                            }
                            else
                                bRenewal = false;
                        }
                        else if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN)
                        {
                            if (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.LnRenewal) || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnRenewal))
                            {
                                // WI#36701 - indentation and use StringHelper instead of substring
                                if (StringHelper.StrLeftX(Convert.ToString(frmGloAccountListRim.colOwnership.UnFormattedValue), 7) == GlobalVars.Instance.ML.Primary
                                    && frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Active
                                    && Convert.ToInt32(frmGloAccountListRim.colPartCount.UnFormattedValue) >= 0)
                                    bRenewal = true;
                                else
                                    bRenewal = false;
                            }
                            else
                                bRenewal = false;
                        }
                        else
                            bRenewal = false;

                        if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.SD)
                        {
                            if (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.SdVisitHistory) || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.SdVisitHistory))
                            {
                                bSdVisit = true;
                            }
                            else
                                bSdVisit = false;
                        }
                        else
                            bSdVisit = false;
                        if ((frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Ext && frmGloAccountListRim.colAdapter.UnFormattedValue.ToString().Trim() != "Y") || frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Atm)
                        {
                            Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 225);       // disable tc post
                            Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 219);       // disable auto tfrs

                            if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Atm && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.AtmTcHistory))
                                pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                            else
                                pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);

                            bRenewal = false;
                            bSdVisit = false;
                          //  bRestrictions = false;

                        }

                        if (!(Convert.ToBoolean(this.Workspace.Variables["RimEditAccess"])))
                        {
                            pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            pbPortfolio.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            pbRim.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            frmGloAccountListRim.lblAddress.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Disable);  //Task #43698
                            frmGloAccountListRim.lblIDVerification.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Disable);  //Task #43698
                          //  bRestrictions = false;
                            bRenewal = false;
                            bSdVisit = false;
                        }
                        if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.SD)
                        {
                            Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 219);       // disable auto tfrs

                            if (frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Closed)
                                Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 225);       // disable tc post
                        }
                        if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP || frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN)
                        {
                            if (frmGloAccountListRim.bCaptureDocs || frmGloAccountListRim.bEcmDocEnabled)
                            {
                                if (CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CaptureQuestDocSearch) ||
                                    !CoreService.UIAccessProvider.IsSecurityEnabled)
                                    Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 223);
                                else
                                    Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 222);
                            }
                            else
                                Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 222);
                        }
                        else
                        {
                            Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 222);
                        }
                        if (depLoan != null && !multiSelection)
                        {                           

                            if (LocSetUmbrellaStatus())
                                pbUmbrella.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                            else
                                pbUmbrella.SetObjectStatus(VisibilityState.Default, EnableState.Disable);

                            if (depLoan.Trim() == GlobalVars.Instance.ML.DP)
                                pbDirectAcct.ImageButton.DropDownMenu = cmDpDirectMenu;
                            else if (depLoan.Trim() == GlobalVars.Instance.ML.LN)
                                pbDirectAcct.ImageButton.DropDownMenu = cmLnDirectMenu;
                            else if (depLoan.Trim() == GlobalVars.Instance.ML.Atm)
                                pbDirectAcct.ImageButton.DropDownMenu = cmAtmDirectMenu;
                            else
                                pbDirectAcct.ImageButton.DropDownMenu = null;
                        }                       
                    }
                    else
                    {
                        if (this.Workspace != null)
                        {
                            Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "AcctType", "");
                            Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "AcctNo", "");
                            Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "DepType", "");
                            pbDirectAcct.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            pbEdit.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            pbDisplay.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            pbHistory.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            pbUmbrella.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            pbArchive.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            bRenewal = false;
                            bSdVisit = false;
                           // bRestrictions = false;
                            if (LocSetUmbrellaStatus())
                                pbUmbrella.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                            else
                                pbUmbrella.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                            Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 228);       //33779
                            Phoenix.Windows.Client.Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, 1, 222);       // disable pbdocview

                        }
                        //End 60647
                        #endregion
                    }
                    /*#End 23466*/

                }
                else if (picTabs.SelectedIndex == 0)
                    EnableDisableControls("AcctNoEnter");
                else if (picTabs.SelectedIndex == 4)
                {
                    if (processingPrint)
                    {
                        Name0.IsDisabled = true;
                        Name1.IsDisabled = true;
                        Name2.IsDisabled = true;
                        Name3.IsDisabled = true;
                        pbSkip.Enabled = true;
                    }
                    else
                    {
                        pbSkip.Enabled = false;
                    }
                }
                //Begin Task#87731
                if (picTabs.SelectedTab == Name0 || picTabs.SelectedTab == Name1 || picTabs.SelectedTab == Name2)
                {
                    tabEasyCapture.IsDisabled = (_tlTranSet.TellerVars.AdTlControl.EnableQuickTranTab.Value != GlobalVars.Instance.ML.Y || _tlTranSet.Transactions.Count > 0
                        || _isOvRunning);
                    Name1.IsDisabled = Name0.IsDisabled;
                }
                else if (picTabs.SelectedTab == tabEasyCapture)
                {
                    Name0.IsDisabled = _tlTranSet.Transactions.Count > 0;
                    Name1.IsDisabled = Name0.IsDisabled;
                    //Task# 90007
                    if (!_tlTranSet.TellerVars.IsAppOnline) //Disable search tab when Offline.
                    {
                        Name2.IsDisabled = true;
                    }
                    else
                    {
                        Name2.IsDisabled = Name0.IsDisabled;    //#87731
                    }

                    //Begin Task#89976
                    //bool displayEnabled = CoreService.UIAccessProvider.HasReadAcces(Shared.Constants.ScreenId.RmDisplay); //Bug #95565 #101468
                    //bool displayHistoryEnabled = CoreService.UIAccessProvider.HasReadAcces(Shared.Constants.ScreenId.RmHistory);//Bug #95565
                    pbDisplay.Visible = true;
                    pbHistory.Visible = true;
                    //pbDisplay.Enabled = displayEnabled && quickAccountGridPopulated; //Bug #95565 #101468
                    //pbHistory.Enabled = displayHistoryEnabled && quickAccountGridPopulated; //Bug #95565
                    //End Task#89976

                    if (QuickAccountSelectedRow != null)
                    {
                        SetQuickWorkSpaceVariable(); //Bug#92482/Bug#92483/Bug#92484
                    }

                    //this.Workspace.Variables["CurAcctNo"] = frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString();
                    //this.Workspace.Variables["CurAcctType"] = frmGloAccountListRim.colAcctType.UnFormattedValue.ToString();
                    //TBD
                    //pbItemCapture.Enabled = true;
                    //pbItemCapture.Visible = pbItemCapture.Enabled;
                    //pbCashIn.Enabled = true;
                    //pbCashIn.Visible = pbCashIn.Enabled;
                    //pbCashOut.Enabled = true;
                    //pbCashOut.Visible = pbCashOut.Enabled;
                }
                //End Task#87731
                //Begin Bug#89886
                else if (picTabs.SelectedTab == Name3)
                {
                    //When focus is on the RMS tab, enable the Teller Transaction tab 
                    // Disable Input Teller tab once user has successfully completed a search in the Quick Tran tab.
                    if (QuickAccountSelectedRow != null)
                        Name0.IsDisabled = true;  //Bug #109821

                    else
                        Name0.IsDisabled = false;
                }
                //End Bug#89886
            }

            if (origin == "ProcessPassbookUpdates")
            {
                Name4.IsDisabled = false;
            }

            if (origin == "InventoryItem")
            {
                // cmbInventoryType enable/disable
                if (cmbInventoryType.CodeValue == null)
                {
                    lblPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#140772
                    dfInvSerialNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                    cmbInventoryPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                }

                if (processingSelectTran)
                {
                    _totalInventoryItems = _tlTranSet.CurTran.NoInvAvailable.Value + _tlTranSet.CurTran.CheckNo.Value;
                    _adGbInventoryType.TypeId.Value = Convert.ToDecimal(cmbInventoryType.CodeValue);
                    CoreService.DataService.ProcessRequest(XmActionType.Select, _adGbInventoryType);
                }

                if (cmbInventoryType.CodeValue != null || processingSelectTran)
                {
                    if (_adGbInventoryType.Class.Value == CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Serial"))
                    {
                        lblPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Default); //#140772
                        cmbInventoryPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                        dfInvSerialNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.DisableShowText); //#21274
                        if (_tlTranSet.TellerVars.AdTlTc.EnableNumberItems.Value == GlobalVars.Instance.ML.Y)
                        {
                            dfCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.DisableShowText);
                        }

                        if (!_adGbInventoryType.ItemValue.IsNull && _adGbInventoryType.ItemValue.Value > 0 && _totalInventoryItems > 0 &&
                            (dfCheckNo.UnFormattedValue == null || (dfCheckNo.UnFormattedValue != null && Convert.ToDecimal(dfCheckNo.UnFormattedValue) <= 0)))
                            dfInvSerialNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
                        else
                            dfInvSerialNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.DisableShowText);
                    }
                    else if (_adGbInventoryType.Class.Value == CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Packet"))
                    {
                        lblPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Default); //#140772
                        dfInvSerialNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                        cmbInventoryPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
                    }
                    else
                    {
                        lblPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default); //#140772
                        dfInvSerialNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                        cmbInventoryPacket.SetObjectStatus(NullabilityState.Default, VisibilityState.Hide, EnableState.Default);
                    }
                    SetPacketSerialLabel();

                    if (_adGbInventoryType.Class.Value != CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Serial"))  //#21274
                    {
                        if (_tlTranSet.TellerVars.AdTlTc.EnableNumberItems.Value != GlobalVars.Instance.ML.Y)
                            dfCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.DisableShowText); //#21085
                    }


                    // cmbInventoryPacket enable/disable
                    if (cmbInventoryPacket.CodeValue != null) //#21085
                    {

                        _tlTranSet.TellerVars.SetContextObject("AdGbInventoryPacketArray", Convert.ToString(cmbInventoryPacket.CodeValue));


                        if (_tlTranSet.TellerVars.AdTlTc.EnableNumberItems.Value == GlobalVars.Instance.ML.Y)
                        {
                            if (_totalInventoryItems <= 0 || _adGbInventoryType.Class.Value == CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Serial") ||
                                (_adGbInventoryType.Class.Value == CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Packet") &&
                                !_tlTranSet.TellerVars.AdGbInventoryPacket.SerialPacket.IsNull &&
                                _tlTranSet.TellerVars.AdGbInventoryPacket.SerialPacket.Value == "Y"))
                                dfCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.DisableShowText);
                            else
                                dfCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Enable);
                        }
                        else
                            dfCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.DisableShowText); //#21085


                        //Begin CR23981
                        if (Convert.ToString(cmbInventoryPacket.CodeValue) == "-1") 
                        {
                            //Always disable the '# Of Items' datafield when "All Packets" is selected from the Packet combo box
                            //dfCheckNo.Value = null;
                            //dfCheckNo.UnFormattedValue = null;
                            dfCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.DisableShowText);
                            //_tlTranSet.CurTran.PacketId.Value  = -1;
                        }
                        //End CR23981
                    }

                    // dfInvSerialNo enable/disable
                }
            }
            /* #126357 | 244510 */
            if (origin == "ExceptionHold" )
            {

                //Task #134375
                if (_tlTranSet.TellerVars.AdTlControl.EnableExcepHold.Value == "Y" && dfTransitChks.Value != null && Convert.ToDecimal(dfTransitChks.UnFormattedValue) > 0
                    && (_tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP ||
                    (_tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.LN &&
                            !_tlTranSet.CurTran.TranAcct.AdvanceType.IsNull &&
                            (_tlTranSet.CurTran.TranAcct.AdvanceType.Value.Trim() == "Multiple" ||
                            _tlTranSet.CurTran.TranAcct.AdvanceType.Value.Trim() == "Revolving"))))
                {
                    pbExceptionHold.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                }
                else
                {
                    pbExceptionHold.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                }
            }



            #region TabClicked
            if (origin == "TabClicked" || origin == "FormCreate" || origin == "TabClickedSetActions")	// #71892 - Added TabClickedSetActions
            {

                if (picTabs.SelectedIndex == (int)TAB.QuickTran)
                {
                    visible = _quickTranWindow.GetCurrentRim() > 0; //Bug #104269
                }
                else
                {
                    visible = (picTabs.SelectedIndex == 0);
                }

                pbClearAll.Visible = visible;
                pbSeparator1.Visible = visible;

                pbCashIn.Visible = visible && pbCashIn.Enabled && _tlTranSet.CurTran.TlTranCode.Value != "VLT"; //#72916
                pbItemCapture.Visible = visible && pbItemCapture.Enabled;

                pbCashOut.Visible = visible && pbCashOut.Enabled;
                pbFees.Visible = visible && pbFees.Enabled;
                pbGetGLAcct.Visible = visible;
                pbGetAcct.Visible = visible; /* && GlobalObjects.Instance[Phoenix.Shared.Variables.GlobalObjectNames.AdGbBankControl] != null &&
                    (GlobalObjects.Instance[Phoenix.Shared.Variables.GlobalObjectNames.AdGbBankControl] as AdGbBankControl).ConfAcctSecurity.Value == GlobalVars.Instance.ML.Y;  */      // #17047
                
                pbLastAcct.Enabled = (_tlTranSet.TellerVars.LastAccts.Count > 0);
                pbTCDDenom.Visible = visible;
                //#71893
                pbMakeBreakStrap.Visible = visible && _tlTranSet.TellerVars.AdTlControl.BalDenomTracking.Value == GlobalVars.Instance.ML.Y;
                //#72916
                //#74665 - always enable if TCD connection allows, do not depend on picTCD
                //pbChkTCDStatus.Visible = (visible && _tlTranSet.TellerVars.IsTCDConnected);
                pbChkTCDStatus.Visible = pbReset.Visible = ((visible) && (_tlTranSet.TellerVars.IsTCDEnabled || _tlTranSet.TellerVars.IsTCDConnected));  //#89998 #101468
                //Begin Task #88995
                //if (picTabs.SelectedIndex == (int)TAB.QuickTran)  //#101468
                //{
                //    pbClearAll.Visible = true;
                //    pbClearAll.Enabled = true;
                //    pbSeparator1.Visible = true;
                //    pbSeparator1.Enabled = true;
                //    pbCashIn.Visible = true;
                //    pbCashIn.Enabled = false;
                //}
                //End Task #88995

                //visible = (picTabs.SelectedIndex == 0 || picTabs.SelectedIndex == 3);
                visible = (picTabs.SelectedIndex == (int)TAB.InputTran || picTabs.SelectedIndex == (int)TAB.CustSummary || picTabs.SelectedIndex == (int)TAB.QuickTran); //Task#89976

                pbDisplay.Visible = visible;
                pbHistory.Visible = visible;
                pbRestrictions.Visible = visible;

                visible = (picTabs.SelectedIndex == (int)TAB.ViewTran); // (picTabs.SelectedIndex == 1);
                pbRemoveTran.Visible = visible;
                pbSelectTran.Visible = visible;

                visible = (picTabs.SelectedIndex == (int)TAB.Search); // (picTabs.SelectedIndex == 2);
                pbSearch.Visible = visible;
                pbSelectSearch.Visible = visible;
                pbAddNonCust.Visible = visible && isNonCustAllowed;     //#9320

				//Begin #9539
                if (frmTBarSearch != null && frmTBarSearch.grdCustomerList.Items.Count > 0 
                    && frmTBarSearch.cbNonCust.Checked)	//2010 #10783; 2011 #10784
                {
                    pbEditNonCust.Enabled = true;
                }
                else
                {
                    pbEditNonCust.Enabled = false;
                }

                pbEditNonCust.Visible = visible && (isNonCustAllowed || (GlobalVars.UserType == "AcProc" && _bAcProcFraudEnabled));//92056 Code for Actual Issue of this WI
                //End #9539

                visible = (picTabs.SelectedIndex == (int)TAB.CustSummary);
                pbSelectAcct.Visible = visible;
                pbSelectRIM.Visible = visible;
                pbVod.Visible = visible; //WI#140785 
                pbRelationship.Visible = visible; //#180274

                //Begin 61240
                #region WI#29312 Reversed pbEditService button
                if (frmGloAccountListRim != null && frmGloAccountListRim.Visible && //WI28477
                        frmGloAccountListRim.picTabCustSummary.SelectedIndex == (int)Phoenix.Client.RimAccounts.frmGloAccountListRim.TAB.Services)
                {                   
                    picTabCustSummary_SelectedIndexChanged(null, null); // #62593
                }
                #endregion
                //End 61240

                #region #14251
                if (_tlTranSet.CurTran.TranAcct.RimNo.Value != int.MinValue)
                {
                    _nOCRimNo.Value = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                    _nOCDfiAcctNo.Value = null;
                    //Begin #18483
                    bool fetchNocCount = Workspace == null || Workspace.Variables["_UseStoredNOCInfo"] == null || Convert.ToBoolean(Workspace.Variables["_UseStoredNOCInfo"]) == false ||
                            _nOCRimNo.Value != Convert.ToInt32(Workspace.Variables["_StoredPrevNocRimNo"]);
                    //End #18483
                    if (_tlTranSet.TellerVars.IsAppOnline && fetchNocCount)    // #18483 /Bug#103647
                    {
                        _achNocHistory = new AchNocHistory();
                        CoreService.DataService.ProcessCustomAction(_achNocHistory, "GetNOCCount", _nOCRimNo, _nOCDfiAcctNo, _nOCCount);
                        if (Workspace != null)
                        {
                            Workspace.Variables["_StoredPrevNocRimNo"] = _nOCRimNo.Value;     // #18483
                            Workspace.Variables["_StoredPrevNocRimCount"] = _nOCCount.Value;    // #18483
                            //Workspace.Variables["_UseStoredNOCInfo"] = true;		// #18483
                        }
                    }
                    else      // #18483
                    {
                        _nOCCount.Value = Convert.ToInt32(Workspace.Variables["_StoredPrevNocRimCount"]);		// #18483
                    }
                }
                #endregion

                if (_nOCCount.Value <= 0) // #14251
                {
                    pbNOCHistory.Visible = false;
                    pbNOCHistory.Enabled = false;
                    pbNOCHistoryMisc.Visible = false; //#60578
                    pbNOCHistoryMisc.Enabled = false;//#60578
                }
                else
                {
                   // pbNOCHistory.Visible = visible; // #80649
                   // pbNOCHistory.Enabled = visible; // #80649
                    pbNOCHistoryMisc.Visible = visible;//#60578
                    pbNOCHistoryMisc.Enabled = visible;//#60578
                }

                visible = (picTabs.SelectedIndex == (int)TAB.Passbook); //(picTabs.SelectedIndex == 4)
                pbSkip.Visible = visible;
                pbUpdatePB.Visible = visible;

                visible = (picTabs.SelectedIndex != (int)TAB.Passbook); //(picTabs.SelectedIndex != 4)

                ActionSave.Visible = visible;
                ActionAddNext.Visible = visible;
                ActionClose.Visible = visible;

                enable = (picTabs.SelectedIndex == 0 || picTabs.SelectedIndex == 1);
                enable = enable || picTabs.SelectedTab == tabEasyCapture;   // #87731

                ActionSave.Enabled = enable;
                ActionAddNext.Enabled = enable && picTabs.SelectedIndex != 1;
                //				ActionClose.Enabled = enable;
                //#101468
                //Begin Task#87717
                visible = picTabs.SelectedTab != tabEasyCapture;
                pbOnUs.Visible = visible; //Bug#108569C
                pbInventory.Visible = visible;
                pbPendingCC.Visible = visible;
                ActionAddNext.Visible = visible;
                pbAdvancedView.Visible = picTabs.SelectedTab == tabEasyCapture;
                //End Task#87717

                // HACK: to be remove later
                pbTCDDenom.Visible = false;
                //pbCashOut.Visible = false;
                //Begin #60578. Hide Post and add Next in Search and Summary Tab
                if (picTabs.SelectedIndex == (int)TAB.Search || picTabs.SelectedIndex == (int)TAB.CustSummary)
                {
                    ActionSave.Visible = false;
                    ActionAddNext.Visible = false;
                    pbPendingCC.Visible = false; //65205
                }

                //Bug# 108569
                pbLastAcct.Visible = (picTabs.SelectedIndex == (int)TAB.InputTran || picTabs.SelectedIndex == (int)TAB.QuickTran);
                //End #60578

                //Begin #87731
                //if (picTabs.SelectedTab == tabEasyCapture)    //#101468
                //{
                //    pbItemCapture.Visible = true; //Bug #92955
                //    pbItemCapture.Enabled = false; //Bug #92023
                //    pbCashIn.Visible = true;    //Bug #93430
                //    pbCashIn.Enabled = false;   //Bug #93430
                //    //Begin 87757
                //    pbGetAcct.Visible = true;
                //    EnableDisableControls(EnumEnableDisable.DisableGetAcct);
                //    //End 87757
                //    pbPrintMailer.Visible = true;   //#96623
                //    pbLastAcct.Visible = true; //89989
                //    pbLastAcct.Enabled = _tlTranSet.TellerVars.LastAccts.Count > 0 && GetQuickTranAccts() > 0;  //89989
                //    pbFees.Visible = true;  //#92886
                //    pbFees.Enabled = true; // #92886 _quickTranWindow.GetSelectedTran() != null && _quickTranWindow.GetSelectedTran().MappedTranIndex > 0 && _quickTranWindow.GetSelectedTran().CcAmt > 0;
                //    pbRelationship.Visible = true; //Task#87765
                //}
                //End #87731

                //Begin Bug# 108569
                if (picTabs.SelectedIndex == (int)TAB.QuickTran)
                {
                        //if (_previousTab == (int)TAB.CustSummary)
                    //{
                    //    //RestoreButtonStateVisibility(); //Bug #104269//
                    //}

                    EnableDisableQuickButtons(true);
                }
                //End Bug# 108569
            }
            #endregion
            #region #76055
            visible = (picTabs.SelectedIndex == 0 || picTabs.SelectedIndex == 3);
            pbACHFut.Visible = visible;
            if (picTabs.SelectedIndex == 0 && cmbAcctType.SelectedIndex > -1 && dfAcctNo.Text.Length > 0)
            {
                pbACHFut.Enabled = true;
            }
            else if (picTabs.SelectedIndex == 3 && frmGloAccountListRim != null)
            {
                #region #14251\
                if (_tlTranSet.CurTran.TranAcct.RimNo.Value != int.MinValue)
                {
                    _nOCRimNo.Value = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                    _nOCDfiAcctNo.Value = null;
                    //Begin #18483
                    bool fetchNocCount = Workspace == null || Workspace.Variables["_UseStoredNOCInfo"] == null || Convert.ToBoolean(Workspace.Variables["_UseStoredNOCInfo"]) == false ||
                            _nOCRimNo.Value != Convert.ToInt32(Workspace.Variables["_StoredPrevNocRimNo"]);
                    //End #18483
                    if (fetchNocCount)      // #18483
                    {
                        _achNocHistory = new AchNocHistory();
                        CoreService.DataService.ProcessCustomAction(_achNocHistory, "GetNOCCount", _nOCRimNo, _nOCDfiAcctNo, _nOCCount);
                        if (Workspace != null)
                        {
                            Workspace.Variables["_StoredPrevNocRimNo"] = _nOCRimNo.Value;     // #18483
                            Workspace.Variables["_StoredPrevNocRimCount"] = _nOCCount.Value;    // #18483
                            //Workspace.Variables["_UseStoredNOCInfo"] = true;
                        }
                    }
                    else      // #18483
                    {
                        _nOCCount.Value = Convert.ToInt32(Workspace.Variables["_StoredPrevNocRimCount"]); 		// #18483
                    }
                }
                if (_nOCCount.Value > 0)
                    pbNOCHistory.Enabled = true; // #80649
                else
                    pbNOCHistory.Enabled = false;
                #endregion #14251

               if (frmGloAccountListRim.gridAccountListSum.SelectedIndicies.Count == 1)
                    pbACHFut.Enabled = true;
                else
                    pbACHFut.Enabled = false;
            }
            else
            {
                pbACHFut.Enabled = false;
                pbNOCHistory.Enabled = false; // #80649
            }
            #endregion #76055

            #region #194535
            if (picTabs.SelectedIndex == (int)TAB.InputTran || picTabs.SelectedIndex == (int)TAB.CustSummary || picTabs.SelectedIndex == (int)TAB.QuickTran)
            {
                pbeReceipt.Visible = true;
                if (_tlTranSet.TellerVars.AdTlControl.EnableEreceipt.Value == "Y" && _tlTranSet.TellerVars.IsAppOnline && //#40177   //#42151
                   (!_tlTranSet.CurTran.TranAcct.RimNo.IsNull || searchRimNo > 0)) // Bug#103638 
                {
                    pbeReceipt.Enabled = true;
                }
                else
                {
                    pbeReceipt.Enabled = false;
                }
            }
            else
            {
                pbeReceipt.Visible = false;
            }
            #endregion #194535

            #region #79619
            if (TellerVars.Instance.IsNonCashDrawer)
            {
                this.pbMakeBreakStrap.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                this.pbCashIn.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                this.pbCashOut.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
            }
            if (TellerVars.Instance.AdTlControl.VltGlTranOnly.StringValue == "Y" && TellerVars.Instance.IsVaultDrawer)
                Name2.IsDisabled = true;
            #endregion

            #region #79314
            ResetFormForSupViewOnlyMode(origin);
            #endregion

			EnableDisableTellerCaptureTran(origin);   // #140895-ReadOnly
            //Begin 60578
            if (picTabs.SelectedIndex == (int)TAB.CustSummary)
            {
                if (frmGloAccountListRim != null)
                {
                    pbRestrictions.Visible = false;
                    pbACHFut.Visible = false;
                    pbIrsRpt.Visible = false;
                    pbPendingCC.Visible = false;
                    pbVod.Visible = false;
                    pbeReceipt.Visible = false;
                    pbNOCHistory.Visible = false;
                    pbPrintMailer.Visible = false;

                }
            }
            //End 60578       

            if (!processingSelectTran && Workspace != null)
                Workspace.ActionPanel.UpdateView();
            //Workspace.UpdateView();

            //if (origin == "TranCodeSelect") //#72916*
            //{
            //    //toggle TCD/Drawe if required
            //    if (_tlTranSet.TellerVars.IsTCDEnabled && ((_tlTranSet.CurTran.TranCode.Value == 505 && picTCD.Visible) ||
            //        (_tlTranSet.CurTran.TlTranCode.Value == "VLT" && picDrawer.Visible)))
            //        TcdDrawerIconClick(picTCD, picDrawer);
            //}

            if (setAlertAccount)
            {
                //Begin #19415
                if (origin == "AcctNoEnter" && !_tlTranSet.CurTran.TranAcct.AlertInfo.IsNull)
                {
                    acctAlerts = new AcctAlerts();
                    if (!acctAlerts.LoadFromString(_tlTranSet.CurTran.TranAcct.AlertInfo.Value))
                        acctAlerts = null;
                }
                //End #19415

                if (!string.IsNullOrEmpty(acctType) && !string.IsNullOrEmpty(acctNo)) //Bug #95957
                {
                    //#127787 Add null check, sometimes when cross reference is used CurrentWindow is getting null values.
                    if (Workspace.CurrentWindow != null)
                    {
                        ((Workspace as PwksWindow).WksExtension as WkspaceExtension).SetAlertAccount(
                            acctType, acctNo, acctId, !acctHasPostAccessOnly, acctAlerts);
                    }
                }
                //Workspace.UpdateView( );
                //71033
                //Begin #65372.
                if (picTabs.SelectedIndex != (int)TAB.CustSummary)
                {
                    UpdateView();
                }
                //End #65372

                /* Begin 112736 */
                if (picTabs.SelectedTab == Name2 || picTabs.SelectedTab == Name3) //Search or RMS tab
                {
                    if (TellerVars.Instance.DrawerNo <= 0)
                    {
                        Name0.IsDisabled = true;
                        this.tabEasyCapture.IsDisabled = true;
                    }
                }
                /* End 112736 */
            }
            _previousTab = picTabs.SelectedIndex;
        }

        private bool RemoveTransaction(int tranIndex)
        {
            return true;
        }

        public override bool OnActionSave(bool isAddNext)
        {
            if (_invokedByWorkflow && Workspace != null && isAddNext == false)
            {
                Workspace.Variables[InputParamTranSet.WFTranStatusWkspaceVar] = WFTranStatus.Posting.ToString();
            }

            // Begin #94549 - Show message when user trying to post transactions, when drawer is already closed out. 
            DateTime curPostingDate = _gbHelper.GetCurPostingDate(_tlTranSet.TellerVars.BranchNo, _tlTranSet.TellerVars.DrawerNo);
            if (curPostingDate == DateTime.MinValue)
            {
                // You have closed out.Please Exit the Teller System before trying to do anything else.
                PMessageBox.Show(this, 311337, MessageType.Error, MessageBoxButtons.OK);
                return false;
            }
            // End #94549
            //Begin #87731
            if (picTabs.SelectedTab == tabEasyCapture && !_tlTranSet.CaptureAllCheckTranItems)  //#102719
            {
                _quickTranWindow.DeleteEmptyTranRow();  //#124249

                //Begin Task #103255
                MapEasyCaptureToTranSet(false, false, false, false);
                if (!_quickTranWindow.ValidateTransactions())
                    return false;
                //End Task #103255

                // _easyCaptureTranSet =  //TODO map to the dev express control
                if (!MapEasyCaptureToTranSet(true,false,true,true))
                    return false;

                _quickTabFocusedOnSave = true; //92498
            }
            //End #87731

            _tabOnSave = true; //92498

            if (bPenaltyIsNull && dfPenaltyAmt.Focused)     // WI#12051 - if penalty was null, and system re-generated value, abort save, but reset flag.
            {                                               // this is required for instances where the user blanks out the dfPenaltyAmt field, and presses
															// alt+P to save.  without this code, the form will attempt to save, even with the error message appearing
                Name0.Focus();                              // shift focus away from dfPenaltyAmt to force Text property to update properly
                dfPenaltyAmt.Focus();                       // shift focus back to dfPenaltyAmt
				bPenaltyIsNull = false;
				return false;
			}

            //#140780
            bODPMsgDisplayed = false;

			// Begin #79572
			//#79572
			//if (isNonCust())
			//{
			//cmbAcctType.SetValue("RIM");
			//dfAcctNo.Enabled = false;
			//cmbAcctType.Enabled = false;
            _tranPostingAttempted = true;
			if (isNonCust())
			{
				_tlTranSet.CurTran.AcctType.Value = _tlTranSet.CurTran.TranAcct.AcctType.Value = "RIM";
				dfAcctNo.Text = _tlTranSet.CurTran.AcctNo.Value = _tlTranSet.CurTran.TranAcct.AcctNo.Value = this.Workspace.Variables["NonCustRimNo"].ToString();
				_tlTranSet.CurTran.TranAcct.RimNo.Value = Convert.ToInt32(this.Workspace.Variables["NonCustRimNo"]);
				_tlTranSet.CurTran.NonCust.Value = "Y";
			}

			//if (IsDisplayTransitItemFields() && _tlTranSet.CurTran.Items.Count == 0 &&
			//    !_tlTranSet.CurTran.TransitChks.IsNull && _tlTranSet.CurTran.TransitChks.Value > 0)
			//{
			//    TlItemCapture tlItemCapture = new TlItemCapture();
			//    tlItemCapture.BranchNo.Value = _tlTranSet.TellerVars.BranchNo;
			//    tlItemCapture.DrawerNo.Value = _tlTranSet.TellerVars.DrawerNo;
			//    //tlItemCapture.SequenceNo.Value
			//    tlItemCapture.ItemNo.Value = 1;
			//    tlItemCapture.AcctType.Value = null;
			//    tlItemCapture.AcctNo.Value = _tlTranSet.CurTran.TlItemAcctNo.Value;
			//    //tlItemCapture.TranStatus.Value
			//    tlItemCapture.EffectiveDt.Value = _tlTranSet.TellerVars.PostingDt;
			//    //tlItemCapture.Ptid
			//    //tlItemCapture.CreateDt.Value
			//    tlItemCapture.EmplId.Value = _tlTranSet.TellerVars.EmployeeId;
			//    tlItemCapture.CheckNo.Value = _tlTranSet.CurTran.TlItemCheckNo.Value;
			//    //tlItemCapture.ItemType.Value = ;
			//    tlItemCapture.TranCode.Value = Int16.MinValue;
			//    //dfTransitChks.UnFormattedValue = "100";
			//    //dfTransitChks_PhoenixUIValidateEvent(null, new PCancelEventArgs(new CancelEventArgs()));
			//    tlItemCapture.Amount.Value = _tlTranSet.CurTran.TransitChks.Value;
			//    //_tlTranSet.CurTran.TransitChks.Value = tlItemCapture.Amount.Value = Convert.ToDecimal(dfTransitChks.Text);
			//    tlItemCapture.CheckType.Value = "T";
			//    tlItemCapture.RoutingNo.Value = _tlTranSet.CurTran.TlItemRoutingNo.Value;
			//    //tlItemCapture.JournalPtid.Value
			//    _tlTranSet.CurTran.Items.Add(tlItemCapture);
			//}
			//}
			//#79572
			// End #79572

            #region #79619
            if (_tlTranSet.CurTran.TranCode.Value == 555 || _tlTranSet.CurTran.TranCode.Value == 505)
            {
                if (!_tlTranSet.CurTran.CheckNo.IsNull) // #7986
                {
                    _tlDrawer.DrawerNo.Value = Convert.ToInt16(_tlTranSet.CurTran.CheckNo.Value);
                    _tlDrawer.BranchNo.Value = _tlTranSet.TellerVars.BranchNo;
                    _tlDrawer.SelectAllFields = true;

                    _tlDrawer.ActionType = XmActionType.Select;
                    CoreService.DataService.ProcessRequest(_tlDrawer);
                    if (_tlDrawer.NonCash.StringValue == "Y")
                    {
                        PMessageBox.Show(11570, MessageType.Error, MessageBoxButtons.OK, String.Empty);
                        return false;
                    }
                }
            }
            #endregion

            sharePrimaryCheck = false; //76029
            // Begin #76041
            myPost = isAddNext;
            if (!isAddNext)
            {
                _myRim = 0;
                myPostAccess = string.Empty;    //#5700
                myEditAccess = string.Empty;    //#5700
            }
            else
            {
                //Begin #13182/#13183
                if (populateGridWithSavedRim && _tlTranSet.CurTran.TranAcct.RimNo.Value < 1)
                    _tlTranSet.CurTran.TranAcct.RimNo.Value = _myRim;
                //End #13182/#13183
                _myRim = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                if (_tlTranSet.CurTran.TranAcct.PostAccess != null) //73404
                {
                    myPostAccess = _tlTranSet.CurTran.TranAcct.PostAccess.Value;    //#5700
                }
                if (_tlTranSet.CurTran.TranAcct.EditAccess != null)//73404
                {
                    myEditAccess = _tlTranSet.CurTran.TranAcct.EditAccess.Value;    //#5700
                }
            }
            // End #76041

            string focusField = "";

            postCashInTriggered = false;

            if (Workspace.Screens[12094] != null && cashDenomCallType == "CashInDenom" && !postCashInTriggered)	// if cash count window is created due to enter/add next , then trigger post after close out of window( triggering not impleneted )
            {
                postCashInTriggered = true;
                return false;
            }

            //Begin #140895
            _triggeredCashInOnPostTlCapture = false;
            if (_tlTranSet.IsTellerCaptureTran && !isAddNext)
            {
                saveActionType = isAddNext;
                if (!TlCaptureValidateOnPost())
                    return false;
            }
            //End #140895


            if (picTabs.SelectedTab == Name0 || _creatingTlCaptureTranSet)     // #140895 - Check for _creatingTlCaptureTranSet #102719
            {
                if (!addNextCashInTriggered)
                {
                    if (isAddNext)
                    {
                        if (!CheckForPendingValidation(ActionAddNext.ImageButton))
                            return false;
                    }
                    else
                    {
                        if (!CheckForPendingValidation(ActionSave.ImageButton))
                            return false;
                    }

                    MoveAmtScreensToObject();
                    MoveMiscScreensToObject(miscTCFields);
                    MoveMiscScreensToObject(miscAcctFields);
                    MoveAcctScreensToObject(dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct);
                    if (_tlTranSet.TriggerCashInOut("AddNext", !_tlTranSet.IsTellerCaptureTran)) // #140895 - passed  IsTellerCaptureTran
                    {
                        addNextCashInTriggered = true;
                        saveActionType = isAddNext;
                        HandleCashInOutDenom("CashInDenom");
                        return false;
                    }
                }

                addNextCashInTriggered = false;

                _tlTranSet.IsTcdConnected.Value = (_tlTranSet.TellerVars.IsTCDConnected ? Convert.ToInt32(1) : Convert.ToInt32(0)); //#72916
                _tlTranSet.ValidateAddTransaction(ref focusField, (_tlTranSet.TellerVars.IsTCDConnected && picTCD.Visible)); //#72916*
                _tlTranSet.CurTran.ProcessAsRegD.Value = (cbRegD.Checked ? "Y" : "N"); //#7449
                if (!ProcessResponses(null))
                {
                    if (_tlTranSet.CurTran.Items.Count > 0 && cmbTfrAcctType.Enabled)
                    {
                        MoveAcctObjectsToScreen(dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct);
                        EnableDisableControls("ItemCaptureClick");
                    }
                    GetControlByXmlTag(focusField, true);
                    return false;
                }

                //Begin #140895
                if (_tlTranSet.TellerVars.IsTellerCaptureEnabled && isAddNext)
                    CollectCheckInfoForChkPrinting(true);
                //End #140895

                // Begin #180277
                if (_tlTranSet.CurTran.TranCode.Value == 300)
                {
                    if (!VerifyLnOverPayment())
                        return false;
                }
                // End #180277

                if (isAddNext) // #8562
                    this.CallOtherForms("Services");
                curTranIndex = _tlTranSet.AddTransaction();
                PopulateTransetTable();
            }

            try
            {
                if (!isAddNext)
                {

                    //Begin #87731
                    if (_quickTranWindow != null && _quickTranWindow.TranSet != null && _quickTranWindow.TranSet.Transactions.Count > 0)
                    {
                        if (!ValidateEasyCaptureTranSet())
                            return false;
                    }
                    //End #87731

                    //Begin #TellerWF
                    if ( _inputParamTranSet != null && _inputParamTranSet.Transactions.Count > 0 )
                    {
                        if (!ValidateInputParamTranSet())
                            return false;
                    }
                    //End #TellerWF

                    _tlTranSet.ValidatePrePost(ref focusField);

                    if (!ProcessResponses(null))
                    {
                        if (_tlTranSet.Transactions.Count > 0)
                        {
                            ctwTranSet.ContextRow = _tlTranSet.Transactions.Count - 1;
                            SelectTran(-1);
                            GetControlByXmlTag(focusField, true);

                            //Begin #140780
                            if (bRegdExceeded == true)
                            {
                                bRegdExceeded = false;
                                dfQuickTranCode.Focus();
                            }
                            //End #140780
                        }
                        return false;

                    }
                    //#5732
                    //postCashOutTriggered = false;
                    //tcdDispenseTriggered = false;
                    //isTcdDispenseFailed = false;
                    //postTcdCashOutTriggered = false;
                    //
                    if (_tlTranSet.IsTellerCaptureCheckOnlyTran && !_tlTranSet.CaptureAllCheckTranItems)   //#102719 #102717
                    {
                        if (_tellerCapture != null)
                        {
                            try
                            {
                                _tlCaptureAVTCSilentMode = true;
                                //SetTellerCaptureFlagForTranSet(true);
                                //_tlTranSet.EnableChecksOnlyTran = false;
                                _tlTranSet.CaptureAllCheckTranItems = true;    // force the effect of after post
                                _tellerCapture.LastTranCommitPending = false;   // since we are recapturing the tran we turn it to false and finally make it true
                                this.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "ActionTlrCapSingleRelatedClick", new object[] { string.Empty });
                            }
                            finally
                            {
                                _tellerCapture.LastTranCommitPending = true;
                            }
                        }
                    }

                    WriteToDebugLog("Called PostTransactions from OnActionSave");


                    #region Is Acct member or IRA set ? #140782 //140782-3

                    // We no longer have _tlTranSet.CurTran.TranCode.Value, so we need to use cmbTranCode....
                    //Begin #140895
                    //string tc = cmbTranCode.CodeValue.ToString();
                    //string acctNo = this.dfAcctNo.Text;
                    //string acctType = this.cmbAcctType.CodeValue.ToString();
                    string tc = Convert.ToString(_tlTranSet.CurTran.TranCode.Value);
                    string acctNo = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
                    string acctType = _tlTranSet.CurTran.TranAcct.AcctType.Value;
                    //End #140895
                    //22654
                    //#37585 - removed TCs 276, 279 and 287
                    //140782-3 if ((cmbTranCode.CodeValue.ToString() == "176" || cmbTranCode.CodeValue.ToString() == "179" || cmbTranCode.CodeValue.ToString() == "187" || cmbTranCode.CodeValue.ToString() == "276" || cmbTranCode.CodeValue.ToString() == "279" || cmbTranCode.CodeValue.ToString() == "287")
                    if (tc == "176"
                        || tc == "179"
                        || tc == "187")
                    {
                        bool HasIraDisb = _tlTranSet.HasIraDisb(acctNo, acctType);
                        if (HasIraDisb)
                        {
                            // Account is a member of a retirement plan that has an automatic distribution.  Please have the customer see a customer service representative if they would like to make changes to the existing distribution.
                            PMessageBox.Show(13923, MessageType.Warning, MessageBoxButtons.OK, String.Empty);
                        }
                    }

                    #endregion

                    PostTransactions();
                    /*Begin #112458-Close restriction after posting transactions sucessfully*/
                    if (_tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.Success)
                    {
                        foreach (TlTransaction tran in _tlTranSet.Transactions)
                        {
                            if (tran.TranCode.Value == 131 || tran.TranCode.Value == 176 || tran.TranCode.Value == 177 || tran.TranCode.Value == 178 || tran.TranCode.Value == 193)
                            {
                                PDecimal returnValue1 = new PDecimal("returnValue1");
                                PDecimal returnValue2 = new PDecimal("returnValue2");
                                if (_tlTranSet.CloseRestrictions(tran.TranAcct.AcctNo.Value, tran.TranAcct.AcctType.Value, returnValue1, returnValue2))
                                {
                                    ////msg 14775: There were %1! restrictions that have been closed of which %2! were stop payments.
                                    PMessageBox.Show(14775, MessageType.Warning, MessageBoxButtons.OK, new string[] { returnValue1.Value.ToString(), returnValue2.Value.ToString() });
                                }
                            }
                        }

                    }
                    /*End #112458*/

                    EnableDisableControls(EnumEnableDisable.CDRedemp); //140782,21033

                    return true;
                }
            }
            catch (PhoenixException pe)
            {
                PMessageBox.Show(pe, MessageBoxButtons.OK);
                if (_tlTranSet.Transactions.Count > 0)
                {
                    ctwTranSet.ContextRow = _tlTranSet.Transactions.Count - 1;
                    SelectTran(-1);
                }
                return false;
            }
            finally
            {
                dlgInformation.Instance.HideInfo();
                /* #4889 - per jackie, display notes for same account when the transaction has been posted.
                 * cause second tx could be 5 hrs apart. also, dont display notes when for same account
                 * if its in a tx set.
                 */
                if (!isAddNext)
                    notePtids.Clear();
            }
            ActionAfterAddNext();
            return true;
        }

        public override bool OnActionAddNext()
        {
            _fromAddNext = true;
            #region #10495 - Store the security access since tranacct will be wiped out....
            _myPostAccessAddNext = myPostAccess;
            _myEditAccessAddNext = myEditAccess;
            #endregion
            return OnActionSave(true);
        }

        private bool ProcessResponses(PMessageCollection msgCollection,string focusField = null, EasyCaptureTran easyCaptureTran = null,bool showErrorMessage = true)     // #87731 - Add fromAsyncCall
        {
            MessageType msgType = MessageType.Warning;
            MessageBoxButtons buttons = MessageBoxButtons.OK;
            DialogResult response = DialogResult.None;  //#87731

            if (msgCollection == null)
            {
				pbPendingCC.Enabled = false;	// #140792
                int row = 0;
                foreach (Phoenix.BusObj.Teller.TranResponse tranResponse in _tlTranSet.TranResponses)
                {
                    if (tranResponse.RetCode < 0 && tranResponse.RetCodeDesc == null || tranResponse.RetCodeDesc == String.Empty)
                        tranResponse.RetCodeDesc = _gbHelper.GetSPMessageText(tranResponse.RetCode, false);

                    if (tranResponse.ErrorType == "E")
                    {
                        msgType = MessageType.Warning;
                        buttons = MessageBoxButtons.OK;
                    }
                    else if (tranResponse.ErrorType == "Q")
                    {
                        msgType = MessageType.Question;
                        buttons = MessageBoxButtons.YesNo;
                    }
                    else if (tranResponse.ErrorType == "I")
                    {
                        msgType = MessageType.Message;
                        buttons = MessageBoxButtons.OK;
                    }

                    //Begin #140780
                    if (tranResponse.RetCode == 13805)
                        bRegdExceeded = true;
                    //End #140780

                    if (tranResponse.RetCode == 5165)   // #140792
					{
						pbPendingCC.Enabled = true;
					}

                    var easyCaptureTranResponse = new EasyCaptureTranResponse
                    {
                        ErrorType = tranResponse.ErrorType,
                        ErrorCode = tranResponse.RetCode,
                        ErrorText = tranResponse.RetCodeDesc,
                        FocusField = focusField,
                    };
                    if (easyCaptureTran == null)       //#87731
                    {
                        if (showErrorMessage) //Bug 98536
                        {
                            response = PMessageBox.Show(360188, msgType, buttons, new string[] { tranResponse.RetCode.ToString() + "-" + tranResponse.RetCodeDesc });
                            if (picTabs.SelectedIndex == (int)TAB.QuickTran)
                            {
                                if (_tlTranSet.Transactions.Count > 0) //Task# 90007
                                    _quickTranWindow.FocusProblematicField(easyCaptureTranResponse, _tlTranSet.CurTran.TranIndex.Value);
                            }
                        }
                    }
                    else
                    {
                        easyCaptureTran.TranResponse.Add(easyCaptureTranResponse);

                        if (tranResponse.ErrorType == "Q")  // all question type messages are treated as rejected and deferred for final post call.
                            response = DialogResult.No; 
                    }

                    if (tranResponse.ErrorType == "E" || response == DialogResult.No)
                        return false;
                    ++row;
                }
            }
            else
            {
                foreach (PMessage pmessage in msgCollection)
                {
                    if (pmessage.Id < 0 && pmessage.Text == null || pmessage.Text == String.Empty)
                        pmessage.Text = _gbHelper.GetSPMessageText(pmessage.Id, false);

                    if (pmessage.Severity == MLErrorLevel.Error)
                    {
                        msgType = MessageType.Warning;
                        buttons = MessageBoxButtons.OK;
                    }
                    else
                    {
                        msgType = MessageType.Message;
                        buttons = MessageBoxButtons.OK;
                    }

                    response = PMessageBox.Show(360188, msgType, buttons, new string[] { pmessage.Id.ToString() + "-" + pmessage.Text });

                    if (pmessage.Severity == MLErrorLevel.Error)
                        return false;

                }
            }
            return true;
        }

        private bool IsOnUsTCEnabled                //8837
        {
            get
            {
                return _tlTranSet.TellerVars.AdTlControl.EnableOnUsTc.Value == "Y"
                          && (_tlTranSet.CurTran.TranAcct.DepLoan.Value == "RM" || isNonCust()); // #10082 - Added non cust check
            }

        }

        private void MoveAmtScreensToObject()
        {
            foreach (PdfCurrency amtField in amtFields)
            {
                // hack
                if (amtField.UnFormattedValue != null && (amtField.UnFormattedValue.ToString() == String.Empty))
                {
                    amtField.UnFormattedValue = null;
                }
                //amtField.PhoenixUIControl.ScreenToObject( amtField.UnFormattedValue );
                amtField.ScreenToObject();
            }
        }

        private void MoveAmtObjectsToScreen()
        {
            foreach (PdfCurrency amtField in amtFields)
            {
                //amtField.PhoenixUIControl.ObjectToScreen();
                amtField.ObjectToScreen();
                // hack
                if (amtField.UnFormattedValue != null && (amtField.UnFormattedValue.ToString() == String.Empty))
                {
                    amtField.UnFormattedValue = null;
                }
            }
            SetTotalDebitsAndCredits();
        }

        private void MoveMiscScreensToObject(ArrayList miscFields)
        {
            PdfStandard dataField = null;
            foreach (Control control in miscFields)
            {
                if (control is PdfStandard)
                {
                    dataField = control as PdfStandard;
                    if (dataField.UnFormattedValue != null && dataField.UnFormattedValue.ToString() == String.Empty)
                        dataField.UnFormattedValue = null;
                    dataField.ScreenToObject();
                }
                else if (control is PComboBoxStandard)
                    (control as PComboBoxStandard).ScreenToObject();
                else if (control is PCheckBoxStandard)

                    (control as PCheckBoxStandard).ScreenToObject();
            }
        }

        private void MoveMiscObjectsToScreen(ArrayList miscFields)
        {
            PComboBoxStandard combo = null;
            foreach (Control control in miscFields)
            {
                if (control is PdfStandard)
                    (control as PdfStandard).ObjectToScreen();
                else if (control is PComboBoxStandard)
                {
                    combo = control as PComboBoxStandard;
                    combo.CodeValue = combo.PhoenixUIControl.BusObjectProperty.Value;
                }
                else if (control is PCheckBoxStandard)
                    (control as PCheckBoxStandard).ObjectToScreen();
            }
        }

        private void MoveAcctObjectsToScreen(PdfStandard acctNoField,
            PComboBoxStandard acctTypeField, TlAcctDetails acctDetails)
        {
            bool acctTypeSrch = (_tlTranSet.TellerVars.AdTlControl.AcctTypeSearch.Value == GlobalVars.Instance.ML.Y);

            if (!acctDetails.AcctNo.IsNull && !acctDetails.AcctType.IsNull)
            {
                if (acctTypeSrch)
                    acctTypeField.CodeValue = acctDetails.AcctType.Value;
                else
                    acctTypeField.CodeValue = acctDetails.ApplType.Value;

                SetMask(acctTypeField, acctNoField);
                SetAcctNoField(acctDetails.AcctNo.Value, acctNoField, acctTypeField, acctDetails);
            }
            else if (!acctDetails.AcctType.IsNull)
            {
                if (acctTypeSrch)
                    acctTypeField.CodeValue = acctDetails.AcctType.Value;
                else
                    acctTypeField.CodeValue = acctDetails.ApplType.Value;
            }
            else
            {
                acctTypeField.CodeValue = null;
                SetAcctNoField(null, acctNoField, acctTypeField, acctDetails);
            }
        }

        private void MoveAcctScreensToObject(PdfStandard acctNoField,
            PComboBoxStandard acctTypeField, TlAcctDetails acctDetails)
        {
            if (acctTypeField.CodeValue != null && acctDetails.AcctType.IsNull &&
                acctDetails.ApplType.IsNull)
            {
                if (acctTypeSrch)
                    acctDetails.AcctType.Value = acctTypeField.CodeValue.ToString();
                else
                    acctDetails.ApplType.Value = acctTypeField.CodeValue.ToString();
            }
        }

        private Control SetTabOrder(string origin)
        {
            int tabIndex = 0;
            Control focusControl = null;

            focusControlAfterOnUs = null;
			focusControlAfterTransit = null;    //#79572

            if (origin == "FormCreate")
            {
                // All Group boxes
                tabIndex = 0;
                gbAccountInformation.TabIndex = tabIndex++;
                dfTransactionInformation.TabIndex = tabIndex++;

                // Group Account Information
                tabIndex = 0;
                cmbAcctType.TabIndex = tabIndex++;
                dfAcctNo.TabIndex = tabIndex++;
                cbPbPresent.TabIndex = tabIndex++;
                cbPayrollTran.TabIndex = tabIndex++;
                cbRetirement.TabIndex = tabIndex++;
                cmbCrncy.TabIndex = tabIndex++;

                // Group Transaction Information
                tabIndex = 0;
                dfQuickTranCode.TabIndex = tabIndex++;
                cmbTranCode.TabIndex = tabIndex++;
                cbPassDesc.TabIndex = tabIndex++;
                cbRegD.TabIndex = tabIndex++; // #8502
                dfTranEffectiveDt.TabIndex = tabIndex++;
                cmbExchCrncy.TabIndex = tabIndex++;
                dfTranDescription.TabIndex = tabIndex++;
				cmbUtility.TabIndex = tabIndex++;
				cmbLnEscrowAgent.TabIndex = tabIndex++;	//#80617
                dfReference.TabIndex = tabIndex++;
                cmbRefAcctType.TabIndex = tabIndex++;
                dfRefAcctNo.TabIndex = tabIndex++;
                cmbInventoryType.TabIndex = tabIndex++; //#140772
                dfInvSerialNo.TabIndex = tabIndex++;   //#140772
                cmbInventoryPacket.TabIndex = tabIndex++;   //#140772
                dfNoInvAvailable.TabIndex = tabIndex++; //#140772
                dfCashIn.TabIndex = tabIndex++;
                dfUMBCode.TabIndex = tabIndex++;
                cmbUmbCode.TabIndex = tabIndex++;
                cmbChannel.TabIndex = tabIndex++;//#79506
                cmbEndPoint.TabIndex = tabIndex++;
                cmbTCDDrawer.TabIndex = tabIndex++;
                dfChksAsCash.TabIndex = tabIndex++;
                dfOnUsChks.TabIndex = tabIndex++;
                cmbTfrAcctType.TabIndex = tabIndex++;
                dfTfrAcctNo.TabIndex = tabIndex++;
                dfTfrCheckNo.TabIndex = tabIndex++;
                cmbOnUsTc.TabIndex = tabIndex++;    //#9513
                cbTfrPbPresent.TabIndex = tabIndex++;
                dfTransitChks.TabIndex = tabIndex++;
                dfTlItemAcctNo.TabIndex = tabIndex++;       //#79572
                dfTlItemRoutingNo.TabIndex = tabIndex++;    //#79572
				dfTlItemCheckNo.TabIndex = tabIndex++;		//#79572
                dfOnUsTitle1.TabIndex = tabIndex++;
                dfOnUsSignatures.TabIndex = tabIndex++;
                dfCashOut.TabIndex = tabIndex++;
                dfOnUsTitle2.TabIndex = tabIndex++;
                // #80620 - Commented dfOnUsAlerts.TabIndex = tabIndex++;
                dfAmt.TabIndex = tabIndex++;
                dfPostingExchRate.TabIndex = tabIndex++;
                dfAmtEq.TabIndex = tabIndex++;
                dfCheckNo.TabIndex = tabIndex++;
                dfCCAmt.TabIndex = tabIndex++;
                dfWithholdingAmt.TabIndex = tabIndex++;
                dfInterestPaid.TabIndex = tabIndex++;
                dfPenaltyAmt.TabIndex = tabIndex++;
                //cmbDispenseType.TabIndex = tabIndex++; //#72916
                cbWaiveSignature.TabIndex = tabIndex++; //#76033
                cbDenominate.TabIndex = tabIndex++; //#72916
                cmbRegCC.TabIndex = tabIndex++;
                cmbRecalcPmtDt.TabIndex = tabIndex++; //#76425
                dfRecalcPmt.TabIndex = tabIndex++; //#76425
            }
            else if (origin == "TranCodeSelect")
            {
                ArrayList tabOrderControls = new ArrayList();
                Control prevControl = null;

                // create an array of controls and put the fields in that array
                // in tab order.
                tabOrderControls.Add(cbPassDesc);
                tabOrderControls.Add(cbRegD);   // #8502
                tabOrderControls.Add(dfTranEffectiveDt);
                tabOrderControls.Add(cmbExchCrncy);
                tabOrderControls.Add(dfTranDescription);
                tabOrderControls.Add(cmbChannel);//#79506
				tabOrderControls.Add(cmbUtility);
				if (_tlTranSet.AdTlTc.DescriptionEnable.Value == "Y")
					tabOrderControls.Add(cmbLnEscrowAgent);	//#80617
                tabOrderControls.Add(cmbEndPoint);
                tabOrderControls.Add(dfReference);
                tabOrderControls.Add(cmbRefAcctType);
                tabOrderControls.Add(dfRefAcctNo);
                tabOrderControls.Add(cmbEndPoint);
                tabOrderControls.Add(cmbInventoryType); //#140772
                tabIndex = tabOrderControls.IndexOf(cmbInventoryType);     //#140772
                if (!_tlTranSet.AdTlTc.TranCode.IsNull && (_tlTranSet.AdTlTc.TranCode.Value == 938 || _tlTranSet.AdTlTc.TranCode.Value == 939)) //#140772
                {
                    if (tabIndex > 0)
                    {
                        if (_adGbInventoryType.Class.Value == CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Serial"))
                        {
                            tabOrderControls.Insert(tabIndex + 1, dfInvSerialNo);
                        }
                        else if (_adGbInventoryType.Class.Value == CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Packet"))
                        {
                            tabOrderControls.Insert(tabIndex + 1, cmbInventoryPacket);
                            if (_tlTranSet.AdTlTc.EnableNumberItems.Value == "Y")   //#140772
                                tabOrderControls.Insert(tabIndex + 2, dfCheckNo);
                        }
                        else
                        {
                            if (_tlTranSet.AdTlTc.EnableNumberItems.Value == "Y")   //#140772
                                tabOrderControls.Insert(tabIndex + 1, dfCheckNo);
                        }
                    }
                }
                int tabFieldsCount = tabOrderControls.Count;
                for (int i = 1; i <= 10; i++)
                {
                    if (_tlTranSet.AdTlTc.CashInTabs.Value == i)
                        tabOrderControls.Add(dfCashIn);
                    else if (_tlTranSet.AdTlTc.ChksAsCashTabs.Value == i)
                        tabOrderControls.Add(dfChksAsCash);
                    else if (_tlTranSet.AdTlTc.OnUsChksTabs.Value == i)
                        tabOrderControls.Add(dfOnUsChks);
                    else if (_tlTranSet.AdTlTc.TransitChksTabs.Value == i)
                        tabOrderControls.Add(dfTransitChks);
                    else if (_tlTranSet.AdTlTc.CashOutTabs.Value == i)
                        tabOrderControls.Add(dfCashOut);
                    else if (_tlTranSet.AdTlTc.NetAmtTabs.Value == i)
                        tabOrderControls.Add(dfAmt);
                    else if (_tlTranSet.AdTlTc.ExchRateTabs.Value == i)
                        tabOrderControls.Add(dfPostingExchRate);
                    else if (_tlTranSet.AdTlTc.EquivAmtTabs.Value == i)
                        tabOrderControls.Add(dfAmtEq);

					//Begin #80617
					if (_tlTranSet.AdTlTc.DescriptionEnable.Value != "Y" && tabOrderControls.Count == (tabFieldsCount + 1))
						tabOrderControls.Add(cmbLnEscrowAgent);
					//End #80617
                }

                // add the amount fields not addressed by the loop above
                foreach (PdfCurrency amtField in amtFields)
                {
                    if (amtField != dfInterestPaid
                        && amtField != dfCCAmt
                        && amtField != dfPenaltyAmt
                        && amtField != dfWithholdingAmt) // #140782
                    {
                        if (tabOrderControls.IndexOf(amtField) < 0)
                        {
                            tabOrderControls.Add(amtField);
                        }
                    }
					//Begin #80617
                    if (_tlTranSet.AdTlTc.DescriptionEnable.Value != "Y"
                        && tabOrderControls.Count == (tabFieldsCount + 1)
                        && tabOrderControls.IndexOf(cmbLnEscrowAgent) == -1)
                    {
                        tabOrderControls.Add(cmbLnEscrowAgent);
                    }
					//End #80617
                }

                // add the remaining fields
                if (tabOrderControls.IndexOf(dfPostingExchRate) < 0)
                {
                    tabOrderControls.Add(dfPostingExchRate);
                }
                if (tabOrderControls.IndexOf(dfAmtEq) < 0)
                {
                    tabOrderControls.Add(dfAmtEq);
                }
                tabOrderControls.Add(dfCCAmt);
                tabOrderControls.Add(dfWithholdingAmt);

                //handle some special fields which has related fields
                //#9425
                //#140772 - added 938 and 939
                tabIndex = tabOrderControls.IndexOf(dfCashIn);
                if (tabIndex > 0 && _tlTranSet.AdTlTc.CashOutEnable.Value != GlobalVars.Instance.ML.Y
                    && !_tlTranSet.AdTlTc.TranCode.IsNull
                    && "102,117,120,156,157,163,164,191,902,910,912,913,915,916,920,921,922,928,938,939".IndexOf(_tlTranSet.AdTlTc.TranCode.StringValue.Trim()) < 0)
                {

                    tabOrderControls.Insert(tabIndex + 1, cbWaiveSignature);
                }

                tabIndex = tabOrderControls.IndexOf(dfOnUsChks);
                if (tabIndex > 0)
                {
                    tabOrderControls.Insert(tabIndex + 1, cmbTfrAcctType);
                    tabOrderControls.Insert(tabIndex + 2, dfTfrAcctNo);
                    tabOrderControls.Insert(tabIndex + 3, dfTfrCheckNo);

                    // #79370 - Enable the tab order for this control ... #8837
                    //#9513
                    //if (IsOnUsTCEnabled && (!string.IsNullOrEmpty(dfOnUsChks.Text)))
                    //{
                    //    tabOrderControls.Insert(tabIndex + 4, cmbOnUsTc);
                    //}
                    if (IsOnUsTCEnabled)
						tabOrderControls.Insert(tabIndex + 4, cmbOnUsTc);
					//#79572
					tabIndex = tabOrderControls.IndexOf(dfTransitChks);
					if (tabIndex > 0)
					{
						tabOrderControls.Insert(tabIndex + 1, dfTlItemAcctNo);
						tabOrderControls.Insert(tabIndex + 2, dfTlItemRoutingNo);
						tabOrderControls.Insert(tabIndex + 3, dfTlItemCheckNo);
					}
					//#79572
                }
                if (_tlTranSet.AdTlTc.BatchId.IsNull)
                    tabIndex = tabOrderControls.IndexOf(dfCashOut);
                else
                    tabIndex = tabOrderControls.IndexOf(dfAmt);

                //Begin #76033
                if (tabIndex > 0)
                    tabOrderControls.Insert(tabIndex + 1, cbWaiveSignature);
                //End #76033

                if (tabIndex > 0)
                    tabOrderControls.Insert(tabIndex + 2, cbDenominate);
                //End #72916

                tabIndex = tabOrderControls.IndexOf(dfAmt);
                if (tabIndex > 0)
                {
                    tabOrderControls.Insert(tabIndex + 1, dfInterestPaid);
                    if (!_tlTranSet.AdTlTc.TranCode.IsNull && (_tlTranSet.AdTlTc.TranCode.Value == 938 || _tlTranSet.AdTlTc.TranCode.Value == 939)) //#140772
                    {
                        tabOrderControls.Insert(tabIndex + 2, dfPenaltyAmt);
                    }
                    else
                    {
                        tabOrderControls.Insert(tabIndex + 2, dfCheckNo);
                        tabOrderControls.Insert(tabIndex + 3, dfPenaltyAmt);
                    }
                }
                //Begin #76425
                if (_tlTranSet.AdTlTc != null && _tlTranSet.IsRecalcPmtRequired())
                {
                    tabOrderControls.Add(cmbRecalcPmtDt);
                    tabIndex = tabOrderControls.IndexOf(cmbRecalcPmtDt);
                    //
                    if (tabIndex > 0)
                    {
                        tabOrderControls.Insert(tabIndex + 1, dfRecalcPmt); ;
                    }
                }
                //End #76425

                // now set the order
                tabIndex = cmbTranCode.TabIndex + 1;
                foreach (Control control in tabOrderControls)
                {
                    if (control.Visible && control.Enabled)
                    {
                        if (focusControl == null)
                            focusControl = control;
                        if (prevControl == dfTfrCheckNo || (prevControl == cmbOnUsTc && prevControl.Visible))   //#9984
                            focusControlAfterOnUs = control;
						if (prevControl == dfTlItemCheckNo)     //#79572
							focusControlAfterTransit = control;

                        control.TabIndex = tabIndex++;
                        prevControl = control;
                    }
                }

            }
            if (!_tlTranSet.AdTlTc.TranCode.IsNull && (_tlTranSet.AdTlTc.TranCode.Value == 938 || _tlTranSet.AdTlTc.TranCode.Value == 939)) //#21564
                SetInvNoItemsLabel();  //#140772
            SetLocation(origin);
            SetCheckNoLabel(origin);
            SetRefAcctLabel(origin); //67882
            SetFeeAmountLabel(origin); //#76043
            if (origin == "TranCodeSelect") //#76033
                SetWaiveSignatureLocation();
            return focusControl;

        }

        #region #80620
        private void GetOnUsNoteCount()
        {
            int[] notesList = null;
            _onUsNoteCount = 0;
            _onUsNotePopupCount = 0;
            if (Phoenix.FrameWork.CDS.DataService.Instance.PrimaryDbAvailable == true)
            {
                _onUsNotePopupCount = _tlTranSet.GetOnUsNotesList(ref showNotes, ref notesList);
                if (notesList != null)
                    _onUsNoteCount = notesList.Length;
            }
        }

        private void AttachAcctAlertsIcons()
        {
            //Begin #79496, #16763
            if (!TellerVars.Instance.IsAppOnline)
                return;
            //End #79496, #16763

            onUsBar.Clear();

            AcctAlerts onusAcctAlerts = new AcctAlerts();                               //140780-20052
            onusAcctAlerts.LoadFromString(_tlTranSet.CurTran.TfrAcct.AlertInfo.Value);  //140780-20052

            #region add images
            iconOnUsCaution.Image = Alerts.Acct_Caution;    //32891 TellerImages.Caution;
            iconOnUsHold.Image = Alerts.Acct_Hold;          //32891 TellerImages.Hold;
            iconOnUsStop.Image = Alerts.Acct_Stop;          //32891 TellerImages.Stop;
            iconOnUsSweep.Image = Alerts.Acct_Sweep;        //32891 TellerImages.Sweep;
            iconOnUsAnalysis.Image = Alerts.Acct_Analysis;  //32891 TellerImages.Analysis;
            iconOnUsAcctRegD.Image = Alerts.Acct_RegD;                                  //140780-20052
            iconOnUsSigner.Image = TellerImages.CustomerImage16;    //32891
            if (_gbMemo.IsNotesPlus(_tlTranSet.CurTran.TfrAcct.AcctType.Value, _tlTranSet.CurTran.TfrAcct.AcctNo.Value))
            {
                // #15942 - Designer change to display Notes Plus icon if note count > 1
                iconOnUsNotes.Image = TellerImages.NotesPlus;
            }
            else
            {
                iconOnUsNotes.Image = TellerImages.Notes;
            }
            #endregion

            onUsBar.ItemHeight = 22;
            onUsBar.StartColor = this.BackColor;
            onUsBar.EndColor = this.BackColor;
            if (ThemeHelper.ActionButtonOldStyle)
            {
                onUsBar.StartColor = onUsBar.EndColor;
            }

            iconOnUsSigner.Enabled = true;

            #region NextScreenId
            iconOnUsSweep.NextScreenId = Phoenix.Shared.Constants.ScreenId.DpSweepDisplay;
            iconOnUsCaution.NextScreenId = Phoenix.Shared.Constants.ScreenId.GbStopHold;
            iconOnUsHold.NextScreenId = Phoenix.Shared.Constants.ScreenId.GbStopHold;
            iconOnUsStop.NextScreenId = Phoenix.Shared.Constants.ScreenId.GbStopHold;
            iconOnUsAnalysis.NextScreenId = Phoenix.Shared.Constants.ScreenId.AcctAnalPreview;
            iconOnUsNotes.NextScreenId = Phoenix.Shared.Constants.ScreenId.GbMessage;
            iconOnUsAcctRegD.NextScreenId = Phoenix.Shared.Constants.ScreenId.DpDisplayRegDDisplay;  //140780-20052 // FIXME
            #endregion


            #region add to Nmgr



            if (_tlTranSet.CurTran.TfrAcct.AcctHasSweep.Value == 1)
            {
                onUsBar.AddAction(iconOnUsSweep);
            }
            if (_tlTranSet.CurTran.TfrAcct.Cautions.Value == GlobalVars.Instance.ML.Y)
            {
                onUsBar.AddAction(iconOnUsCaution);
            }
            if (_tlTranSet.CurTran.TfrAcct.HoldBal.Value > 0)
            {
                onUsBar.AddAction(iconOnUsHold);
            }
            if (_tlTranSet.CurTran.TfrAcct.Analysis.Value == GlobalVars.Instance.ML.Y)
            {
                onUsBar.AddAction(iconOnUsAnalysis);
            }
            if (_tlTranSet.CurTran.TfrAcct.Stops.Value == GlobalVars.Instance.ML.Y)
            {
                onUsBar.AddAction(iconOnUsStop);
            }
            if (_tlTranSet.CurTran.TfrAcct.AcctType.Value != GlobalVars.Instance.ML.GL)   // #79496
            {
                onUsBar.AddAction(iconOnUsSigner);
            }
            if (onusAcctAlerts.AcctRegD)                        //140780-20052
            {
                onUsBar.AddAction(iconOnUsAcctRegD);
            }

            GetOnUsNoteCount();

            if (_onUsNoteCount > 0 && iconOnUsNotes.Enabled == true)
            {
                onUsBar.AddAction(iconOnUsNotes);
                cmOnUs.MenuItems[3].Enabled = true;
            }
            else
            {
                cmOnUs.MenuItems[3].Enabled = false;
            }

            if (iconOnUsCaution.Enabled == true || iconOnUsHold.Enabled == true || iconOnUsStop.Enabled == true)
            {
                cmOnUs.MenuItems[2].Enabled = true;
            }
            else
            {
                cmOnUs.MenuItems[2].Enabled = false;
            }

            cmOnUs.MenuItems[0].Enabled = ScreenHasAccess("display", true);    //#16961

            onUsBar.RecalcItems();
            onUsBar.UpdateView();

            if (onUsBar.Controls.Count == 0)   // #79496
            {
                onUsBar.Visible = false;
            }
            #endregion
        }
        #endregion

        private void MapFieldToObject()
        {
            this.cbRetirement.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.TranAcct.RetirementTran;
            this.cbPayrollTran.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.PayrollWd;
            this.cmbAcctType.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.AcctType;
            this.dfAcctNo.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.AcctNo;
            this.cmbTranCode.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.TlTranCode;
            this.dfCashIn.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.CashIn;
            this.dfChksAsCash.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.ChksAsCash;
            this.dfOnUsChks.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.OnUsChks;
            this.dfTransitChks.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.TransitChks;
            this.dfCashOut.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.CashOut;
            this.dfInterestPaid.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.IntAmt;
            this.dfAmt.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.NetAmt;
            this.dfCCAmt.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.CcAmt;
            this.dfPenaltyAmt.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.PenaltyAmt;
            this.dfTfrAcctNo.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.TfrAcctNo;
            this.cmbTfrAcctType.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.TfrAcctType;
            this.dfTfrCheckNo.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.TfrChkNo;
            this.dfCheckNo.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.CheckNo;
            this.cmbRefAcctType.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.ReferenceAcctType;
            this.dfRefAcctNo.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.ReferenceAcctNo;
            this.dfReference.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.Reference;
            this.dfTranDescription.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.Description;
            this.cmbEndPoint.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.Endpoint;
            this.cmbUmbCode.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.UmbCode;
            this.cmbUtility.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.UtilityId;
            this.cmbLnEscrowAgent.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.Loan3rdPartyId;		//#80617
            this.cbPassDesc.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.UseDescription;
            this.dfTranEffectiveDt.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.TranEffectiveDt;
            this.cbDenominate.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.TcdDenominate;
            this.cbWaiveSignature.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.WaiveSignature; //#76033
            this.dfRecalcPmt.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.RecalcPmtAmt; //#76425
            this.cmbRecalcPmtDt.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.RecalcPmtDt; //#76425
            this.cbRegD.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.ProcessAsRegD; //#7449
            this.cmbOnUsTc.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.OnUsTc;  // #79370
			this.cmbChannel.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.ChannelId;//#79506

			//#79572
			this.dfTlItemAcctNo.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.TlItemAcctNo;
			this.dfTlItemRoutingNo.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.TlItemRoutingNo;
			this.dfTlItemCheckNo.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.TlItemCheckNo;
			//#79572

            //Begin #140772
            this.cmbInventoryType.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.TypeId;
            this.cmbInventoryPacket.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.PacketId;
            this.dfInvSerialNo.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.InvSerialNo;
            this.dfNoInvAvailable.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.NoInvAvailable;
            //End #140772
        }

        private string GetXmlTag(Control control)
        {
            FieldBase busObjectProperty = null;

            if (control is PdfStandard)
                busObjectProperty = (control as PdfStandard).PhoenixUIControl.BusObjectProperty;
            else if (control is PComboBoxStandard)
                busObjectProperty = (control as PComboBoxStandard).PhoenixUIControl.BusObjectProperty;
            else if (control is PCheckBoxStandard)
                busObjectProperty = (control as PCheckBoxStandard).PhoenixUIControl.BusObjectProperty;

            if (busObjectProperty != null)
                return busObjectProperty.XmlTag;
            else
                return null;
        }

        private Control GetControlByXmlTag(string xmlTag, bool setFocus)
        {
            Control baseControl = this.GetNextControl(null, true);
            if (xmlTag == null || xmlTag == "")
                return null;

            if (_tlTranSet.CurTran.TlTranCode.XmlTag == xmlTag && setFocus &&
                (dfQuickTranCode.UnFormattedValue == null ||
                Convert.ToString(dfQuickTranCode.UnFormattedValue).Trim() == String.Empty))
            {
                dfQuickTranCode.Focus();
                return cmbTranCode;
            }
            while (baseControl != null)
            {
                if (xmlTag == GetXmlTag(baseControl))
                {
                    if (setFocus)
                        baseControl.Focus();
                    return baseControl;
                }
                baseControl = this.GetNextControl(baseControl, true);
            }
            return null;
        }

        private void LoadAmtFields()
        {
            if (amtFields.Count == 0)
            {
                amtFields.Add(dfCashIn);
                amtFields.Add(dfChksAsCash);
                amtFields.Add(dfOnUsChks);
                amtFields.Add(dfTransitChks);
                amtFields.Add(dfCashOut);
                amtFields.Add(dfInterestPaid);
                amtFields.Add(dfAmt);
                amtFields.Add(dfCCAmt);
                amtFields.Add(dfPenaltyAmt);
                amtFields.Add(dfWithholdingAmt);
            }
        }

        private void LoadHiddenFields()
        {
            if (hiddenFields.Count == 0)
            {
                hiddenFields.Add(cbTfrPbPresent);
                hiddenFields.Add(cmbTCDDrawer);
                hiddenFields.Add(cmbRefAcctType);
                hiddenFields.Add(dfRefAcctNo);
				hiddenFields.Add(cmbUtility);
				hiddenFields.Add(cmbLnEscrowAgent);	//#80617
                hiddenFields.Add(cmbExchCrncy);
                hiddenFields.Add(cmbRegCC);
                hiddenFields.Add(cmbEndPoint);
                hiddenFields.Add(cmbUmbCode);
                hiddenFields.Add(cmbChannel);//#79506
                hiddenFields.Add(cbRetirement);
                hiddenFields.Add(cbPayrollTran);
                hiddenFields.Add(cbPbPresent);
                hiddenFields.Add(cmbCrncy);
                hiddenFields.Add(dfAmtEq);
                hiddenFields.Add(dfPostingExchRate);
                hiddenFields.Add(cbDenominate); //#72916
                hiddenFields.Add(cbWaiveSignature); //#76033
                hiddenFields.Add(cmbRecalcPmtDt); //#76425
                hiddenFields.Add(dfRecalcPmt); //#76425
				//#79572
				hiddenFields.Add(dfTlItemAcctNo);
				hiddenFields.Add(dfTlItemRoutingNo);
				hiddenFields.Add(dfTlItemCheckNo);
				//#79572

                //Begin #140772
                //hiddenFields.Add(cmbInventoryType);   //#21564
                hiddenFields.Add(cmbInventoryPacket);
                hiddenFields.Add(dfInvSerialNo);
                hiddenFields.Add(dfNoInvAvailable);
                //End #140772
            }
        }

        private void LoadMiscTCFields()
        {
            if (miscTCFields.Count == 0)
            {
				miscTCFields.Add(cmbUtility);
				miscTCFields.Add(cmbLnEscrowAgent);	//#80617
                miscTCFields.Add(cmbEndPoint);
                miscTCFields.Add(cmbUmbCode);
                miscTCFields.Add(cmbChannel);//#79506
                miscTCFields.Add(dfTranDescription);
                miscTCFields.Add(dfReference);
                miscTCFields.Add(dfTfrCheckNo);
                miscTCFields.Add(dfCheckNo);
                miscTCFields.Add(dfTranEffectiveDt);
                miscTCFields.Add(cbPassDesc);
                miscTCFields.Add(cbDenominate); //#72916
                miscTCFields.Add(cbWaiveSignature); //#76033
                // Begin #76041
                if (_tlTranSet.TellerVars.IsAppOnline)
                {
                    miscTCFields.Add(dfAcctNickname);
                }
                // End #76041
                miscTCFields.Add(cmbRecalcPmtDt); //#76425
                miscTCFields.Add(dfRecalcPmt); //#76425

				//#79572
				miscTCFields.Add(dfTlItemAcctNo);
				miscTCFields.Add(dfTlItemRoutingNo);
				miscTCFields.Add(dfTlItemCheckNo);
				//#79572

                //Begin #140772
                miscTCFields.Add(cmbInventoryType);
                miscTCFields.Add(cmbInventoryPacket);
                miscTCFields.Add(dfInvSerialNo);
                miscTCFields.Add(dfNoInvAvailable);
                //End #140772

            }
        }

        private void LoadMiscAcctFields()
        {
            if (miscAcctFields.Count == 0)
            {
                miscAcctFields.Add(cbRetirement);
                miscAcctFields.Add(cbPayrollTran);
            }
        }

        private void PopulateTransetTable()
        {

            //Begin #140895
            if (_creatingTlCaptureTranSet)
                return;
            bool delayAddingItem = _tlTranSet.IsTellerCaptureTran && picTabs.SelectedIndex == 1;
            //End #140895

            try
            {
                _tranSetPopulating = true;  // #140895-ReadOnly

                GLItem listItem = null;
                string compNames = null;
                string compAmts = null;

                ctwTranSet.ResetTable();

                foreach (TlTransaction tran in _tlTranSet.Transactions)
                {
                    //TODO: use the columns to set the Value.
                    //TODO: use the columns to set the Value.
                    if (delayAddingItem)        // #140895 - check for delayAddingItem
                        listItem = new GLItem();
                    else
                        listItem = ctwTranSet.Items[ctwTranSet.AddNewRow()];

                    compNames = null;
                    compAmts = null;

                    //Begin #79156
                    if (!tran.RimNo.IsNull)
                        listItem.SubItems.Add(tran.RimNo.Value.ToString());
                    else
                        listItem.SubItems.Add("");  //#79574
                    //End #79156

                    //Begin #76458
                    if (_tlTranSet.IsExternalAdapterAcct(tran.AcctType.Value))
                        listItem.SubItems.Add(tran.AcctType.Value + " - " + _tlTranSet.TellerVars.DisplayAcctNos.GetMaskedAcctNo(tran.AcctType.Value, tran.AcctNo.Value));
                    else
                        listItem.SubItems.Add(tran.AcctType.Value + " - " + tran.AcctNo.Value);
                    //End #76458
                    // Begin #76041 - 1965
                    //if (_tlTranSet.TellerVars.IsAppOnline)
                    if (_tlTranSet.TellerVars.IsAppOnline && !tran.AcctNickname.IsNull)	//#79572
                        listItem.SubItems.Add(tran.AcctNickname.Value.ToString());
                    else
                        listItem.SubItems.Add(string.Empty);
                    // End #76041
                    listItem.SubItems.Add(tran.TranCodeDesc.Value);
                    MakeCompString("Cash In", tran.CashIn.Value, ref compNames, ref compAmts);
                    MakeCompString("Checks as Cash", tran.ChksAsCash.Value, ref compNames, ref compAmts);
                    MakeCompString("On-Us Checks", tran.OnUsChks.Value, ref compNames, ref compAmts);
                    MakeCompString("Transit Checks", tran.TransitChks.Value, ref compNames, ref compAmts);
                    MakeCompString("Cash Out", tran.CashOut.Value, ref compNames, ref compAmts);
                    MakeCompString("Net Amt", tran.NetAmt.Value, ref compNames, ref compAmts);
                    listItem.SubItems.Add(compNames);
                    listItem.SubItems.Add(compAmts);
                    listItem.SubItems.Add("");
                    listItem.SubItems.Add("");
                    listItem.SubItems.Add("");
                    listItem.SubItems.Add("");
                    if (!tran.TfrAcctType.IsNull)
                    {
                        //Begin #76458
                        if (_tlTranSet.IsExternalAdapterAcct(tran.TfrAcctType.Value))
                            listItem.SubItems.Add(tran.TfrAcctType.Value + " - " + _tlTranSet.TellerVars.DisplayAcctNos.GetMaskedAcctNo(tran.TfrAcctType.Value, tran.TfrAcctNo.Value));
                        else
                            listItem.SubItems.Add(tran.TfrAcctType.Value + " - " + tran.TfrAcctNo.Value);
                        //End #76458
                    }
                    else
                        listItem.SubItems.Add("");
                    listItem.SubItems.Add((tran.Description.IsNull ? "" : tran.Description.Value));
                    listItem.SubItems.Add((tran.Reference.IsNull ? "" : tran.Reference.Value));
                    listItem.SubItems.Add(tran.TranIndex.Value.ToString());
                    //ctwTranSet.Items.Add( listItem );

                    //Begin #140895
                    if (delayAddingItem)
                    {
                        ctwTranSet.Items.Add(listItem);
                    }
                    //End #140895


                }
            }
            finally
            {
                _tranSetPopulating = false; // #140895-ReadOnly
            }
        }

        private void MakeCompString(string compName, decimal compAmt,
            ref string compNames, ref string compAmts)
        {
            if (compAmt > 0)
            {
                compNames = (compNames == null ? compName : compNames + "\n" + compName);
                compAmts = (compAmts == null ? CurrencyHelper.GetFormattedValue(compAmt) : compAmts + "\n" +
                    CurrencyHelper.GetFormattedValue(compAmt));
            }
        }

        private bool SetAcctNoField(
            string acctNo, 
            PdfStandard acctNoField,
            PComboBoxStandard acctTypeField, 
            TlAcctDetails acctDetails,
            int tranRimNo = int.MinValue  // Rim executing the transaction #180274  
            )  
        {

            string applType = null;
            string depLoan = null;
            string format = null;
            bool invalidAcct = false;
            bool setFieldOnly = false;
            bool recordFailedAccess = false;
            bool showMessage = true;            //#74562 - Fix the annoying account validation message pop-up
            bool clearField = false;
            int[] notesList = null;
            int notesCount = 0;
            bool offline = !_tlTranSet.TellerVars.IsAppOnline;
            string realAcctNo = "";         //#76458
            string maskedAcctNo = "";       //#76458
            bool isRimSelected = false;     /* TASK #40974 (Arun) - flag used to know whether the user has selected a RIM */

            // begin #11499
            _tlTranSet.CurTran.TfrAcct.CustomParam1.Value = null;
            _tlTranSet.CurTran.TfrAcct.CustomParam2.Value = null;
            _tlTranSet.CurTran.TfrAcct.CustomParam3.Value = null;
            // end 11499

            if (this.ActiveControl != null)
            {
                //#5959 - Added additional condition to set showMessage for RefAcctNo
                showMessage = (this.ActiveControl.Name == dfAcctNo.Name || this.ActiveControl.Name == cmbAcctType.Name || this.ActiveControl.Name == dfQuickTranCode.Name || this.ActiveControl.Name == dfTfrCheckNo.Name || (this.lastFocussedField != null && this.lastFocussedField.Name == dfRefAcctNo.Name)); //#75648 - added dfTfrCheckNo to show invalid acct msg
            }

            acctDetails.FetchAcctAddlInfo.Value = true;     // #19415

            if (acctNo == String.Empty)
            {
                acctNo = null;
            }

            //Begin #76458
            if (!acctDetails.AcctType.IsNull && _tlTranSet.IsExternalAdapterAcct(acctDetails.AcctType.Value))
            {
                setFieldOnly = false;
            }
            else
            {
                if (acctNo == acctDetails.AcctNo.Value && Convert.ToString(acctTypeField.CodeValue) == acctDetails.AcctType.Value) //105267
                {
                    if (acctNo == acctNoField.Text)
                        return true;
                    else
                        setFieldOnly = true;
                }
            }
            //End #76458

            try
            {
                //clean up up the old stuff if necessary
                if (!setFieldOnly)
                {
                    if (!acctDetails.AcctNo.IsNull)
                    {
                        acctDetails.CleanUpValues(true);
                    }
                }

                // Begin #76041
                if (_tlTranSet.TellerVars.IsAppOnline && !isNonCust())		//#79572 if (_tlTranSet.TellerVars.IsAppOnline)
                {
                    _tlTranSet.CurTran.TranAcct.GetAcctNoNicknameDetails();
                }
                // End #76041

                if (acctNo == null)
                {
                    acctNoField.UnFormattedValue = null;
                }

                if (acctNoField == dfAcctNo)
                {
                    //Begin #76429
                    //Save the incoming trf/acct number before formating
                    if (acctNo != null && acctTypeField.CodeValue != null && !(picTabs.SelectedTab == tabEasyCapture)) //94416
                    {
                        if (acctDetails.IncomingAcctNo.IsNull)
                        {
                            acctDetails.IncomingAcctNo.Value = acctNo;
                        }
                        acctDetails.SwapAcct.Value = 0;
                    }
                    //End #76429

                    showNotes = false;
                    SetNotesFlag();
                    EnableDisableControls("AcctNoCleanUp");
                    MoveAcctDataToFields();

                    if (!setFieldOnly)
                    {
                        SetQuickTranCodeField(null, null);
                    }
                }
                else if (acctNoField == dfTfrAcctNo)
                {
                    //Begin #76429
                    //Save the incoming trf/acct number before formating
                    if (acctNo != null && acctTypeField.CodeValue != null)
                    {
                        acctDetails.IncomingTfrAcctNo.Value = acctNo;
                        acctDetails.SwapAcct.Value = 0;
                    }
                    //End #76429

                    EnableDisableControls("TfrAcctNoCleanUp");
                    MoveTfrAcctDataToFields();      //#74015
                }

                //if (acctNo != null && acctTypeField.CodeValue != null)
				if (acctNo != null && acctTypeField.CodeValue != null 
                    && (!isNonCust() || (acctTypeField.Name == "cmbTfrAcctType" && acctNoField.Name == "dfTfrAcctNo")))	//#79572
                {

                    GetAcctTypeDetails(acctTypeField, ref applType, ref depLoan, ref format);

                    //Begin #105472
                    //if (format != null && format != String.Empty)
                    if (format != null && format != String.Empty && depLoan != GlobalVars.Instance.ML.SD && depLoan != GlobalVars.Instance.ML.RIM)
                    //End #105472
                    {
                        acctNoField.UnFormattedValue = _tlTranSet.TellerHelper.FormatAccount(acctNo, format);
                        realAcctNo = _tlTranSet.TellerHelper.FormatAccount(acctNo, format); //#2926
                    }
                    else
                    {
                        acctNoField.UnFormattedValue = acctNo;
                        realAcctNo = acctNo; //#2926
                    }

                    if (!setFieldOnly)
                    {
                        //Begin #76458

                        if (acctTypeField.CodeValue != null)
                        {
                            if (_tlTranSet.IsExternalAdapterAcct(acctTypeField.CodeValue.ToString()))
                            {
                                maskedAcctNo = _tlTranSet.TellerVars.DisplayAcctNos.GetMaskedAcctNo(acctTypeField.CodeValue.ToString(), realAcctNo);
                                if (maskedAcctNo == realAcctNo || maskedAcctNo == "")
                                {
                                    maskedAcctNo = "";
                                    maskedAcctNo = _tlTranSet.GlobalHelper.GetMaskedExtAcct(acctTypeField.CodeValue.ToString(), realAcctNo);
                                    _tlTranSet.TellerVars.DisplayAcctNos.SetMaskedAcctNo(acctTypeField.CodeValue.ToString(), realAcctNo, maskedAcctNo);
                                }
                                acctNoField.UnFormattedValue = maskedAcctNo;
                            }
                        }

                        acctDetails.AcctNo.Value = realAcctNo;

                        //End #76458

                        acctDetails.ApplType.Value = applType;
                        acctDetails.DepLoan.Value = depLoan;
                        acctDetails.AcctType.Value = acctTypeField.CodeValue.ToString(); //#76458

                        #region Select Secondary Owner #180274, #34406

                        if (AppInfo.Instance.IsAppOnline && _adRmControl.SelectSecondOwner.Value == "Y" 
                            && (acctNoField == dfAcctNo)
                            && (tranRimNo == int.MinValue)
                            && (acctDetails.DepLoan.Value != "RM") 
                            && (acctDetails.DepLoan.Value != "GL")
                            && (acctDetails.DepLoan.Value != "EX") //94071
                            && ((!_tlTranSet.IsTellerCaptureTran && !_jointRimsShownForCrossRef) || (_tlTranSet.IsTellerCaptureTran && !_jointRimsShownForTellerCapture && !_tlTranSet.IsTellerCaptureBulkTran)))    //#34401 #39946 #75273 - excluded Bulk Tran
                        {
                            //if (!_tlTranSet.IsTellerCaptureTran && !_jointRimsShownForCrossRef)   //##38637
                            //{
                            //    acctDetails.SwapAcctNo();
                            //}

                            #region Get secondary Rim frmMsgBoxOption

                            string sOptions = "";
                            sOptions += "AcctType~" + acctDetails.AcctType.Value + "~";
                            sOptions += "AcctNo~" + acctDetails.AcctNo.Value + "~";
                            //sOptions += "AcctId~~";  
                            //sOptions += "RimNo~~";
                            sOptions += "SwapAcct~" + (!_tlTranSet.IsTellerCaptureTran ? "Y" : "N");

                            Phoenix.Client.MsgBox.frmMsgBoxOption msgBox = new Phoenix.Client.MsgBox.frmMsgBoxOption();
                            //msgBox.InitParameters(this.ScreenId, "SelectSecondaryOwner", sOptions, !_tlTranSet.IsTellerCaptureTran); //#38637
                            msgBox.InitParameters(this.ScreenId, "SelectSecondaryOwner", sOptions);
                            msgBox.ShowDialog();
                            System.Windows.Forms.DialogResult result = msgBox.DialogResult;
                            string response = msgBox.DialogOptions;
                            msgBox.Dispose();

                            if (_tlTranSet.IsTellerCaptureTran)
                            {
                                _jointRimsShownForTellerCapture = true;	//#34401
                            }

                            if (!_tlTranSet.IsTellerCaptureTran)   //##38637
                            {
                                _jointRimsShownForCrossRef = true;
                            }

                            if (result == System.Windows.Forms.DialogResult.OK)
                            {
                                string[] Response = response.Split("~".ToCharArray(), StringSplitOptions.None);

                                acctDetails.RimNo.Value = Convert.ToInt32(Response[1]); //RimNo

                                searchRimNo = acctDetails.RimNo.Value; // Needed to override Primary Rim when LastAcct used.

                                isRimSelected = true;     /* TASK #40974 (Arun) - Now the user has selected the RIM */

                                if (Response[3] == "Primary")
                                {
                                    this.Workspace.Variables["RelationshipType"] = "Primary";
                                }
                                else
                                {
                                    this.Workspace.Variables["RelationshipType"] = "All";
                                }

                                if (Response != null && Response.Length > 4)   //#38637
                                {
                                    acctDetails.AcctNo.Value = Convert.ToString(Response[4]);   //Outgoing Account Number
                                }
                            }
                            else if (result == System.Windows.Forms.DialogResult.Cancel)
                            {
                                // the main Try/Finally will use these:
                                invalidAcct = true;
                                showMessage = false;
                                clearField = true;
                                return false;
                            }
                            else if (result == System.Windows.Forms.DialogResult.Abort)
                            {
                                //#38638
                                string[] Response = response.Split("~".ToCharArray(), StringSplitOptions.None);
                                if (Response != null && Response.Length == 1)   //#38637
                                {
                                    acctDetails.AcctNo.Value = Convert.ToString(Response[0]);   //Outgoing Account Number
                                }
                                else
                                {
                                    // the main Try/Finally will use these:
                                    invalidAcct = true;
                                    showMessage = true;
                                    clearField = false;
                                    return false;
                                }
                            }

                            #endregion
                        }
                        else if (_tlTranSet.IsTellerCaptureTran && _jointRimsShownForTellerCapture) //#34401
                        {
                            acctDetails.RimNo.Value = searchRimNo;

                            isRimSelected = true;     /* TASK #40974 (Arun) - This is to skip the below fix for Teller Capture functionality*/
                        }


                        #endregion  //end   #180274


                        // ***********************
                        // *    GetAcctDetails()
                        // ***********************

                        try
                        {
                            using (new WaitCursor())
                            {
                                /*Begin - TASK #40974 (Arun) 
                                 * When user didn't selected the RIM and SetAcctNoField is called for dfAcctNo we have to fetch current acct's RIM*/
                                //if ((isRimSelected == false && acctNoField == dfAcctNo && _tlTranSet.TellerVars.AdTlControl.EnableEreceipt.Value == "N") ||
                                //   (!acctDetails.AcctType.IsNull && acctDetails.AcctType.Value == "GL")) //#85589
                                if ((isRimSelected == false && acctNoField == dfAcctNo && _tlTranSet.TellerVars.AdTlControl.EnableEreceipt.Value == "N") ||
                                    (!acctDetails.AcctType.IsNull && acctDetails.AcctType.Value == "GL")) //#86161
                                {
                                    //This will force acctDetails.GetAcctDetails() to fetch PrimaryRim as the RimNo, otherwise it will keep the existing value. 
                                    acctDetails.RimNo.SetValueToNull(); 
                                }
                                /*End - TASK #40974 (Arun)*/

                                acctDetails.GetAcctDetails();
                            }
                        }
                        catch (PhoenixException pe)
                        {
                            PMessageBox.Show(pe, MessageBoxButtons.OK);
                            invalidAcct = true;
                            showMessage = false;
                            return false;
                        }

                        //Begin #76429
                        //If validation fails then check to see if the incoming acct has cross reference
                        if (acctNoField == dfAcctNo)
                        {
                            if (acctDetails.SuspectAcct.Value == 1 && !offline)
                            {
                                acctDetails.SwapAcct.Value = 1;
                                acctDetails.AcctNo.Value = acctDetails.IncomingAcctNo.Value;
                                try
                                {
                                    using (new WaitCursor())
                                    {
                                        acctDetails.GetAcctDetails();
                                    }
                                }
                                catch (PhoenixException pe)
                                {
                                    PMessageBox.Show(pe, MessageBoxButtons.OK);
                                    invalidAcct = true;
                                    showMessage = false;
                                    return false;
                                }
                            }

                            if (acctDetails.SuspectAcct.Value != 1)
                            {
                                string incomingAcct1 = acctDetails.IncomingAcctNo.Value;
                                //Format incoming acct and compare with AcctNo
                                GetAcctTypeDetails(acctTypeField, ref applType, ref depLoan, ref format);
                                if (format != null && format != String.Empty)
                                    incomingAcct1 = _tlTranSet.TellerHelper.FormatAccount(incomingAcct1, format);
                                if (acctDetails.AcctNo.Value == incomingAcct1)
                                    //No swap: Set incoming account number to null
                                    acctDetails.IncomingAcctNo.Value = null;
                            }
                        }
                        else if (acctNoField == dfTfrAcctNo)
                        {
                            if (acctDetails.SuspectAcct.Value == 1 && !offline)
                            {
                                acctDetails.SwapAcct.Value = 1;
                                acctDetails.AcctNo.Value = acctDetails.IncomingTfrAcctNo.Value;
                                try
                                {
                                    using (new WaitCursor())
                                    {
                                        acctDetails.GetAcctDetails();
                                    }
                                }
                                catch (PhoenixException pe)
                                {
                                    PMessageBox.Show(pe, MessageBoxButtons.OK);
                                    invalidAcct = true;
                                    showMessage = false;
                                    return false;
                                }
                            }

                            if (acctDetails.SuspectAcct.Value != 1)
                            {
                                string incomingAcct1 = acctDetails.IncomingTfrAcctNo.Value;
                                //Format incoming acct and compare with AcctNo
                                GetAcctTypeDetails(acctTypeField, ref applType, ref depLoan, ref format);
                                if (format != null && format != String.Empty)
                                    incomingAcct1 = _tlTranSet.TellerHelper.FormatAccount(incomingAcct1, format);
                                if (acctDetails.AcctNo.Value == incomingAcct1)
                                    //No swap: Set incoming account number to null
                                    acctDetails.IncomingTfrAcctNo.Value = null;
                            }
                        }

                        //End #76429

                        #region handle suspect/invalid acct
                        if (acctDetails.SuspectAcct.Value == 1 && !offline)
                        {
                            // show message
                            //PMessageBox.Show( MessageType.Warning, tranResponse.RetCodeDesc,MessageBoxButtons.OK );
							if (acctNoField == dfAcctNo)
                            {
                                if (_tlTranSet.CurTran.TranAcct.DepLoan.Value == "DP" &&
                                    _tlTranSet.TellerVars.AdTlControl.BypassAcctVal.Value == GlobalVars.Instance.ML.Y)	// ML
                                {
                                    if (DialogResult.No == PMessageBox.Show(317950, MessageType.Question, MessageBoxButtons.YesNo, String.Empty))
                                    {
                                        invalidAcct = true;
                                        showMessage = false;
                                        clearField = true;
                                        this.gotAccts = true;   //#76041
                                        return false;
                                    }
                                    else
                                    {
                                        showRetirement = true;
                                        acctDetails.AcctType.Value = acctTypeField.CodeValue as string;
                                    }
                                }
                                else
                                {
                                    this.gotAccts = true;   //#76041
                                    invalidAcct = true;
                                    clearField = true;  // #74368
                                    return false;
                                }
                            }
                            //Begin #80617
							//else if (_tlTranSet.CurTran.TranCode.Value == 163 &&
							//	dfTfrAcctNo == acctNoField && _tlTranSet.CurTran.PostRealTime.Value != 1)
                            else if (_tlTranSet.CurTran.TranCode.Value == 163 && dfTfrAcctNo == acctNoField)
							{
								if (_tlTranSet.TellerVars.AdTlControl.BypassAcctVal.Value == GlobalVars.Instance.ML.Y &&
									_tlTranSet.AdTlTc.RealTimeEnable.Value != GlobalVars.Instance.ML.Y)
                                {
									//#80617 - message#317950 - This account number does not currently exist in the system. Do you want to post a new account deposit using this account number?
                                    if (DialogResult.No == PMessageBox.Show(317950, MessageType.Question, MessageBoxButtons.YesNo, String.Empty))
                                    {
                                        invalidAcct = true;
                                        showMessage = false;
                                        clearField = true;
                                        return false;
                                    }
                                    else
                                    {
                                        _tlTranSet.CurTran.TfrAcct.SuspectAcct.Value = 1;
                                    }
                                }
								else
								{
									invalidAcct = true;
									showMessage = true;
									clearField = true;
									return false;
								}
							}
							//End #80617
                            else
                            {
                                invalidAcct = true;
                                clearField = true;  // #74368
                                return false;
                            }
                        }
                        else if (offline)
                        {
                            showRetirement = _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP;
                            acctDetails.AcctType.Value = Convert.ToString(acctTypeField.CodeValue);
                        }
                        else
                        {
                            showRetirement = false;
                        }
                        #endregion

                        #region handle employee access
                        // Begin #74778
                        //if (acctNoField == dfAcctNo && acctDetails.SuspectAcct.Value != 1)
                        //{
                        //    _tlTranSet.VerifyEmplAccess(_tlTranSet.CurTran.TranAcct.PostAccess.Value,
                        //        _tlTranSet.CurTran.TranAcct.EditAccess.Value, _tlTranSet.CurTran.TranAcct.Status.Value,
                        //        ref recordFailedAccess, ref acctHasPostAccessOnly, ref acctHasViewAcesssOnly);

                        //    if (recordFailedAccess)
                        //    {
                        //        RecordFailedAccess(_tlTranSet.CurTran.TranAcct.RimNo.Value);
                        //    }
                        //    if (!ProcessResponses(null))
                        //    {
                        //        invalidAcct = true;
                        //        showMessage = false;
                        //        return false;
                        //    }
                        //}
                        if (acctDetails.SuspectAcct.Value != 1)
                        {
                            if (acctNoField == dfAcctNo)
                            {
                                _tlTranSet.VerifyEmplAccess(_tlTranSet.CurTran.TranAcct.PostAccess.Value,
                                    _tlTranSet.CurTran.TranAcct.EditAccess.Value, _tlTranSet.CurTran.TranAcct.Status.Value,
                                    ref recordFailedAccess, ref acctHasPostAccessOnly, ref acctHasViewAcesssOnly);

                                if (recordFailedAccess)
                                {
                                    RecordFailedAccess(_tlTranSet.CurTran.TranAcct.RimNo.Value);
                                }
                                if (!ProcessResponses(null) || (_tlTranSet.CurTran.TranAcct.PostAccess.Value == GlobalVars.Instance.ML.N && _tlTranSet.CurTran.TranAcct.EditAccess.Value == GlobalVars.Instance.ML.Y))       // WI#16236 Handle when Edit = Y and Post = N (Should Also Cleat Out Account Number So They Cannot Post To It
                                {
                                    invalidAcct = true;
                                    clearField = true;  // #74368
                                    showMessage = false;
                                    return false;
                                }

                                // Begin WI#16236 - Handle Tfr Acct
                                //if (acctHasPostAccessOnly) //#1437
                                //    _tlTranSet.CurTran.TranAcct.bAcctHasPostAccessOnly.Value = true;
                                //else
                                //    _tlTranSet.CurTran.TranAcct.bAcctHasPostAccessOnly.Value = false;
                                if (this.focusAcctField.Name == "cmbTfrAcctType")
                                {
                                    if (tfracctHasPostAccessOnly)
                                        _tlTranSet.CurTran.TfrAcct.bAcctHasPostAccessOnly.Value = true;
                                    else
                                        _tlTranSet.CurTran.TfrAcct.bAcctHasPostAccessOnly.Value = false;
                                }
                                else
                                {
                                    if (acctHasPostAccessOnly) //#1437
                                        _tlTranSet.CurTran.TranAcct.bAcctHasPostAccessOnly.Value = true;
                                    else
                                        _tlTranSet.CurTran.TranAcct.bAcctHasPostAccessOnly.Value = false;
                                }
                                // End WI#16236


                                //Begin #80630
                                if (TellerVars.Instance.DrawerNo >0 && isRmSumInvoked == false && !(Extension as FormExtension).VerifyConfAcctAccess(ActionSave, _tlTranSet.CurTran.TranAcct.AcctType.Value,
                                    _tlTranSet.CurTran.TranAcct.AcctNo.Value, _tlTranSet.CurTran.TranAcct.Confidential.Value))   // #19415 - replaced lats para null  //111762. Reset it to false.If call comes from Fav or define relation isRmSumInvoked will be true and we are just accessing the RIm so no need to validate Posting conf Acc.
                                {
                                    invalidAcct = true;
                                    clearField = true;
                                    showMessage = false;
                                    return false;
                                }
                                //End #80630

                            }
                            else if (acctNoField == dfTfrAcctNo)
                            {
                                #region #13713

                                #region #14251
                                //140793
                                if (cmbTfrAcctType.Value != null && cmbTfrAcctType.Value.ToString() == "GL")
                                {
                                    _tlTranSet.VerifyEmplAccess(_tlTranSet.CurTran.TfrAcct.PostAccess.Value.ToString(), _tlTranSet.CurTran.TfrAcct.EditAccess.Value, _tlTranSet.CurTran.TfrAcct.Status.Value,
                                        ref recordFailedAccess, ref tfracctHasPostAccessOnly, ref tfracctHasViewAcesssOnly);
                                }
                                else
                                {
                                    AdRmRestrict _adRmRestrict = new AdRmRestrict();
                                    _RimRestrictLevel.Value = _adRmRestrict.GetRestrictLevel(_tlTranSet.CurTran.TfrAcct.RimNo.Value);
                                #endregion

                                    _tlTranSet.VerifyEmplAccess(_tlTranSet.CurTran.TfrAcct.RimNo.Value, _RimRestrictLevel.Value, _tlTranSet.TellerVars.EmplRestrictLevel,
                                        ref recordFailedAccess, ref tfracctHasPostAccessOnly, ref tfracctHasViewAcesssOnly); //14286 used the new tfracct references
                                }
                                #endregion #13713

                                if (recordFailedAccess)
                                {
                                    RecordFailedAccess(_tlTranSet.CurTran.TfrAcct.RimNo.Value);
                                    rimRestrictTfrAcct = true;
                                }
                                else
                                {
                                    rimRestrictTfrAcct = false;
                                }

                                if (tfracctHasPostAccessOnly) //#1437 // #13713 changed to TfrAcct //14286 used tfraccthasPostAccessOnly
                                    _tlTranSet.CurTran.TfrAcct.bAcctHasPostAccessOnly.Value = true;
                                else
                                    _tlTranSet.CurTran.TfrAcct.bAcctHasPostAccessOnly.Value = false;

                                //Begin #80630
                                if (!(Extension as FormExtension).VerifyConfAcctAccess(ActionSave, _tlTranSet.CurTran.TfrAcct.AcctType.Value,
                                    _tlTranSet.CurTran.TfrAcct.AcctNo.Value, _tlTranSet.CurTran.TfrAcct.Confidential.Value))   // #19415 - replaced lats para null
                                {
                                    invalidAcct = true;
                                    clearField = true;
                                    showMessage = false;
                                    return false;
                                }
                                //End #80630
                              //WI#14024
                               if (!ProcessResponses(null) || (_tlTranSet.CurTran.TfrAcct.PostAccess.Value == GlobalVars.Instance.ML.N && _tlTranSet.CurTran.TfrAcct.EditAccess.Value == GlobalVars.Instance.ML.Y))       // WI#16236 Handle when Edit = Y and Post = N (Should Also Cleat Out Account Number So They Cannot Post To It
                               {
                               invalidAcct = true;
                               clearField = true;
                               showMessage = false;
                               return false;
                               }
                            //WI#14024
                            }
                        }
                        // End #74778
                        #endregion



                    }

                    bool skipNotes = (_tlTranSet.IsTellerCaptureTran && !_creatingTlCaptureTranSet) || processingSelectTran;     // #140895 - for teller capture tran only show notes when creating transactions. But do not show notes when selecting an existing transaction.

                    if (acctNoField == dfAcctNo)
                    {
                        showRetirement = acctDetails.SuspectAcct.Value == 1 && _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP
                            && !_tlTranSet.IsRimTran(_tlTranSet.CurTran.TranCode.Value);
                        MoveAcctDataToFields();
                        //71110
                        if (Phoenix.FrameWork.CDS.DataService.Instance.PrimaryDbAvailable == true)
                        {
                            notesCount = _tlTranSet.GetNotesList(ref showNotes, ref notesList);
                            SetNotesFlag();
                        }
                        else
                            notesCount = 0;

                        //Begin #140895
                        if (skipNotes)
                            notesCount = 0;
                        //End #140895

                        //71110
                        EnableDisableControls("AcctNoEnter");
                        PopulateTranCodeCombo(depLoan, acctTypeField.Text); //#76458 - added param value for acctType
                        //
                        if (notesCount > 0 && !_isSwitchedToRim && ShowNotes)		//#4889
                        {
                            if (notesCount > 1)
                                Extension.ShowNotes(this); // #80620
                            else
                            {
                                if (!processingSelectTran)
                                {
                                    // send msg to show show pop up notes
                                    Extension.Reset();
                                    #region #4889
                                    foreach (int notePtid in notesList)
                                    {
                                        notePtidFound = false;
                                        foreach (int notePtidFromList in notePtids)
                                        {
                                            if (notePtidFromList == notePtid)
                                            {
                                                notePtidFound = true;
                                                if (Extension.PopupCount == 0) //#11280
                                                    Extension.AddPopup(notePtid);
                                                break;
                                            }
                                        }
                                        if (!notePtidFound)
                                        {
                                            notePtids.Add(notePtid);
                                            Extension.AddPopup(notePtid);
                                        }
                                    }
                                    #endregion
                                    Extension.ShowNextNote(this);
                                }
                            } // #80620
                        }
                        _isSwitchedToRim = false;
                        // send msg to enable disable the mdi notes button based on showNotes flag
                        if (!processingSelectTran && _tlTranSet.ShowBadAddressWarning())
                        {
                            //ATTENTION:  The customer you have entered does not have a valid address.  Please collect a valid address from the customer and modify their customer record with the udpated information.
                            PMessageBox.Show(360779, MessageType.Warning, MessageBoxButtons.OK, String.Empty);
                        }

                        if (!_tlTranSet.TellerVars.AdTlCls.TlTranCode.IsNull && _tlTranSet.CurTran.TlTranCode.IsNull && !processingSelectTran)  //#122567
                        {
                            if (!_tlTranSet.CurTran.TranAcct.DepLoan.IsNull && _tlTranSet.ValidateDefaultTc(_tlTranSet.CurTran.TranAcct.DepLoan.Value, _tlTranSet.TellerVars.AdTlCls.TlTranCode.Value))
                                SetQuickTranCodeField(_tlTranSet.TellerVars.AdTlCls.TlTranCode.Value, null);
                        }

                        //Begin #76043
                        //if (acctNo != null && depLoan == GlobalVars.Instance.ML.LN && !offline &&
                        //    Phoenix.FrameWork.CDS.DataService.Instance.XmDbStatus.ToString().Substring(0, 1).ToUpper() == "D")
                        //    _tlTranSet.DeleteLoanCcTrmTierRows(true);
                        //End #76043
                    }
                    else if (acctNoField == dfTfrAcctNo)
                    {
                        EnableDisableControls("TfrAcctNoEnter");
                        MoveTfrAcctDataToFields();      //#74015
                        #region #80620
                        AttachAcctAlertsIcons();
                        if (Phoenix.FrameWork.CDS.DataService.Instance.PrimaryDbAvailable == true)
                        {
                            notesCount = _tlTranSet.GetOnUsNotesList(ref showNotes, ref notesList);
                            SetNotesFlag();
                        }
                        else
                            notesCount = 0;

                        //Begin #140895
                        if (skipNotes)
                            notesCount = 0;
                        //End #140895

                        if (notesCount > 0 && !_isSwitchedToRim && ShowNotes && _tlTranSet.TellerVars.AdTlCls.ShowOnusAcctNotes.Value == "Y")
                        {
                            if (notesCount > 1)
                            {
                                _isShowOnUsNotes = true;
                                Extension.ShowNotes(this);
                                _isShowOnUsNotes = false;
                            }
                            else
                            {
                                if (!processingSelectTran)
                                {
                                    // send msg to show show pop up notes
                                    Extension.Reset();
                                    #region #4889
                                    foreach (int notePtid in notesList)
                                    {
                                        notePtidFound = false;
                                        foreach (int notePtidFromList in notePtids)
                                        {
                                            if (notePtidFromList == notePtid)
                                            {
                                                notePtidFound = true;
                                                if (Extension.PopupCount == 0) //#11280
                                                    Extension.AddPopup(notePtid);
                                                break;
                                            }
                                        }
                                        if (!notePtidFound)
                                        {
                                            notePtids.Add(notePtid);
                                            Extension.AddPopup(notePtid);
                                        }
                                    }
                                    #endregion
                                    Extension.ShowNextNote(this);
                                }
                            }
                        }
                        #endregion
                    }
                }

                // Begin WI#13780 - Handle Validating GL Access - Only If Not Offline
                if (!offline && !invalidAcct && acctNo != String.Empty && acctNo != null && cmbAcctType.CodeValue != null && cmbAcctType.CodeValue.ToString() == GlobalVars.Instance.ML.GL &&
                    acctNoField == dfAcctNo)   // #79496, #16763 - the existing code below is supposedly meant to validate dfAcctNo field only
                {
                    // Parse Out Ledger And Prefix
                    string _sLedgerNo = string.Empty;
                    string _sPrefix = string.Empty;
                    string delimiterHyphen = "-";
                    char[] delimiter = delimiterHyphen.ToCharArray();
                    string _sTemp = dfAcctNo.UnFormattedValue.ToString();

                    string[] AcctArray = _sTemp.Split(delimiter);

                    _sLedgerNo = AcctArray[AcctArray.Length - 1];
                    _sPrefix = _sTemp.Substring(0, _sTemp.IndexOf(_sLedgerNo) - 1);

                    // Create Gl Acct Object
                    Phoenix.BusObj.GL.GlAcct _glAcct = new GlAcct();

                    // Call Vaidation Method
                    if (!_glAcct.ValidateGLEmplAccess(_sPrefix, _sLedgerNo))
                    {
                        //361299 - You do not have GL access rights to post transactions to any GL accounts with ledger %1!  Please modify your selection criteria or have your system administrator modify your GL access permissions.
                        PMessageBox.Show(this, 361299, MessageType.Error, MessageBoxButtons.OK, _sLedgerNo);
                        acctNoField.Focus();
                        acctNoField.UnFormattedValue = null;
                        acctDetails.AcctNo.Value = null;  // Clear out because Validate Of dfAcctNo stops SetAcctNoFields from running
                        return false;
                    }
                }
                // End WI#13780
                //26836
                if (!offline && !invalidAcct && acctNo != String.Empty && acctNo != null && cmbTfrAcctType.CodeValue != null && cmbTfrAcctType.CodeValue.ToString() == GlobalVars.Instance.ML.GL &&
                    acctNoField == dfTfrAcctNo)   // #79496, #16763 - the existing code below is supposedly meant to validate dfAcctNo field only
                {
                    // Parse Out Ledger And Prefix
                    string _sLedgerNo = string.Empty;
                    string _sPrefix = string.Empty;
                    string delimiterHyphen = "-";
                    char[] delimiter = delimiterHyphen.ToCharArray();
                    string _sTemp = dfTfrAcctNo.UnFormattedValue.ToString();

                    string[] AcctArray = _sTemp.Split(delimiter);

                    _sLedgerNo = AcctArray[AcctArray.Length - 1];
                    _sPrefix = _sTemp.Substring(0, _sTemp.IndexOf(_sLedgerNo) - 1);

                    // Create Gl Acct Object
                    Phoenix.BusObj.GL.GlAcct _glAcct = new GlAcct();

                    // Call Vaidation Method
                    /****Task #111735 - If the Trancode is set with Offset GL, then  for that OffSetAcctConfigured will be 1. So if it 1 then we no need to show this error message.
                    * because GL Account was OffSet WIP. */
                    if (_tlTranSet.CurTran.OffsetAcctConfigured.IsNull || _tlTranSet.CurTran.OffsetAcctConfigured.IntValue != 1)
                    {
                        if (!_glAcct.ValidateGLEmplAccess(_sPrefix, _sLedgerNo))//Task #111735 - We can skip this step if it GL Offset.
                        {
                            //361299 - You do not have GL access rights to post transactions to any GL accounts with ledger %1!  Please modify your selection criteria or have your system administrator modify your GL access permissions.
                            PMessageBox.Show(this, 361299, MessageType.Error, MessageBoxButtons.OK, _sLedgerNo);
                            acctNoField.Focus();
                            acctNoField.UnFormattedValue = null;
                            acctDetails.AcctNo.Value = null;  // Clear out because Validate Of dfAcctNo stops SetAcctNoFields from running
                            return false;
                        }
                    }
                }

                if (!string.IsNullOrEmpty(acctDetails.AcctType.StringValue) && !string.IsNullOrEmpty(acctDetails.AcctNo.StringValue) 
                    && !string.IsNullOrEmpty(acctDetails.RimNo.StringValue)) //Bug #102323
                    SetWorkspaceAccountVariables(acctDetails.AcctType.StringValue, acctDetails.AcctNo.StringValue, acctDetails.RimNo.StringValue, acctDetails.DepLoan.StringValue); //#99011
                return true;
            }
            finally
            {
                if (invalidAcct)
                {
                    acctDetails.CleanUpValues(true);
                    //MessageBox.Show( "Invalid Acct", "Warning", MessageBoxButtons.OK );
                    if (!string.IsNullOrEmpty(invalidAcctNo) && (invalidAcctNo == dfAcctNo.Text || invalidAcctNo == acctNo))    //#125019
                    {
                        showMessage = false;
                        clearField = true;
                    }

                    if (showMessage)
                        PMessageBox.Show(318515, MessageType.Warning, MessageBoxButtons.OK, String.Empty);

                    acctNoField.Focus();

                    invalidAcctNo = acctNo;

                    if (clearField)
                    {
                        acctNoField.UnFormattedValue = null;
                        vldnFailedCntrl = null;
                    }
                    else
                        vldnFailedCntrl = acctNoField;

                    if (!string.IsNullOrEmpty(invalidAcctNo) && (invalidAcctNo == dfAcctNo.Text || invalidAcctNo == acctNo))    //#125019
                        clearField = true;
                }
                else
                {
                    if (acctNoField == dfAcctNo && acctDetails.DepLoan.Value != GlobalVars.Instance.ML.GL 
                        && !acctDetails.RimNo.IsNull)
                    {
                        //#8609 - replace searchRimNo only when the customer info not searched before
                        if (!_fromRelMgmtSummary)
                        {
                            //#13182/#13183 - Save the value of rimNo
                            if (!populateGridWithSavedRim)
                                searchRimNo = acctDetails.RimNo.Value;
                        }
                        else
                        {
                            if (_fromRelMgmtSummary && frmGloAccountListRim != null &&
                                frmGloAccountListRim.colOwnership != null &&
                                frmGloAccountListRim.colOwnership.UnFormattedValue != null &&
                                frmGloAccountListRim.colOwnership.UnFormattedValue.ToString().Trim() == "Primary")
                                searchRimNo = acctDetails.RimNo.Value;
                            //_fromRelMgmtSummary = false;  //#10477
                        }

                        if (_holdRimNo != -1) // Reset It
                            _holdRimNo = searchRimNo; //#7054
                        searchAcctType = acctDetails.AcctType.Value;
                        searchAcctNo = acctDetails.AcctNo.Value;
                    }
                    invalidAcctNo = null;
                    vldnFailedCntrl = null;
                }
            }
        }

        #region #8502
        private bool FmtAcctNoField(string acctNo, PdfStandard acctNoField,
           PComboBoxStandard acctTypeField, TlAcctDetails acctDetails)
        {
            string applType = null;
            string depLoan = null;
            string format = null;
            bool invalidAcct = false;
            bool setFieldOnly = false;
            bool showMessage = true;
            if (this.ActiveControl != null)
                showMessage = (this.ActiveControl.Name == dfAcctNo.Name || this.ActiveControl.Name == cmbAcctType.Name || this.ActiveControl.Name == dfQuickTranCode.Name || this.ActiveControl.Name == dfTfrCheckNo.Name || (this.lastFocussedField != null && this.lastFocussedField.Name == dfRefAcctNo.Name));

            bool clearField = false;
            bool offline = !_tlTranSet.TellerVars.IsAppOnline;
            string realAcctNo = "";
            string maskedAcctNo = "";

            if (acctNo == String.Empty)
                acctNo = null;

            if (!acctDetails.AcctType.IsNull && _tlTranSet.IsExternalAdapterAcct(acctDetails.AcctType.Value))
                setFieldOnly = false;
            else
            {
                if (acctNo == acctDetails.AcctNo.Value)
                {
                    if (acctNo == acctNoField.Text)
                        return true;
                    else
                        setFieldOnly = true;
                }
            }

            try
            {
                //clean up up the old stuff if necessary
                if (!setFieldOnly)
                {
                    if (!acctDetails.AcctNo.IsNull)
                        acctDetails.CleanUpValues(true);
                }

                if (_tlTranSet.TellerVars.IsAppOnline)
                    _tlTranSet.CurTran.TranAcct.GetAcctNoNicknameDetails();

                if (acctNo == null)
                    acctNoField.UnFormattedValue = null;
                if (acctNoField == dfTfrAcctNo)
                {
                    //Save the incoming trf/acct number before formating
                    if (acctNo != null && acctTypeField.CodeValue != null)
                    {
                        acctDetails.IncomingTfrAcctNo.Value = acctNo;
                        acctDetails.SwapAcct.Value = 0;
                    }

                    EnableDisableControls("TfrAcctNoCleanUp");
                    MoveTfrAcctDataToFields();
                }

                if (acctNo != null && acctTypeField.CodeValue != null)
                {

                    GetAcctTypeDetails(acctTypeField, ref applType, ref depLoan, ref format);
                    if (format != null && format != String.Empty)
                    {
                        acctNoField.UnFormattedValue = _tlTranSet.TellerHelper.FormatAccount(acctNo, format);
                        realAcctNo = _tlTranSet.TellerHelper.FormatAccount(acctNo, format);
                    }
                    else
                    {
                        acctNoField.UnFormattedValue = acctNo;
                        realAcctNo = acctNo;
                    }

                    if (!setFieldOnly)
                    {
                        if (acctTypeField.CodeValue != null)
                        {
                            if (_tlTranSet.IsExternalAdapterAcct(acctTypeField.CodeValue.ToString()))
                            {
                                maskedAcctNo = _tlTranSet.TellerVars.DisplayAcctNos.GetMaskedAcctNo(acctTypeField.CodeValue.ToString(), realAcctNo);
                                if (maskedAcctNo == realAcctNo || maskedAcctNo == "")
                                {
                                    maskedAcctNo = "";
                                    maskedAcctNo = _tlTranSet.GlobalHelper.GetMaskedExtAcct(acctTypeField.CodeValue.ToString(), realAcctNo);
                                    _tlTranSet.TellerVars.DisplayAcctNos.SetMaskedAcctNo(acctTypeField.CodeValue.ToString(), realAcctNo, maskedAcctNo);
                                }
                                acctNoField.UnFormattedValue = maskedAcctNo;
                            }
                        }
                        acctDetails.AcctNo.Value = realAcctNo;
                        acctDetails.ApplType.Value = applType;
                        acctDetails.DepLoan.Value = depLoan;
                        acctDetails.AcctType.Value = acctTypeField.CodeValue.ToString();
                        try
                        {
                            using (new WaitCursor())
                            {
                                acctDetails.GetAcctDetails();
                            }
                        }
                        catch (PhoenixException pe)
                        {
                            PMessageBox.Show(pe, MessageBoxButtons.OK);
                            invalidAcct = true;
                            showMessage = false;
                            return false;
                        }
                        //If validation fails then check to see if the incoming acct has cross reference
                        if (acctNoField == dfTfrAcctNo)
                        {
                            if (acctDetails.SuspectAcct.Value == 1 && !offline)
                            {
                                acctDetails.SwapAcct.Value = 1;
                                acctDetails.AcctNo.Value = acctDetails.IncomingTfrAcctNo.Value;
                                try
                                {
                                    using (new WaitCursor())
                                    {
                                        acctDetails.GetAcctDetails();
                                    }
                                }
                                catch (PhoenixException pe)
                                {
                                    string dummy = pe.ToString(); // Do not show error, it will be handled through validation
                                    showMessage = false;
                                    return false;
                                }
                            }

                            if (acctDetails.SuspectAcct.Value != 1)
                            {
                                string incomingAcct1 = acctDetails.IncomingTfrAcctNo.Value;
                                //Format incoming acct and compare with AcctNo
                                GetAcctTypeDetails(acctTypeField, ref applType, ref depLoan, ref format);
                                if (format != null && format != String.Empty)
                                    incomingAcct1 = _tlTranSet.TellerHelper.FormatAccount(incomingAcct1, format);
                                if (acctDetails.AcctNo.Value == incomingAcct1)
                                    //No swap: Set incoming account number to null
                                    acctDetails.IncomingTfrAcctNo.Value = null;
                            }
                        }
                    }

                    if (acctNoField == dfTfrAcctNo)
                    {
                        EnableDisableControls("TfrAcctNoEnter");
                        MoveTfrAcctDataToFields();
                    }
                }
                return true;
            }
            finally
            {
                if (invalidAcct)
                {
                    acctDetails.CleanUpValues(true);
                    if (clearField)
                    {
                        acctNoField.UnFormattedValue = null;
                        vldnFailedCntrl = null;
                    }
                    else
                        vldnFailedCntrl = acctNoField;
                }
                else
                {
                    if (acctNoField == dfAcctNo && acctDetails.DepLoan.Value != GlobalVars.Instance.ML.GL &&
                        !acctDetails.RimNo.IsNull)
                    {
                        searchRimNo = acctDetails.RimNo.Value;

                        if (_holdRimNo != -1) // Reset It
                            _holdRimNo = searchRimNo;
                        searchAcctType = acctDetails.AcctType.Value;
                        searchAcctNo = acctDetails.AcctNo.Value;
                    }
                    invalidAcctNo = null;
                    vldnFailedCntrl = null;
                }
            }
        }
        #endregion

		//Begin #79572
		private bool isNonCust()
		{
            if (this.Workspace != null && this.Workspace.Variables["NonCust"] != null && this.Workspace.Variables["NonCust"].ToString() == "Y")  //Task #124027 - Added Null Check for Workspace for Workflow
                return true;
			else
				return false;
		}
		//#79572

        private bool IsPrimaryAmtField(Control amtField)         // 21599
        {
            // Primary "amtFields" include NetAmt, CashIn, CashOut etc.
            // Secondary "amtFields" include Penalty, Interest, Withholding

            // The Secondary list is shorter so add it to the list below.

            return (amtField != dfInterestPaid
                    && amtField != dfCCAmt
                    && amtField != dfPenaltyAmt
                    && amtField != dfWithholdingAmt); //#140782
        }

		private bool IsDisplayTransitItemFields()
		{
			/*if(!isNonCust())
			{
				return false;
			}
			else if (isNonCust() &&  _tlTranSet.AdTlTc.ItemCapture == GlobalVars.Instance.ML.Y)
			{
				return false;
			}
			else if (isNonCust() && _tlTranSet.AdTlTc.ItemCapture != GlobalVars.Instance.ML.Y &&
				_tlTranSet.AdTlTc.TransitChkEnable == GlobalVars.Instance.ML.N)
			{
				return false;
			}
			else */

			if (_tlTranSet.AdTlTc.ItemCapture.Value != GlobalVars.Instance.ML.Y &&
				_tlTranSet.AdTlTc.TransitChkEnable.Value == GlobalVars.Instance.ML.Y &&
                isNonCustAllowed)   //#9568
			{
				return true;
			}
			else
			{
				return false;
			}
		}
		//#79572
		//End #79572

        private bool SetQuickTranCodeField(string tranCode, Control focusField)
        {
            bool setFieldOnly = false;
            bool invalidTC = false;
            bool showMessage = false;
            bool acctEntered = (!_tlTranSet.CurTran.TranAcct.AcctNo.IsNull);
            bool popUpBondPurchase = false; // #03882

            if (processingSelectTran && tranCode == null)
                return true;

            if (processingSelectTran && tranCode != null)   //#4175
                setFieldOnly = true;

            //START: #75379 - modified to look for both trancode and quicktrancode
            //if (tranCode == _tlTranSet.CurTran.TlTranCode.Value)
            if (tranCode == _tlTranSet.CurTran.TlTranCode.Value && (string)dfQuickTranCode.UnFormattedValue == _tlTranSet.CurTran.TlTranCode.Value) //#75379
            {
                //if ((string)cmbTranCode.CodeValue == tranCode)
                //    return true;
                //else
                //    setFieldOnly = true;

                if ((string)cmbTranCode.CodeValue == tranCode && (string)dfQuickTranCode.UnFormattedValue == tranCode)
                    return true;
                else
                    setFieldOnly = true;
            }
            //END: #75379 - modified to look for both trancode and quicktrancode

            if (processingEvent)
                return true;

            processingEvent = true;

            try
            {
                // Begin #76047
                //#3401 - moved the following code to new location down below
                //if (CheckBondTranCode((_tlTranSet.CurTran.TranAcct.TranCode.IsNull ? _tlTranSet.CurTran.TranCode.Value.ToString() : _tlTranSet.CurTran.TranAcct.TranCode.Value.ToString()))) //3401
                //{
                //    if (tranCode != dfQuickTranCode.Text)
                //    {
                //        //Clear out our bond list if the tran code changes
                //        this._tlTranSet.CurTran.Bonds.Clear();
                //    }

                //    this.EnableDisableControls(EnumEnableDisable.EnableBondPurchase);

                //    if (_tlTranSet.AdTlControl.EnableBondPopup.Value == Phoenix.FrameWork.Shared.Variables.GlobalVars.Instance.ML.Y)
                //    {
                //        this.CallOtherForms(EnumCallOtherForms.BondPurchase, tranCode);
                //    }
                //}
                //else
                //{
                //    //Clear out our bond list if the tran code changes
                //    this._tlTranSet.CurTran.Bonds.Clear();
                //    this.EnableDisableControls(EnumEnableDisable.DisableBondPurchase);
                //}
                // End #76047

                // hack
                if (cmbTranCode.PhoenixUIControl.BusObjectProperty == null)
                    cmbTranCode.PhoenixUIControl.BusObjectProperty = _tlTranSet.TellerHelper.TlTranCode;


                //clean up up the old stuff if necessary
                if (!setFieldOnly)
                {
                    //if ( !_tlTranSet.CurTran.TlTranCode.IsNull )
                    ReverseDeviceDeposit(false);    //#8977
                    _tlTranSet.CurTran.CleanUpValues();
                    _tlTranSet.CurTran.TfrAcct.CleanUpValues(true);
                    _tlTranSet.CurTran.RefAcct.CleanUpValues(true);
                    if (tranCode == "179")  //#13912
					{
						_tlTranSet.CurTran.TranAcct.CloseAmt.SetValue(null);
						_tlTranSet.CurTran.TranAcct.PenaltyAmt.SetValue(null);
					}

                    if (_tlTranSet.CurTran.TranAcct.AcctType.IsNull || _tlTranSet.CurTran.TranAcct.AcctNo.IsNull)
                        setTitleBarName(_tlTranSet.CurTran.TranAcct.RimNo.Value, false);    //#8690
                    /* WI#3549, #3550
                     * dfAmt (XmlTag NetAmt) - needs to be in the object to trigger charges functionality.
                     * after cleaning up values the amount was not there in the object but was there on the screen.
                     * so charges was not being calculated cause of null amount in the object.
                     */
                    //Begin #4175
                    //Rolledback the fix added as part of #3549 since it is causing problem
                    //dfAmt.ScreenToObject();
                    //End #4175
                }

                EnableDisableControls("TranCodeCleanUp");
                SetTabOrder("FormCreate");
                if (tranCode == null)
                {
                    dfQuickTranCode.UnFormattedValue = null;
                    cmbTranCode.CodeValue = dfQuickTranCode.UnFormattedValue;
                }
                //TODO : cleaning up on us fields
                /* issue #77176 added if condition*/
                if (!processingSelectTran)
                {
                    MoveAmtObjectsToScreen();
                }
                MoveAcctObjectsToScreen(dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct);
                MoveAcctObjectsToScreen(dfRefAcctNo, cmbRefAcctType, _tlTranSet.CurTran.RefAcct);
                MoveMiscObjectsToScreen(miscTCFields);

                if (tranCode != null)
                {
                    cmbTranCode.CodeValue = tranCode;
                    if (cmbTranCode.Text == null || cmbTranCode.Text == String.Empty && (picTabs.SelectedTab != tabEasyCapture)) //Bug#99140
                    {
                        //TODO : Add message
                        showMessage = true;
                        invalidTC = true;
                        cmbTranCode.CodeValue = null;
                        return false;
                    }
                    if (!setFieldOnly)
                    {
                        try
                        {
                            using (new WaitCursor())
                            {
                                /* Begin #73911
                                _tlTranSet.ValidateTlTrancode( cmbTranCode.CodeValue.ToString() );
                                //Begin #72916
                                if (ProcessResponses(null))
                                {
                                    if (_tlTranSet.TellerVars.IsTCDEnabled || _tlTranSet.TellerVars.IsTCDConnected)
                                    {
                                        _tlTranSet.ValidateTlTrancode(cmbTranCode.CodeValue.ToString(), _tlTranSet.TellerVars.IsTCDEnabled, _tlTranSet.TellerVars.IsTCDConnected);
                                    }
                                }
                                 * */

                                //Begin #9099
                                if (isNonCust())
                                {
									_tlTranSet.CurTran.NonCust.Value = "Y";
                                }
								//End #9099

								//#79370 - Added null check
                                if (_tlTranSet.TellerVars.IsTCDEnabled || _tlTranSet.TellerVars.IsTCDConnected)
                                {
									_tlTranSet.ValidateTlTrancode(cmbTranCode.CodeValue == null ? null : cmbTranCode.CodeValue.ToString(), _tlTranSet.TellerVars.IsTCDEnabled, _tlTranSet.TellerVars.IsTCDConnected);
                                }
                                else
                                    _tlTranSet.ValidateTlTrancode(cmbTranCode.CodeValue == null ? null : cmbTranCode.CodeValue.ToString());
                                //
                                //End #72916
                                /* End #73911 */
                            }
                        }
                        catch (PhoenixException pe)
                        {
                            PMessageBox.Show(pe, MessageBoxButtons.OK);
                            invalidTC = true;
                            showMessage = false;
                            return false;
                        }
                        if (!ProcessResponses(null))
                        {
                            invalidTC = true;
                            return false;
                        }

                    }

                    enableAddNext = _tlTranSet.AddNextAllowed();
                    if (!ProcessResponses(null))
                    {
                        invalidTC = true;
                        return false;
                    }

                    //Begin #79496
                    if (!processingSelectTran && _tlTranSet.AdTlTc.AutoSelectUseDesc.Value == GlobalVars.Instance.ML.Y)
                    {
                        cbPassDesc.SetValue(true);
                    }
                    if (_tlTranSet.OnUsIsCustomOffset())
                    {
                        cmbOnUsTc.Populate(new ArrayList(), null);
                        cmbOnUsTc.Append(_tlTranSet.GetCustomOffsetTC(), _tlTranSet.GetCustomOffsetTC().ToString());
                        cmbOnUsTc.SetValue(_tlTranSet.GetCustomOffsetTC());
                    }
                    //End #79496

                    if ((processingSelectTran && _inputParamTranSet != null) == false)  //  #TellerWF - do npt process the code if processing selct tran for inputTranSet case
                    {
                        //#3401 - Moved the code added as part of #76047
                        if (CheckBondTranCode(_tlTranSet.CurTran.TranAcct.TranCode.Value.ToString())) //3401
                        {
                            /*
                             * #4150 - #76047 - when input transaction tab is refreshed we should clear out the array
                             * ading check for rim number change
                             *
                             * #4157 - 76047 - Bond information is not retained with multiple transaction set; when this code is being
                             * executed when one of the transactions is viewed from multiple transactions, dfQuickTranCode is empty
                             * and trancode has a value there by making this condition tranCode != dfQuickTranCode.Text - true and
                             * then clearing out Bonds array.
                             *
                             * other issue - suppose i input a 922, add bonds and then later i change 922 to 913. in this case
                             * we need to clear bonds. tranCode != dfQuickTranCode.Text is true if i change the transaction from drop down
                             * but both tranCode and dfQuickTranCode.Text have same values if i change it in the text box.
                             * for that i had to check for dfQuickTranCode.UnFormattedValue instead of dfQuickTranCode.Text
                             * UnformattedValue is set to current tran code later in the fn.
                             */
                            if (_tlTranSet.CurTran.Bonds.Count > 0 &&
                                ((dfQuickTranCode.UnFormattedValue != null &&
                                tranCode != dfQuickTranCode.UnFormattedValue.ToString()) ||
                                _tlTranSet.CurTran.TranAcct.RimNo.Value != ((GbBondPurchase)_tlTranSet.CurTran.Bonds[0]).RimNo.Value))
                            {
                                //Clear out our bond list if the tran code changes
                                this._tlTranSet.CurTran.Bonds.Clear();
                            }

                            this.EnableDisableControls(EnumEnableDisable.EnableBondPurchase);

                            if (_tlTranSet.AdTlControl.EnableBondPopup.Value == Phoenix.FrameWork.Shared.Variables.GlobalVars.Instance.ML.Y)
                            {
                                //#3401 - removed trancode parameter
                                //Begin #03882
                                //this.CallOtherForms("GbBondPurchase");
                                popUpBondPurchase = true;
                                //End #03882
                            }
                        }
                        else
                        {
                            //Clear out our bond list if the tran code changes
                            this._tlTranSet.CurTran.Bonds.Clear();
                            this.EnableDisableControls(EnumEnableDisable.DisableBondPurchase);
                        }
                        //End #3401
                    }

                    // Check the TC is RIM and acct type is not rim
                    /* 40347 - cmbAcctType.CodeValue.ToString() Changed to Convert.ToString() */

                    if (_tlTranSet.IsRimTran(_tlTranSet.CurTran.TranCode.Value) && acctEntered &&
                        Convert.ToString(cmbAcctType.CodeValue) != "RIM" && Convert.ToString(cmbAcctType.CodeValue) != "RM")
                    {
                        if (_tlTranSet.TellerVars.IsAppOnline)
                        {
                            _isSwitchedToRim = true;
                            EnableDisableControls(EnumEnableDisable.CDRedemp); //140782,21033

                            if (_tlTranSet.TellerVars.AdTlControl.AcctTypeSearch.Value == GlobalVars.Instance.ML.Y) // ML
                                cmbAcctType.CodeValue = "RIM";
                            else
                                cmbAcctType.CodeValue = "RM";
                            SetMask(cmbAcctType, dfAcctNo);
                             //WI#7052
							if (_tlTranSet.CurTran.TranAcct.RimNo.Value < 1)
								_tlTranSet.CurTran.TranAcct.RimNo.Value = _myRim;
                            //end WI#7052
                            // #8953 - Core issue _tlTranSet.CurTran.AcctType.Value set to rim, but _tlTranSet.CurTran.AcctNo.Value remains null
                            _tlTranSet.CurTran.AcctNo.Value = _tlTranSet.CurTran.TranAcct.RimNo.StringValue; // #8953

                            SetAcctNoField(
                                _tlTranSet.CurTran.TranAcct.RimNo.Value.ToString(), 
                                dfAcctNo,
                                cmbAcctType, 
                                _tlTranSet.CurTran.TranAcct);

                            //#22426
							// #79370 - Throw in a bug fix while we're at it!
                            //if (cmbTranCode.CodeValue != null)
                            //{
                            //    _tlTranSet.ValidateTlTrancode(cmbTranCode.CodeValue.ToString()); //#2157 - validate after switch to Rim
                            //}
                            SetTabOrder("FormCreate");
                            _tlTranSet.ValidateTlTrancode(cmbTranCode.CodeValue == null ? null : cmbTranCode.CodeValue.ToString());
                        }
                        cbPayrollTran.Checked = false;
                        cbPbPresent.Checked = false;
                        cbRetirement.Checked = false;
                        showRetirement = false;
                        EnableDisableControls("SwitchToRim");
                    }
                    //140793
                    //if (_tlTranSet.CurTran.TranCode.Value == 128 || _tlTranSet.CurTran.TranCode.Value == 156 ||
                    //    _tlTranSet.CurTran.TranCode.Value == 138 || _tlTranSet.CurTran.TranCode.Value == 191 ||
                    //    _tlTranSet.OnUsIsCustomOffset()) // #79496
                    //    PopulateAcctTypeCombo(cmbTfrAcctType, false, true);
                    //else
                        PopulateAcctTypeCombo(cmbTfrAcctType, false, true);

                    dfQuickTranCode.UnFormattedValue = tranCode;
                    cmbTranCode.CodeValue = dfQuickTranCode.UnFormattedValue;
                    _tlTranSet.CurTran.TranCodeDesc.Value = cmbTranCode.Text;
                    if (_tlTranSet.TellerHelper.IsTransferTran(_tlTranSet.CurTran.TranCode.Value))
                    {
                        if (_tlTranSet.TellerHelper.IsCreditTran(_tlTranSet.CurTran.TranCode.Value))
                            lblAccount.Text = CoreService.Translation.GetUserMessageX(360011);
                        else
                            lblAccount.Text = CoreService.Translation.GetUserMessageX(360010);

                    }
                    else
                        lblAccount.Text = CoreService.Translation.GetUserMessageX(360012);

                    if (!_tlTranSet.CurTran.UmbCode.IsNull)
                    {
                        dfUMBCode.UnFormattedValue = _tlTranSet.CurTran.TranAcct.UmbCode.Value.ToString() + "-" + _tlTranSet.CurTran.TranAcct.UmbDesc.Value;
                        cmbUmbCode.CodeValue = _tlTranSet.CurTran.UmbCode.Value;
                    }
					//#79506 Begin

					   if (!_tlTranSet.CurTran.ChannelId.IsNull)
					                  {
					                           cmbChannel.CodeValue = _tlTranSet.CurTran.ChannelId.Value;

					                  }
									  //Begin #9891
									  cmbChannel.SetValue(null, EventBehavior.Force);
									  //End #9891

                    //#79506 End
                    /* issue #77176 added if condition*/
                    if (!processingSelectTran)
                    {
                        MoveAmtObjectsToScreen();
                    }
                    MoveAcctObjectsToScreen(dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct);
					EnableDisableControls("TranCodeSelect");
                    focusField = SetTabOrder("TranCodeSelect");
                    //toggle TCD/Drawe if required
                    //#79574 -Modified existing condition also added new one for VLS
                    //if (_tlTranSet.TellerVars.IsTCDEnabled && ((_tlTranSet.CurTran.TranCode.Value == 505 && picTCD.Visible) ||
                    //    (_tlTranSet.CurTran.TlTranCode.Value == "VLT" && picDrawer.Visible)))
                    //{
                    //    if (!TcdDrawerIconClick(picTCD, picDrawer))
                    //    {
                    //        invalidTC = true;
                    //        focusField = null;
                    //        return false;
                    //    }
                    //}
                    if (_tlTranSet.TellerVars.IsTCDEnabled && (picTCD.Visible && (_tlTranSet.CurTran.TranCode.Value == 505 || _tlTranSet.CurTran.TranCode.Value == 555) &&
                        !(_tlTranSet.CurTran.TlTranCode.Value == "VLT" || _tlTranSet.CurTran.TlTranCode.Value == "VLS")) ||
                        (picDrawer.Visible && (_tlTranSet.CurTran.TlTranCode.Value == "VLT" || _tlTranSet.CurTran.TlTranCode.Value == "VLS")))
                    {
                        if (!TcdDrawerIconClick(picTCD, picDrawer))
                        {
                            invalidTC = true;
                            focusField = null;
                            return false;
                        }
                    }

                    //Begin #76425
                    if (_tlTranSet.IsRecalcPmtRequired())
                    {
                        PopulateRecalcPmtDt();
                        MoveMiscObjectsToScreen(miscTCFields);  //#76425
                    }
                    //End #76425

                    if (cbWaiveSignature.Visible) // #12619
                        SetWaiveSignature();

                    if (focusField != null && !processingSelectTran)
                        focusField.Focus();
                }

                return true;
            }
            finally
            {
                processingEvent = false;
                focusAcctField = cmbAcctType;
                if (invalidTC)
                {
                    _tlTranSet.CurTran.CleanUpValues();
                    dfQuickTranCode.UnFormattedValue = null;
                    cmbTranCode.CodeValue = null;
                    if (showMessage)
                        //MessageBox.Show( "Invalid Trancode", "Warning", MessageBoxButtons.OK );
                        PMessageBox.Show(315164, MessageType.Warning, MessageBoxButtons.OK, String.Empty);
                    (focusField == null ? dfQuickTranCode : focusField).Focus();
                }
                else
                {
                    //Begin #04620
                    if (!_tlTranSet.TellerVars.IsAppOnline)
                        popUpBondPurchase = false;
                    //End #04620

                    // Begin #03882
                    if (popUpBondPurchase)
                    { // #13025
                        this.EnableDisableControls(EnumEnableDisable.EnableBondPurchase);//#12216 #12217
                        this.CallOtherForms("GbBondPurchase");
                    } // #13025
                    // End #03882
                }
                EnableDisableWithholding(); // #140782
            }
        }

        private bool ShowPassbook(short origin, string pbFlag, PCheckBoxStandard pbCheckBox)
        {
            //			short tranCode = -1;

            if (pbFlag != GlobalVars.Instance.ML.Y)
            {
                pbCheckBox.Checked = false;
                return false;
            }
            //			if ( !_tlTranSet.CurTran.TranCode.IsNull )
            //				tranCode = _tlTranSet.CurTran.TranCode.Value;
            //
            //			if ( tranCode < 0 )
            //			{
            //				pbCheckBox.Checked = true;
            //				return true;
            //			}
            //			if ( tranCode == 122 || tranCode == 182 ||
            //				( origin == 1 && _tlTranSet.TellerHelper.IsTransferTran( tranCode )) )
            //			{
            //				pbCheckBox.Checked = false;
            //				return false;
            //			}
            pbCheckBox.Checked = true;
            return true;
        }

        private void SelectTran(int tranIndex)
        {
            try
            {
                processingSelectTran = true;
                SuspendLayout();
                //SuspendPaint( gbTransactionInformation, true );
                if (tranIndex < 0)
                {
                    tranIndex = Convert.ToInt32(colTranIndex.UnFormattedValue);
                }
                //#16655 -- WI#16237 - Commented Back Out Cause It Allows Access When It Should Not
                //picTabs.SelectedIndex = 0;    //WI#16236_2 Commented this one and uncommented one below so rimno is selected before call
                //Invalidate();
                _tlTranSet.SelectTransaction(tranIndex, false);  //#80618
                if (curTranIndex != tranIndex)
                {
                    frmTlTranCode_PInitCompleteEvent();
                }
                else
                {
                    MapFieldToObject();
                }
                MoveAcctObjectsToScreen(dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct);

                if (cmbAcctType.CodeValue != null && cmbAcctType.CodeValue.ToString() == GlobalVars.Instance.ML.GL)
                {
                    PopulateTranCodeCombo(GetDepLoan(cmbAcctType), cmbAcctType.CodeValue.ToString());  //#76458 - added param value for acctType
                }
                if (_tlTranSet.CurTran.TlTranCode.IsNull)   // #8096 - Restore nulled value
                    _tlTranSet.CurTran.TlTranCode.Value = holdTlTranCode;
                if (!_tlTranSet.CurTran.TlTranCode.IsNull)  //#21564
                {
                    if (!_creatingTlCaptureTranSet)     // #140895 - check for _creatingTlCaptureTranSet
                    {
                        //Begin #140895
                        // force the my rim stuff otherwise it is forcing  _tlTranSet.CurTran.TranAcct.RimNo.Value to -1 when selected index is changed
                        if (_tlTranSet.CurTran.TranAcct.RimNo.Value > 0 && _myRim != _tlTranSet.CurTran.TranAcct.RimNo.Value)
                        {
                            _myRim = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                            myPostAccess = _tlTranSet.CurTran.TranAcct.PostAccess.Value;    //#5700
                            myEditAccess = _tlTranSet.CurTran.TranAcct.EditAccess.Value;    //#5700
                        }
                        //End #140895
                        picTabs.SelectedIndex = 0;
                    }
                    dfQuickTranCode_KeyUp(null, null);
                }
                SetQuickTranCodeField(_tlTranSet.CurTran.TlTranCode.Value, null);
                MoveAcctObjectsToScreen(dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct);
                MoveAcctObjectsToScreen(dfRefAcctNo, cmbRefAcctType, _tlTranSet.CurTran.RefAcct);
                MoveMiscObjectsToScreen(miscTCFields);

				//populate and enable OnUs fields
				processCaptureItems();  //WI#19027

                if (!_tlTranSet.CurTran.TypeId.IsNull && _tlTranSet.CurTran.TypeId.Value > 0)   //#21564
                {
                    EnableDisableControls("InventoryItem");
                }

                // Begin WI#16236_2
                _holdRimNo = _tlTranSet.CurTran.RimNo.Value;
                // End WI#16236_2


                if (!_creatingTlCaptureTranSet)     // #140895 - check for _creatingTlCaptureTranSet
                {
                    picTabs.SelectedIndex = 0;    // WI#16236_2 umcommented this call and commented call above
                    cmbAcctType.Focus();
                }
            }
            finally
            {
                processingSelectTran = false;
                curTranIndex = -1;
                EnableDisableControls("SelectTran"); ; // #140895-ReadOnly
                ResumeLayout(true);
                //SuspendPaint( gbTransactionInformation, false );
                Workspace.ActionPanel.UpdateView();
            }
        }

		//Begin WI#19027

		/// <summary>
		/// Trim Capture Items arraylist from empty members. Needed to remove auto added empty record at the end.
		/// </summary>
		/// <param name="captureItems">ArrayList containing Capture Items</param>
		private void trimCaptureItems(ArrayList captureItems)
		{
			for (int i = 0; i < captureItems.Count; i++)
			{
				if ((captureItems[i] as TlItemCapture).AcctNo.StringValue == string.Empty)
				{
					captureItems.RemoveAt(i);
					trimCaptureItems(captureItems);
					break;
				}
			}
		}

		/// <summary>
		/// Fill and enable OnUs Fields with Capture Item[0], if there is only 1 in collection. Otherwise disable OnUs fields
		/// </summary>
		private void processCaptureItems()
		{
			//trim empty items
			trimCaptureItems(_tlTranSet.CurTran.Items);
            string onusTC = string.Empty;   //#39025

			if (!_tlTranSet.MoveItemsToOnUs())
			{
				//More than one. Disable OnUs fields
				EnableDisableControls("ItemCaptureClick");
			}
			else
			{
				//0 or 1 item. Show values and enable OnUs fields
				MoveMiscObjectsToScreen(GetAssocControls("EnableDisable", dfOnUsChks));
				MoveAcctObjectsToScreen(dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct);
				EnableDisableControls("EnableOnUsFields");
                if (_tlTranSet.CurTran.Items != null && _tlTranSet.CurTran.Items.Count == 1)
                    onusTC = (_tlTranSet.CurTran.Items[0] as TlItemCapture).TranCode.StringValue;
                if (IsOnUsTCEnabled && _tlTranSet.CurTran.TfrAcct != null && !_tlTranSet.CurTran.TfrAcct.AcctNo.IsNull)    //#39025
                    PopulateOnUsCombo(_tlTranSet.CurTran.TfrAcct.DepLoan.Value,
                        _tlTranSet.CurTran.TfrAcct.AcctType.Value,
                        _tlTranSet.CurTran.TfrAcct.ApplType.Value,
                        onusTC);
                //#56734
                _tlTranSet.CurTran.NetAmt.Value = _tlTranSet.ReCalcNetAmt(_tlTranSet.CurTran);
                dfAmt.ObjectToScreen();
			}
        }
		//End WI#19027

        private void UpdateDrawerBalance()
        {
            //#72916 - Begin
            if (_tlTranSet.TellerVars.IsTCDConnected && !_tlTranSet.TranSetTotalCashDispense.IsNull && _tlTranSet.TranSetTotalCashDispense.Value > 0 &&
                _tlTranSet.CurTran.TlTranCode.Value != "VLT" && _tlTranSet.CurTran.TlTranCode.Value != "VLS")   //#9433
                _tlTranSet.TellerVars.DrawerCash = _tlTranSet.TellerVars.DrawerCash + _tlTranSet.TranSetTotalCash + _tlTranSet.TranSetTotalCashDispense.Value;
            else
            {
                if (_tlTranSet.CurTran.TlTranCode.Value != "VLS")   //#9433
                 {
				     //#10744
				    //_tlTranSet.TellerVars.DrawerCash = _tlTranSet.TellerVars.DrawerCash + _tlTranSet.TranSetTotalCash - (_tlTranSet.TranSetTotalBalanceDue.IsNull ? 0 : _tlTranSet.TranSetTotalBalanceDue.Value);    //#9822 - omit the amoutn not dispensed from TCD/TCR including coin amt.
				    if (_tlTranSet.CurTran.TlTranCode.Value == "VLT")
				        _tlTranSet.TellerVars.DrawerCash = _tlTranSet.TellerVars.DrawerCash + _tlTranSet.TranSetTotalCash - (_tlTranSet.TranSetTotalBalanceDue.IsNull ? 0 : _tlTranSet.TranSetTotalBalanceDue.Value);    //#9822 - omit the amoutn not dispensed from TCD/TCR including coin amt.
				    else
				    {
				        _tlTranSet.TellerVars.DrawerCash = _tlTranSet.TellerVars.DrawerCash + _tlTranSet.TranSetTotalCash;    //#9822 - omit the amoutn not dispensed from TCD/TCR including coin amt.
				        if (!_tlTranSet.TranSetTotalCashDispense.IsNull && _tlTranSet.TranSetTotalCashDispense.Value > 0)
				            _tlTranSet.TellerVars.DrawerCash = _tlTranSet.TellerVars.DrawerCash - (_tlTranSet.TranSetTotalBalanceDue.IsNull ? 0 : _tlTranSet.TranSetTotalBalanceDue.Value);
				    }
                }
            }
            //#72916 -ENd

            //#79574
            if (_tlTranSet.TellerVars.IsTCDConnected && _tlTranSet.TellerVars.IsRecycler)
            {
                decimal totalTcdCashDeposit = 0;
                //
                foreach (TlTransaction tran in _tlTranSet.Transactions)
                {
                    totalTcdCashDeposit += (tran.TcdCashIn.IsNull ? 0 : tran.TcdCashIn.Value);
                }
                //
                _tlTranSet.TellerVars.DrawerCash = _tlTranSet.TellerVars.DrawerCash - totalTcdCashDeposit;
            }

            if (drawerCombo != null)
            {
                drawerCombo.Items.Clear();
                drawerCombo.Items.Add(CurrencyHelper.GetFormattedValue(_tlTranSet.TellerVars.DrawerCash));
                drawerCombo.SelectedIndex = 0;
            }
            // TO DO update the drawer combo
            // #8908 - Do not show cash message for non cash drawer.
            if (_tlTranSet.TellerVars.DrawerCash < _tlTranSet.TellerVars.AdGbRsmLimits.LowDrawerLim.Value && !_tlTranSet.TellerVars.IsNonCashDrawer)
            {
                drawerCombo.ForeColor = System.Drawing.Color.Blue;
                PMessageBox.Show(311350, MessageType.Warning, MessageBoxButtons.OK, "USD");
            }
            else if (_tlTranSet.TellerVars.DrawerCash > _tlTranSet.TellerVars.AdGbRsmLimits.HighDrawerLim.Value && !_tlTranSet.TellerVars.IsNonCashDrawer)
            {
                drawerCombo.ForeColor = System.Drawing.Color.Red;
                PMessageBox.Show(311349, MessageType.Warning, MessageBoxButtons.OK, "USD");
            }
            else
                drawerCombo.ForeColor = System.Drawing.Color.Black;
        }

        private bool ScreenHasAccess(string screenType, bool isTfrAcct)         // WI#16236 added isTfrAcct parameter
        {
            string depLoan = null;
            string acctType = null; //#76458
            int screenId = 0;
            //			bool postAccess = _tlTranSet.CurTran.TranAcct.PostAccess.Value == GlobalVars.Instance.ML.Y;
            //			bool editAccess = _tlTranSet.CurTran.TranAcct.EditAccess.Value == GlobalVars.Instance.ML.Y;

            if (picTabs.SelectedIndex == 3 && frmGloAccountListRim != null &&
                frmGloAccountListRim.colDepLoan.UnFormattedValue != null)
            {
                depLoan = frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString();
                acctType = frmGloAccountListRim.colAcctType.UnFormattedValue.ToString();    //#76458
            }
            else if (picTabs.SelectedIndex == (int)TAB.QuickTran)
            {
                //Begin Bug #95565
                if (QuickAccountSelectedRow != null)
                {
                    depLoan = QuickAccountSelectedRow["DepLoan"] as string;
                    acctType = QuickAccountSelectedRow["AcctType"] as string;
                    if (!string.IsNullOrEmpty(depLoan))
                        depLoan = depLoan.Trim();
                    if (!string.IsNullOrEmpty(acctType))
                        acctType = acctType.Trim();
                }
                //End Bug #95565
            }
            else
            {
                //Begin #76458
                //depLoan = _tlTranSet.CurTran.TranAcct.DepLoan.Value;
                //acctType = _tlTranSet.CurTran.TranAcct.AcctType.Value;
                if (focusAcctField == cmbTfrAcctType)
                {
                    depLoan = _tlTranSet.CurTran.TfrAcct.DepLoan.Value;
                    acctType = _tlTranSet.CurTran.TfrAcct.AcctType.Value;
                }
                else
                {
                    depLoan = _tlTranSet.CurTran.TranAcct.DepLoan.Value;
                    acctType = _tlTranSet.CurTran.TranAcct.AcctType.Value;
                }
                //End #76458

            }

            if (screenType == "display")
            {
                if (depLoan == GlobalVars.Instance.ML.DP)
                    screenId = Phoenix.Shared.Constants.ScreenId.DpDisplay;
                else if (depLoan == GlobalVars.Instance.ML.LN)
                    screenId = Phoenix.Shared.Constants.ScreenId.LnDisplay;
                else if (depLoan == GlobalVars.Instance.ML.RM)
                    screenId = Phoenix.Shared.Constants.ScreenId.RmDisplay;
                else if (depLoan == GlobalVars.Instance.ML.SD)
                    screenId = Phoenix.Shared.Constants.ScreenId.SdDepositDisplay;
                else if (depLoan == GlobalVars.Instance.ML.CM)  /*Begin #7860*/
                    screenId = Phoenix.Shared.Constants.ScreenId.IraLnCommitmentDisplay;  /*End #7860*/
                else if (depLoan == GlobalVars.Instance.ML.Ext || depLoan == "EX")  // #76458
                {
                    //screenId = Phoenix.Shared.Constants.ScreenId.OnExAcctDisp1;
                    screenId = _tlTranSet.GetExternalDisplayScreenId(acctType);
                }
            }
            else if (screenType == "history")
            {
                if (depLoan == GlobalVars.Instance.ML.DP)
                    screenId = Phoenix.Shared.Constants.ScreenId.DpTCHistory;
                else if (depLoan == GlobalVars.Instance.ML.LN)
                    screenId = Phoenix.Shared.Constants.ScreenId.LnTCHistory;
                else if (depLoan == GlobalVars.Instance.ML.RM)
                    screenId = Phoenix.Shared.Constants.ScreenId.RmHistory;
                else if (depLoan == GlobalVars.Instance.ML.SD)
                    screenId = Phoenix.Shared.Constants.ScreenId.SdTCHistory;
                else if (depLoan == GlobalVars.Instance.ML.CM)  /*Begin #7860*/
                    screenId = Phoenix.Shared.Constants.ScreenId.CmtTCHistory;  /*End #7860*/
                else if (depLoan == GlobalVars.Instance.ML.Ext || depLoan == "EX")  // #76458
                    screenId = _tlTranSet.GetExternalHistoryScreenId(acctType);
            }
            else if (screenType == "restriction")
            {
                // Ramki #74024 added LN
                if (depLoan == GlobalVars.Instance.ML.DP || depLoan == GlobalVars.Instance.ML.LN)
                {
                    screenId = Phoenix.Shared.Constants.ScreenId.GbStopHold;
                }
            }
            else if (screenType == "cdredempt") // #140782
            {
                if (depLoan == GlobalVars.Instance.ML.DP && (frmGloAccountListRim.colPlanNo.Text != "" || frmGloAccountListRim.colDepType.Text == "Time"))
                {
                    screenId = Phoenix.Shared.Constants.ScreenId.DpRedempCalc;
                }
            }
            else if (screenType == "custSummary")
            {
                screenId = Phoenix.Shared.Constants.ScreenId.GbAccountListRim;
            }
            if (screenId > 0 && ((CoreService.UIAccessProvider.GetScreenAccess(screenId) &
                AuthorizationType.Read) == AuthorizationType.Read || screenId == Phoenix.Shared.Constants.ScreenId.GbAccountListRim))
            {
                if ((isTfrAcct && tfracctHasPostAccessOnly) || (!isTfrAcct && acctHasPostAccessOnly))   // WI#16236 changed from if(acctHasPostAccessOnly) to if ((isTfrAcct && tfracctHasPostAccessOnly) || (!isTfrAcct && acctHasPostAccessOnly))
                    return false;
                else
                {
                    //#76458 - add code change to make available external xmal window security once their are available
                    if (screenType == "restriction" && _tlTranSet.IsExternalAdapterAcct(acctType)) //#76458 - security changes for adapter
                    {
                        return false;
                    }
                    else
                        return true;

                }
            }
            return false;
        }

        private void CreateEmbeddedWindows(string windowType)
        {
            if (_isWindowShown == false && windowType == "Search")  // #UI Refresh
                return;

            if (windowType == "Search" && frmTBarSearch == null)
            {
                frmTBarSearch = Helper.CreateWindow("phoenix.client.tbarsearch",
                    "Phoenix.Client.Search", "frmtbarsearchMerged") as Phoenix.Client.Search.frmtbarsearchMerged; //60671

				frmTBarSearch.InitParameters(this.Workspace, _tlTranSet.Transactions.Count);	//#79572

                Name2.AssociatedForm = frmTBarSearch;
                WindowHelper.ResizeEmbeddedWinCntrls(frmTBarSearch);    // #203301.User Story 01: 44600
                frmTBarSearch.Show();

                //WindowHelper.ResizeEmbeddedWinCntrls(frmTBarSearch);    // #203301.User Story 01: 44600

                if (IsUIPrefSet == false)//#142717
                {
                    //For Embeded windows need to call the refresh for the preference customization.
                    UIPreferences UIPrefs = new UIPreferences();    //#142717
                    UIPrefs.DoUIPreferences(this, false);           //#142717
                    IsUIPrefSet = true;
                }

                foreach (PAction action in frmTBarSearch.ActionManager.Actions)
                {
                    action.Enabled = false;
                    action.Visible = false;
                }
                frmTBarSearch.grdCustomerList.DoubleClickAction = pbSelectSearch;
                frmTBarSearch.rbAccount.PhoenixUICheckedChangedEvent += new CheckedChangedEventHandler(SearchControl_Click);
                frmTBarSearch.rbName.PhoenixUICheckedChangedEvent += new CheckedChangedEventHandler(SearchControl_Click);
                frmTBarSearch.rbOther.PhoenixUICheckedChangedEvent += new CheckedChangedEventHandler(SearchControl_Click);
                frmTBarSearch.rbPhone.PhoenixUICheckedChangedEvent += new CheckedChangedEventHandler(SearchControl_Click);
                frmTBarSearch.rbTin.PhoenixUICheckedChangedEvent += new CheckedChangedEventHandler(SearchControl_Click);
                frmTBarSearch.grdCustomerList.GotFocus += new EventHandler(grdCustomerList_GotFocus);
                frmTBarSearch.grdCustomerList.Leave += new EventHandler(grdCustomerList_Leave);
                frmTBarSearch.grdCustLookup.DoubleClickAction = pbSelectSearch; //60686
                frmTBarSearch.ptabResults.SelectedIndexChanged += new EventHandler(ptabResults_SelectedIndexChanged);        //WI28477
                frmTBarSearch.grdCustLookup.SelectedIndexChanged += new GridClickedEventHandler(grdCustLookup_SelectedIndexChanged);//92056
            }
            if (windowType == "Search" && frmTBarSearch != null)
            {
                frmTBarSearch.DefaultAction = pbSearch;
                //frmTBarSearch.Visible = true;
                //frmTBarSearch.dfLastName.Focus(); //#74043-2
            }

            if (windowType == "Summary" && frmGloAccountListRim == null)
            {
                //360821 - Please wait while retriving customer information...71231
                dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(360821));
                frmGloAccountListRim = Helper.CreateWindow("phoenix.client.rimaccounts",
                    "Phoenix.Client.RimAccounts", "frmGloAccountListRim") as Phoenix.Client.RimAccounts.frmGloAccountListRim;

                Name3.AssociatedForm = frmGloAccountListRim;
                frmGloAccountListRim.skipRefresh = true;    // #71892
                WindowHelper.ResizeEmbeddedWinCntrls(frmGloAccountListRim); //#203301.User Story 01: 44600
                frmGloAccountListRim.Show();

                //WindowHelper.ResizeEmbeddedWinCntrls(frmGloAccountListRim); //#203301.User Story 01: 44600

                int selectedTab = picTabs.SelectedIndex;  //#45681. Get Selected tab before calling DoUIPreference.
                if (IsUIPrefSet == false)//#142717
                {
                    //For Embeded windows need to call the refresh for the preference customization.
                    UIPreferences UIPrefs = new UIPreferences();
                    UIPrefs.DoUIPreferences(this, false);           //#142717
                    IsUIPrefSet = true;
                }
                picTabs.SelectedIndex = selectedTab;  //#45681.Set SelectedTab which we got before calling DoUiPreferences, because DoUIPreferences will set default tab(Search tab) and it causes focus in search tab even after summary winoow is displayed

                frmGloAccountListRim.skipRefresh = false;	// #71892
                foreach (PAction action in frmGloAccountListRim.ActionManager.Actions)
                {
                    action.Enabled = false;
                    action.Visible = false;
                }
                //frmGloAccountListRim.gridAccountListSum.DoubleClickAction = pbSelectAcct;
                frmGloAccountListRim.gridAccountListSum.DoubleClick += new EventHandler(gridAccountListSum_DoubleClick);

                //#29225: Uncommented the code for double clicking the new tab's rows.
                //frmGloAccountListRim.gridAccountListSum.RowClicked += new GridClickedEventHandler(gridAccountListSum_RowClicked);     //#140788 begin
                frmGloAccountListRim.gridAccountListSum.CellClick += new DataGridViewCellEventHandler(gridAccountListSum_CellClick);
                frmGloAccountListRim.gridCertListSum.DoubleClick += new EventHandler(gridAccountListSum_DoubleClick);
                frmGloAccountListRim.gridDepListSum.DoubleClick += new EventHandler(gridAccountListSum_DoubleClick);
                frmGloAccountListRim.gridLoanListSum.DoubleClick += new EventHandler(gridAccountListSum_DoubleClick);                   //#140788 end
                
                frmGloAccountListRim.gridAccountListSum.Click += new EventHandler(gridAccountListSum_Click);
                frmGloAccountListRim.gridAccountListSum.SelectedIndexChanged += new GridClickedEventHandler(gridAccountListSum_SelectedIndexChanged);//+=new GlacialComponents.Controls.GlacialList.ClickedEventHandler(gridAccountListSum_SelectedIndexChanged);
                //Begin #62740
                if (TellerVars.Instance.DrawerNo > 0)
                {
                frmGloAccountListRim.DefaultAction = pbSelectAcct;
                }
                else
                {
                    frmGloAccountListRim.DefaultAction = pbDisplay;
                }
                //End #62740
                frmGloAccountListRim.gridAccountListSum.BeforePopulate += new GridPopulateEventHandler(gridAccountListSum_BeforePopulate);
                frmGloAccountListRim.gridAccountListSum.AfterPopulate += new GridPopulateEventHandler(gridAccountListSum_AfterPopulate);
                //Begin 61240
                #region WI#29312 Reversed pbEditService button
                frmGloAccountListRim.picTabCustSummary.SelectedIndexChanged += new EventHandler(picTabCustSummary_SelectedIndexChanged);        //WI28477
                frmGloAccountListRim.gridServListSum.SelectedIndexChanged += new GridClickedEventHandler(gridServListSum_SelectedIndexChanged); //WI28477
                #endregion
                frmGloAccountListRim.picTabCustSummary.Leave += new EventHandler(PicTabCustSummary_Leave);//Bug#115682
                //End 61240

            }

            //Begin #Task#87717
            if (windowType == "QuickTran" && tabEasyCapture.AssociatedForm == null)
            {
                //PfwStandard quickForm = new Phoenix.Client.TlTranCode.frmQuickTranWin();
                //PfwStandard quickForm = Helper.CreateWindow("phoenix.client.tlquicktrancode",
                //    "Phoenix.Client.Teller", "frmTlQuickTranCode");
                //PfwStandard quickForm = Helper.CreateWindow("FrmMain.Test","FrmMain.Test", "frmDockingWindows");
                PfwStandard quickForm = Helper.CreateWindow("phoenix.client.tlquicktrancode", "Phoenix.Client.Teller", "frmTlQuickTranCode");
                //PfwStandard quickForm = Helper.CreateWindow("phoenix.client.tlquicktrancode", "Phoenix.Client.Teller", "frmTlQuickTranCode2");
                tabEasyCapture.AssociatedForm = quickForm;
                _quickTranWindow = quickForm as IQuickTranWindow;
                _quickTranWindow.SetTlTranCodeWindow(this);
                _quickTranWindow.AssumeDecimals = (_tlTranSet.TellerVars.AdTlControl.AssumeDecimals.Value == GlobalVars.Instance.ML.Y);
                //_quickTranWindow.OnSearchPerformed += OnQuickTranSearchPerformed; //Bug #92023
                quickForm.Show();
                if (Workspace is PwksWindow)
                    (Workspace as PwksWindow).InvokeSizeChanged(null);
                WindowHelper.ResizeEmbeddedWinCntrls(quickForm);


                _quickTranWindow.ActionSave = this.ActionSave;
            }
            //End #EASYCAP

        }

        //Begin Bug#115682
        private void PicTabCustSummary_Leave(object sender, EventArgs e)
        {
            if (isAudit == false && isTabAudit == false)
            {
                CreateAuditViews();
                isTabAudit = true;
            }

        }
        //End Bug#115682

        //Begin Bug #92023
        //private void OnQuickTranSearchPerformed(bool searchHasResults)
        //{
        //    //pbItemCapture.Enabled = searchHasResults;//Bug# 108569
        //    //pbCashIn.Enabled = searchHasResults; //Bug #93430//Bug# 108569
        //    //SaveButtonStateVibisiblity(); //Bug #104269//Bug# 108569
        //}
        //End Bug #92023

        #region WI#29312 Reversed pbService button
        //void gridServListSum_SelectedIndexChanged(object source, GridClickEventArgs e) //WI28477
        //{
        //    EnableDisableServiceButton(frmGloAccountListRim.colSvcsDescription.Text);
        //}

        //void picTabCustSummary_SelectedIndexChanged(object sender, EventArgs e) //WI28477
        //{
        //    int newTabIndex = frmGloAccountListRim.picTabCustSummary.SelectedIndex;

        //    if (newTabIndex == (int)Phoenix.Client.RimAccounts.frmGloAccountListRim.TAB.Services)
        //    {
        //        pbService.Visible = true;
        //        EnableDisableServiceButton(frmGloAccountListRim.colSvcsDescription.Text);
        //        this.UpdateView();
        //    }
        //    else
        //    {
        //        pbService.Visible = false;
        //    }            
        //}
        #endregion


        private bool AcctIsModified(PdfStandard acctNoField,
            PComboBoxStandard acctTypeField, TlAcctDetails acctDetails)
        {
            string applType = null;
            string depLoan = null;
            string format = null;

            GetAcctTypeDetails(acctTypeField, ref applType, ref depLoan, ref format);
            //#9433 //#14486 - Added applType == acctDetails.ApplType.Value
			/* SDhamija - #15525- Remote Supervisor Override - Cancel and attempt to Post, Ownership Accounts display
			 * fix for #14486 is invalid.
			 * applType != acctDetails.ApplType.Value || applType == acctDetails.ApplType.Value will always be true.
			 * leading to failure of AcctIsModified fn which further causes bug #15525.
			 * pulling out change for #14486.
			 */
            string acctNo = (!acctDetails.AcctNo.IsNull ? acctDetails.AcctNo.Value.Trim() : acctDetails.AcctNo.Value);  //#93834
			if (applType != acctDetails.ApplType.Value
                || (acctNoField.Text != acctNo && !acctDetails.AcctNo.IsNull && (processingSelectTran || _tranPostingAttempted)) ||
                (acctNoField.Text != acctNo && !processingSelectTran && !_tranPostingAttempted))
            {
                //Begin #76043
                if ((acctNoField == dfAcctNo || acctTypeField == cmbAcctType)
                    && (acctDetails.TranCode.PreviousValue == 300
                        || acctDetails.TranCode.PreviousValue == 301
                        || acctDetails.TranCode.PreviousValue == 304
                        || acctDetails.TranCode.PreviousValue == 345)
                        )
                {
                    _tlTranSet.DeleteLoanCcTrmTierRows();
                }
                //End #76043
                //Begin #76458
                if (acctTypeField.CodeValue != null && _tlTranSet.IsExternalAdapterAcct(acctTypeField.CodeValue.ToString()))
                {
                    if (acctTypeField.CodeValue.ToString().Trim() != acctDetails.AcctType.Value || (acctNoField.Text != acctDetails.AcctNo.Value && acctNoField.Text != acctDetails.AcctNoMask.Value))
                        return true;
                    else
                        return false;
                }
                //End #76458
                return true;
            }
            return false;
        }

        //Begin #203301.User Story 01: 44600
        void frmTlTranCode_ResizeFormEnd(object sender, EventArgs e)
        {
            WindowHelper.ResizeEmbeddedWinCntrls(frmTBarSearch);
            WindowHelper.ResizeEmbeddedWinCntrls(frmGloAccountListRim);

            if (Extension is FormExtension)
            {
                gbTransactionSet.Height = (Extension as FormExtension).WksAvailableHeight + 10;
                ctwTranSet.Height = gbTransactionSet.Height - 45;

                dfDifference1.Top = 
                lblDifference1.Top =
                lblTotalDebits1.Top =
                dfTotalCredits1.Top =
                dfTotalDebits1.Top =
                lblTotalCredits1.Top = gbTransactionSet.Bottom - dfDifference1.Height - 5;
            }
            
        }
        //End #203301.User Story 01: 44600

        private void InitializeTranSet()
        {
            _tlTranSet.BranchNo.Value = _tlTranSet.TellerVars.BranchNo;
            _tlTranSet.DrawerNo.Value = _tlTranSet.TellerVars.DrawerNo;
            _tlTranSet.EffectiveDt.Value = _tlTranSet.TellerVars.PostingDt;
            _tlTranSet.EmplId.Value = _tlTranSet.TellerVars.EmployeeId;

            /*
            #region debug init
            _tlTranSet.BranchNo.Value = 1;
            _tlTranSet.DrawerNo.Value = 1;
            _tlTranSet.EffectiveDt.Value = new DateTime(2006,7,31 );
            _tlTranSet.EmplId.Value = 1;
            #endregion
            */
            searchRimNo = -1;
            forceFetchRim = true;
            EnableDisableControls("InitializeTran");
            // Begin #18483
            if (Workspace != null)
            {
                Workspace.Variables["_UseStoredNotesInfo"] = true;
                Workspace.Variables["_UseStoredNOCInfo"] = true;
                Workspace.Variables["_StoredPrevNotesAcctNo"] = null;
                Workspace.Variables["_StoredPrevNotesAcctType"] = null;
                Workspace.Variables["_StoredPrevNotesRimNo"] = null;
                Workspace.Variables["_StoredPrevNocRimNo"] = null;
                Workspace.Variables["_StoredPrevNocRimCount"] = null;
            }
            // End #18483

            //Begin #19415
            GbMemo.UseCaching(true);
            if (Workspace != null)
                ((Workspace as PwksWindow).WksExtension as WkspaceExtension).UseAlertCaching(true);
            //End #19415


            //Begin #140895-ReadOnly
            SetTellerCaptureFlagForTranSet(_tlTranSet.IsTellerCaptureTran);
            //End #140895-ReadOnly
            if (_tellerCapture != null && _tellerCapture.MdiForm != null)   //#140895
            {
                _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                _tellerCapture.LastTranLogInfo = new StringBuilder();   //OOB-Fix , #40977
            }

        }

        private ArrayList GetAssocControls(string origin, Control inputControl)
        {
            ArrayList controlList = new ArrayList();

            if (inputControl == dfCashIn)
            {
                controlList.Add(lblCashIn);
                controlList.Add(dfCashIn);
                if (origin == "SetLocation")
                {
                    //controlList.Add( lblDispenseType );
                    //controlList.Add( cmbDispenseType );
                    #region #9291
                    controlList.Add(lblChannel);
                    controlList.Add(cmbChannel);
                    controlList.Add(lblItems);
                    controlList.Add(dfCheckNo);
                    #endregion
                    if (((_tlTranSet.CurTran.TlTranCode.Value == "VLT" &&
                        (_tlTranSet.CurTran.BatchId.IsNull || _tlTranSet.CurTran.BatchId.Value <= 0) &&
                        _tlTranSet.AdTlTc.CashOutEnable.Value != GlobalVars.Instance.ML.Y) ||
                        (_tlTranSet.TellerVars.IsRecycler && _tlTranSet.CurTran.TlTranCode.Value != "VLS")))    //#79574
                    {
                        if (!_tlTranSet.TellerVars.IsRecycler || (_tlTranSet.TellerVars.IsRecycler && _tlTranSet.CurTran.TlTranCode.Value == "VLT"))  //#79574
                        {
                            controlList.Add(cbDenominate); //#72916
                        }
                        controlList.Add(picDrawer); //#72916
                        controlList.Add(picTCD); //#72916
                    }
                    //#9425
                    if (_tlTranSet.AdTlTc.CashOutEnable.Value != GlobalVars.Instance.ML.Y &&
                        _tlTranSet.CurTran.TranAcct != null &&
                        !_tlTranSet.CurTran.TranAcct.TranCode.IsNull &&
                        "102,117,120,156,157,163,164,191,902,910,912,913,915,916,920,921,922,928".IndexOf(_tlTranSet.CurTran.TranAcct.TranCode.StringValue.Trim()) < 0)
                        controlList.Add(cbWaiveSignature);

                }
            }
            else if (inputControl == dfChksAsCash)
            {
                controlList.Add(lblChecksAsCash);
                controlList.Add(dfChksAsCash);
            }
            else if (inputControl == dfOnUsChks)
            {
                controlList.Add(lblOnUsChecks);
                controlList.Add(dfOnUsChks);
                controlList.Add(cmbTfrAcctType);
                controlList.Add(dfTfrAcctNo);
                controlList.Add(cbTfrPbPresent);
                controlList.Add(lblCheck);
                controlList.Add(dfTfrCheckNo);

				// #79370 Begin

				if (true)
				{
					controlList.Add(lblOnUsTc);
					controlList.Add(cmbOnUsTc);
				}

				// #79370 End

                // Begin #74015
                //Begin #4151 - commented out
                //controlList.Add(dfOnUsTitle1);
                //controlList.Add(dfOnUsTitle2);
                //controlList.Add(dfOnUsAlerts);
                //controlList.Add(dfOnUsSignatures);
                //controlList.Add(lblOnUsTitle2);
                //controlList.Add(lblOnUsTitle1);
                //End #4151
                //controlList.Add(pbOnUsDisplay);
                //controlList.Add(pbOnUsSig);
                // End #74015
            }
            else if (inputControl == dfTransitChks)
            {
                controlList.Add(lblTransitChecks);
                controlList.Add(dfTransitChks);
                // Begin #74015
                //controlList.Add(lblOnUsTitle1);
                //controlList.Add(dfOnUsTitle1);
                //controlList.Add(dfOnUsSignatures);
                // End #74015
				//Begin #79572
				if (IsDisplayTransitItemFields())
				{
					controlList.Add(lblTlItemAcctNo);
					controlList.Add(dfTlItemAcctNo);
					controlList.Add(lblTlItemRoutingNo);
					controlList.Add(dfTlItemRoutingNo);
					controlList.Add(lblTlItemCheckNo);
					controlList.Add(dfTlItemCheckNo);
				}
				//End #79572

            }
            else if (inputControl == dfCashOut)
            {
                controlList.Add(lblCashOut);
                controlList.Add(dfCashOut);
                // Begin #74015
                //controlList.Add(lblOnUsTitle2);
                //controlList.Add(dfOnUsTitle2);
                //controlList.Add(dfOnUsAlerts);
                // End #74015
                if (origin == "SetLocation")
                {
                    if (_tlTranSet.CurTran.BatchId.IsNull || _tlTranSet.CurTran.BatchId.Value <= 0 || _tlTranSet.CurTran.TlTranCode.Value == "VLS") //#79574
                    {
                        if (!_tlTranSet.TellerVars.IsRecycler ||
                            (_tlTranSet.TellerVars.IsRecycler && (_tlTranSet.CurTran.TlTranCode.Value == "VLS" || _tlTranSet.AdTlTc.CashInEnable.Value != GlobalVars.Instance.ML.Y)))
                        {
                            controlList.Add(picDrawer); //#72916
                            controlList.Add(picTCD); //#72916
                        }
                        if (_tlTranSet.CurTran.TlTranCode.Value != "VLS")  //#79574
                        {
                            controlList.Add(cbDenominate); //#72916
                        }
                        controlList.Add(cbWaiveSignature); //#76033
                    }
                }
                // #140782
                controlList.Add(lblCalcWh);
                controlList.Add(dfWithholdingAmt);
            }
            else if (inputControl == dfAmt)
            {
                controlList.Add(lblAmount);
                controlList.Add(dfAmt);
                if (origin == "SetLocation")
                {
                    controlList.Add(lblInterestPaid);
                    controlList.Add(dfInterestPaid);
                    //controlList.Add(lblItems); // #9291 - commented
                    //controlList.Add(dfCheckNo); // #9291 - commented
                    controlList.Add(dfPenaltyAmt);
                    controlList.Add(lblPenalty);
                    //controlList.Add( cbDenominate1 ); //#72916
                    //controlList.Add( picDrawer1 ); //#72916
                    //controlList.Add( picTCD1 ); //#72916
                    //#9425
                    if (!_tlTranSet.CurTran.BatchId.IsNull && _tlTranSet.CurTran.BatchId.Value > 0)
                    {
                        controlList.Add(cbDenominate); //#72916
                        controlList.Add(picDrawer); //#72916
                        if (!_tlTranSet.TellerVars.IsRecycler || (_tlTranSet.TellerVars.IsRecycler && _tlTranSet.AdTlTc.CashInEnable.Value != GlobalVars.Instance.ML.Y))    //#79574
                            controlList.Add(picTCD); //#72916
                        controlList.Add(cbWaiveSignature); //#76033
                    }
                    else if (!_tlTranSet.CurTran.TranAcct.TranCode.IsNull &&
                        "102,117,120,156,157,163,164,191,902,910,912,913,915,916,920,921,922,928".IndexOf(_tlTranSet.CurTran.TranAcct.TranCode.StringValue.Trim()) >= 0)
                        controlList.Add(cbWaiveSignature);
                    else if (_tlTranSet.AdTlTc.CashOutEnable.Value != GlobalVars.Instance.ML.Y &&
                        _tlTranSet.AdTlTc.CashInEnable.Value != GlobalVars.Instance.ML.Y &&
                        _tlTranSet.CurTran.TranAcct != null &&
                        !_tlTranSet.CurTran.TranAcct.TranCode.IsNull &&
                        "102,117,120,156,157,163,164,191,902,910,912,913,915,916,920,921,922,928".IndexOf(_tlTranSet.CurTran.TranAcct.TranCode.StringValue.Trim()) < 0)
                        controlList.Add(cbWaiveSignature);
                }
            }
            else if (inputControl == dfCCAmt)
            {
                controlList.Add(lblFeeAmount);
                controlList.Add(dfCCAmt);
                controlList.Add(lblCalcWh);
                controlList.Add(dfWithholdingAmt);
            }
            else if (inputControl == dfInterestPaid)
            {
                controlList.Add(lblInterestPaid);
                controlList.Add(dfInterestPaid);
            }
            else if (inputControl == dfPenaltyAmt)
            {
                controlList.Add(lblPenalty);
                controlList.Add(dfPenaltyAmt);
            }
            else if (inputControl == cmbUtility)
            {
                controlList.Add(cmbUtility);
                controlList.Add(lblUtility);
            }
            //else if (inputControl == cmbChannel) //#79506 // #9291 - commented block
            //{
            //     controlList.Add(cmbChannel);
            //     controlList.Add(lblChannel);
            //}
            else if (inputControl == dfUMBCode)
            {
                controlList.Add(dfUMBCode);
                controlList.Add(lblUMBCode);
                controlList.Add(lblIRACategory);
            }
            else if (inputControl == cmbRefAcctType)
            {
                controlList.Add(cmbRefAcctType);
                controlList.Add(lblRefAccount);
                lblRefAccount.Width = 83; //#72916*
                controlList.Add(dfRefAcctNo);
            }
            else if (inputControl == dfReference)
            {
                controlList.Add(dfReference);
                controlList.Add(lblReference);
            }
            else if (inputControl == cmbRecalcPmtDt)    //#76425
            {
                if (_tlTranSet.IsRecalcPmtRequired())
                {
                    controlList.Add(cmbRecalcPmtDt);
                    controlList.Add(lblRecalcPmtDt);
                    controlList.Add(dfRecalcPmt);
                    controlList.Add(lblRecalcPmt);
                }
            }
            else if (inputControl == cmbInventoryType)    //#140772
            {
                if (_tlTranSet.IsInventoryItemTran())
                {
                    controlList.Add(cmbInventoryType);
                    controlList.Add(lblInventoryType);
                    controlList.Add(cmbInventoryPacket);
                    controlList.Add(dfInvSerialNo);
                    controlList.Add(lblPacket);
                    controlList.Add(dfNoInvAvailable);
                    controlList.Add(lblNoInvAvailable);
                }
            }

            return controlList;
        }

        //Begin #17716
        private ArrayList GetCustomGLOffSetAcctFields()
        {
            ArrayList controlList = new ArrayList();
            controlList.Add(cmbTfrAcctType);
            controlList.Add(dfTfrAcctNo);
            controlList.Add(lblCheck);
            controlList.Add(dfTfrCheckNo);
            controlList.Add(lblOnUsTc);
            controlList.Add(cmbOnUsTc);
            return controlList;

        }
        //End #17716

        private void SetLocation(string origin)
        {
            ArrayList controlList = null;
            ArrayList amtFieldList = new ArrayList();
            ArrayList miscFieldList = new ArrayList();
            ArrayList onUsControlsOne = new ArrayList();   //#74015
            ArrayList onUsControlsTwo = new ArrayList();   //#74015
            ArrayList amtPlusMiscList = new ArrayList();    //#10423
            int[] miscShiftXFactor = new int[10];
            int[] miscYLoc = new int[10];
            Control curControl = null;
            Point oldPoint;
            int locPosition = 0;
            int amtFieldCount = 0;
            int miscFieldCount = 0;
            int baseYLoc = 0;
            int baseXLoc = 0;
            int shiftX = 0;
            int shiftY = 22;
            int spaceY = 2;     // #74015 this is the size of the space between controls
            int lblItemsXPos = 0;

            oldPoint = lblDescription.Location;
            baseXLoc = oldPoint.X;
            baseYLoc = oldPoint.Y;

            if (labelLocXShift < 0)
                labelLocXShift = lblUtility.Location.X - lblDescription.Location.X;

            if (controlLocXShift < 0)
                controlLocXShift = cmbUtility.Location.X - dfTranDescription.Location.X;

            #region set the X location of misc Fields

            #region handle the description field
            if (dfTranDescription.Visible || origin == "FormCreate" || cmbUtility.Visible || dfUMBCode.Visible)
            {

                if (dfTranDescription.Visible)
                {
                    if (lblUtility.Location.X == baseXLoc)
                    {
                        miscFieldList.Add(cmbUtility);
                        miscShiftXFactor[miscFieldCount] = 1;
                        miscYLoc[miscFieldCount++] = baseYLoc;
                    }
                    if (lblUMBCode.Location.X == baseXLoc)
                    {
                        miscFieldList.Add(dfUMBCode);
                        miscShiftXFactor[miscFieldCount] = 1;
                        miscYLoc[miscFieldCount++] = baseYLoc;
                    }
                }
                else
                {
                    if (cmbUtility.Visible)
                    {
                        miscFieldList.Add(cmbUtility);
                        miscShiftXFactor[miscFieldCount] = -1;
                        miscYLoc[miscFieldCount++] = baseYLoc;
                    }
                    if (dfUMBCode.Visible)
                    {
                        miscFieldList.Add(dfUMBCode);
                        miscShiftXFactor[miscFieldCount] = -1;
                        miscYLoc[miscFieldCount++] = baseYLoc;
                    }
                }
                baseYLoc = baseYLoc + shiftY;
            }
            #endregion

            #region handle the reference field
            if (dfReference.Visible || origin == "FormCreate" || cmbRefAcctType.Visible)
            {

                if (dfReference.Visible)
                {
                    if (lblRefAccount.Location.X == baseXLoc)
                    {
                        miscFieldList.Add(cmbRefAcctType);
                        miscShiftXFactor[miscFieldCount] = 1;
                        miscYLoc[miscFieldCount++] = baseYLoc;
                    }
                }
                else
                {
                    if (cmbRefAcctType.Visible)
                    {
                        miscFieldList.Add(cmbRefAcctType);
                        miscShiftXFactor[miscFieldCount] = -1;
                        miscYLoc[miscFieldCount++] = baseYLoc;
                    }
                }

                miscFieldList.Add(dfReference);
                miscShiftXFactor[miscFieldCount] = 0;
                miscYLoc[miscFieldCount++] = baseYLoc;

                baseYLoc = baseYLoc + shiftY;
            }
            #endregion

            #region handle the inventory type field #140772
            if (cmbInventoryType.Visible)    // || origin == "FormCreate") //#21564
            {

                miscFieldList.Add(cmbInventoryType);
                miscShiftXFactor[miscFieldCount] = 0;
                miscYLoc[miscFieldCount++] = baseYLoc;

                baseYLoc = baseYLoc + shiftY;
            }
            #endregion

            #region set the X/Y locations
            miscFieldCount = miscFieldList.Count;
            for (int i = 0; i < miscFieldCount; i++)
            {
                controlList = GetAssocControls("SetLocation", miscFieldList[i] as Control);
                foreach (Control control in controlList)
                {
                    oldPoint = control.Location;
                    if (control is PLabel)
                        shiftX = (miscShiftXFactor[i] * labelLocXShift);
                    else
                        shiftX = (miscShiftXFactor[i] * controlLocXShift);

                    control.Location = new Point(oldPoint.X + shiftX, miscYLoc[i]);
                }
            }
            #endregion

            #endregion

            #region set the Y location of amt fields

            #region add the visible controls in the tab index sorted order
            foreach (Control amtField in amtFields)
            {
                //if (amtField != dfInterestPaid
                //    && amtField != dfCCAmt
                //    && amtField != dfPenaltyAmt
                //    && amtField != dfWithholdingAmt) //#140782
                if (IsPrimaryAmtField(amtField))
                {
                    if (amtField.Visible || origin == "FormCreate")
                    {
                        amtFieldList.Add(amtField);
                    }
                }

            }

            amtFieldCount = amtFieldList.Count;
            for (int i = 0; i < amtFieldCount; i++)
            {
                for (int j = i; j < amtFieldCount; j++)
                {
                    if ((amtFieldList[j] as Control).TabIndex < (amtFieldList[i] as Control).TabIndex)
                    {
                        curControl = amtFieldList[j] as Control;
                        amtFieldList.RemoveAt(j);
                        amtFieldList.Insert(i, curControl);
                    }
                }
            }
            #endregion

            #region add the invisible controls in the order which they appear
            foreach (Control amtField in amtFields)
            {
                //if (amtField != dfInterestPaid
                //    && amtField != dfCCAmt
                //    && amtField != dfPenaltyAmt
                //    && amtField != dfWithholdingAmt) // #140782
                if (IsPrimaryAmtField(amtField))
                {
                    if (!amtField.Visible)
                    {
                        //amtFieldList.Add( amtField );
                    }
                }
            }
            if (dfCCAmt.Visible)
                amtFieldList.Add(dfCCAmt);
            if (dfWithholdingAmt.Visible) // #140782
                amtFieldList.Add(dfWithholdingAmt);

            #endregion

            // Begin #74015
            if (amtFieldList.Contains(dfOnUsChks))
            {
                onUsControlsOne.Add(lblOnUsTitle1);
                onUsControlsOne.Add(dfOnUsTitle1);
                onUsControlsOne.Add(onUsBar); // #12868
                onUsControlsOne.Add(dfOnUsSignatures);
                onUsControlsTwo.Add(lblOnUsTitle2);
                onUsControlsTwo.Add(dfOnUsTitle2);
                // #80620 - Commented onUsControlsTwo.Add(dfOnUsAlerts);
            }
            // End #74015

            #region set the Y location
            locPosition = 0;
            foreach (Control amtField in amtFieldList)
            {
                controlList = GetAssocControls("SetLocation", amtField);
                foreach (Control control in controlList)
                {
                    oldPoint = control.Location;

                    // Begin #74015
                    //control.Location = new Point(oldPoint.X, baseYLoc + (shiftY * locPosition));
                    if (control != dfOnUsTitle1
                            || control != dfOnUsTitle2
                            || control != dfOnUsAlerts
                            || control != dfOnUsSignatures
                            || control != lblOnUsTitle2
                            || control != lblOnUsTitle1)
                        control.Location = new Point(oldPoint.X, baseYLoc + (shiftY * locPosition) + ((shiftY - spaceY - control.Size.Height) / 2));

                    // End #74015
                }
                //Begin #76425
                #region set the X/Y locations
                if (_tlTranSet.AdTlTc != null && _tlTranSet.CurTran != null && _tlTranSet.CurTran.TranAcct != null &&
                    _tlTranSet.IsRecalcPmtRequired())
                {
                    if ((_tlTranSet.AdTlTc.NetAmtTabs.Value > 0 &&
                    _tlTranSet.AdTlTc.CashOutTabs.Value > 0 &&
                    _tlTranSet.AdTlTc.CashOutTabs.Value > _tlTranSet.AdTlTc.NetAmtTabs.Value) ||
                    ((_tlTranSet.AdTlTc.CashOutTabs.IsNull || _tlTranSet.AdTlTc.NetAmtTabs.IsNull) && _tlTranSet.AdTlTc.DefaultMath.Value == 5))
                    {
                        if (amtField == dfCashOut)
                        {
                            controlList = GetAssocControls("SetLocation", cmbRecalcPmtDt);
                            if (controlList.Count > 0)
                                locPosition++;
                            //
                            foreach (Control control in controlList)
                            {
                                oldPoint = control.Location;
                                if (control is PLabel)
                                    shiftX = (0 * labelLocXShift);
                                else
                                    shiftX = (0 * controlLocXShift);

                                //control.Location = new Point(oldPoint.X + shiftX, 0);
                                control.Location = new Point(oldPoint.X, baseYLoc + (shiftY * locPosition) + ((shiftY - spaceY - control.Size.Height) / 2));
                            }
                            amtPlusMiscList.AddRange(controlList); //#10423
                        }
                    }
                    else if (_tlTranSet.AdTlTc.NetAmtTabs.Value == 0 || _tlTranSet.AdTlTc.NetAmtTabs.Value > _tlTranSet.AdTlTc.CashOutTabs.Value || _tlTranSet.AdTlTc.DefaultMath.Value == 7)
                    {
                        if (amtField == dfAmt)
                        {
                            controlList = GetAssocControls("SetLocation", cmbRecalcPmtDt);
                            if (controlList.Count > 0)
                                locPosition++;
                            //
                            foreach (Control control in controlList)
                            {
                                oldPoint = control.Location;
                                if (control is PLabel)
                                    shiftX = (0 * labelLocXShift);
                                else
                                    shiftX = (0 * controlLocXShift);

                                //control.Location = new Point(oldPoint.X + shiftX, 0);
                                control.Location = new Point(oldPoint.X, baseYLoc + (shiftY * locPosition) + ((shiftY - spaceY - control.Size.Height) / 2));
                            }
                            amtPlusMiscList.AddRange(controlList); //#10423
                        }
                    }
                }
                #endregion
                //End #76425
                //
                locPosition++;
            }

            if (amtFieldList.Contains(dfOnUsChks))
            {
                //if (amtFields.Contains(dfTransitChks) && amtFields.Contains(dfCashOut))
                //    baseYLoc = dfOnUsChks.Location.Y + shiftY;
                //else
                //    baseYLoc = lblDescription.Location.Y + (shiftY * locPosition);

                foreach (Control control in onUsControlsOne)
                {
                    oldPoint = control.Location;
                    control.Location = new Point(oldPoint.X, baseYLoc + (shiftY * locPosition) + ((shiftY - spaceY - control.Size.Height) / 2));
                }
                locPosition++;
                foreach (Control control in onUsControlsTwo)
                {
                    oldPoint = control.Location;
                    control.Location = new Point(oldPoint.X, baseYLoc + (shiftY * locPosition) + ((shiftY - spaceY - control.Size.Height) / 2));
                }
                amtPlusMiscList.AddRange(onUsControlsOne); //#10423
                amtPlusMiscList.AddRange(onUsControlsTwo); //#10423
            }

            #endregion

            #endregion
            #region #10423 - make sure check number does not intersect with any other controls....
            amtPlusMiscList.AddRange(amtFieldList);
            amtPlusMiscList.AddRange(miscFieldList);
            if (dfCheckNo.Visible == true)
            {
                if (!cmbInventoryType.Visible)  //#140772
                {
                    Point origCheckNoLocation = new Point(dfCheckNo.Location.X, dfCheckNo.Location.Y);
                    Point origCheckLblLocation = new Point(lblItems.Location.X, lblItems.Location.Y);

                    foreach (Control amtField in amtPlusMiscList)
                    {
                        controlList = GetAssocControls("SetLocation", amtField);
                        foreach (Control control in controlList)
                        {
                            if (control.Name != "dfCheckNo" && control.Visible == true && control.Bounds.IntersectsWith(new Rectangle(dfCheckNo.Location, dfCheckNo.Size)))
                            {
                                // First try moving the control up one spot....
                                dfCheckNo.Location = new Point(dfCheckNo.Location.X, dfCheckNo.Location.Y - (shiftY) - ((shiftY - spaceY - dfCheckNo.Size.Height) / 2));
                                lblItems.Location = new Point(lblItems.Location.X, lblItems.Location.Y - (shiftY));
                                // Now make sure we're not intersecting with another control after being moved....
                                foreach (Control chkFld in amtPlusMiscList)
                                {
                                    controlList = GetAssocControls("SetLocation", chkFld);
                                    foreach (Control subControl in controlList)
                                    {
                                        // If we intersect, move down one spot until we do not intersect with anything....
                                        if (subControl.Name != "dfCheckNo" && subControl.Visible == true && subControl.Bounds.IntersectsWith(new Rectangle(dfCheckNo.Location, dfCheckNo.Size)))
                                        {
                                            dfCheckNo.Location = new Point(dfCheckNo.Location.X, dfCheckNo.Location.Y + (shiftY) + ((shiftY - spaceY - dfCheckNo.Size.Height) / 2));
                                            lblItems.Location = new Point(lblItems.Location.X, lblItems.Location.Y + (shiftY) + ((shiftY - spaceY - lblItems.Size.Height) / 2));
                                        }
                                    }
                                    // If we've moved the control off the viewable area of the form, put it back to its original location....
                                    if (dfCheckNo.Location.Y > 259)
                                    {
                                        dfCheckNo.Location = new Point(dfCheckNo.Location.X, origCheckNoLocation.Y);
                                        lblItems.Location = new Point(lblItems.Location.X, origCheckLblLocation.Y);
                                    }
                                }
                                break; // We only want to move up one time, so break out of the outer loop....
                            }
                        }
                    }
                }
                if (cmbInventoryType.Visible || origin == "FormCreate")   //#140772
                {
                    if (dfNoInvAvailable.Visible == true)
                    {
                        Point origNoInvAvailLocation = new Point(dfNoInvAvailable.Location.X, dfNoInvAvailable.Location.Y);
                        Point origNoInvAvailLblLocation = new Point(lblNoInvAvailable.Location.X, lblNoInvAvailable.Location.Y);
                        lblItemsXPos = (lblNoInvAvailable.Text.Length < lblItems.Text.Length ? lblItems.Text.Length - lblNoInvAvailable.Text.Length : lblNoInvAvailable.Text.Length - lblItems.Text.Length);

                        dfNoInvAvailable.Location = new Point(dfCheckNo.Location.X, dfCheckNo.Location.Y);
                        lblNoInvAvailable.Location = new Point(lblItems.Location.X, lblItems.Location.Y);

                        dfCheckNo.Location = new Point(origNoInvAvailLocation.X, origNoInvAvailLocation.Y);
                        lblItems.Location = new Point(lblNoInvAvailable.Location.X, origNoInvAvailLblLocation.Y);
                    }
                }
            }
            #endregion #10423

            //Begin #79496
            //show the on-us acct type/ acct # next to amount field for offset accounts
            if (!_tlTranSet.IsCompVisible(dfOnUsChks.XmlTag) && _tlTranSet.OnUsIsCustomOffset() && origin == "TranCodeSelect")
            {
                //Begin #17716
                //cmbTfrAcctType.Location = new Point(cmbTfrAcctType.Location.X, dfAmt.Location.Y);
                //dfTfrAcctNo.Location = new Point(dfTfrAcctNo.Location.X, dfAmt.Location.Y);
                controlList = GetCustomGLOffSetAcctFields();
                foreach (Control control in controlList)
                {
                    control.Location = new Point(control.Location.X, dfAmt.Location.Y);
                }
                if (_tlTranSet.CurTran.TranCode.Value == 505 || _tlTranSet.CurTran.TranCode.Value == 555)
                {
                    if (dfCheckNo.Location.Y == dfAmt.Location.Y)
                    {
                        int checkNoYLoc = dfCCAmt.Location.Y;
                        if (!_tlTranSet.IsCompVisible(dfCCAmt.XmlTag))
                            checkNoYLoc = dfOnUsChks.Location.Y;

                        dfCheckNo.Location = new Point(dfCheckNo.Location.X, checkNoYLoc);
                        lblItems.Location = new Point(lblItems.Location.X, checkNoYLoc);
                    }
                }
                //End #17716
            }
            else if (origin == "FormCreate" && dfOnUsChks.Location.Y != cmbTfrAcctType.Location.Y)
            {
                //Begin #17716
                //cmbTfrAcctType.Location = new Point(cmbTfrAcctType.Location.X, dfOnUsChks.Location.Y);
                //dfTfrAcctNo.Location = new Point(dfTfrAcctNo.Location.X, dfOnUsChks.Location.Y);
                controlList = GetCustomGLOffSetAcctFields();
                foreach (Control control in controlList)
                {
                    control.Location = new Point(control.Location.X, dfOnUsChks.Location.Y);
                }
                dfCheckNo.Location = new Point(dfCheckNo.Location.X, dfAmt.Location.Y);
                lblItems.Location = new Point(lblItems.Location.X, dfAmt.Location.Y);
                //End #17716
            }
            //End #79496

            if (dfReference.Visible)
            {
                cmbInventoryType.Location = new Point(cmbInventoryType.Location.X, dfReference.Location.Y + (shiftY * 1) + ((shiftY - spaceY - cmbInventoryType.Size.Height) / 2));
            }
            else if (dfTranDescription.Visible)
            {
                cmbInventoryType.Location = new Point(cmbInventoryType.Location.X, dfTranDescription.Location.Y + (shiftY * 1) + ((shiftY - spaceY - cmbInventoryType.Size.Height) / 2));
            }
        }

        private void SetCheckNoLabel(string origin)
        {
            short tranCode = _tlTranSet.CurTran.TranCode.Value;

            //#12551
            if (_tlTranSet.CurTran.TlTranCode.Value == "VLT" ||
                _tlTranSet.CurTran.TlTranCode.Value == "VLS")
                lblItems.Width = 108;
            else
                lblItems.Width = 64;
            if (tranCode != 938 && tranCode != 939) //#140772
                lblItems.Location = new Point(dfCheckNo.Location.X - lblItems.Width, dfCheckNo.Location.Y + 4);
            //
            if (_tlTranSet.CurTran.TlTranCode.Value == "VLT") //#72916* #79574 -ML change
                lblItems.Text = CoreService.Translation.GetUserMessageX(361101);
            else if (_tlTranSet.CurTran.TlTranCode.Value == "VLS") //#79574 -ML change
                lblItems.Text = CoreService.Translation.GetUserMessageX(11635);
            else if (tranCode == 505 || tranCode == 555)
                lblItems.Text = CoreService.Translation.GetUserMessageX(360190);
            else if (tranCode == 912 || tranCode == 915 || tranCode == 918 || tranCode == 921 || tranCode == 938 || tranCode == 939)    //#140772 - added 938 and 939
                lblItems.Text = CoreService.Translation.GetUserMessageX(360192);
            else if (_tlTranSet.CurTran.TranAcct.AcctRecon.Value == GlobalVars.Instance.ML.Y)
                lblItems.Text = CoreService.Translation.GetUserMessageX(360191);
            else
                lblItems.Text = CoreService.Translation.GetUserMessageX(360546);

        }
        //Begin #76043
        private void SetFeeAmountLabel(string origin)
        {
            short tranCode = _tlTranSet.CurTran.TranCode.Value;
            if ((tranCode == 300 || tranCode == 301 || tranCode == 304 ||
                tranCode == 345) && _tlTranSet.CurTran.PostRealTime.Value == 1)
            {
                lblFeeAmount.Text = CoreService.Translation.GetUserMessageX(361201); //Loan Charges:
            }
            else
                lblFeeAmount.Text = CoreService.Translation.GetUserMessageX(361202); //Charges:
        }
        //End #76043

        //67882
        private void SetRefAcctLabel(string origin)
        {
            short tranCode = _tlTranSet.CurTran.TranCode.Value;

            if (tranCode == 928)
                lblRefAccount.Text = CoreService.Translation.GetUserMessageX(360714); // Chg Account:
            else
                lblRefAccount.Text = CoreService.Translation.GetUserMessageX(360713); // Ref Account:
        }

        private void SetInvNoItemsLabel()   //#140772
        {
            short tranCode = _tlTranSet.CurTran.TranCode.Value;

            if (tranCode == 938)
                lblNoInvAvailable.Text = CoreService.Translation.GetUserMessageX(13972); // # Available:
            else
                lblNoInvAvailable.Text = CoreService.Translation.GetUserMessageX(13973); // # Sold:
        }

        private void SetPacketSerialLabel()   //#140772
        {
            if (_adGbInventoryType != null && _adGbInventoryType.Class.Value == CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Packet"))
                lblPacket.Text = CoreService.Translation.GetUserMessageX(13993); // Packet:
            else
                lblPacket.Text = CoreService.Translation.GetUserMessageX(13994); // Serial #:
        }

        private void RecordFailedAccess(int rimNo)
        {
            if (rimNo <= 0)
                return;

            _adGbRsmFailedAccess = new AdGbRsmFailedAccess();
            _adGbRsmFailedAccess.ActionType = XmActionType.New;
            _adGbRsmFailedAccess.RimNo.Value = rimNo;
            //_adGbRsmFailedAccess.EmployeeId.Value = _tlTranSet.TellerVars.EmployeeId;//Task #120093
            _adGbRsmFailedAccess.EmployeeId.Value = Convert.ToInt16(GlobalVars.EmployeeId);//Task #120093
            _adGbRsmFailedAccess.AccessTime.Value = System.DateTime.Now;
            _adGbRsmFailedAccess.CopyBackStatus.Value = 1;

            CallXMThruCDS("RecordFailedAccess");

        }

        private bool CheckForPendingValidation(Control sender)
        {
            //#74562 - Fixed the annoying account validation message pop-up and invalid account flag
            if (vldnFailedCntrl == dfAcctNo && (dfAcctNo.Text == "" || dfAcctNo.Text == string.Empty) && invalidAcctNo != string.Empty) //Selva
            {
                vldnFailedCntrl = null;
                invalidAcctNo = null;
            }

            if (sender is PImageButton && picTabs.SelectedIndex != 0)
                return true;

            if (sender is PImageButton && !sender.Focused)
            {
                sender.Focus();					// this will trigger pending validation
            }

            if (this.vldnFailedCntrl != null)
            {
                vldnFailedCntrl.Focus();
                return false;
            }

            return true;
        }

        private void AttachEventForChildControls()
        {
            if (eventInitialized)
                return;
            foreach (Control control in dfTransactionInformation.Controls)
            {
                control.GotFocus += new EventHandler(Control_GotFocus);
            }
            foreach (Control control in gbAccountInformation.Controls)
            {
                control.GotFocus += new EventHandler(Control_GotFocus);
            }
            ActionSave.ImageButton.GotFocus += new EventHandler(Control_GotFocus);

            foreach (PAction action in ActionManager.Actions)
            {
                action.ImageButton.GotFocus += new EventHandler(Action_GotFocus);
            }
            eventInitialized = true;
        }

        private void SuspendPaint(Control contControl, bool suspend)
        {
            foreach (Control control in contControl.Controls)
            {
                if (suspend)
                    control.SuspendLayout();
                else
                    control.ResumeLayout(true);
            }
        }

        private void AddLastAcct()
        {
			//Begin #79572
			if (isNonCust())
				return;
			//End #79572

            Phoenix.Shared.Variables.AcctInfo acctInfo = null;
            string acctType = null;
            string acctNo = null;
            bool addAcct = false;
            string realAcctNo = ""; //#76458

            foreach (TlTransaction tran in _tlTranSet.Transactions)
            {
                if (_tlTranSet.TellerVars.LastAccts.Count > 0)
                    acctInfo = _tlTranSet.TellerVars.LastAccts[0] as Phoenix.Shared.Variables.AcctInfo;

                if (acctTypeSrch)
                {
                    acctType = tran.TranAcct.AcctType.Value;
                }
                else
                {
                    acctType = tran.TranAcct.ApplType.Value;
                }

                acctNo = tran.TranAcct.AcctNo.Value;
                realAcctNo = acctNo; //Begin #76458

                if (tran.TranAcct.TranCode.Value == 520 || tran.TranAcct.TranCode.Value == 570)
                {
                    acctNo = _gbHelper.GetMaskedExtAcct(acctType, realAcctNo);
                }
                //End #76458


                addAcct = true; // 8914 begin

                if (acctInfo != null)
                {
                    //8914 if (acctType != acctInfo.AcctType || realAcctNo != acctInfo.RealAcctNo) // #76458
                    if ((acctType == acctInfo.AcctType && realAcctNo == acctInfo.RealAcctNo)
                        || string.IsNullOrEmpty(acctNo))
                    {
                        addAcct = false;
                    }
                }
                // 8914 end

                // Begin #76041
                #region #9805
                if (tran.TranAcct.AcctNickname.IsNull)
                    tran.TranAcct.AcctNickname.Value = "";
                #endregion

                // #9805 - Changed to check for null or empty nickname....
                if (_tlTranSet.TellerVars.IsAppOnline && string.IsNullOrEmpty(tran.TranAcct.AcctNickname.Value.Trim()) || _tlTranSet.TellerVars.AdTlControl.DisplayNicknames.Value == GlobalVars.Instance.ML.N)
                {
                    //Begin #2031 - moved the following nickname collection logic under the deploan condition
                    if (!tran.TranAcct.DepLoan.IsNull && (tran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP ||
                        tran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.LN || tran.TranAcct.DepLoan.Value == "EX"))
                    {
                        tran.TranAcct.GetAcctNoNicknameDetails();
                        //#3538 begin
                        for (int loop = 0; loop < tran.TranAcct.NicknameAcctList.Count; loop++)
                        {
                            if (tran.TranAcct.NicknameAcctList[loop].ToString() == tran.TranAcct.AcctNo.Value.ToString())
                            {
                                tran.TranAcct.AcctNickname.Value = tran.TranAcct.NicknameAcctList[loop + 4].ToString();
                                loop = tran.TranAcct.NicknameAcctList.Count;
                            }
                        }
                        //#3538 end
                    }
                    //End #2031
                }

                if (addAcct)
                {
					//Begin #79156
					string sName = "";
                    if (_tlTranSet.TellerVars.AdTlCls.ShowTitles.Value == "Y")
					{
                        if (_tlTranSet.TellerVars.AdTlCls.MapRimCust.Value == "Y")
                        {
                           /* Begin - 84704 */
                           // sName =tran.TranAcct.PrimaryRimFirstName.Value + " " + tran.TranAcct.PrimaryRimMiddleInitial.Value + " " + tran.TranAcct.PrimaryRimLastName.Value; //#34405
                            sName = tran.TranAcct.PrimaryRimTitle.Value + " " + tran.TranAcct.PrimaryRimFirstName.Value + " " + tran.TranAcct.PrimaryRimMiddleInitial.Value + " " + tran.TranAcct.PrimaryRimLastName.Value + " " + tran.TranAcct.PrimaryRimSuffix.Value; //#34405
                            /* End - 84704 */
                        }
                        else if (tran.TranAcct.AcctType.Value == "RIM") //9110 begin
                        {
                            /*Begin -#78421 */
                            //sName = tran.TranAcct.GetNameTitle();
                            /*Begin - 84704 */
                            //sName = _gbHelper.ConcateNameX(tran.TranAcct.Title1.Value,
                            //                                tran.TranAcct.Title3.Value,
                            //                                tran.TranAcct.Title2.Value,
                            //                                false);
                            /*End -#78421` */
                            sName = tran.TranAcct.PrimaryRimTitle.Value + " " + _gbHelper.ConcateNameX(tran.TranAcct.Title1.Value,
                                                            tran.TranAcct.Title3.Value,
                                                            tran.TranAcct.Title2.Value,
                                                            false) + " " + tran.TranAcct.PrimaryRimSuffix.Value;
                            /*End - 84704 */
                        }
                        else if (tran.TranAcct.Title1.IsNull == false) //9110  end
                        {
                            sName = tran.TranAcct.Title1.Value;
                        }

					}
					//End #79156
                    //begin #34405
                    string sOwner = ""; 
                    if (_tlTranSet.TellerVars.AdTlCls.ShowTitles.Value == "Y")
                    {
                        if (_tlTranSet.TellerVars.AdTlCls.MapRimCust.Value == "Y")
                        {
                            sOwner = tran.TranAcct.RimFirstName.Value + " " + tran.TranAcct.RimMiddleInitial.Value + " " + tran.TranAcct.RimLastName.Value;
                        }
                        else if (tran.TranAcct.AcctType.Value == "RIM") //9110 begin
                        {
                            /*Begin -#78421  */
                            //sOwner = tran.TranAcct.GetNameTitle();
                            /*Begin - 84704 */
                            //sOwner = _gbHelper.ConcateNameX(tran.TranAcct.Title1.Value,
                            //                                tran.TranAcct.Title3.Value,
                            //                                tran.TranAcct.Title2.Value,
                            //                                false);
                            /*End- #78421 */

                            sOwner = tran.TranAcct.PrimaryRimTitle.Value + " " + _gbHelper.ConcateNameX(tran.TranAcct.Title1.Value,
                                                               tran.TranAcct.Title3.Value,
                                                               tran.TranAcct.Title2.Value,
                                                               false) + " " + tran.TranAcct.PrimaryRimSuffix.Value;
                            /*Begin - 84704 */
                        }
                        else if (tran.TranAcct.Title1.IsNull == false) //9110  end
                        {
                            sOwner = tran.TranAcct.Title1.Value;
                        }

                    }
                    //end   #34405
                    // #2241 - Do not add nickname if acct is not DP or LN
                    //8914
                    _tlTranSet.TellerVars.LastAccts.Insert(
                            0,
                            new Phoenix.Shared.Variables.AcctInfo(acctType,
                                acctNo,
                                (tran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP
                                || tran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.LN
                                || tran.TranAcct.DepLoan.Value == "EX") ? tran.TranAcct.AcctNickname.Value : string.Empty,
                                tran.TranAcct.PrimaryRimNo.Value,
                                realAcctNo,
                                sName,
                                sOwner,
                                (picTabs.SelectedTab == tabEasyCapture ? "Quick" : "Input")) //89989
                            );   //#76458 - added realAcctNo    //#34405

                    //#2241 - Reset the nickname just to make sure because Teller is a clusterf***
					tran.TranAcct.AcctNickname.SetValue(null, EventBehavior.None);		// #6615 - tran.TranAcct.AcctNickname.SetValueToNull();
                }
                // End #76041

            }

        }

        private bool SetAcctFields(string acctType, string acctNo, PdfStandard acctNoField, PComboBoxStandard acctTypeField,
            TlAcctDetails acctDetails, Control focusField)  
        {
            //#180274.2
            // Overload for Rim No.
            return SetAcctFields(
                acctType,
                acctNo,
                acctNoField,
                acctTypeField,
                acctDetails,
                focusField,
                int.MinValue);  
        }

        private bool SetAcctFields(string acctType, string acctNo, PdfStandard acctNoField, PComboBoxStandard acctTypeField,
            TlAcctDetails acctDetails, Control focusField, int rimNo)  //#180274.1
        {
            bool retValue = false;
            acctTypeField.CodeValue = acctType;
            if (acctTypeField.SelectedIndex >= 0)
            {
                SetMask(acctTypeField, acctNoField);
                if (acctNo != null && acctNo != String.Empty)
                {
                    retValue = SetAcctNoField(acctNo, acctNoField, acctTypeField, acctDetails, rimNo);  //#180274.1
                }
                else
                {
                    if (acctTypeField == cmbAcctType)
                    {
                        cmbAcctType_Validating(null, null);
                    }

                    retValue = true;
                }
                if (retValue && focusField != null)
                    focusField.Focus();
                if (!retValue)
                    acctNoField.Modified = true;

            }
            return retValue;
        }

        private void SetTotalsFieldLocation()
        {
            int yLoc = dfTotalCredits.Location.Y + 124;
            int xShift = 4;

            lblTotalCredits1.Location = new Point(lblTotalCredits.Location.X + xShift, yLoc);
            lblTotalDebits1.Location = new Point(lblTotalDebits.Location.X + xShift, yLoc);
            lblDifference1.Location = new Point(lblDifference.Location.X + xShift, yLoc);
            dfTotalCredits1.Location = new Point(dfTotalCredits.Location.X + xShift, yLoc);
            dfTotalDebits1.Location = new Point(dfTotalDebits.Location.X + xShift, yLoc);
            dfDifference1.Location = new Point(dfDifference.Location.X + xShift, yLoc);
        }

        private void SetWaiveSignatureLocation()    //#76033
        {
            // Begin 5204
            return;
            //int tcdDenominate = cbDenominate.Location.X;
            //int waiveSig = cbWaiveSignature.Location.X;
            ////
            //if (_tlTranSet.ShowWaiveSignatureBox() && !cbDenominate.Visible)
            //{
            //    if (waiveSig > tcdDenominate)
            //    {
            //        cbWaiveSignature.Location = new Point(tcdDenominate, cbWaiveSignature.Location.Y);
            //        cbDenominate.Location = new Point(waiveSig, cbDenominate.Location.Y);
            //    }
            //}
            //else if (_tlTranSet.ShowWaiveSignatureBox())
            //    cbWaiveSignature.Location = new Point(cbWaiveSignature.Location.X, cbWaiveSignature.Location.Y);
            // End 5204
        }

        private void AddImages()
        {
            if (NotificationManager.Actions.Count > 0)
                NotificationManager.Actions.Clear();
            iconCaution.Image = Alerts.Acct_Caution;    // 32891 TellerImages.Caution;
            iconHold.Image = Alerts.Acct_Hold;          // 32891 TellerImages.Hold;
            iconNSF.Image = Alerts.Acct_Nsf;            // 32891 TellerImages.NSF;
            iconRealTime.Image = TellerImages.RealTime;
            iconREJ.Image = Alerts.Acct_Reject;         // 32891 TellerImages.REJ;
            iconRetirement.Image = Alerts.Acct_Umb;     // 32891 TellerImages.Retirement;
            iconStop.Image = Alerts.Acct_Stop;          // 32891 TellerImages.Stop;
            iconSweep.Image = Alerts.Acct_Sweep;        // 32891 TellerImages.Sweep;
            iconUCF.Image = Alerts.Acct_Ucf;            // 32891 TellerImages.UCF;
            iconSigner.Image = TellerImages.CustomerImage16;    // 32891
            picRealTime.Image = TellerImages.RealTime;
            //picMemo.Image = TellerImages.Memo;
            iconAnalysis.Image = Alerts.Acct_Analysis;   // 32891 TellerImages.Analysis;
            picDrawer.Image = TellerImages.Drawer; //#72916
            picTCD.Image = TellerImages.TCDSmall; //#72916 // #17048
            //picDrawer1.Image = TellerImages.Calculator; //#72916
            //picTCD1.Image = TellerImages.Ctr; //#72916

            if (iconFields.Count == 0)
            {
                iconFields.Add(iconCaution);
                iconFields.Add(iconHold);
                iconFields.Add(iconNSF);
                iconFields.Add(iconRealTime);
                iconFields.Add(iconREJ);
                iconFields.Add(iconRetirement);
                iconFields.Add(iconStop);
                iconFields.Add(iconSweep);
                iconFields.Add(iconUCF);
                iconFields.Add(iconSigner);
                iconFields.Add(iconAnalysis);
            }
        }

        public override void CallParent(params object[] paramList)
        {
            string caller = "";
            string callers = "";/*Bug #111419*/
            if (paramList != null && paramList.Length > 0 && paramList[0] != null)
                caller = Convert.ToString(paramList[0]);
            /*Begin Bug #111419*/
            if (paramList != null && paramList.Length > 1 && paramList[1] != null)
                callers = Convert.ToString(paramList[1]);
            /*End Bug #111419*/
            //Begin #140895-ReadOnly
            if (_tlTranSet != null && _tlTranSet.IsTellerCaptureTran && (caller == "RedemptionOut" || caller == "Calculator"))  //Task #124027 - Added a null check for Workflow Wrapper window
                return;
            //End #140895-ReadOnly

			if (caller == "ItemCapture")
            {
                //Begin #87743
                if (picTabs.SelectedTab == tabEasyCapture)
                {
                    if (_quickTranWindow.TranSet != null && _quickTranWindow.TranSet.ChecksTran != null &&
                        _quickTranWindow.TranSet.ChecksTran.MappedTranIndex > 0)
                    {
                        //_tlTranSet.IsTellerQuickTran = true;  // to turn off default field calculation
                        _tlTranSet.GetItemTotals();
                        //_tlTranSet.IsTellerQuickTran = false;
                    }
                    return;
                }
                //End #87743

                #region ItemCapture
                MoveAmtScreensToObject();
                _tlTranSet.GetItemTotals();
                MoveAmtObjectsToScreen();
                if (_tlTranSet.CurTran.Items.Count > 0)
                    EnableDisableControls("ItemCaptureClick");

                #endregion
            }
            else if (caller == "Charges")
            {

                //Begin #92886
                if (picTabs.SelectedTab == tabEasyCapture)
                {
                    var tran = (_quickTranWindow.CurTranId > 0 ? _quickTranWindow.GetCurrentEasyCaptureTran(_quickTranWindow.CurTranId) : _quickTranWindow.GetCurrentEasyCaptureTran());

                    if (tran != null && tran.MappedTranIndex > 0)
                    {
                        //_tlTranSet.IsTellerCaptureTran = true;  // to turn off default field calculation
                        _tlTranSet.CalculateCharges();
                        //_tlTranSet.IsTellerCaptureTran = false;
                        tran.CcAmt = _tlTranSet.CurTran.CcAmt.Value;
                    }
                    return;
                }
                //End #92886

                #region Charges
                //CalcDefaultField( dfCCAmt);
                MoveAmtScreensToObject();
                _tlTranSet.CalculateCharges();
                CalcDefaultField(dfCCAmt); //#71278
                MoveAmtObjectsToScreen();
                #endregion
            }
            else if (caller == "CTRTransactor")
            {
                #region CTRTransactor

                if (paramList[1] != null)
                {
                    if (Convert.ToInt32(paramList[1]) >= 0)
                    {
                        _tlTranSet.AddTransactor(Convert.ToInt32(paramList[1]));
                        //Begin #9449
                        if (isNonCust())
							triggerOwnBehalf = false;
						//End #9449
                    }
                }
                //Begin Bug#73424 //Begin Task#56865
                //Task #70707 added if else condition moved the existing code to if Part.
                if (!IsNonCustCTR)
                {
                    //End Bug#73424 //End Task#56865
                    if (DialogResult.Yes == PMessageBox.Show(319118, MessageType.Question, MessageBoxButtons.YesNo,
                    String.Empty))
                    {
                        CallOtherForms("CTRTransactor");
                    }
                    else
                    {
                        CollectTransactors();
                    }
                    //Begin Bug#73424 //Begin Task#56865
                }
                else
                {
                    CollectTransactors();
                }
                // End Bug#73424 //End Task#56865
                #endregion

            }
            else if (caller == "RedemptionIn")
            {
                #region RedemptionIn
                if (dfTranEffectiveDt.UnFormattedValue != null && dfTranEffectiveDt.UnFormattedValue.ToString() != String.Empty)
                    (paramList[1] as PDateTime).Value = Convert.ToDateTime(dfTranEffectiveDt.UnFormattedValue);

                #endregion
            }
            else if (caller == "RedemptionOut")
            {
                #region RedemptionOut

                dfCheckNo.UnFormattedValue = Convert.ToInt32(paramList[1]);
                dfInterestPaid.UnFormattedValue = Convert.ToDecimal(paramList[2]);
                dfAmt.UnFormattedValue = Convert.ToDecimal(paramList[3]);
                CalcDefaultField(dfAmt);
                #endregion
            }
            else if (caller == "Calculator")
            {
                #region Calculator

                //Begin 89907
                if (calcControl == null)
                {
                    if (picTabs.SelectedIndex == (int)TAB.QuickTran)
                        return;

                    calcControl = dfAmt;
                }

                if (picTabs.SelectedIndex == (int)TAB.QuickTran && calcControl.Name == "gcTransactions")
                {
                    //Push the calculator value back to the Quick Tran window to set the value to the amount column with the focus in the grid
                    _quickTranWindow.SetCalcValue2GridColumn(calcControl, Convert.ToDecimal(paramList[1]));
                }
                else if (calcControl is PdfCurrency)
                {
                    (calcControl as PdfCurrency).UnFormattedValue = Convert.ToDecimal(paramList[1]);

                    CalcDefaultField(calcControl as PdfCurrency);
                }
                //End 89907
                #endregion
            }
            else if (caller == "OdCcOverride")
            {
                #region OdCcOverride

                //_resetEvent.Set();
                if (paramList.Length > 1)
                {

                    dialogResultOdCc = (DialogResult)paramList[1];
                }
                #endregion
            }
            else if (caller == "Override")
            {
                #region Override
                //_resetEvent.Set();
                if (paramList.Length > 1)
                {
                    if (Convert.ToBoolean(paramList[1]) == true)
                        dialogResult = DialogResult.OK;
                    else
                        dialogResult = DialogResult.Cancel;

                    //Begin Task#97603
                    if(picTabs.SelectedTab == tabEasyCapture)
                    {
                        if (dialogResult == DialogResult.Cancel)
                            //If there transacions already in the grid, do not clear quick tran window.
                            if (_quickTranWindow.TranSet != null && _quickTranWindow.TranSet.Transactions.Count == 0) //Bug#99140
                                _quickTranWindow.InitializeTranSet();
                    }
                    //End Task#97603

                    //Begin #9568
                    else if (dialogResult == DialogResult.Cancel && isNonCustAllowed && dfQuickTranCode.Text == "")
                    {
                        //cmbTranCode.SetValue(null);
                        //dfQuickTranCode.SetValue(null);
                        cmbTranCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Disable);
                        dfQuickTranCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Disable);

                    }
                    //End #9568
                    //Begin #9539
                    else if (dialogResult == DialogResult.OK && isNonCustAllowed && dfQuickTranCode.Text == "")
                    {
                        cmbTranCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Enable);
                        dfQuickTranCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Enable);
                    }
					//End #9539

                    if (dialogResult == DialogResult.Cancel)    //#16909
                    {
                        _tlTranSet.RemoveSuspenseOverridesAfterCancel();
                    }

                }
                #endregion
            }
            else if (callers == "CashDenom") /*Bug #111419*/
            {
                #region CashDenom
                if (paramList.Length > 2) /*Bug #111419*/
                {
                    if (Convert.ToBoolean(paramList[2]) == true) /*Bug #111419*/
                        dialogResult = DialogResult.OK;
                    else
                        dialogResult = DialogResult.Cancel;
                }
                #endregion
            }
            else if (caller == Phoenix.Shared.Constants.ScreenId.GlAccountSearch.ToString())
            {
                #region GlAccountSearch
                //140793

                PString listName = new PString("listName");
                listName.Value = "OffsetNickName";
                PInt emplId = new PInt("emplId");
                emplId.Value = BusGlobalVars.EmployeeId;                

                _gbHelper.GetAutoCompleteList(listName, emplId, out OffsetNickNameList);
                GlobalObjects.Instance[Phoenix.Shared.Variables.GlobalObjectNames.OffsetNickNameList] = OffsetNickNameList; //28160

                dfTfrAcctNo.AutoCompleteCustomSource = OffsetNickNameList;
                this.dfTfrAcctNo.AutoCompleteMode = AutoCompleteMode.Suggest;
                this.dfTfrAcctNo.AutoCompleteSource = System.Windows.Forms.AutoCompleteSource.CustomSource;
                dfAcctNo.AutoCompleteCustomSource = OffsetNickNameList;
                this.dfAcctNo.AutoCompleteMode = AutoCompleteMode.Suggest;
                this.dfAcctNo.AutoCompleteSource = System.Windows.Forms.AutoCompleteSource.CustomSource;

                if (paramList.Length > 3)
                {
                    gLSearchAcctNo = Convert.ToString(paramList[3]);
                }
                #endregion
            }
            // Begin #17047
            else if (caller == Phoenix.Shared.Constants.ScreenId.GbAccountList.ToString())
            {
                #region GbAccountList

                if (paramList.Length > 2)
                {
                    //Begin 87757
                    if (picTabs.SelectedTab == tabEasyCapture)
                    {
                        _quickTranWindow.SetGetAcctValue(Convert.ToString(paramList[1]), Convert.ToString(paramList[2]));
                    }
                    else
                    {
                    getAcctSearchAcctType = Convert.ToString(paramList[1]);
                    getAcctSearchAcctNo = Convert.ToString(paramList[2]);
                    /*Get account is not working in Input transaction Tab, When Focus is on Text Box. Existing bug Fix*/
                    if (paramList.Length > 8)
                    {
                        this.Workspace.Variables["RimNo"] = Convert.ToInt32(paramList[8]); //WI #82865. RimNo Conversion should be of int32
                    }
                    }
                    //End 87757
                }
                #endregion
            }
            // End #17047
			//Begin #79572
			else if (caller == "NonCust")
            {
                #region NonCust

                //SetAcctFields("RIM", this.Workspace.Variables["NonCustRimNo"].ToString(), dfAcctNo, cmbAcctType, new TlAcctDetails(), dfTranDescription);
				TlAcctDetails acctDetails = new TlAcctDetails();
				acctDetails.RimNo.Value = Convert.ToInt32(this.Workspace.Variables["NonCustRimNo"]);
				acctDetails.AcctType.Value = "RIM";
				acctDetails.AcctNo.Value = this.Workspace.Variables["NonCustRimNo"].ToString();
                SetAcctNoField(this.Workspace.Variables["NonCustRimNo"].ToString(), dfAcctNo, cmbAcctType, acctDetails);
				/*
				 * moved to picTabs_SelectedIndexChanged
				 * dfAcctNo.Text = this.Workspace.Variables["NonCustRimNo"].ToString();
				cmbAcctType.SetValue("RIM");
				dfAcctNo.Enabled = false;
				cmbAcctType.Enabled = false;
				_tlTranSet.CurTran.AcctType.Value = _tlTranSet.CurTran.TranAcct.AcctType.Value =  "RIM";
				_tlTranSet.CurTran.AcctNo.Value = _tlTranSet.CurTran.TranAcct.AcctNo.Value = this.Workspace.Variables["NonCustRimNo"].ToString();
				_tlTranSet.CurTran.TranAcct.RimNo.Value = Convert.ToInt32(this.Workspace.Variables["NonCustRimNo"]);
				_tlTranSet.CurTran.NonCust.Value = "Y";*/
				picTabs.SelectedIndex = 0;
                #endregion
            }
			//Begin #8723
			else if (caller == "NonCustNoRimNo")
			{

			}
			//End #8723
            //End #79572

            else if (caller == "Notes")
            {
                #region Notes #80620
                // Set alerts for Main account....
                AcctAlerts acctAlerts = null;
                acctAlerts = null;
                ((Workspace as PwksWindow).WksExtension as WkspaceExtension).SetAlertAccount(
        _tlTranSet.CurTran.TranAcct.AcctType.Value, _tlTranSet.CurTran.TranAcct.AcctNo.Value, _tlTranSet.CurTran.TranAcct.AcctId.Value, !acctHasPostAccessOnly, acctAlerts);
                UpdateView();
                //#60668. Select Row when notes window closed
                if (picTabs.SelectedIndex == (int)TAB.CustSummary && frmGloAccountListRim != null && frmGloAccountListRim.colAcctNo != null && frmGloAccountListRim.colAcctType != null)
                {
                    EnableDisableControls("AccountListSumClick");
                }     
                #endregion
            }

            //else if (caller == Convert.ToString(Phoenix.Shared.Constants.ScreenId.InventoryVerificationRequired))   //#140772
            //{
            //    #region InventoryVerificationRequired

            //    if (int.Parse(paramList[0].ToString()) == Phoenix.Shared.Constants.ScreenId.InventoryVerificationRequired)
            //    {
            //        for (int i = 0; i < _tlTranSet.TellerVars.AdGbInventoryType.SigRequiredPurchase.Value; i++)
            //        {
            //            if (int.Parse(paramList[i + 1].ToString()) <= 0)
            //            {
            //                break;
            //            }
            //            else
            //            {
            //                foreach (GbInventoryItem item in _tlTranSet.CurTran.InventoryItems)
            //                {
            //                    if (item.InvVerifier1.IsNull)
            //                        item.InvVerifier1.Value = short.Parse(paramList[i + 1].ToString());
            //                    else
            //                        item.InvVerifier2.Value = short.Parse(paramList[i + 1].ToString());
            //                }
            //            }
            //        }
            //        //PostTransactions();
            //    }
            //    #endregion
            //}
            else if (caller == Phoenix.Shared.Constants.ScreenId.DpRedempCalc.ToString())             // #140782
            {
                // CallParent is called twice by the Calculator window.
                // First call is made specifically, passing 13 params back here.
                // Second call is default from the framework after Save/Cancel pressed. We ignore it.

                #region CD Redemp Calculator  // #140782-3, 20072

                if (paramList.Length == 13)
                {
                    // NB: The parameters are stored here, however the Calculator logic is triggered in tempWin_Closed().
                    // Had to be done this way because the Calculator can change the trancode and therefore the
                    // Input Tran layout. However, the Position/Location logic requires Input Tran window to be visible.
                    // Here in CallParent(), the Calculator window is still visible and it kills the positioning logic.
                    // Everything was moved to tempWin_Close, by which time the Calculator window is destroyed.

                    _tlTranSet.CurTran.XmlDpRedempCalc.Value = Convert.ToString(paramList[12]);     // Business object as XML
                    _fromDpRedempCalc = true;

                }
                #endregion CD Redemp
            }
            else if (caller == Phoenix.Shared.Constants.ScreenId.PendingDisplay.ToString())   //#140792
            {
                if (Convert.ToString(paramList[1]) == "RefreshPendingCc")
                {
                    _tlTranSet.CurTran.TranAcct.CCPendingCount.Value = Convert.ToInt32(paramList[2]);
                }

            }
            #region Merged Application Code
            //Begin 60647. Call frmGloAccountListRim's Call Parent with same Param List
            if (picTabs.SelectedIndex == (int)TAB.CustSummary && frmGloAccountListRim != null)
            {
                ////Begin 61730
                //#97861. Removed Code which were written to highlight the selected account. thats been already handled in tempWin_closed. here we just need to pass the paramList of sender window.
                if (caller == Phoenix.Shared.Constants.ScreenId.Rm.ToString() || caller == Phoenix.Shared.Constants.ScreenId.TlRmAddress.ToString()
                      || caller == Phoenix.Shared.Constants.ScreenId.AdditionalID.ToString() || caller == "2180")
                {
                    string curAcctType = string.Empty;
                    string curacctNo = string.Empty;
                    if (frmGloAccountListRim.colAcctNo != null && frmGloAccountListRim.colAcctType != null)
                    {
                        curAcctType = Convert.ToString(frmGloAccountListRim.colAcctType.UnFormattedValue);
                        curacctNo = Convert.ToString(frmGloAccountListRim.colAcctNo.UnFormattedValue);
                    }
                    else
                    {
                        curAcctType = searchAcctType;
                        curacctNo = searchAcctNo;
                    }
                    //92591. Commented below call. this call is making the issue of refresh. 
                    //if (!isBlocked)
                    //    frmGloAccountListRim.ResetRim(searchRimNo, curAcctType, curacctNo, true);
                    //else
                    //{
                    //    CurRimNo = (Convert.ToInt32(this.Workspace.Variables["RimNo"]));//WI #83060. this is not for this WI fix. but in General RImNo should be int32. So modifying code under this WI
                    //    frmGloAccountListRim.ResetRim(CurRimNo, curAcctType, curacctNo, true);

                    //}
                    // frmGloAccountListRim.CallParent(paramList); //92591. In frmGloAccountListRim call parent, called the new method.
                }

                //Begin Bug #100897
                if (_quickTranWindow != null && _quickTranWindow.GetCurrentRim() > 0)
                {
                    _quickTranWindow.RefreshCurrentRimInfo();
                }
                //End Bug #100897

                //End 61730
                frmGloAccountListRim.CallParent(paramList); //#97861.Removed above code because that has been already written in TempWin_Closed event. Always invoke call parent with sender's required Parameter. Tested this scenario withh all account Type.
                //End 60647.
                //Begin #102195.
                if (caller == Phoenix.Shared.Constants.ScreenId.Rm.ToString()) /*If Call is coming from Edit Cust then only call Set Title Bar.*/
                {
                    setTitleBar(frmGloAccountListRim.dfName.Text);
                } 
                //End #102195    
            }
            #endregion

        }

        public void HandleCashInOutDenom(string callType)
        {
            cashDenomCallType = callType;
            CallOtherForms(callType);
        }

        private void ActionAfterHandlePrinting()    //#76425 - broken away from ActionAfterPost
        {
            bool skipCleanUp = false;
            bool bOwnBehalfReason = false; // #2288
            bool showAssociatedPenWarning = false; //#1157
            string inventoryThresholdMsg = string.Empty;    //#140772

            HandleHardHoldNotice(); //#87765

            cTRPTID = -1;

            if (triggerOwnBehalf && !isNonCust() && _tlTranSet.CurTran.TranCode.Value != 900)	//#9191   //WI#23683
            {
                triggerOwnBehalf = false;
                NonPerOnUs = false; //WI#23683
                NonPerOwner = false;//WI#23683

				if (DialogResult.No == PMessageBox.Show(317991, MessageType.Question, MessageBoxButtons.YesNo, String.Empty))
                {
                    skipCleanUp = true;
                    CollectTransactors();
                    return;
                }
                else
                {
                    bOwnBehalfReason = true;  // #2288
                }
            }
            //WI#23683
            else if (triggerOwnBehalf && !isNonCust() && _tlTranSet.CurTran.TranCode.Value == 900)
            {
                triggerOwnBehalf = false;

                NonPerOnUs = false;
                NonPerOwner = false;
                RmAcct _rmAcct = new RmAcct();
                _rmAcct.RimNo.Value = _tlTranSet.CurTran.RimNo.Value;
                _rmAcct.SelectAllFields = false;
                _rmAcct.RimType.Selected = true;
                _rmAcct.ActionType = XmActionType.Select;
                CoreService.DataService.ProcessRequest(XmActionType.Select, _rmAcct);

                if (_rmAcct.RimType.Value == "Personal")
                {
                    if (DialogResult.No == PMessageBox.Show(317991, MessageType.Question, MessageBoxButtons.YesNo, String.Empty))
                    {
                        skipCleanUp = true;
                        CollectTransactors();
                        return;
                    }
                    else
                    {
                        bOwnBehalfReason = true;  // #2288
                    }
                }
                else if (_rmAcct.RimType.Value == "NonPersonal")
                {
                    if (DialogResult.Yes == PMessageBox.Show(14382, MessageType.Question, MessageBoxButtons.YesNo, String.Empty))
                    {
                        NonPerOnUs = true;
                        NonPerOwner = false;
                        CollectTransactors();
                        return;

                    }
                    else
                    {
                        NonPerOnUs = false;
                        NonPerOwner = true;
                        CollectTransactors();
                        return;
                    }
                }
                //end WI#23683
            }
			//Begin #79510
			else if (_tlTranSet.IsAcquirerTran && cTRRequired && !acquirerTransactorCollected)
			{
				//Is the transactor an owner of the account ?
				if (DialogResult.Yes == PMessageBox.Show(13199, MessageType.Question, MessageBoxButtons.YesNo,
	String.Empty))
					acquirerTranIsOwner = true;

				skipCleanUp = true;
				acquirerTransactorCollected = true;
				CollectTransactors();
				return;
			}
            //End #79510
            //Begin #9027
            //#9503 - per selva, for a batch transaction, its safe to assume netamt is cash.
            //Task#70707 added IsNonCustCTR in the if condition
            //Bug#73424 revoked Changes done for Task#70707
            //Task#56865 revoked changes done for Bug#73424
            else if (isNonCust() && !IsNonCustCTR && ((_tlTranSet.CurTran.CashIn.Value > 0 || _tlTranSet.CurTran.CashOut.Value > 0 ||
                _tlTranSet.CurTran.TcdCashIn.Value > 0 || _tlTranSet.CurTran.TcdCashOut.Value > 0 ||
                triggerOwnBehalf) ||
                (!_tlTranSet.CurTran.BatchId.IsNull && !_tlTranSet.CurTran.NetAmt.IsNull && _tlTranSet.CurTran.BatchId.Value > 0 &&
                _tlTranSet.CurTran.NetAmt.Value > 0)))  //#9191, #9503 #38060 - added TcdCashIn and TcdCashOut
			{
				//triggerOwnBehalf = false;	//#9191, moved to callparent.

				//if (!fraudTransactorCollected)	//#9191
                if (_tlTranSet.CurTran.TransactorNos.IsNull)    //#9449
				{
					//Is the transactor on shared branch account also an owner of the account ?
					if (DialogResult.Yes == PMessageBox.Show(317991, MessageType.Question, MessageBoxButtons.YesNo, String.Empty))
					{
						acquirerTranIsOwner = true;
                        bOwnBehalfReason = true;    //#9288
					}
					skipCleanUp = true;
					CollectTransactors();
					//fraudTransactorCollected = true;	//#9191
					return;
				}
				else
				{
					// invokes shared branch fn, so cant use it
					//_tlTranSet.IsAcquirerTran = true;
                    bOwnBehalfReason = acquirerTranIsOwner; //#9288
				}
			}
			//else if (isNonCust() && !fraudTransactorCollected)	//#9191
            else if (isNonCust() && _tlTranSet.CurTran.TransactorNos.IsNull)    //#9449
			{
				cTRRequired = false;
			}
			//End #9027



            try
            {
                #region CTR processing
                if (cTRRequired)
                {
                    cTRRequired = false;
                    dlgInformation.Instance.ShowInfo("Verifying Transaction For CTR...");
                    cTRPtids = null;

                    //Begin #79510
					//if ((_tlTranSet.IsAcquirerTran || isNonCust()) && acquirerTranIsOwner)		//#9027, #9288 - for noncust its may not always be the owner.
					if ((_tlTranSet.IsAcquirerTran) && acquirerTranIsOwner)		//#9027
                        bOwnBehalfReason = true;
                    //End #79510

                    _tlTranSet.ProcessCTR(ref _tlJournalOvrd, ref cTRPtids, ref cTRPTID, bOwnBehalfReason, NonPerOnUs, NonPerOwner); // #2288  //WI#23683
                    dlgInformation.Instance.HideInfo();
                    if (!_tlTranSet.ErrorString.IsNull)
                        PMessageBox.Show(360188, MessageType.Warning, MessageBoxButtons.OK,
                            new string[] { _tlTranSet.ErrorString.Value });
                    else
                    {
                        if (!ProcessResponses(null))
                            return;
                        if (cTRPTID > 0)
                        {
                            if (DialogResult.Yes == PMessageBox.Show(317919, MessageType.Question,
                                //MessageBoxButtons.YesNo, MessageBoxDefaultButton.Button2.ToString(),String.Empty ))	 #72074 - Added default button change done on 3/27
                                MessageBoxButtons.YesNo, MessageBoxDefaultButton.Button2, String.Empty))	// #72074 - change done on 8/14
                            {
                                dlgInformation.Instance.HideInfo();
                                CallOtherForms("CTRTransactions");
                            }
                            else
                            {
                                skipCleanUp = true;
                                HandleCTRDeferral();
                                return;
                            }
                        }
                    }
                }

                if (cTRDeferred)
                {
                    cTRDeferred = false;
                    //#124259 - To avoid overrode transactions to be recorded as System (0)
                    if (_tlJournalOvrd.SuperEmplId.Value == DbSmallInt.MinValue ||
                                        _tlJournalOvrd.SuperEmplId.Value < 0)
                    {
                        _tlJournalOvrd.SuperEmplId.Value = -1;
                    }
                    _tlTranSet.UpdateJrnlCTRStatus(cTRPtids, _tlJournalOvrd.SuperEmplId.Value, (_tlJournalOvrd.OvrdStatus.IsNull ? Convert.ToInt16(-1) : _tlJournalOvrd.OvrdStatus.Value), (_tlJournalOvrd.MessageId.IsNull ? Convert.ToInt32(-1) : _tlJournalOvrd.MessageId.Value));   //#13028
                }
                #endregion

                processingPrint = true;
                #region Passbook Processing
                if (passbookPending)
                {
                    skipCleanUp = true;
                    passbookPending = false;
                    ProcessPassbookUpdates();
                    return;
                }
                #endregion

            }
            catch (PhoenixException pe)
            {
                PMessageBox.Show(pe, MessageBoxButtons.OK);
            }
            finally
            {
                bool doAcquirerCleanUp = !skipCleanUp;      //#79510
                IsNonCustCTR = false;//Task#70707//Bug#73424//Task#56865
                if (passbookPending || _tlTranSet.IsAcquirerTran)  // #79510 - Added IsAcquirerTran
                    skipCleanUp = true;
                if (!skipCleanUp)
                {
                    dlgInformation.Instance.HideInfo();
                    AddLastAcct();
                    pdfInfo.Clear();    //#40276
                    ctwTranSet.ResetTable();
                    UpdateDrawerBalance();
                    _loadCustSummary = IsLoadCustSummary();
                    //Begin #72916*
                    if (_tlTranSet.CurTran.TlTranCode.Value == "VLT" && !_tlTranSet.TranSetTotalBalanceDue.IsNull &&
                        _tlTranSet.TranSetTotalBalanceDue.Value > 0)
                    {
                        PMessageBox.Show(361088, MessageType.Warning, MessageBoxButtons.OK, new string[] { CurrencyHelper.GetFormattedValue((_tlTranSet.TranSetTotalCashDispense.IsNull ? Convert.ToDecimal(0) : _tlTranSet.TranSetTotalCashDispense.Value)) }); //#72916*
                    }

                    //End #72916

                    //Begin #76054
                    //if (AppInfo.Instance.IsAppOnline)
                    if (AppInfo.Instance.IsAppOnline && Phoenix.FrameWork.CDS.DataService.Instance.XmDbStatus == XmDbStatus.Day && _tlTranSet.CurTran.PostRealTime.Value == 1 &&
                        (_tlTranSet.CurTran.TranEffectiveDt.IsNull ? GlobalVars.SystemDate : _tlTranSet.CurTran.TranEffectiveDt.Value) == _tlTranSet.TellerVars.PostingDt)
                    {
                        string chgInfo = _tlTranSet.GetChargeInformation();
                        if (chgInfo != "")
                            PMessageBox.Show(10893, MessageType.Warning, MessageBoxButtons.OK, new string[] { chgInfo }); //#76054
                    }
                    //End #76054


                    if (!_tlTranSet.WarningOnlyErrors.IsNull)
                    {
                        PMessageBox.Show(Convert.ToInt32(_tlTranSet.WarningOnlyErrors.Value), MessageType.Warning, MessageBoxButtons.OK, new string[0]); //#72916*
                    }

                    //Begin #76033 - //#76033 - New
                    if (_tlTranSet.IsHylandVoucherSvcAvailable() || _tlTranSet.TellerVars.IsECMVoucherAvailable)    //#118299
                    {
                        if (!_tlTranSet.CurTran.ColdStorComplete.IsNull)
                        {
                            _tlTranSet.UpdateJournalData();
                        }
                    }
                    //End #76033

                    //#4439
                    _tlTranSet.IsCheckPrintAvailable(true, -1, false);

                    #region Show Warning if Penalties associated to any Loan transactions #1157

                    foreach (TlTransaction tran in _tlTranSet.Transactions)
                    {
                        if (!tran.TranCode.IsNull
                            && (tran.TranCode.Value == 300
                                || tran.TranCode.Value == 301
                                || tran.TranCode.Value == 304))
                        {
                            foreach (TlCc charge in tran.Charges) //#04953
                            {
                                if (charge.ChargeSource.Value == "LN" && charge.Amt.Value > 0)
                                {
                                    showAssociatedPenWarning = true;
                                    break;
                                }
                            }
                        }
                    }

                    if (showAssociatedPenWarning)
                    {
                        //11407 - There are penalties associated with one or more transactions in this transaction set.  Please inform customer or member that they have the opportunity to satisfy the loan fees now.
                        PMessageBox.Show(this, 11407, MessageType.Warning, MessageBoxButtons.OK, new string[0]);
                    }
                    #endregion #1157
                    //#8839

                    //Begin #140772
                    inventoryThresholdMsg = _tlTranSet.GetLowDrawerBranchWarningMsg(_tlTranSet.Transactions);
                    if (!string.IsNullOrEmpty(inventoryThresholdMsg))
                    {
                        //#13992 - Your teller drawer/branch is now lower than the limit specified  for the following inventory item types and packets.
                        //%1!
                        PMessageBox.Show(this, 13992, MessageType.Warning, MessageBoxButtons.OK, new string[] { inventoryThresholdMsg });
                    }
                    //End #140772
                    if (_loadCustSummary)
                    {
                        TlTransaction tran = null;
                        if (_tlTranSet.Transactions.Count == 0)
                            tran = _tlTranSet.CurTran;
                        else if (_tlTranSet.Transactions.Count > 0)
                            tran = ((TlTransaction)_tlTranSet.Transactions[_tlTranSet.Transactions.Count - 1]);
                        _loadCustSummary = (tran.RimNo.Value > 0 && !acctHasPostAccessOnly);  //#15149 - Added check for acctHasPostAccessOnly.
                        if (_loadCustSummary && (tran.NonCust.IsNull || (!tran.NonCust.IsNull && tran.NonCust.Value != GlobalVars.Instance.ML.Y)))
                            _lastSearchRimNo = tran.RimNo.Value;
                    }
                    //
                    //Begin #140895
                    ResetFlagsAndInitializeTranSet("AfterHandlePrinting");
                    //_tlTranSet = new TlTransactionSet();
                    //frmTBarSearch = null; //#75874  #79156 - moved here from after ActionAfterAddNext();
                    //_tranPostingAttempted = false;  //#10003
                    //InitializeTranSet();
                    //_isFormRecalcPmtHistoryClosed = true; //#76425
                    //_isFormRecalcPmtHistoryInvoked = false; //#76425
                    //_isTcdToggleWarningShown = false; //#72916
                    //cTRTranNo = -1;
                    //passbookTranNo = -1;
                    //processingPrint = false;
                    //tcdDispenseTriggered = false; //#75743
                    //isTcdDispenseFailed = false; //#75743
                    //postCashOutTriggered = false; //#6747
                    //postTcdCashOutTriggered = false; //#6747
                    //_isInventoryPurchaseVerified = true;    //#140772
                    //if (picTabs.SelectedIndex != 0)
                    //    picTabs.SelectedIndex = 0;
                    //ActionAfterAddNext();
                    //End #140895
                    //frmTBarSearch = null; //#75874

                    #region Store Last RIM, default Search #8839,#8914

                    //int lastRimNo = int.MinValue;

                    //if (_tlTranSet.TellerVars.IsAppOnline)
                    //{
                    //    if (_tlTranSet.Transactions.Count == 0)
                    //    {
                    //        // Just 1 transaction
                    //        lastRimNo = _tlTranSet.CurTran.RimNo.Value;
                    //    }
                    //    else if ( _tlTranSet.Transactions.Count >= 0 ) //#8839
                    //    {
                    //        // Add-Next transactions
                    //        int i = _tlTranSet.Transactions.Count - 1;
                    //        lastRimNo = ((TlTransaction)_tlTranSet.Transactions[i]).RimNo.Value;
                    //    }
                    //    // Push Last Rim No into search fields.
                    //    if (lastRimNo != int.MinValue
                    //        && _tlTranSet.TellerVars.IsAppOnline
                    //        && !_tlTranSet.TellerVars.AdTlControl.TellerTabDefault.IsNull
                    //        && _tlTranSet.TellerVars.AdTlControl.TellerTabDefault.Value == "S")
                    //    {

                    //        this.Workspace.Variables["RimNo"] = lastRimNo;
                    //        searchRimNo = lastRimNo;
                    //        searchAcctNo = frmTBarSearch.dfAcctNo.Text = Convert.ToString(lastRimNo);

                    //        if (picTabs.SelectedIndex != 2)
                    //            picTabs.SelectedIndex = 2;

                    //        frmTBarSearch.rbCustNumber.Checked = true;
                    //        frmTBarSearch.dfAcctNo.UnFormattedValue = searchAcctNo;
                    //        frmTBarSearch.SetAcctNoField(frmTBarSearch.dfAcctNo, frmTBarSearch.cmbAcctType);
                    //        pbSearch_Click(ActionSave, null);
                    //        EnableDisableControls("SearchClick");
                    //    }
                    //}

                    #endregion #8839,#8914-End
                }

                if (passbookPending && !cTRDeferred)
                    ActionAfterPost();

                //Begin #79510
                if (_tlTranSet.IsAcquirerTran && doAcquirerCleanUp)
                {
                    UpdateDrawerBalance();
                    this.OnActionClose();
                    acquirerWinOkToClose = true;
                    this.Close();
                }
                //End #79510
            }
        }

        private void ActionAfterPost()
        {
            bool offline = !_tlTranSet.TellerVars.IsAppOnline;

            //begin #76029
            if (!sharePrimaryCheck)
            {
                sharePrimaryCheck = true;
                HandlePrimaryShareAcct();
                return;     //#3409 - When TC 913 or 922 is posted Phoenix Warning #311350 “Your teller drawer is low…..” is popping up 2 times.
            }
            //end #76029

            if (!offline)
            {
                SetTransactionVariables(); //#12618 //Bug#103647: only trigger when DB is online.
            }

            _balancesAlreadyPrompted = false; // #79502

            // #14244 - if offline, suppress balances (for enhanced voucher)
            if (offline)
            {
                
                _printBalances = false;
            }
                

            #region #80615
            // Call HandleMTPrinting() if MT Printing configured, else call HandlePrinting()....
            if (_tlTranSet.TellerVars.AdTlControl.EnableMtPrint.Value == "Y")
            {
                HandleMTPrinting();
                _tlTranSet.UpdateRimReceiptandEmail();  //#40276
            }
            else
            {
                HandlePrinting();
                //begin #194535
                _tlTranSet.UpdateRimReceiptandEmail();  //#40276
                //end   #194535
            }
            #endregion

            //_tlTranSet.UpdateRimReceiptandEmail(); //#194535    //#40276
            if (_isFormRecalcPmtHistoryClosed)  //#76425
            {
                ActionAfterHandlePrinting();
            }
            if (picTabs.SelectedIndex == (int)TAB.QuickTran)
            {
                pbPrintMailer.SetObjectStatus(VisibilityState.Hide, EnableState.Disable); //Bug #104269
                pbPrintMailerMisc.SetObjectStatus(VisibilityState.Hide, EnableState.Disable);//Bug #104269
                pbIrsRpt.Visible = false; //Bug #104269
            }
            else
            {
                pbPrintMailer.SetObjectStatus(VisibilityState.Show, EnableState.Disable); // #80615
                pbPrintMailerMisc.SetObjectStatus(VisibilityState.Show, EnableState.Disable);//#60578
            }
            this.UpdateView();
            // Reset the MT Printing variables....
            InitializeMTTranVars(); // #80615
            _printRimNo = 0; //#12618
            _printCustName = ""; // #12618
            ovrdSig = false; // #12619
        }

        private void ActionAfterAddNext()
        {
            frmTlTranCode_PInitCompleteEvent();
            SetTotalDebitsAndCredits();
            curTranIndex = -1;
            //Begin #76041
            if (_tlTranSet.TellerVars.IsAppOnline && !_tlTranSet.IsTellerCaptureTran)   // #140895 - Check for _creatingTlCaptureTranSet
            {
                gotAccts = false;
                //dfAcctNo.Focus();

                if ((_myRim > 0 || _tlTranSet.CurTran.TranAcct.RimNo.Value > 0) && myPost)
                {
                    _tlTranSet.CurTran.TranAcct.RimNo.Value = _myRim;
                    _tlTranSet.CurTran.TranAcct.PostAccess.Value = myPostAccess;    //#5700
                    _tlTranSet.CurTran.TranAcct.EditAccess.Value = myEditAccess;    //#5700

                    if (!gotAccts)
                    {
                        if (_tlTranSet.CurTran.TranAcct.RimNo.Value > 0)
                        {
                            _tlTranSet.CurTran.TranAcct.AcctType.Value = this.cmbAcctType.Text;
                            CallOtherForms("ShowAcctNicknamesList");
                            gotAccts = true;
                        }
                    }
                    else gotAccts = false;
                }
            }
            // End #76041
            _holdRimNo = -1; // #8107
			// Begin#79572
			if (isNonCust())
			{
				cmbAcctType.SetValue("RIM");
				_tlTranSet.CurTran.AcctType.Value = _tlTranSet.CurTran.TranAcct.AcctType.Value = "RIM";
				dfAcctNo.Text = _tlTranSet.CurTran.AcctNo.Value = _tlTranSet.CurTran.TranAcct.AcctNo.Value = this.Workspace.Variables["NonCustRimNo"].ToString();
				_tlTranSet.CurTran.TranAcct.RimNo.Value = Convert.ToInt32(this.Workspace.Variables["NonCustRimNo"]);
				dfAcctNo.Enabled = false;
				cmbAcctType.Enabled = false;
				_tlTranSet.CurTran.NonCust.Value = "Y";
				//this.ActionAddNext.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                //Task#39796 - Begin

                dfTitle1.Text = _tlTranSet.CurTran.TranAcct.Title1.Value = this.Workspace.Variables["NonCustRimNo"].ToString() + " - " + this.Workspace.Variables["NonCustName"].ToString();
                //Task#39796 - End

			}
			// End#79572
        }

        #region #80615
        // Initialize MT Tran Variables after post....
        private void InitializeMTTranVars()
        {
            _tlTranSet.MtReceiptText.Value = "";
            _tlTranSet.MtCashInTotal.Value = 0;
            _tlTranSet.MtCashOutTotal.Value = 0;
            _tlTranSet.MtCksOffUs.Value = 0;
            _tlTranSet.MtCksOnUs.Value = 0;
        }
        #endregion

        #region #12619 Set Waive Signature For Entire TranSet
        private void SetWaiveSignature()
        {
            if (ovrdSig)
                this.cbWaiveSignature.Checked = true;
        }

        private void SetTransactionVariables()
        {
            foreach (TlTransaction tran in _tlTranSet.Transactions)
            {
                #region Retain First Rim Number for Header and Sig Pad
                // Load first rim number into _printRimNo....
                if (_printRimNo == 0 && tran.TranAcct.RimNo.Value != int.MinValue)
                {
                    //Begin Task#124157 will only invoke if rim_no have value -1
                    if (tran.TranAcct.RimNo.Value == -1)
                    {
                        PInt nRimNo = new PInt("nRimNo");
                        nRimNo.Value = _busObjTlJournal.GetCurRimNo(tran.TranAcct.AcctType.Value, tran.TranAcct.AcctNo.Value);
                        if (nRimNo.Value > 0)
                        {
                            tran.TranAcct.RimNo.Value = Convert.ToInt32(nRimNo.Value);
                        }
                    }
                    //End Task#124157
                    _printRimNo = tran.TranAcct.RimNo.Value;
                    #region #13067
                    this._acctSearchBusObj.ActionType = XmActionType.Select;
                    this._acctSearchBusObj.RimNo.Value = _printRimNo;
                    this._acctSearchBusObj.OutputType.Value = 2;
                    //Begin #19415
                    if (!tran.TranAcct.RimLastName.IsNull)
                    {
                        _acctSearchBusObj.RimFirstName.Value = tran.TranAcct.RimFirstName.Value;
                        _acctSearchBusObj.RimLastName.Value = tran.TranAcct.RimLastName.Value;
                        _acctSearchBusObj.RimMiddleInitial.Value = tran.TranAcct.RimMiddleInitial.Value;
                    }
                    else
                        //End #19415
                        CoreService.DataService.ProcessRequest(this._acctSearchBusObj);

                    _printCustName = _tlTranSet.GlobalHelper.ConcateNameX(this._acctSearchBusObj.RimFirstName.Value, this._acctSearchBusObj.RimLastName.Value, this._acctSearchBusObj.RimMiddleInitial.Value, false);
                    #endregion
                }
                #endregion
            }
        }
        #endregion

        private void CollectTransactors()
        {
			//if (_tlTranSet.GetNextTransactorTran(ref cTRTranNo) || isNonCust())	//#9027
            if (_tlTranSet.GetNextTransactorTran(ref cTRTranNo))    //#9027
			{
				CallOtherForms("CTRTransactor");
            }
            else
            {
				//Begin #9027
				//if (isNonCust() && !fraudTransactorCollected)	//#9191
                if (isNonCust() && _tlTranSet.CurTran.TransactorNos.IsNull) //#9449
				{
                    IsNonCustCTR = true;//Task#70707 added to check if its non customer and the transactor was not added//Bug#73424
                    //Begin #9503
                    if (!transactorWindowCalled)
                    {
                        transactorWindowCalled = true;
                        CallOtherForms("CTRTransactor");
                        return;//Bug#73424//Task#56865
                    }
                    else
                    {
                        string CustomerType = string.Empty;
                        if (Phoenix.FrameWork.Shared.Variables.GlobalVars.InstitutionType != "CU")
                        {

                            PMessageBox.Show(13269, MessageType.Message, "non-customer");     //#9449
                            CustomerType = "(Non-Cust)";
                        }
                        else
                        {
                            PMessageBox.Show(13269, MessageType.Message, "non-member");     //#9449
                            CustomerType = "(Non-Mbr)";
                        }
                        //Begin Task#56865                        
                        //Begin Bug#73424
                        //Begin Task#70707
                        //Begin Bug#75075 added if condition and moved the existing code to else part
                        if (_tlTranSet.CurTran.TranCode.Value == 900 && (_tlTranSet.CurTran.CashOut.IsNull))
                        {
                            _tlTranSet.CTRFailedTran(_tlTranSet.CurTran.AcctType.Value, _tlTranSet.CurTran.AcctNo.Value, _tlTranSet.CurTran.CashIn.Value, _tlTranSet.CurTran.NetAmt.Value, CustomerType);
                        }
                        else
                        {
                            _tlTranSet.CTRFailedTran(_tlTranSet.CurTran.AcctType.Value, _tlTranSet.CurTran.AcctNo.Value, _tlTranSet.CurTran.CashIn.Value, _tlTranSet.CurTran.CashOut.Value, CustomerType);
                        }
                        //End Bug#75075
                        //CallOtherForms("CTRTransactor");
                        //End Task#70707
                        //End Bug#73424
                        //End Task#56865

                    }
                    //End #9503
                    //return; //Task#70707 Commented //Bug#73424 //Task#56865
                }
                //End #9027
                ActionAfterPost();
            }
        }
        //begin #76029
        private bool HandlePrimaryShareAcct()
        {
            if (_tlJournalOvrd == null)
                _tlJournalOvrd = new TlJournalOvrd();

            _tlJournalOvrd.AcctType.Value = _tlTranSet.CurTran.AcctType.Value;
            _tlJournalOvrd.AcctNo.Value = _tlTranSet.CurTran.AcctNo.Value;
			//Begin #05321
			//_tlJournalOvrd.TlTranCode.Value = _tlTranSet.CurTran.TlTranCode.Value;
			_tlJournalOvrd.TranCode.Value = _tlTranSet.CurTran.TranCode.Value;
			//End #05321
            string ret = _tlJournalOvrd.SharePrimAcctAfterPost();
            if (ret == "PrimaryWithEligiblePrimShare")
            {
                CallOtherForms("SharePrimAcct");
                // Begin #4172
                ActionAfterPost();

                // End #4172
            }
            else
            {
                // acct is not primary, or it doesnt have any other primary so dont worry
                ActionAfterPost();
            }
            return true;
        }
        //end #76029

        private bool HandleCTRDeferral()
        {
            cTRDeferred = true;
            //			_tlJournalOvrd = new TlJournalOvrd();
            //			_tlJournalOvrd.OvrdId.Value = OverrideID.CTRDeferral;
            if (_tlJournalOvrd.RequireMiscOvrs(OverrideID.CTRDeferral, _tlTranSet.AdGbRsm))
            {
                CallOtherForms("CTROverride");
                return true;
            }
            else
                ActionAfterPost();
            return true;
        }

        private void SetPassbookFields(bool refresh)
        {
            if (passbookAcctDetails == null)
                return;

            if (processingPrint)
                refresh = true;
            try
            {
                if (!refresh)
                    if (dfPbAcctNo.Text == passbookAcctDetails.AcctNo.Value &&
                        ((acctTypeSrch && dfPbAcctType.Text == passbookAcctDetails.AcctType.Value) ||
                            (!acctTypeSrch && dfPbAcctType.Text == passbookAcctDetails.ApplType.Value) ||
                            _refreshPassbook > 0))
                        return;
                if (refresh)
                {
                    try
                    {
                        dlgInformation.Instance.ShowInfo("Refreshing Passbook Data...");
                        passbookAcctDetails.RefreshPassbookData();
                    }
                    finally
                    {
                        dlgInformation.Instance.HideInfo();
                        _refreshPassbook = -1;
                    }
                }
                if (acctTypeSrch)
                    dfPbAcctType.UnFormattedValue = passbookAcctDetails.AcctType.Value;
                else
                    dfPbAcctType.UnFormattedValue = passbookAcctDetails.ApplType.Value;

                dfPbAcctNo.UnFormattedValue = passbookAcctDetails.AcctNo.Value;
                dfPbBalance.UnFormattedValue = passbookAcctDetails.PbBalance.Value;
                dfUnbookedDeposits.UnFormattedValue = passbookAcctDetails.PbCredits.Value;
                dfUnbookedWithdrawals.UnFormattedValue = passbookAcctDetails.PbDebits.Value;
                // Begin #76048
                //dfPbTitle1.UnFormattedValue = passbookAcctDetails.Title1.Value;
                //dfPbTitle2.UnFormattedValue = passbookAcctDetails.Title2.Value;
                this.setPassbookTitles();
                // End #76048
                dfEndingBalance.UnFormattedValue = passbookAcctDetails.PbBalance.Value +
                    passbookAcctDetails.PbCredits.Value - passbookAcctDetails.PbDebits.Value;
                if (dfPbLines.UnFormattedValue == null)
                    dfPbLines.UnFormattedValue = _tlTranSet.TellerVars.AdTlControl.NoPbLines.Value;
                if (cmbPassbookType.CodeValue == null)
                    cmbPassbookType.SelectedIndex = 0;
                Invalidate();
                //this.dfPbLines.UnFormattedValue = acctDetails.PbLastLine.Value;
                if (_accountHistory == null)
                    _accountHistory = new AccountHistory();

                _accountHistory.AcctNo.Value = passbookAcctDetails.AcctNo.Value;
                _accountHistory.AcctType.Value = passbookAcctDetails.AcctType.Value;
                _accountHistory.EffectiveDt.Value = _tlTranSet.TellerVars.PostingDt;
                _accountHistory.OutputType.Value = 1;
                twPassbook.ListViewObject = _accountHistory;
                twPassbook.ObjectToScreen();
            }
            catch (PhoenixException pe)
            {
                PMessageBox.Show(pe, MessageBoxButtons.OK);
            }
        }

        private void ProcessPassbookUpdates()
        {

            passbookAcctDetails = _tlTranSet.GetNextPassbookAcct(ref passbookTranNo, ref isTranferTran);
            if (passbookAcctDetails != null)
            {
                if (picTabs.SelectedIndex == 4)
                    SetPassbookFields(true);
                else
                {
                    if (Name4.IsDisabled)
                        EnableDisableControls("ProcessPassbookUpdates");
                    picTabs.SelectedIndex = 4;
                }
            }
            else
            {
                ActionAfterPost();
            }

        }

        private bool IsPbSupportedNow()
        {
            return (Phoenix.FrameWork.CDS.DataService.Instance.XmDbStatus == XmDbStatus.Day);
        }

        private bool ShowTranAcctAlertsOnCurTab()
        {
            return picTabs.SelectedIndex == 0 || picTabs.SelectedIndex == 1 || picTabs.SelectedIndex == 4;
            //return picTabs.SelectedIndex == 0 || picTabs.SelectedIndex == 1 || picTabs.SelectedIndex == 4 || picTabs.SelectedIndex == 3;
        }

        public int GetCurrentSelectedTabIndex()
        {
            return picTabs.SelectedIndex;
        }

        private void SetNextScreenIds()
        {
            pbCashIn.NextScreenId = Phoenix.Shared.Constants.ScreenId.CashCount;
            pbCashOut.NextScreenId = Phoenix.Shared.Constants.ScreenId.CashCount;
            pbItemCapture.NextScreenId = Phoenix.Shared.Constants.ScreenId.CapturedItems;
            pbGetGLAcct.NextScreenId = GlobalVars.UserType == "Combined" ? Phoenix.Shared.Constants.ScreenId.GlAccountSearch : Phoenix.Shared.Constants.ScreenId.TlGlAccountSearch; //77062. For combines User access AcProc Tree // #140772 Phoenix.Shared.Constants.ScreenId.TlGlAccountSearch; //#3032 - replace GlAccountSearch with TlGlAccountSearch for sec purpose only.
            iconSigner.NextScreenId = Phoenix.Shared.Constants.ScreenId.RmSignature;
            //79225
            this.pbIrsRpt.NextScreenId = Phoenix.Shared.Constants.ScreenId.TaxRepAggregation;
            this.pbACHFut.NextScreenId = Phoenix.Shared.Constants.ScreenId.TlTcFutDtTxView; //#6595
            this.pbNOCHistory.NextScreenId = Phoenix.Shared.Constants.ScreenId.NOCHistory; // #14636
            this.pbInventory.NextScreenId = GlobalVars.UserType == "Combined" ? Phoenix.Shared.Constants.ScreenId.InventoryItemSearchBackOffice : Phoenix.Shared.Constants.ScreenId.InventoryItemSearchTeller; //77062. //#140772 
            this.pbInventoryMisc.NextScreenId = GlobalVars.UserType == "Combined" ? Phoenix.Shared.Constants.ScreenId.InventoryItemSearchBackOffice : Phoenix.Shared.Constants.ScreenId.InventoryItemSearchTeller; //77062//#140772
            this.pbPendingCC.NextScreenId = Phoenix.Shared.Constants.ScreenId.PendingDisplay; //#140792
            this.pbNOCHistoryMisc.NextScreenId = Phoenix.Shared.Constants.ScreenId.NOCHistory; //#60578
            this.pbAddNonCust.NextScreenId = GlobalVars.UserType == "Teller" ? Phoenix.Shared.Constants.ScreenId.TlNonRmAcct : Phoenix.Shared.Constants.ScreenId.OnNonRmAcctEdit;  //77062. Non customer security.
            this.pbEditNonCust.NextScreenId = GlobalVars.UserType == "Teller" ? Phoenix.Shared.Constants.ScreenId.TlNonRmAcct : Phoenix.Shared.Constants.ScreenId.OnNonRmAcctEdit; //77062. Non customer security.
            this.pbAdvancedView.NextScreenId = 0;
            this.pbExceptionHold.NextScreenId = Phoenix.Shared.Constants.ScreenId.GbExceptionHoldEdit;       /* #126357 | 244510 | Task #134375*/
        }

        private bool RequireSignatureForInventoryPurchase() //#140772
        {
            bool isRequireSig = false;
            //preseve CurTran

            if (!_tlTranSet.TellerVars.IsAppOnline)
                return isRequireSig;

            // If Transaction has overrides, then check info has already been collected.
            if (_tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.HasOverrides) //8570
            {
                return isRequireSig;
            }

            try
            {
                foreach (TlTransaction tran in _tlTranSet.Transactions)
                {
                    if (!tran.TranCode.IsNull && tran.TranCode.Value == 938)
                    {
                        if (_tlTranSet.TellerVars.SetContextObject("AdGbInventoryTypeArray", tran.TypeId.StringValue))
                        {
                            if (!_tlTranSet.TellerVars.AdGbInventoryType.SigRequiredPurchase.IsNull && _tlTranSet.TellerVars.AdGbInventoryType.SigRequiredPurchase.Value > 0)
                            {
                                isRequireSig = true;
                                break;
                            }
                        }
                    }
                }
            }
            catch (PhoenixException)
            {
                isRequireSig = false;
            }
            finally
            {
                if (!_tlTranSet.CurTran.TranCode.IsNull && _tlTranSet.CurTran.TranCode.Value == 938)
                {
                    _tlTranSet.TellerVars.SetContextObject("AdGbInventoryTypeArray", _tlTranSet.CurTran.TypeId.StringValue);
                }
            }
            return isRequireSig;
        }

        //Begin #140895
        private void CollectCheckInfoForChkPrinting()
        {
            CollectCheckInfoForChkPrinting(false);
        }
        //End #140895
        private void CollectCheckInfoForChkPrinting(bool curTranOnly) //Selva-ChkPrintFix // #140895 - Added curTranOnly parameter

        {

            bool collectChkInfo = false;
            bool isFormDefined = false;
            printInfoForm = new PrintInfo();

            // If Transaction has overrides, then check info has already been collected.
            if (_tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.HasOverrides) //8570
            {
                  return;
            }

            //preseve CurTran
            //Begin #140895
            ArrayList tranList = null;
            if (curTranOnly)
            {
                tranList = new ArrayList();
                tranList.Add(_tlTranSet.CurTran);
            }
            else
                tranList = _tlTranSet.Transactions;
            //End #140895

            TlTransaction actualTran = _tlTranSet.CurTran;
            foreach (TlTransaction tran in tranList)   // #140895 - replaced _tlTranSet.Transactions by tranList
            {
                _tlTranSet.CurTran = tran;
                //Begin #79510, #10883-2
                if (_tlTranSet.IsAcquirerTran)
                    _tlTranSet.IsSqrFormExist();
                //End #79510, #10883-2

                if (_tlTranSet.IsCheckPrintAvailable(false, -1, false))
                {
                    isFormDefined = _tlTranSet.IsFormDefinedForChkPrint();


                    collectChkInfo = false;

                    if (isFormDefined
                        && (_tlTranSet.CurTran.TranCode.Value == 902  // 9348
                            || _tlTranSet.CurTran.TranCode.Value == 910)
                        && (_tlTranSet.CurTran.TlChkForms == null
                            || _tlTranSet.CurTran.CollectChkInfo.IsNull
                            || (!_tlTranSet.CurTran.CollectChkInfo.IsNull
                                && _tlTranSet.CurTran.CollectChkInfo.Value != 1)
                            )
                        )


                    {
                        collectChkInfo = true;
                    }

                    #region #9723 - If SQR form has not been defined for the trancode, display error....
                    if (!isFormDefined
                        && (_tlTranSet.CurTran.TranCode.Value == 902  // 9348
                            || _tlTranSet.CurTran.TranCode.Value == 910)
                        && (_tlTranSet.CurTran.TlChkForms == null
                            || _tlTranSet.CurTran.CollectChkInfo.IsNull
                            || (!_tlTranSet.CurTran.CollectChkInfo.IsNull
                                && _tlTranSet.CurTran.CollectChkInfo.Value != 1)
                            )
                        )
                    {

                        _hadCheckPrintingError = true;
                        PMessageBox.Show(13279, MessageType.Error, MessageBoxButtons.OK, String.Empty);
                        return;

                    }
                    #endregion

                    if (collectChkInfo)
                    {
                        if (!ovrdTriggered && collectChkInfo)
                        {
                            if (!_tlTranSet.CurTran.BranchNo.IsNull)
                                printInfoForm.BranchNo = _tlTranSet.CurTran.BranchNo.Value;
                            else
                                printInfoForm.BranchNo = _tlTranSet.TellerVars.BranchNo;


                            if (_tlTranSet.IsAcquirerTran) //#79510, 09218
                            {
                                _tlJournalAddlInfo = new TlJournalAddlInfo();
                                _tlJournalAddlInfo.JournalPtid.Value = _tlTranSet.CurTran.Ptid.Value;
                                _tlJournalAddlInfo.ActionType = XmActionType.Select;
                                CallXMThruCDS("GetAcqTranAddlInfo");

                                if (_tlJournalAddlInfo.OtherInfo.Contains("PayeeName"))
                                {
                                    printInfoForm.CheckLine1 = Convert.ToString(_tlJournalAddlInfo.OtherInfo["PayeeName"].Value);
                                }
                                //Begin #140784
                                if (_tlJournalAddlInfo.OtherInfo.Contains("Reference"))
                                {
                                    printInfoForm.ReasonForCheck = Convert.ToString(_tlJournalAddlInfo.OtherInfo["Reference"].Value);
                                }
                                //End #140784
                            }


                            // This where it all happens.....

                            CallOtherForms("CheckInfo");
                        }
                    }
                }
            }

            #region #9723
            if (_hadCheckPrintingError)
                return;
            #endregion

            _tlTranSet.CurTran = actualTran;
        }

        private void PostTransactions()
        {

            bool odLimitUsed = false;
            bool tranSetHasOvrdOnly = false;
            string errorText = null;
            bool skipHide = false;
            _hadCheckPrintingError = false; // #9723
            bool popPurchReturnItemDetailWindow = false;    //#140772

            //Begin #13182/#13183
            populateGridWithSavedRim = false;
            //End #13182/#13183
            WriteToDebugLog("Default values of TCD, TCR, cash out flags");
            WriteToDebugLog(string.Format("{0}={1}", "postCashOutTriggered", postCashOutTriggered.ToString()));
            WriteToDebugLog(string.Format("{0}={1}", "_tlTranSet.TellerVars.IsTCDConnected", _tlTranSet.TellerVars.IsTCDConnected.ToString()));
            WriteToDebugLog(string.Format("{0}={1}", "tcdDispenseTriggered", tcdDispenseTriggered.ToString()));
            WriteToDebugLog(string.Format("{0}={1}", "postTcdCashOutTriggered", postTcdCashOutTriggered.ToString()));
            WriteToDebugLog(string.Format("{0}={1}", "_tlTranSet.IsAcquirerTran", _tlTranSet.IsAcquirerTran.ToString()));
            WriteToDebugLog(string.Format("{0}={1}", "ovrdTriggered", ovrdTriggered.ToString()));
            WriteToDebugLog(string.Format("{0}={1}", "InventoryPurchaseVerified", _isInventoryPurchaseVerified.ToString()));    //#140772
            try
            {
                if ((!postCashOutTriggered && !_tlTranSet.TellerVars.IsTCDConnected) || (_tlTranSet.TellerVars.IsTCDConnected && !(tcdDispenseTriggered || postTcdCashOutTriggered)))
                {
                    if (!_tlTranSet.IsAcquirerTran) // #79510 - Added the if block
                    {

                        //Begin #140895
                        if (_tlTranSet.IsTellerCaptureTran)
                        {
                            string focusField = string.Empty;
                            int focusTran = -1;
                            if (!_tlTranSet.ValidateTlCaptureTranSet(ref focusTran, ref focusField))
                            {
                                ProcessResponses(null);
                                if (focusTran >= 0 && focusTran < ctwTranSet.Count)
                                {
                                    ctwTranSet.ContextRow = focusTran;
                                    SelectTran(-1);
                                    GetControlByXmlTag(focusField, true);
                                }
                                return;
                            }
                        }
                        //End #140895
                        if (!ovrdTriggered || dialogResult == DialogResult.OK)
                        {
                            dialogResult = DialogResult.Cancel;
                            ovrdTriggered = false;
                            failedTran = 0;
                            focusField = "";
                            _tlTranSet.IsTcdConnected.Value = (_tlTranSet.TellerVars.IsTCDConnected ? Convert.ToInt32(1) : Convert.ToInt32(0)); //#72916
                            dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(360271));

                            using (new WaitCursor())
                            {
                                //Begin Selva-ChkPrintFix
                                CollectCheckInfoForChkPrinting();
                                //End Selva-ChkPrintFix
                                #region #9723
                                if (_hadCheckPrintingError)
                                    return;
                                #endregion

                                //Begin #140772
                                #region Require Signature for Inventory Item Purchase
                                //#21274 - Modified the signature required logic, no sig verification is required so just pop-up the message.
                                if (RequireSignatureForInventoryPurchase())
                                {
                                    _isInventoryPurchaseVerified = true;
                                    //13997 - The purchase of this inventory type requires %1! signature.
                                    PMessageBox.Show(13997, MessageType.Warning, new string[] { Convert.ToString(_tlTranSet.TellerVars.AdGbInventoryType.SigRequiredPurchase.Value) });
                                }
                                if (!_isInventoryPurchaseVerified)
                                {
                                    dlgInformation.Instance.HideInfo();
                                    return;
                                }
                                #endregion
                                //End #140772

                                if (_tlTranSet.TranPostedStatus.Value != (short)TranPostStatus.Success) // #140895, #28965 - check if the transaction is not already posted ( for whatever faulty logic )
                                {
                                    _tlTranSet.PostTransactions(ref focusField, ref failedTran, ref tranSetHasOvrdOnly,
                                        ref cTRRequired, ref triggerOwnBehalf);

                                    // #40977
                                    if (_tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.Success)
                                    {
                                        _tlTranSet.TellerVars.LastJrnlSequenceNo = _tlTranSet.SequenceNo.Value;
                                        if (_tlTranSet.IsTellerCaptureTran)
                                        {
                                            _tellerCapture.LastTranCommitPending = true;
                                            _tellerCapture.LastTranSequenceNo = _tlTranSet.SequenceNo.Value;
                                            CoreService.LogPublisher.LogDebug("Post Transaction:Teller Transaction Posted/Committed and Teller Capture Commit Tran is Pending");
                                            if (_tellerCapture.LastTranLogInfo != null)//OOB-Fix , #40977
                                                CoreService.LogPublisher.LogInfo("\n Post Transaction:Teller Transaction :  \n *** AVTC CALL SEQUENCE *** \n" + _tellerCapture.LastTranLogInfo.ToString());
                                        }
                                    }
                                }
                                else
                                {
                                    // Begin #140895, #28965
                                    try
                                    {
                                        string logError = string.Format("frmTlTranCode:DOUBLE POSTING TRIGGERED. Drawer #:{0}, Sequence #:{1}",
                                            _tlTranSet.DrawerNo.Value, _tlTranSet.SequenceNo.Value);
                                        logError += string.Format("Variables: postCashOutTriggered={0}, _tlTranSet.TellerVars.IsTCDConnected = {1}, tcdDispenseTriggered = {2}, postTcdCashOutTriggered = {3}, ovrdTriggered = {4}, dialogResult = {5}",
                                            postCashOutTriggered, _tlTranSet.TellerVars.IsTCDConnected, tcdDispenseTriggered,
                                            postTcdCashOutTriggered, ovrdTriggered, dialogResult);

                                        #region stack info
                                        int stackLevel = 5;
                                        if (stackLevel > 0)
                                        {
                                            logError = logError + @"
STACK:";



                                            System.Diagnostics.StackTrace st = new System.Diagnostics.StackTrace(true);

                                            //System.Diagnostics.StackFrame[] stackFrames = st.GetFrames();
                                            //foreach (System.Diagnostics.StackFrame stackFrame in stackFrames)
                                            //{
                                            //    CoreService.LogPublisher.LogDebug(stackFrame.GetMethod().Name);   // write method name
                                            //}

                                            int stFrmCnt = st.GetFrames().Length;

                                            if (stFrmCnt > stackLevel)
                                                stFrmCnt = stackLevel;
                                            for (int i = 0; i < stFrmCnt; i++)
                                            {
                                                System.Diagnostics.StackFrame sf = st.GetFrame(i);
                                                logError += @"
" + sf.GetMethod().Name;
                                            }
                                        }
                                        #endregion

                                        CoreService.LogPublisher.LogError(logError, true);

                                    }
                                    catch
                                    {
                                    }
                                    // End #140895, #28965
                                }
                            }

                            if (_tlTranSet.TellerVars.AdTlControl.OdLimitFeeWarn.Value == GlobalVars.Instance.ML.Y ||
                                _tlTranSet.TranPostedStatus.Value != (short)TranPostStatus.Success)
                            {
                                errorText = _tlTranSet.ErrorString.Value;
                                odLimitUsed = (_tlTranSet.TranUsedODLimit.Value == 1);
                            }


                            //Begin #140780
                            if (_tlTranSet.TellerVars.AdTlControl.OdpWarning.Value == GlobalVars.Instance.ML.Y &&
                                  _tlTranSet.TellerHelper.IsDepositTran(_tlTranSet.CurTran.TranCode.Value) &&
                                  _tlTranSet.TellerHelper.IsDebitTran(_tlTranSet.CurTran.TranCode.Value) &&
                                  bODPMsgDisplayed == false && _tlTranSet.TellerVars.IsAppOnline)   //#19904 - Added IsAppOnline check
                            {
                                _dpDisplay = new DpDisplay();
                                _dpDisplay.AcctType.Value = _tlTranSet.CurTran.TranAcct.AcctType.Value;
                                _dpDisplay.AcctNo.Value = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
                                _dpDisplay.SelectAllFields = true;
                                _dpDisplay.ActionType = XmActionType.Select;
                                CoreService.DataService.ProcessRequest(_dpDisplay);

                                if (_dpDisplay.LineOfCredit.Value == GlobalVars.Instance.ML.Y)
                                {
                                    PDecimal SweepAvailBal = new PDecimal("SweepAvailBal");
                                    SweepAvailBal.Value = 0;

                                    if (_tlTranSet.TellerVars.AdXpSvcs.SweepPost.Value == GlobalVars.Instance.ML.Y)
                                        SweepAvailBal.Value = (_dpDisplay.SweepAvailBal.IsNull ? 0 : _dpDisplay.SweepAvailBal.Value);

                                    if (_tlTranSet.CurTran.AcctAvailBal.Value < _tlTranSet.CurTran.NetAmt.Value)
                                    {
                                        if (_tlTranSet.CurTran.AcctAvailBal.Value + SweepAvailBal.Value < _tlTranSet.CurTran.NetAmt.Value)
                                        {

                                            if (_tlTranSet.TellerVars.AdXpSvcs.LocPost.Value == GlobalVars.Instance.ML.Y &&
                                               !_dpDisplay.LocAvailBal.IsNull && _dpDisplay.LocAvailBal.Value > 0)
                                            {
                                                bODPMsgDisplayed = true;

                                                // Display the appropriate message
                                                if (_tlTranSet.TellerVars.AdTlTc.RealTimeEnable.Value == GlobalVars.Instance.ML.Y)
                                                {
                                                    PMessageBox.Show(this, 13811, MessageType.Message, MessageBoxButtons.OK);
                                                    //13811 - Completion of this transaction will require an Overdraft Protection transfer.
                                                    //An ODP fee may be assessed for the transaction.
                                                }
                                                else
                                                {
                                                    if (odLimitUsed)
                                                    {
                                                        PMessageBox.Show(this, 13812, MessageType.Message, MessageBoxButtons.OK);
                                                        //13812 - Completion of this transaction may require an Overdraft Protection transfer
                                                        //and access to your OD Limit. An ODP and/or OD limit fee may be assessed for the transaction.
                                                    }
                                                    else
                                                    {
                                                        PMessageBox.Show(this, 13813, MessageType.Message, MessageBoxButtons.OK);
                                                        //13813 - Completion of this transaction may require an Overdraft Protection transfer.
                                                        //An ODP fee may be assessed for the transaction.
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            //End #140780


                            if (_tlTranSet.TranPostedStatus.Value != (short)TranPostStatus.Success)
                            {
                                if (_tlTranSet.IsTellerCaptureCheckOnlyTran)    //#102719
                                {
                                    try
                                    {
                                        _tlTranSet.RefreshTlCaptureChecksOnlyItems(false);
                                    }
                                    finally
                                    {
                                        _tlTranSet.CaptureAllCheckTranItems = false;
                                        _tlCaptureAVTCSilentMode = false;
                                        SetTellerCaptureFlagForTranSet(false);
                                    }
                                }

                                if (!tranSetHasOvrdOnly)
                                {
                                    PMessageBox.Show(360188, MessageType.Warning, MessageBoxButtons.OK,
                                        new string[] { errorText });

                                    foreach (TlTransaction tran in _tlTranSet.Transactions) //#140772
                                    {
                                        if (tran.TranCode.Value == 938 || tran.TranCode.Value == 939)
                                        {
                                            foreach (GbInventoryItem item in tran.InventoryItems)
                                            {
                                                if (!item.ItemExists.IsNull && item.ItemExists.Value == 0)
                                                {
                                                    popPurchReturnItemDetailWindow = true;
                                                    break;
                                                }
                                            }
                                        }
                                        break;
                                    }

                                    if (popPurchReturnItemDetailWindow) //#140772
                                    {
                                        this.dfCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.DisableShowText); //140772
                                        popPurchReturnItemDetailWindow = false;
                                        CallOtherForms("InventoryPurchaseReturnClick");
                                    }
                                }

                                if (_tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.HasOverrides)
                                {
                                    //#76052
                                    #region ODCcOverrideDialog
                                    if (_tlTranSet.TranSetHasODCcOverride())
                                    {
                                        CallOtherForms("OdCcOverride");
                                        if (!_tlTranSet.TranSetHasOverrides() || dialogResultOdCc == DialogResult.Cancel)
                                            return;
                                    }
                                    #endregion

                                    #region TranOverride
                                    if (_tlTranSet.TranSetHasOverrides())
                                    {
                                        dlgInformation.Instance.HideInfo();
                                        ovrdTriggered = true;
                                        WriteToDebugLog("TranOverride Region");
                                        WriteToDebugLog(string.Format("{0}={1}", "ovrdTriggered", ovrdTriggered.ToString()));
                                        skipHide = true;
                                        CallOtherForms("Override");
                                        return;
                                    }
                                    #endregion
                                }

                            }
                        }

                        if (ovrdTriggered || _tlTranSet.TranPostedStatus.Value != (short)TranPostStatus.Success)
                        {
                            ovrdTriggered = false;
                            WriteToDebugLog("Reset overiride flag");
                            WriteToDebugLog(string.Format("{0}={1}", "ovrdTriggered", ovrdTriggered.ToString()));
                            if (dialogResult == DialogResult.Cancel)
                            {
                                //MessageBox.Show( DecodeResponseXML( ref failedTran ));
                                _tlTranSet.OdCcAction.SetValue(null, EventBehavior.None);   // #6615 - _tlTranSet.OdCcAction.SetValueToNull();
                                ctwTranSet.ContextRow = failedTran;
                                SelectTran(-1);
                                GetControlByXmlTag(focusField, true);
                                return;
                            }
                        }

                        //#140780: Added other conditions
                        //#19197: Removed the other conditions
                        if (odLimitUsed)
                            PMessageBox.Show(318310, MessageType.Warning, MessageBoxButtons.OK,
                                String.Empty);
                    }   // !IsAcquirerTran
                    //Begin #79510
                    else
                    {
                        CollectCheckInfoForChkPrinting();
                        #region #9723
                        if (_hadCheckPrintingError)
                            return;
                        #endregion
                    }
                    //End #79510


                    // Begin #140895 - Bulk Mode
                    if (_tlTranSet.IsTellerCaptureTran && _tlCaptureBulkModePosting)
                    {
                        if (_tlTranSet.TranPostedStatus.Value != (short)TranPostStatus.Success)
                        {
                            _tlCaptureBulkPostStatus = 3;   //Failed
                            if (_tlTranSet.Transactions.Count > 0 && (_tlTranSet.Transactions[0] as TlTransaction).ForcePostTran.Value != 1)
                            {
                                //TODO: Fix message
                                //TODO: DialogResult response = MessageBox.Show("Do you want to force post the trsnactions?", "Question", MessageBoxButtons.YesNo);
                                DialogResult response = DialogResult.No;
                                if (response == System.Windows.Forms.DialogResult.Yes)
                                {
                                    _tlCaptureBulkPostStatus = 2;   // Force Posted
                                    foreach (TlTransaction tran in _tlTranSet.Transactions)
                                    {
                                        tran.ForcePostTran.Value = 1;
                                    }
                                    OnActionSave(false);
                                    //return;
                                }
                            }
                            return;
                        }
                        else if (_tlCaptureBulkPostStatus <= 0)
                        {
                            _tlCaptureBulkPostStatus = 1;   // Normal Posted
                        }
                    }
                    // End #140895 - Bulk Mode

                    //Begin #72916
                    if (_tlTranSet.TellerVars.IsTCDConnected && ((_tlTranSet.TranSetTotalCashOut.Value > 0 && _tlTranSet.CurTran.TranCode.Value != 555) ||
                        _tlTranSet.CurTran.TlTranCode.Value == "VLT") && !tcdDispenseTriggered && _tlTranSet.CurTran.TlTranCode.Value != "VLS") //#79574
                    {
                        //#79574 - Removed 24/7 limitation
                        //if (Phoenix.FrameWork.CDS.DataService.Instance.XmDbStatus != XmDbStatus.Day)
                        //{
                        //    _tlTranSet.TellerVars.IsTCDConnected = false;
                        //    //Begin #75741
                        //    tcdDispenseTriggered = true; //#75741
                        //    _tlTranSet.TranSetTotalBalanceDue.Value = (_tlTranSet.CurTran.TlTranCode.Value == "VLT" ? _tlTranSet.CurTran.NetAmt.Value : _tlTranSet.TranSetTotalCashOut);
                        //    _tlTranSet.TranSetTotalCashDispense.Value = (_tlTranSet.CurTran.TlTranCode.Value == "VLT" ? _tlTranSet.CurTran.NetAmt.Value : _tlTranSet.TranSetTotalCashOut);
                        //    //End #75741
                        //}
                        //else
                        //{                            //tcdDispenseTriggered = true;
                        bool isAutoDispense = true;
                        _tcdDeviceResp = new ArrayList();
                        foreach (TlTransaction tran in _tlTranSet.Transactions)
                        {
                            if (tran.TcdDenominate.Value == GlobalVars.Instance.ML.Y)
                            {
                                isAutoDispense = false;
                                break;
                            }
                        }
                        try
                        {
                            using (new WaitCursor())
                            {
                                if (isAutoDispense)
                                    dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(361057));
                                else
                                    dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(361058));
                                InitializeCashDispense();
                                //
                                cashDisp.ReturnCode = 0;
                                cashDisp.IgnoreReturnString = true;
                                //block the F1 key
                                _isOkToBlockF1Key = true;
                                tcdAction.Shortcut = Keys.F1;
                                //
                                isTcdDispenseFailed = false;
                                if (cashDisp.WindowTitle != _tlTranSet.TellerVars.DeviceDispWindowTitle)
                                {
                                    //cashDisp.Close();
                                    //cashDisp.WindowTitle = _tlTranSet.TellerVars.DeviceDispWindowTitle; //#79574
                                    //cashDisp.Open();
                                    cashDisp.IsConnOpen = false;
                                    cashDisp.WindowTitle = _tlTranSet.TellerVars.DeviceDispWindowTitle; //#79574
                                }
                                //#13797:
                                tcdDispenseTriggered = true;
                                WriteToDebugLog("Call to UCM interface for dispense");
                                WriteToDebugLog(string.Format("{0}={1}", "isTcdDispenseFailed", isTcdDispenseFailed.ToString()));
                                WriteToDebugLog(string.Format("{0}={1}", "tcdDispenseTriggered", tcdDispenseTriggered.ToString()));
                                if (cashDisp.Dispense(_tlTranSet.TellerVars.DrawerNo.ToString(),
                                    (_tlTranSet.CurTran.TlTranCode.Value == "VLT" ? (double)_tlTranSet.CurTran.NetAmt.Value : (double)_tlTranSet.TranSetTotalCashOut.Value),
                                    isAutoDispense,
                                    _tcdDeviceResp))
                                {
                                    dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(361059));
                                    tcdDispenseTriggered = true;
                                    WriteToDebugLog("Dispense call successful...load cash denoms");
                                    WriteToDebugLog(string.Format("{0}={1}", "tcdDispenseTriggered", tcdDispenseTriggered.ToString()));
                                    if (_tcdDeviceResp != null)
                                        WriteToDebugLog(string.Format("{0}={1}", "Device Response count", _tcdDeviceResp.Count.ToString()));
                                    //
                                    _tlTranSet.LoadTCDCashOutDenom(_tcdDeviceResp, TlTransactionSet.UcmInterface.DeviceDispense);   //#79574
                                    if (_tlTranSet.CurTran.TlTranCode.Value == "VLT")
                                    {
                                        WriteToDebugLog("Load Vault Buy cash denoms");
                                        _tlTranSet.LoadTCDCashOutDenom(_tcdDeviceResp, TlTransactionSet.UcmInterface.VaultBuy); //#79574
                                    }
                                }
                            }

                        }
                        catch (PhoenixException)
                        {
                            if (cashDisp.ReturnCode != 0)
                            {
                                tcdDispenseTriggered = true; //#75743 - changed from false to true
                                isTcdDispenseFailed = true;
                                _isOkToBlockF1Key = false;
                                tcdAction.Visible = false; //#72916
                                WriteToDebugLog("Catch Block for UCM Dispense");
                                WriteToDebugLog(string.Format("{0}={1}", "tcdDispenseTriggered", tcdDispenseTriggered.ToString()));
                                WriteToDebugLog(string.Format("{0}={1}", "isTcdDispenseFailed", isTcdDispenseFailed.ToString()));
                                PMessageBox.Show(317446, MessageType.Warning, MessageBoxButtons.OK,
                                new string[] { cashDisp.GetErrorString(cashDisp.ReturnCode) });
                            }
                        }
                        finally
                        {
                            dlgInformation.Instance.HideInfo();
                            _isOkToBlockF1Key = false;
                            tcdAction.Shortcut = Keys.None; //#72916TBD
                            WriteToDebugLog("finally block for UCM Dispense");
                            WriteToDebugLog(string.Format("{0}={1}", "tcdDispenseTriggered", tcdDispenseTriggered.ToString()));
                            if (cashDisp.ReturnCode != 0)
                            {
                                tcdDispenseTriggered = true; //#75743 - changed from false to true
                                isTcdDispenseFailed = true;
                                WriteToDebugLog("Dispense Failed with Return Code...");
                                WriteToDebugLog(string.Format("{0}={1}", "cashDisp.ReturnCode", cashDisp.ReturnCode.ToString()));
                                if (cashDisp.ReturnCode != 0 && cashDisp.ReturnCode != -1)
                                {
                                    PMessageBox.Show(317446, MessageType.Warning, MessageBoxButtons.OK,
                                    new string[] { cashDisp.GetErrorString(cashDisp.ReturnCode) });
                                }
                            }
                            //#13797
                            if (isTcdDispenseFailed || cashDisp.ReturnCode == -1 || _tlTranSet.GetDispensedAmt(_tcdDeviceResp, (_tlTranSet.CurTran.TlTranCode.Value == "VLT" ? _tlTranSet.CurTran.NetAmt.Value : _tlTranSet.TranSetTotalCashOut.Value)) <= 0)
                            {
                                //_tlTranSet.ResetTranSetTcdInfo(true, null); //#75743
                                _tlTranSet.TranSetTotalBalanceDue.Value = (_tlTranSet.CurTran.TlTranCode.Value == "VLT" ? _tlTranSet.CurTran.NetAmt.Value : _tlTranSet.TranSetTotalCashOut.Value);
                                //#79574 - #225528
                                //_tlTranSet.TranSetTotalCashDispense.Value = (_tlTranSet.CurTran.TlTranCode.Value == "VLT" ? _tlTranSet.CurTran.NetAmt.Value : _tlTranSet.TranSetTotalCashOut);
                                //#9079
                                //_tlTranSet.TranSetTotalCashDispense.Value = (_tlTranSet.CurTran.TlTranCode.Value == "VLT" ? _tlTranSet.CurTran.NetAmt.Value : 0);
                                _tlTranSet.TranSetTotalCashDispense.Value = 0;
                            }
                        }
                        //}
                    }
                    //if (tcdDispenseTriggered && _tlTranSet.CurTran.TlTranCode.Value != "VLT")
                    //if (tcdDispenseTriggered) //#75743
                    if (tcdDispenseTriggered ||
                        (_tlTranSet.IsAcquirerTran && (Convert.ToBoolean(Workspace.Variables["IsAcquirerTranTCRCashIn"]) ||
                        Convert.ToBoolean(Workspace.Variables["IsAcquirerTranTCDCashOut"]) ||
                        Convert.ToBoolean(Workspace.Variables["IsAcquirerTranTCDDenomCashOut"])))) //#75743 //#11655 -- added acquirer conditiona
                    {
                        WriteToDebugLog("Call to ProcessTcdDispense");
                        WriteToDebugLog(string.Format("{0}={1}", "tcdDispenseTriggered", tcdDispenseTriggered.ToString()));
                        WriteToDebugLog(string.Format("{0}={1}", "_tlTranSet.IsAcquirerTran", _tlTranSet.IsAcquirerTran.ToString()));
                        _tlTranSet.ProcessTcdDispense();
                        dlgInformation.Instance.HideInfo();
                        if (!_tlTranSet.ErrorString.IsNull)
                            PMessageBox.Show(360188, MessageType.Warning, MessageBoxButtons.OK,
                                new string[] { _tlTranSet.ErrorString.Value });
                        else
                        {
                            if (!ProcessResponses(null))
                                return;
                        }
                        //
                    }
                    if (_tlTranSet.TriggerCashInOut("Post") && (!(postTcdCashOutTriggered || postCashOutTriggered)) &&
                        _tlTranSet.CurTran.TlTranCode.Value != "VLS")   //#79574
                    {
                        postCashOutTriggered = true;
                        if (tcdDispenseTriggered) //#75743
                            postTcdCashOutTriggered = true;
                        //Begin #72916
                        _totalCashOutAmount = 0;
                        WriteToDebugLog("_tlTranSet.TriggerCashInOut(Post) block");
                        WriteToDebugLog(string.Format("{0}={1}", "postTcdCashOutTriggered", postTcdCashOutTriggered.ToString()));
                        WriteToDebugLog(string.Format("{0}={1}", "postCashOutTriggered", postCashOutTriggered.ToString()));
                        WriteToDebugLog(string.Format("{0}={1}", "tcdDispenseTriggered", tcdDispenseTriggered.ToString()));
                        if (_tlTranSet.TellerVars.IsTCDConnected)
                        {
                            if (!_tlTranSet.TranSetTotalBalanceDue.IsNull && _tlTranSet.TranSetTotalBalanceDue.Value > 0)
                            {
                                if (_tlTranSet.CurTran.TlTranCode.Value == "VLT")
                                    _totalCashOutAmount = 0; //suppress balance due for VLT
                                else
                                    _totalCashOutAmount = _tlTranSet.TranSetTotalBalanceDue.Value;
                            }
                            else if (!_tlTranSet.TranSetTotalCashDispense.IsNull && _tlTranSet.TranSetTotalCashDispense.Value > 0)
                                _totalCashOutAmount = 0;
                            else
                                _totalCashOutAmount = (_tlTranSet.CurTran.TlTranCode.Value == "VLT" ? _tlTranSet.CurTran.NetAmt.Value : _tlTranSet.TranSetTotalCashOut.Value);
                        }
                        else
                        {
                            _totalCashOutAmount = _tlTranSet.TranSetTotalCashOut.Value;
                        }
                        //Begin #TellerWF
                        if (_totalCashOutAmount > 0 && _inputParamTranSet != null && _tlTranSet.CashOutDenoms.Count > 0 && 
                            (_tlTranSet.CashOutDenoms[0] as TlCashCount).TotalDenomAmt(_tlTranSet.CashOutDenoms) == _totalCashOutAmount )
                        {
                            _totalCashOutAmount = 0;
                        }
                        //End #TellerWF
                        WriteToDebugLog(string.Format("{0}={1}", "_totalCashOutAmount", _totalCashOutAmount.ToString()));
                        if (_totalCashOutAmount > 0)
                            HandleCashInOutDenom("PostCashOutDenom");
                        else
                        {
                            WriteToDebugLog("Called PostTransactions from PostTransactions in the else part of _totalCashOutAmount greater than 0");
                            PostTransactions();
                        }
                        //End #72916
                        return;
                    }
                    else if (!_tlTranSet.TriggerCashInOut("Post") && !postTcdCashOutTriggered && tcdDispenseTriggered && _tlTranSet.TellerVars.IsTCDConnected && !isTcdDispenseFailed) //#72916 #75743 - added isTcdDispenseFailed
                    {
                        postTcdCashOutTriggered = true;
                        WriteToDebugLog("Called PostTransactions from PostTransactions in the else if part of _tlTranSet.TriggerCashInOut(Post)");
                        PostTransactions();
                        return;
                    }
                    //End #72916
                }

                if (postCashOutTriggered || postTcdCashOutTriggered)
                {
                    if (postTcdCashOutTriggered && !isTcdDispenseFailed) //#75743
                    {
                        postTcdCashOutTriggered = false;
                        tcdDispenseTriggered = false;
                        //
                        if (_tlTranSet.TellerVars.AdTlControl.DenomCashIn.Value == GlobalVars.Instance.ML.Y &&
                            _tlTranSet.CurTran.TlTranCode.Value == "VLT" &&
                            !_tlTranSet.CurTran.CashIn.IsNull &&
                            _tlTranSet.CurTran.CashIn.Value > 0)
                            _tlTranSet.SaveCashOutDenom(true, CoreService.Translation.GetListItemX(ListId.DENOMTRANTYPE, "I"));
                        else if (_tlTranSet.CurTran.TlTranCode.Value != "VLT")
                            _tlTranSet.SaveCashOutDenom(true, CoreService.Translation.GetListItemX(ListId.DENOMTRANTYPE, "D"));

                    }
                    if (postCashOutTriggered)
                    {
                        postCashOutTriggered = false;
                        _tlTranSet.SaveCashOutDenom();
                    }
                }
            }
            catch (PhoenixException pe)
            {
                PMessageBox.Show(pe, MessageBoxButtons.OK);
                if (_tlTranSet.Transactions.Count > 0)
                {
                    ctwTranSet.ContextRow = _tlTranSet.Transactions.Count - 1;
                    SelectTran(-1);
                }
                return;
            }
            finally
            {
                if (!skipHide)
                    dlgInformation.Instance.HideInfo();
            }

            passbookPending = IsPbSupportedNow();
            printPending = true;

            //Begin #140895
            // #40977
            //if (_tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.Success)
            //{
            //    _tlTranSet.TellerVars.LastJrnlSequenceNo = _tlTranSet.SequenceNo.Value;
            //    if (_tlTranSet.IsTellerCaptureTran)
            //    {
            //        //string deviceResponse = "Success";
            //        //string imageCommitFlag = "Y";
            //        string deviceResponse = "Pending";
            //        string imageCommitFlag = "N";
            //        try
            //        {
            //            _tlCaptureTranXML = null;
            //            if (_tlTranSet.RecreateTlCaptureTran())
            //            {
            //                _tlCaptureAVTCSilentMode = true;
            //                if (_tellerCapture != null && _tellerCapture.IsTransactionInProgress)
            //                    this.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "ActionTlrCapSingleRelatedClick", new object[] { string.Empty });
            //                else if ( _tlCaptureNoDeviceDebugMode )
            //                {
            //                    Message msg = new Message();
            //                    this.ProcessCmdKey(ref msg, _tlCaptureNoDeviceDebugKey);
            //                }
            //            }
            //            if (_tellerCapture != null) //OOB-Fix
            //            {
            //                //_tellerCapture.SendPostResults(PostResultsStatusCode.Accepted, string.Empty);
            //                if (_tellerCapture.SendPostResults(PostResultsStatusCode.Accepted, string.Empty))
            //                {
            //                    deviceResponse = "Success";
            //                    imageCommitFlag = "Y";
            //                }
            //                else
            //                {
            //                    imageCommitFlag = "F";
            //                    deviceResponse = "Error: " + _tellerCapture.PhxErrorMessage;
            //                    _tellerCapture.PhxErrorMessage = String.Empty;
            //                }
            //            }
            //        }
            //        catch (Exception e)
            //        {
            //            deviceResponse = "Error: " + e.Message;
            //            imageCommitFlag = "F";
            //            PMessageBox.Show(e);
            //        }
            //        finally
            //        {
            //            _tlTranSet.UpdateTlCaptureImageCommitFlag(_tlCaptureTranXML, deviceResponse, imageCommitFlag);
            //        }
            //    }
            //}
            //Begin //OOB-Fix , #40977
                        if (_tellerCapture != null)
                CommitTellerCaptureTran(); //For Testing Only - Uncomment it after testing
            //End //OOB-Fix , #40977
            //End #140895

            //Begin #74014
            this.CallOtherForms("Services");
            //End #74014

            #region #7449
            cbRegD.Checked = false;
            cbRegD.Enabled = false;
            cbRegD.Visible = false;
            #endregion

			HandleBusObjMessages(_tlTranSet);	// #140791

            ActionAfterPost();
            return;
        }

        private bool SkipOnUsField()
        {
            if (dfOnUsChks.Visible && (dfOnUsChks.UnFormattedValue == null || dfOnUsChks.UnFormattedValue.ToString() == String.Empty
                || Convert.ToDecimal(dfOnUsChks.UnFormattedValue) == 0) &&
                (cmbTfrAcctType.Text == null || cmbTfrAcctType.Text.Trim() == String.Empty || !cmbTfrAcctType.Enabled) &&
                (dfTfrAcctNo.Text == null || dfTfrAcctNo.Text.Trim() == String.Empty || !dfTfrAcctNo.Enabled) &&
                (dfTfrCheckNo.Text == null || dfTfrCheckNo.Text.Trim() == String.Empty))
            {
                //				cmbTfrAcctType.TabStop = false;
                //				dfTfrAcctNo.TabStop = false;
                //				dfTfrCheckNo.TabStop = false;
                return true;
            }
            else
            {
                //				cmbTfrAcctType.TabStop = true;
                //				dfTfrAcctNo.TabStop = true;
                //				dfTfrCheckNo.TabStop = true;
                return false;
            }
        }
		//#79572
		private bool SkipTransitField()
		{
			if (dfTransitChks.Visible && (dfTransitChks.UnFormattedValue == null || dfTransitChks.UnFormattedValue.ToString() == String.Empty
				|| Convert.ToDecimal(dfTransitChks.UnFormattedValue) == 0) &&
				(dfTlItemAcctNo.Text == null || dfTlItemAcctNo.Text.Trim() == String.Empty || !dfTlItemAcctNo.Enabled) &&
				(dfTlItemRoutingNo.Text == null || dfTlItemRoutingNo.Text.Trim() == String.Empty || !dfTlItemRoutingNo.Enabled) &&
				(dfTlItemCheckNo.Text == null || dfTlItemCheckNo.Text.Trim() == String.Empty))
				return true;
			else
				return false;
		}
		//#79572

        private void InvokeRecalcPmtDisplay()   //#76425
        {
            decimal histPtid = 0;
            if (_tlTranSet.IsRecalcPmtRequired() && _tlTranSet.IsTrueRealtimeMode())
            {

                if (_isFormRecalcPmtHistoryClosed && !_isFormRecalcPmtHistoryInvoked)
                {
                    if (_tlTranSet.IsPrintStringEnabled("[RecalcPmt]", null))
                    {
                        using (new WaitCursor())
                        {
                            _isFormRecalcPmtHistoryClosed = false;
                            _isFormRecalcPmtHistoryInvoked = true;
                            histPtid = _tlTranSet.CurTran.XpPtid.Value;
                            _tlTranSet.TellerHelper.GetHistoryPtidFromXm(_tlTranSet.CurTran.TranAcct.AcctNo.Value,
                            _tlTranSet.CurTran.TranAcct.AcctType.Value, _tlTranSet.CurTran.TranAcct.TranCode.Value, ref histPtid);
                            //
                            _historyPtid = histPtid;
                            //
                            CallOtherForms("LoanPmtRecalc");
                        }
                    }
                }
            }
        }

		private void HandlePrinting()
        {
			//SignAndArchive is called from CallParent override
			int tranNo = -1;
            int chargeNo = 0;
            int copiesCount = 0;
            int arrayOffset = 0;
            int itemNo = -1;
            int printTranCode = 0;  //#76057
            string[] asRegCCHolds = null; // #74269
            PrintInfo printInfo = null;
			ArrayList prevPrintInfo = null;
            bool skipTran = false;
            bool canContinue = true;
            bool canPrint = false;
            bool rePrint = false;
            bool skipChecks = false;
            bool collectChkInfo = false;
            bool formFound = false; //#80615
            bool skipPrintWithOfacMatch = false;    // #76057
            bool skip = false;  //#194535
            int isConditionalPrintForm = 0; //#3401
            bool offline = !_tlTranSet.TellerVars.IsAppOnline; // #13811
            //begin #194535
            bool isReceipt = false;
            bool isArchiveAndEmail = false; //#41346
            bool bIsHylandServiceAvailable = _tlTranSet.IsHylandVoucherSvcAvailable() || _tlTranSet.TellerVars.IsECMVoucherAvailable;   //#118299
            string mediaName = null;
            string formName = null;
            byte[] image = null;
            TellerVars _tellerVars = TellerVars.Instance;
            //end   #194535
            bool isArchived = false;    //#40224
            bool isSignatureNeeded = false; //#42567  Do not ask for a signature twice the Regcc forms.
            string logicalService = string.Empty; //#67156
            bool tcFound = false; //Task111436

            if (!printPending)
                return;

            //#76425
            if (_tlTranSet.CurTran.TranAcct.TranCode.Value == 350 ||
                _tlTranSet.CurTran.TranAcct.TranCode.Value == 355)
                InvokeRecalcPmtDisplay();

            #region #79502
            if (!_balancesAlreadyPrompted)
            {
                _promptBalances = false;
                foreach (TlTransaction tlTranTest in _tlTranSet.Transactions)
                {
                    formFound = _tlTranSet.TellerVars.SetContextObject("AdTlTcFormArray", tlTranTest.TlTranCode.Value);
                    AdTlTcForm tmpAdTlTcForm = null;
                    for (int thisForm = 0; thisForm < _tlTranSet.TellerVars.AdTlTcFormArray.Count; thisForm++)
                    {
                        tmpAdTlTcForm = _tlTranSet.TellerVars.AdTlTcFormArray[thisForm] as AdTlTcForm;
                        if (tmpAdTlTcForm.TlTranCode.Value == tlTranTest.TlTranCode.Value)
                        {
                            int thisFormId = tmpAdTlTcForm.FormId.Value;
                            formFound = _tlTranSet.TellerVars.SetContextObject("AdTlFormArray", thisFormId);

                            //Begin 111436
                            tcFound = _tlTranSet.TellerVars.SetContextObject("AdTlTcArray", tlTranTest.TlTranCode.Value);
                            if (tcFound)
                            {
                                if (formFound && _tlTranSet.TellerVars.AdTlForm.TextQrp.Value != "R")
                                {
                                    if (_tlTranSet.TellerVars.AdTlTc.IncludePrtPrompt.Value == "Y") // #79502
                                        _promptBalances = true;
                                }
                            }
                            //End 111436
                        }
                    }
                }
            }
            #region #79502 us2011

            // #13811 - Added offline check
            if (!offline && printPending && _promptBalances && !_balancesAlreadyPrompted && _tlTranSet.TellerVars.AdTlControl.EnablePrtPrompt.Value == "Y")
            {
                CallOtherForms("PrintBalPrompt");
            }
            #endregion
            #endregion

            if (_isFormRecalcPmtHistoryClosed) //#76425
            {
                try
                {
                    do
                    {
                        canPrint = true;
                        try
                        {
                            dlgInformation.Instance.ShowInfo("Fetching Print Data...");
                            canContinue = _tlTranSet.GetNextPrintObject(null, skipTran, rePrint, skipChecks,
                                ref showItemField, ref tranNo, ref chargeNo, ref itemNo, ref formId,
                                ref copiesCount, ref collectChkInfo,
                                ref printInfo, ref arrayOffset, ref prevPrintInfo, ref canReprint, ref isConditionalPrintForm); //#3401 - added isConditionalPrintForm
                            //16278 redoing 14630 so commenting this out
                            //Begin #14630 //15177 make sure value is not null//15505 make sure frmtbarsearch is not null
                            /*if (searchRimNo > 0 && !_tlTranSet.CurTran.RimNo.IsNull && Convert.ToInt32(_tlTranSet.CurTran.RimNo.Value) != searchRimNo && frmTBarSearch!=null)
                            {
                                printInfo.RimNo = searchRimNo;
                                printInfo.AcctTitle1 = rimName;
                                printInfo.CustomerName = frmTBarSearch.colName.FormattedValue;
                            }*/
                            //End #14630
                        }
                        catch (PhoenixException pe)
                        {
                            PMessageBox.Show(pe, MessageBoxButtons.OK);
                            canPrint = false;
                        }
                        finally
                        {
                            dlgInformation.Instance.HideInfo();
                        }

                        if (printInfo != null)  //#24267
						    printInfo.RequireSignature = (_tlTranSet.TellerVars.AdTlTc.RequireSignature.Value == "Y");
						//_tlTranSet.TellerVars.SetContextObject("AdTlTcArray", Convert.ToInt32(printInfo.TlTranCode));
						//printInfo.RequireSignature = (_tlTranSet.TellerVars.AdTlTc.RequireSignature.Value == GlobalVars.Instance.ML.Y);

                        #region 79502
                        _printTfrBalances = true;
                        _printPrimaryBalances = true;

                        if (_printBalOption == "A")
                        {
                            if (_tlTranSet.TellerVars.AdTlTc.IncludePrtPrompt.Value == "Y" && !_tlTranSet.CurTran.TranAcct.bAcctHasPostAccessOnly.Value == true
                                && !((_tlTranSet.IsConfAcct(false) && _tlTranSet.TellerVars.AdTlControl.PrintConfAcctBal.Value != "Y") && !(_tlTranSet.GlobalHelper.AllowEmployeeToViewConfidentialFlag || _tlTranSet.GlobalHelper.AllowEmployeeToIgnoreConfidentialFlag))      // #19415 - replaced GlobalHelper.IsConfAcct(_tlTranSet.CurTran.TranAcct.AcctType.Value, _tlTranSet.CurTran.TranAcct.AcctNo.Value)
                                && !(_tlTranSet.CurTran.TranAcct.TranCode.Value >= 300 && _tlTranSet.CurTran.TranAcct.TranCode.Value <= 399 && _tlTranSet.TellerVars.AdTlTc.RealTimeEnable.Value != "Y")
                                && !(_tlTranSet.CurTran.TranAcct.DepLoan.Value == "GL")
                                && !(_tlTranSet.CurTran.TranAcct.DepLoan.Value == "SD" && _tlTranSet.TellerHelper.IsSafeDepositTran(_tlTranSet.CurTran.TranAcct.TranCode.Value)))
                            {
                                _tlTranSet.CurTran.PrintBalance.Value = "Y";
                            }
                            else
                            {
                                _tlTranSet.CurTran.PrintBalance.Value = "N";
                            }
                            if (!_tlTranSet.CurTran.TfrTranCode.IsNull || (_tlTranSet.CurTran.TfrTranCode.IsNull && !_tlTranSet.CurTran.TfrAcctNo.IsNull && _tlTranSet.CurTran.TfrAcctNo.Value.Trim() != ""))
                            {
                                if (_tlTranSet.TellerVars.AdTlTc.IncludePrtPrompt.Value == "Y" && !_tlTranSet.CurTran.TfrAcct.bAcctHasPostAccessOnly.Value == true
                                    && !((_tlTranSet.IsConfAcct(true) && _tlTranSet.TellerVars.AdTlControl.PrintConfAcctBal.Value != "Y") && !(_tlTranSet.GlobalHelper.AllowEmployeeToViewConfidentialFlag || _tlTranSet.GlobalHelper.AllowEmployeeToIgnoreConfidentialFlag))       // #19415 - replaced GlobalHelper.IsConfAcct(_tlTranSet.CurTran.TfrAcct.AcctType.Value, _tlTranSet.CurTran.TfrAcct.AcctNo.Value)
                                    && !(_tlTranSet.CurTran.TfrTranCode.Value >= 300 && _tlTranSet.CurTran.TfrTranCode.Value <= 399 && _tlTranSet.TellerVars.AdTlTc.RealTimeEnable.Value != "Y")
                                    && !(_tlTranSet.CurTran.TfrAcct.DepLoan.Value == "GL")
                                    && !(_tlTranSet.CurTran.TfrAcct.DepLoan.Value == "SD" && _tlTranSet.TellerHelper.IsSafeDepositTran(_tlTranSet.CurTran.TfrTranCode.Value))) // #13713
                                {
                                    _tlTranSet.CurTran.PrintTfrBalance.Value = "Y";
                                }
                                else
                                {
                                    _tlTranSet.CurTran.PrintTfrBalance.Value = "N";
                                }
                            }
                        }
                        if (!_printBalances && _tlTranSet.AdTlTc.IncludePrtPrompt.Value == "Y") // #79502
                        {
                            _printPrimaryBalances = false;
                            _printTfrBalances = false;
                            printInfo = SuppressBalances(printInfo, _tlTranSet.CurTran.TranAcct.bAcctHasPostAccessOnly.Value || _tlTranSet.CurTran.TfrAcct.bAcctHasPostAccessOnly.Value);
                        }
                        if (_printBalances && _tlTranSet.AdTlTc.IncludePrtPrompt.Value == "Y")
                        {
                            if (_tlTranSet.CurTran.PrintBalance.Value == "N")
                                _printPrimaryBalances = false;
                            if (_tlTranSet.CurTran.TfrTranCode.IsNull || _tlTranSet.CurTran.PrintTfrBalance.Value == "N")
                                _printTfrBalances = false;
                            if (!_printPrimaryBalances || !_printTfrBalances)
                                printInfo = SuppressBalances(printInfo, _tlTranSet.CurTran.TranAcct.bAcctHasPostAccessOnly.Value || _tlTranSet.CurTran.TfrAcct.bAcctHasPostAccessOnly.Value);
                        }
                        #endregion

                        formFound = _tlTranSet.TellerVars.SetContextObject("AdTlFormArray", formId); // #80615

                        if ((_tlTranSet.TellerVars.AdTlControl.EnableMtPrint.Value == "Y" && _tlTranSet.TellerVars.AdTlForm.TextQrp.Value != "R") || _tlTranSet.TellerVars.AdTlControl.EnableMtPrint.Value != "Y") // #80615
                        {
							canPrint = !(!ProcessResponses(null) || printInfo == null);
                            isReceipt = _tlTranSet.TellerVars.AdTlForm.ServiceType.Value == "Receipt";    //#194535
                            //if ( skipChecks && printInfo.ItemNo > 0 )
                            //continue;

                            if (canContinue && canPrint)
                            {
                                #region Get Float Lines - #74269
                                 /*13555 did not not find code that puts the '^' but splitting based on \r\n that were actually in the string*/
                                if (printInfo.RegCCHolds != null)
							    {
							      if (printInfo.RegCCHolds.Contains("^"))
								      asRegCCHolds = printInfo.RegCCHolds.Split('^');
								  else
							          asRegCCHolds = printInfo.RegCCHolds.Split(new string[] { "\n", "\r\n" }, StringSplitOptions.RemoveEmptyEntries);
                                  if (_adGbBankControl.RegCcEsignChange.Value == "N") //#43143
                                  {
                                      isPrintRequired = true;  //Disable email radio button in dlgReceiptInfo.
                                  }
                                }
                                else
                                {
                                    isPrintRequired = false; //#43143 Enable email radio button in dlgReceiptInfo.
                                }
                                #endregion

                                printInfoForm = printInfo;

                                if (collectChkInfo && !_tlTranSet.IsCheckPrintAvailable(false, -1, false)) //Selva-ChkPrintFix
                                {
                                    CallOtherForms("CheckInfo");
                                }

                                //canReprint = ( prevPrintInfo != null && prevPrintInfo.Count > 0 );
                                printTranCode = Convert.ToInt16(_tlTranSet.CurTran.TranCode.Value);

                                if (!(_tlTranSet.IsCheckPrintAvailable(false, -1, false) && collectChkInfo && (printTranCode == 902 || printTranCode == 910))) // #76057 Do not print Wosa if Sqr
                                {
                                    for (int i = 1; i <= copiesCount; i++)
                                    {
                                        if (i > 1)
                                            printInfoForm.Duplicate = true;
                                        passbookAcctDetails = null;		// #71242
                                        #region Print Single/Multiple Forms - #74269
                                        /*-----#74269 - Commented original code-----
                    CallOtherForms( "PrintForm" );
					skipTran = dialogResult == DialogResult.Cancel;
					rePrint = dialogResult == DialogResult.Retry;
					skipChecks = dialogResult == DialogResult.Abort;
					if ( rePrint || skipTran || skipChecks )
						break;
                    -------#74269 - End commented code-------*/
                                        if (asRegCCHolds != null)
                                        {
                                            if (asRegCCHolds.Length <= 3 && printInfo.RegCCHolds != null)
                                            {
                                                printInfo.RegCCHolds = printInfo.RegCCHolds.Replace("^", " | ");
                                                printInfo.RegCCHolds = printInfo.RegCCHolds.Replace("\r\n", " | ");/*13555 did not find "^" but \r\n were there in the string*/
                                                //begin #194535
                                                if (_tlTranSet.TellerVars.AdTlControl.EnableEreceipt.Value == "Y" && isReceipt && _tlTranSet.TellerVars.IsAppOnline)    //#42151
                                                {
                                                    _tlTranSet.CurTran.TranAcct.FromMTForms.Value = "N";
                                                    CallOtherForms("eReceipt");
                                                    if (dialogResult == DialogResult.No || dialogResult == DialogResult.OK)
                                                    {
                                                        //if (bIsHylandServiceAvailable)
                                                        isArchiveAndEmail = (dialogResult == DialogResult.No);  //#41346
                                                        if (dialogResult == DialogResult.OK)
                                                        {
                                                            if (myInstruction.ReceiptDelMethod == PRINTANDEMAIL)
                                                            {
                                                                PrintAndArchive = true;
                                                            }
                                                            else if (myInstruction.ReceiptDelMethod == EMAIL)
                                                            {
                                                                isArchiveAndEmail = true;   //#41346
                                                            }
                                                            //begin #40196
                                                            else if (myInstruction.ReceiptDelMethod == PRINT)
                                                            {
                                                                emailAddress = "";
                                                            }
                                                            //end   #40196
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    CallOtherForms("PrintForm");
                                                    isArchiveAndEmail = false;  //#41346
                                                    PrintAndArchive = false;
                                                }
                                                //end   #194535
                                                skipTran = dialogResult == DialogResult.Cancel;
                                                rePrint = dialogResult == DialogResult.Retry;
                                                skipChecks = dialogResult == DialogResult.Abort;
                                                skip = dialogResult == DialogResult.Ignore;     //#194535
                                                if (rePrint || skipTran || skipChecks || skip)  //#194535
                                                    break;
                                            }
                                            else
                                            {
                                                string holdInfo = "";
                                                isReadOnly = false;    //#42567 Do not disable screen edits in dlgReceiptInfo
                                                for (int b = 0; b < asRegCCHolds.Length; b++)
                                                {
                                                    if (b == asRegCCHolds.Length - 1)
                                                        holdInfo += asRegCCHolds[b];
                                                    else
                                                        holdInfo += asRegCCHolds[b] + " | ";
                                                    if ((b + 1) % 3 == 0 || b == asRegCCHolds.Length - 1)
                                                    {
                                                        printInfo.RegCCHolds = holdInfo;
                                                        //begin #194535
                                                        if (_tlTranSet.TellerVars.AdTlControl.EnableEreceipt.Value == "Y" && isReceipt && _tlTranSet.TellerVars.IsAppOnline)    //#42151
                                                        {
                                                            _tlTranSet.CurTran.TranAcct.FromMTForms.Value = "N";
                                                            CallOtherForms("eReceipt");
                                                            if (dialogResult == DialogResult.No || dialogResult == DialogResult.OK)
                                                            {
                                                                //if (bIsHylandServiceAvailable)
                                                                isArchiveAndEmail = (dialogResult == DialogResult.No);  //#41346
                                                                if (dialogResult == DialogResult.OK)
                                                                {
                                                                    if (myInstruction.ReceiptDelMethod == PRINTANDEMAIL)
                                                                    {
                                                                        PrintAndArchive = true;
                                                                    }
                                                                    else if (myInstruction.ReceiptDelMethod == EMAIL)
                                                                    {
                                                                        isArchiveAndEmail = true;   //#41346
                                                                    }
                                                                    //begin #40196
                                                                    else if (myInstruction.ReceiptDelMethod == PRINT)
                                                                    {
                                                                        emailAddress = "";
                                                                    }
                                                                    //end   #40196
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            CallOtherForms("PrintForm");
                                                            isArchiveAndEmail = false;  //#41346
                                                            PrintAndArchive = false;
                                                        }
                                                        //end   #194535
                                                        skipTran = dialogResult == DialogResult.Cancel;
                                                        rePrint = dialogResult == DialogResult.Retry;
                                                        skipChecks = dialogResult == DialogResult.Abort;
                                                        holdInfo = "";
                                                        skip = dialogResult == DialogResult.Ignore;     //#194535
                                                        if (rePrint || skipTran || skipChecks || skip) // Break out of print loop   //#194535
                                                            break;
                                                        //begin #42567  Email the Reg CC lines
                                                        if (PrintAndArchive || isArchiveAndEmail)
                                                        {
                                                            mediaName = _tlTranSet.TellerVars.AdTlForm.MediaName.Value;
                                                            formName = _tlTranSet.TellerVars.AdTlForm.FormName.Value;


                                                            combinedBitmap = null;
                                                            //Begin #67156
                                                            logicalService = (TellerVars.Instance.IsRemotePrinting) ? TellerVars.Instance.PrinterSvcReceipt : _tlTranSet.TellerVars.AdTlForm.LogicalService.Value;
                                                            //begin #194535
                                                            if (myLogicalService != "")
                                                            {
                                                                logicalService = myLogicalService;
                                                            }
                                                            //end   #194535

                                                            //_printer = new XfsPrinter(TellerVars.Instance.PrinterSvcReceipt); //_tellerVars.AdTlForm.LogicalService.Value
                                                            _printer = new XfsPrinter(logicalService); //_tellerVars.AdTlForm.LogicalService.Value
                                                            _printer.UseImaging = true;
                                                            _printCustName = printInfo.CustomerName;
                                                            _printRimNo = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                                                            if (PrintAndArchive)
                                                            {
                                                                // If I am PrintAndArchive I have already printed the form in dlgReceiptInfo,
                                                                // so tell it to image it only.
                                                                isArchiveAndEmail = true;
                                                            }
                                                            _printer.PrintFormAndReturnImage(mediaName, formName, printInfo, out image, isArchiveAndEmail);
                                                            combinedBitmap = new Bitmap(new MemoryStream((byte[])image));
                                                            //_printer.GetCombinedBitmapAndSigBoxDetails(out combinedBitmap, out sigPos);
                                                            sigPos = new SigBoxDetails();
                                                            _printer.ClearBitmaps();

                                                            if (_printCustName == null)
                                                            {
                                                                _printCustName = "";
                                                            }
                                                            sigPos.CombinedformHeight = combinedBitmap.Height;
                                                            sigPos.CombinedFormWidth = combinedBitmap.Width;
                                                            isSignatureNeeded = printInfo.RequireSignature; //#42567 Do we need a signature.
                                                            if (isReadOnly)   //#42567
                                                            {
                                                                isSignatureNeeded = false;  //already got the signature, so don't ask again
                                                            }
                                                            if (sigPos.x1 == 0) //#119678
                                                            {
                                                                if (_imageData.Count == 3 && _imageData[1] != null) //120142
                                                                {
                                                                    sigPos = (SigBoxDetails)_imageData[1];
                                                                }
                                                            }
                                                            SignAndArchiveVoucher(combinedBitmap, sigPos, printInfo, isSignatureNeeded, false, emailAddress);  //#42567
                                                            isArchived = true;
                                                        }
                                                        isReadOnly = true;    //Disable screen edits in dlgReceiptInfo
                                                        //end #42567
                                                    }
                                                }
                                                isReadOnly = false;    //#42567  Do not disable screen edits in dlgReceiptInfo because we are done with Reg CC print/email
                                            }
                                        }
                                        else if (isConditionalPrintForm == 1 && _tlTranSet.CurTran.Bonds != null && _tlTranSet.CurTran.Bonds.Count > 0)
                                        {
                                            #region WI-3401
                                            // Begin *76047
                                            foreach (GbBondPurchase tlBond in _tlTranSet.CurTran.Bonds)
                                            {
                                                //Bond Owner info
                                                tlBond.BuildFullNames();
                                                //
                                                if (!tlBond.OwnerFullName.IsNull)
                                                    printInfo.BondOwnerName = tlBond.OwnerFullName.Value;
                                                if (!tlBond.OwnerRimNo.IsNull)
                                                    printInfo.BondOwnerRimNo = tlBond.OwnerRimNo.Value;
                                                if (!tlBond.Tin.IsNull)
                                                    printInfo.BondOwnerSSN = _gbHelper.FormatTIN(tlBond.Tin.Value, "Y");  // #04790 - passed second para
                                                if (!tlBond.InCareOf.IsNull)
                                                    printInfo.BondInCareOf = tlBond.InCareOf.Value;
                                                if (!tlBond.AddressLine1.IsNull)
                                                    printInfo.BondOwnerAddr = tlBond.AddressLine1.Value;
                                                if (!tlBond.City.IsNull)
                                                    printInfo.BondOwnerCity = tlBond.City.Value;
                                                if (!tlBond.State.IsNull)
                                                    printInfo.BondOwnerState = tlBond.State.Value;
                                                if (!tlBond.Zip.IsNull)
                                                    printInfo.BondOwnerZip = tlBond.Zip.Value;
                                                //Bond Co-Owner
                                                if (!tlBond.CoOwnerFullName.IsNull)
                                                    printInfo.BondCoOwnerName = tlBond.CoOwnerFullName.Value;
                                                //Bond Monetary info
                                                if (!tlBond.TotalBondQuantity.IsNull)
                                                    printInfo.BondTotalOrderQty = tlBond.TotalBondQuantity.Value;
                                                if (!tlBond.TotalOrderAmt.IsNull)
                                                    printInfo.BondTotalOrderAmt = tlBond.TotalOrderAmt.Value;
                                                if (!tlBond.TotalOrderAmt.IsNull)
                                                    printInfo.BondFaceValue = tlBond.TotalOrderAmt.Value;
                                                //call pringing
                                                //begin #194535
                                                if (_tlTranSet.TellerVars.AdTlControl.EnableEreceipt.Value == "Y" && isReceipt && _tlTranSet.TellerVars.IsAppOnline)    //#42151
                                                {
                                                    _tlTranSet.CurTran.TranAcct.FromMTForms.Value = "N";
                                                    CallOtherForms("eReceipt");
                                                    if (dialogResult == DialogResult.No || dialogResult == DialogResult.OK)
                                                    {
                                                        //if (bIsHylandServiceAvailable)
                                                        isArchiveAndEmail = (dialogResult == DialogResult.No);  //#41346
                                                        if (dialogResult == DialogResult.OK)
                                                        {
                                                            if (myInstruction.ReceiptDelMethod == PRINTANDEMAIL)
                                                            {
                                                                PrintAndArchive = true;
                                                            }
                                                            else if (myInstruction.ReceiptDelMethod == EMAIL)
                                                            {
                                                                isArchiveAndEmail = true;   //#41346
                                                            }
                                                            //begin #40196
                                                            else if (myInstruction.ReceiptDelMethod == PRINT)
                                                            {
                                                                emailAddress = "";
                                                            }
                                                            //end   #40196
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    CallOtherForms("PrintForm");
                                                    isArchiveAndEmail = false;  //#41346
                                                    PrintAndArchive = false;
                                                }
                                                //end   #194535
                                                skipTran = dialogResult == DialogResult.Cancel;
                                                rePrint = dialogResult == DialogResult.Retry;
                                                skipChecks = dialogResult == DialogResult.Abort;
                                                skip = dialogResult == DialogResult.Ignore;     //#194535
                                                if (rePrint || skipTran || skip) // Break out of print loop //#194535
                                                    break;
                                            }
                                            // End #7604
                                            #endregion
                                        }
                                        else if (isConditionalPrintForm >= 0) /* 75678 */    //#76425
                                        {
                                            //begin #194535
                                            if (_tlTranSet.TellerVars.AdTlControl.EnableEreceipt.Value == "Y" && isReceipt && !printInfoForm.Duplicate && _tlTranSet.TellerVars.IsAppOnline) //#42171
                                            {
                                                _tlTranSet.CurTran.TranAcct.FromMTForms.Value = "N";
                                                CallOtherForms("eReceipt");
                                                if (dialogResult == DialogResult.No || dialogResult == DialogResult.OK)
                                                {
                                                    //if (bIsHylandServiceAvailable)
                                                    isArchiveAndEmail = (dialogResult == DialogResult.No);  //#41346
                                                    if (dialogResult == DialogResult.OK)
                                                    {
                                                        if (myInstruction.ReceiptDelMethod == PRINTANDEMAIL)
                                                        {
                                                            PrintAndArchive = true;
                                                        }
                                                        else if (myInstruction.ReceiptDelMethod == EMAIL)
                                                        {
                                                            isArchiveAndEmail = true;   //#41346
                                                        }
                                                        //begin #40196
                                                        else if (myInstruction.ReceiptDelMethod == PRINT)
                                                        {
                                                            emailAddress = "";
                                                        }
                                                        //end   #40196
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                CallOtherForms("PrintForm");
                                                isArchiveAndEmail = false;  //#41346
                                                PrintAndArchive = false;
                                            }
                                            //end   #194535
                                            skipTran = dialogResult == DialogResult.Cancel;
                                            rePrint = dialogResult == DialogResult.Retry;
                                            skipChecks = dialogResult == DialogResult.Abort;
                                            skip = dialogResult == DialogResult.Ignore;     //#194535
                                            if (rePrint || skipTran || skipChecks || skip)
                                                break;
                                        }
                                        #endregion
                                        if (rePrint || skipTran || skipChecks || skip) // Break out of copies loop  //#194535
                                            break;
                                        //begin #194535
                                        if (PrintAndArchive || isArchiveAndEmail)   //#41346
                                        {
                                            mediaName = _tlTranSet.TellerVars.AdTlForm.MediaName.Value;
                                            formName = _tlTranSet.TellerVars.AdTlForm.FormName.Value;


                                            combinedBitmap = null;
                                            //Begin #67156
                                            logicalService = (TellerVars.Instance.IsRemotePrinting) ? TellerVars.Instance.PrinterSvcReceipt : _tlTranSet.TellerVars.AdTlForm.LogicalService.Value;
                                            //begin #194535
                                            if (myLogicalService != "")
                                            {
                                                logicalService = myLogicalService;
                                            }
                                            //end   #194535
                                            //_printer = new XfsPrinter(TellerVars.Instance.PrinterSvcReceipt); //_tellerVars.AdTlForm.LogicalService.Value
                                            _printer = new XfsPrinter(logicalService); //_tellerVars.AdTlForm.LogicalService.Value

                                            _printer.UseImaging = true;
                                            _printCustName = printInfo.CustomerName;
                                            _printRimNo = _tlTranSet.CurTran.TranAcct.RimNo.Value;
                                            if (PrintAndArchive)    //#41346
                                            {
                                                // If I am PrintAndArchive I have already printed the form in dlgReceiptInfo,
                                                // so tell it to image it only.
                                                isArchiveAndEmail = true;
                                            }
                                            _printer.PrintFormAndReturnImage(mediaName, formName, printInfo, out image, isArchiveAndEmail); //#41346
                                            combinedBitmap = new Bitmap(new MemoryStream((byte[])image));
                                            //_printer.GetCombinedBitmapAndSigBoxDetails(out combinedBitmap, out sigPos);
                                            sigPos = new SigBoxDetails();
                                            _printer.ClearBitmaps();

                                            if (_printCustName == null)
                                            {
                                                _printCustName = "";
                                            }
                                            sigPos.CombinedformHeight = combinedBitmap.Height;
                                            sigPos.CombinedFormWidth = combinedBitmap.Width;
                                            //Phoenix.Windows.Client.frmTlTranCode.SignAndArchiveVoucher(combinedBitmap, sigPos, printInfo, mtRequireSignature, true, emailAddress);
                                            if (sigPos.x1 == 0) //#119678
                                            {
                                                if (_imageData.Count == 3 && _imageData[1] != null) //120142
                                                {
                                                    sigPos = (SigBoxDetails)_imageData[1];
                                                }
                                            }
                                            SignAndArchiveVoucher(combinedBitmap, sigPos, printInfo, printInfo.RequireSignature, false, emailAddress);  //#41584
                                            isArchived = true; //#40224
                                        }
                                        //end #194535
                                    }
                                    //Begin #79510, #09368
                                    if (_tlTranSet.IsAcquirerTran && dialogResult == DialogResult.OK && printInfo.ItemNo > 0 && printInfo.ItemNo <= _tlTranSet.CurTran.Items.Count)
                                    {
                                        (_tlTranSet.CurTran.Items[printInfo.ItemNo - 1] as TlItemCapture).EndorseStatus.Value = "P";
                                    }
                                    //End #79510, #09368
                                } // #76057 End If

                                #region #76057
                                // As Tech Spec directed - form not skipped if (_tlTranSet.IsCheckPrintAvailable() && dialogResult == DialogResult.OK && (_tlTranSet.CurTran.TranCode.Value == 902 || _tlTranSet.CurTran.TranCode.Value == 910))
                                if (_tlTranSet.IsCheckPrintAvailable(false, -1, false) && (_tlTranSet.CurTran.TranCode.Value == 902 || _tlTranSet.CurTran.TranCode.Value == 910))
                                {
                                    #region OFAC Search Selva-ChkPrintFix
                                    bool isFound = false;
                                    //if (!_tlTranSet.SearchGbOfacSdnList(printInfo.CheckLine1, Convert.ToInt32(_tlTranSet.CurTran.TranAcct.RimNo.Value)))
                                    //{
                                    //    if (_tlTranSet.SearchGbOfacSdnList(printInfo.CheckLine2, Convert.ToInt32(_tlTranSet.CurTran.TranAcct.RimNo.Value)))
                                    //        isFound = true;
                                    //}
                                    //else
                                    //    isFound = true;
                                    if (isFound)
                                    {
                                        // 11/07/2008 - It was decided not to prompt user to print check - just print always
                                        //if (PMessageBox.Show(this, 10788, MessageType.Message, MessageBoxButtons.YesNo) == DialogResult.No)
                                        //{
                                        //    // do not print check
                                        //    skipPrintWithOfacMatch = true;
                                        //}
                                        PMessageBox.Show(this, 10788, MessageType.Message, MessageBoxButtons.OK);
                                    }
                                    #endregion

                                    if (!skipPrintWithOfacMatch)
                                    {
                                        if (_tlTranSet.IsCheckPrintAvailable(false, -1, false) && collectChkInfo)
                                        {
                                            printInfo.CheckNo = _tlTranSet.CurTran.CheckNo.Value; //9591
                                            printInfo.JournalPtid = _tlTranSet.CurTran.Ptid.Value; //9591
                                            printInfo.SbSeqNo = _tlTranSet.CurTran.SubSequence.StringValue; //#120397
                                            GenerateChkPrintingReport(printInfo); //9591
                                        }
                                    }
                                }
                                #endregion
                            }
                        }

                        if ((_tlTranSet.IsHylandVoucherSvcAvailable() || _tlTranSet.TellerVars.IsECMVoucherAvailable) && _tlTranSet.IsVoucherForm(formId, printInfo) && !isArchived)   //#40224 #118299
                        {
                            //#157637 imagedata arraylist reference is passed to (as param from callotherforms()) and populated in dlgprintforms with data that was printed
                            if (_imageData.Count == 3)
                            {
                                Bitmap comBmp = (Bitmap)_imageData[0];
                                SigBoxDetails sigBxDt = (SigBoxDetails)_imageData[1];
                                PrintInfo pInfo = (PrintInfo)_imageData[2];
                                SignAndArchiveVoucher(comBmp, sigBxDt, pInfo, pInfo.RequireSignature, false, emailAddress); //#194535
                            }
                        }
						_imageData.Clear();

                    } while (canContinue);
                }
                finally
                {
                    if (_tlTranSet.TellerVars.AdTlControl.EnableMtPrint.Value != "Y") // #80615
                    {
                        //Begin #79510, #09368
                        if (_tlTranSet.IsAcquirerTran)
                        {
                            _tlTranSet.UpdateEndorsementStatus();
                        }
                        //End #79510, #09368

                        //#04449 - Added loop
                        foreach (TlTransaction tlTran in _tlTranSet.Transactions)
                        {
                            if (tlTran.BondExists)
                            {
                                if (PMessageBox.Show(11214, MessageType.Question, MessageBoxButtons.YesNo) == DialogResult.Yes)
                                {
                                    //foreach (GbBondPurchase bond in _tlTranSet.CurTran.Bonds)
                                    //{
                                    //    // Begin #4306
                                    //    bond.GenerateBondFDF(false);
                                    //    // End #4306
                                    //}

                                    printBondFDFs();
                                }
                                break;
                            }
                        }
                        printPending = false;
                        showItemField = false;
                        //
                        if (_isFormRecalcPmtHistoryInvoked) //#76425
                            ActionAfterHandlePrinting();
                    }
                }
            }
        }

        private void printBondFDFs()
        {
            //#04449 - Added loop
            foreach (TlTransaction tlTran in _tlTranSet.Transactions)
            {
                if (tlTran.BondExists)
                {
                    foreach (GbBondPurchase bond in tlTran.Bonds)
                    {
                        //#04449 - Enlose teh code in try catch block and wait for process to complete


                        try
                        {
                            dlgInformation.Instance.ShowInfo("Printing Bond(s)...");
                            Phoenix.BusObj.Misc.Eforms eformBusObj = new Phoenix.BusObj.Misc.Eforms();
                            eformBusObj.EFormTemplateName.Value = "SavingsBond.PDF";
                            eformBusObj.EFormLocalPath.Value = Environment.CurrentDirectory + @"\forms\";
                            eformBusObj.PDFMode.Value = "View";
                            eformBusObj.NoCopies.Value = 1;
                            eformBusObj.PrintType.Value = "S";
                            eformBusObj.CreateAudit.Value = "Y";
                            Application.DoEvents();
                            eformBusObj.GenerateFDF(bond);
                            if (eformBusObj.AdobeProcess != null)
                            {
                                eformBusObj.AdobeProcess.WaitForExit(2 * 60 * 1000);    //2 min
                                //eformBusObj.AdobeProcess.Exited += new EventHandler(AdobeProcess_Exited);
                            }

                        }
                        finally
                        {
                            dlgInformation.Instance.Hide();
                            Application.DoEvents();
                        }
                    }
                }
            }
        }

        #region GenerateChkPrintingReport - #76057
        //9591 public void GenerateChkPrintingReport()
        public void GenerateChkPrintingReport(PrintInfo printInfo)
        {
            bool Result = false;
            string rptName = null;

            //9591 commented block
            //PInt pBranch = new PInt("a1");
            PInt pTranCode = new PInt("a2");
            //PString pJournalPtid = new PString("journalPtid");
            //pBranch.Value = Convert.ToInt16(_tlTranSet.BranchNo.Value);
            pTranCode.Value = Convert.ToInt16(_tlTranSet.CurTran.TranCode.Value);
            //pJournalPtid.Value = Convert.ToString(_tlTranSet.CurTran.Ptid.Value.ToString());

            //TlChkForm CheckForm = null;		// #9608

            //if (_tlTranSet.CurTran.TlChkForms.Count > 0)
            //{
            //    // Make sure we set the proper printer context just in case multiple trans were created using AddNext
            //    CheckForm = _tlTranSet.CurTran.TlChkForms[0] as TlChkForm;
            //    _tlTranSet.TellerVars.SetPrinterContextObject(CheckForm.PrinterPtid.DecimalValue);
            //}

			/*
			 * #79621 - No longer needed; we're using a TlChkPrinter object instead ...
			 * string printerInfo = _tlTranSet.GetPrinterInfo(pBranch, pTranCode);
			 * string[] printerInfoArray = new string[2];
			 * printerInfoArray = printerInfo.Split('^');
			*/

            if (pTranCode.Value == 902)
                rptName = "TLC60000.SQR";
            else if (pTranCode.Value == 910)
                rptName = "TLC60500.SQR";

            if (OnlineCheckHelper.IsInitialized)
            {
                DateTime Today = GlobalVars.SystemDate;

                OnlineCheckHelper.DeleteAfterPrint = false;

				/* #79621 - Change this call, using the Printer object properties instead of the printerInfoArray ..
				 *
				 * Result = OnlineCheckHelper.PrintCheck(rptName,
				 *    printerInfoArray[1].ToString(),
				 *    printerInfoArray[2].ToString(),
				 *    Today.AddDays(-1),
				 *    Today,
				 *    DateTime.Now,
				 *    GlobalVars.EmployeeId,
				 *    pJournalPtid.Value,
				 *    null,
				 *    null,
				 *    null,
				 *    null,
				 *    null);
				*/

				Result = OnlineCheckHelper.PrintCheck(
                    rptName,
                    printInfo.PrinterTray, //9591 _tlTranSet.TellerVars.TlChkPrinter.Tray.Value,
                    printInfo.CheckPrinterID, //9591 _tlTranSet.TellerVars.TlChkPrinter.ChkPrintPort.Value,
					Today.AddDays(-1),
					Today,
					DateTime.Now,
					GlobalVars.EmployeeId,
                    printInfo.JournalPtid.ToString(), //9591 pJournalPtid.Value,
                    printInfo.PrinterPtid.ToString(), //9591 _tlTranSet.TellerVars.TlChkPrinter.Ptid.StringValue, //9591
                    printInfo.CheckNo.ToString(), //9591 _tlTranSet.CurTran.CheckNo.StringValue,    //9591
					null,
					null,
					null);
            }
        }
        #endregion

        public override INotesInfo GetNotesInfo()
        {
            //if ( !ShowTranAcctAlertsOnCurTab())
            if (!ShowTranAcctAlertsOnCurTab() && (picTabs.SelectedIndex != 3 && (picTabs.SelectedIndex != (int)TAB.QuickTran))) //Task#89967
                return null;
            PNotes note = new PNotes();
            //71033 - We need to show all the notes on screen id 889 and RimNo Ptid
            if (picTabs.SelectedIndex == 3)
            {
                //With this we show notes for customer summary also
                /*Begin #101490*/
                /*note.ScreenId = Phoenix.Shared.Constants.ScreenId.GbAccountListRim;*/
                note.ScreenId = Phoenix.Shared.Constants.ScreenId.AccountListRim;
                /*End #101490*/
                note.ScreenPtid = frmGloAccountListRim._rmAcctPtid;
                note.RimNo = frmGloAccountListRim._rmAcctPtid; // #17473
            }
            //Begin Task#89967
            else if (picTabs.SelectedIndex == (int)TAB.QuickTran && QuickAccountSelectedRow.RowState != DataRowState.Detached)
            {
                note.ScreenId = Phoenix.Shared.Constants.ScreenId.GbAccountListRim;
                note.ScreenPtid = RmAcctPtid;
                note.RimNo = RmAcctPtid;
            }
            //End Task#89967
            else
            {
                note.ScreenId = -ScreenId;
                if (_isShowOnUsNotes) // #80620
                {
                    note.AcctType = _tlTranSet.CurTran.TfrAcct.AcctType.Value;
                    note.AcctNo = _tlTranSet.CurTran.TfrAcct.AcctNo.Value;
                    note.RimNo = _tlTranSet.CurTran.TfrAcct.RimNo.Value;
                    if (!_tlTranSet.CurTran.TfrAcct.CustomerPTID.IsNull)
                        note.ScreenPtid = (int)_tlTranSet.CurTran.TfrAcct.CustomerPTID.Value;
                }
                else
                {
                    note.AcctType = _tlTranSet.CurTran.TranAcct.AcctType.Value;
                    note.AcctNo = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
                    note.RimNo = _tlTranSet.CurTran.TranAcct.RimNo.Value; // #80657
                    if (!_tlTranSet.CurTran.TranAcct.CustomerPTID.IsNull)
                        note.ScreenPtid = (int)_tlTranSet.CurTran.TranAcct.CustomerPTID.Value;
                }
            }
            return note;

            #region Old Code
            //			if ( !ShowTranAcctAlertsOnCurTab())
            //				return null;
            //			PNotes note = new PNotes();
            //			note.ScreenId = -ScreenId;
            //			note.AcctType = _tlTranSet.CurTran.TranAcct.AcctType.Value;
            //			note.AcctNo = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
            //			if ( !_tlTranSet.CurTran.TranAcct.CustomerPTID.IsNull )
            //				note.ScreenPtid = (int)_tlTranSet.CurTran.TranAcct.CustomerPTID.Value;
            //			return note;
            #endregion
        }

        private void SetNotesFlag()
        {
            //71110 - Turn off Notes info if prime db not available
            if (Phoenix.FrameWork.CDS.DataService.Instance.PrimaryDbAvailable)
            {
                if (picTabs.SelectedIndex == 3)
                {
                    FormExtension t = Extension as FormExtension;
                    t.IsNotesAvailable = (t.NotesInfo.Count > 0);
                    ShowNotes = (t.NotesInfo.Count > 0);
                }
                else
                {
                    (Extension as FormExtension).IsNotesAvailable = ShowTranAcctAlertsOnCurTab() && showNotes;
                    ShowNotes = ShowTranAcctAlertsOnCurTab() && !_tlTranSet.CurTran.TranAcct.AcctType.IsNull &&
                        !_tlTranSet.CurTran.TranAcct.AcctNo.IsNull && _tlTranSet.CurTran.TranAcct.SuspectAcct.Value != 1;
                }
            }
            else
            {
                (Extension as FormExtension).IsNotesAvailable = false;
                ShowNotes = false;

            }
            //71110
        }

        //Begin Enh# 69248
        private bool ScanAcctTracker(string psMode, int pnRimNo)
        {
            //Temp is used to enuemrate. We cannot use the org hash as we will be modifying it inside the enumeration
            Hashtable TmpHash = (Hashtable)acctsTrackHash.Clone();

            IDictionaryEnumerator hashenum = TmpHash.GetEnumerator();
            while (hashenum.MoveNext())
            {
                string sKey = hashenum.Key.ToString();
                string sValue = hashenum.Value.ToString();

                if (psMode == "Acct")
                {
                    if ((sKey.Trim() == dfAcctNo.Text.Trim()) && (sValue.Trim() == cmbAcctType.Text.Trim()))
                        return true;
                    else
                    {
                        //check if the RIM No exists
                        if (pnRimNo > 0)
                        {
                            if ((sKey.Trim() == pnRimNo.ToString().Trim()) && (sValue.Trim() == "RIM"))
                                return true;
                        }

                        ManipulateAcctTrackList(psMode, pnRimNo);
                    }
                }
                else
                {
                    if ((sKey.Trim() == searchRimNo.ToString().Trim()) && (sValue.Trim() == "RIM"))
                        return true;
                    else
                    {
                        ManipulateAcctTrackList(psMode, pnRimNo);
                    }
                }
            }

            ManipulateAcctTrackList(psMode, pnRimNo);

            return false;
        }

        #region Quick Tran

        //Begin 89899
        public void PopulateRMSWithQuickTranInfo(int rimNo)
        {
            RefreshCustLookupGrid = true; //#100896
            Name3.IsDisabled = !ScreenHasAccess("custSummary", false);
            this.Workspace.Variables["RimNo"] = searchRimNo = rimNo;
            searchAcctType = "RIM";
            searchAcctNo = Convert.ToString(rimNo);
            if (_tlTranSet.EnableChecksOnlyTran)    //#102719   - Cancel the existing checks tran 
            {
                HandleCancelAVTCTransaction(false);
                if (!string.IsNullOrEmpty(_tlCaptureTranXML))
                    _tlCaptureTranXML = null;
                if (_tlTranSet.TlCaptureChecksOnlyItems != null && _tlTranSet.TlCaptureChecksOnlyItems.Count > 0)
                    _tlTranSet.TlCaptureChecksOnlyItems.Clear();
                if (_tlTranSet.TlCaptureInputItems != null && _tlTranSet.TlCaptureInputItems.Count > 0)
                    _tlTranSet.TlCaptureInputItems.Clear();
                if (_tlTranSet.TlCaptureOnValidateItems != null && _tlTranSet.TlCaptureOnValidateItems.Count > 0)
                    _tlTranSet.TlCaptureOnValidateItems.Clear();
            }
            _tlTranSet.EnableChecksOnlyTran = (_tlTranSet.TellerVars.IsTellerCaptureEnabled && _tlTranSet.TellerVars.AdTlControl.SingleRelated.Value == "Y");   //102719
        }
        //End 89899

        //maps and validates the easy capture transet to _tlTranSet object
        //Begin #87731
        //public void ProcessEasyCaptureTran(string transaction)
        //{
        //    this.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "OnTransmitForPost", new object[] { transaction });
        //    SetTellerCaptureFlagForTranSet(false);
        //    EnableDisableTellerCaptureTran("SwitchToPhoenixTran");
        //}

        public void PerformQuickTranActionClick(string actionName, params object[] paramList) //#87731
        {
                if (actionName == "CashIn")
            {
                //if (_tlTranSet.TellerVars.AdTlControl.DenomCashIn.Value == "Y")
                //    pbCashIn_Click(_quickTranWindow.CashIn, null);
                if (_tlTranSet.TellerVars.AdTlControl.DenomCashIn.Value == "Y")
                {
                    pbCashIn.ImageButton.Focus();
                    pbCashIn.PerformClick();
                }
            }
            else if (actionName == "Post")
                OnActionSave(false);
            else if (actionName == "ItemCapture")   //#89998
                pbItemCapture_Click(pbItemCapture, null);
        }

        public void QuickTranDeviceDeposit() //#89998
        {
            if (picTabs.SelectedTab == tabEasyCapture && _quickTranWindow != null)
            {
                if (_tlTranSet.TellerVars.IsTCDEnabled && _tlTranSet.TellerVars.IsTCDConnected)
                {
                    DeviceDeposit(TlTransactionSet.UcmInterface.DeviceDeposit, false, 0);
                    if (_tlTranSet.CurTran.CashInDenoms == null || _tlTranSet.CurTran.CashInDenoms.Count == 0)
                    {
                        ArrayList targetList = _tlTranSet.CurTran.CashInDenoms;
                        ArrayList sourceList = _quickTranWindow.TranSet.CashIns;

                        targetList.Clear();

                        foreach (var denom in sourceList)
                        {
                            targetList.Add(denom);
                        }
                    }
                    _quickTranWindow.DeviceDeposit = _tlTranSet.GetTotalTcrCashDeposited(_tlTranSet.CurTran);
                }
            }
        }

        public void QuickTranReverseDeviceDeposit() //#89998
        {
            if (picTabs.SelectedTab == tabEasyCapture && _quickTranWindow != null)
            {
                if (_tlTranSet.TellerVars.IsTCDEnabled && _tlTranSet.TellerVars.IsTCDConnected)
                {
                    ReverseDeviceDeposit(false);
                    _quickTranWindow.DeviceDeposit = _tlTranSet.GetTotalTcrCashDeposited(_tlTranSet.CurTran);
                }
            }
        }

        public void QuickTranTcdDrawerIconToggle(PictureBox picTempTCD, PictureBox picTempDrawer) //#89998
        {
            TcdDrawerIconClick(picTempTCD, picTempDrawer);
        }

        public void PerformEnableDisableControls(string origin)
        {
            //if (_tlTranSet.CurTran != null && !string.IsNullOrEmpty(_tlTranSet.CurTran.TlTranCode.Value))
            //    EnableDisableControls(origin);
            //else
            //{
            //    if (_quickTranWindow != null)
            //    {
            //        var easyCaptureTranSet = _quickTranWindow.TranSet;
            //        EasyCaptureTran curEasycaptureTran = _quickTranWindow.GetCurrentEasyCaptureTran();
            //        if (curEasycaptureTran != null && !string.IsNullOrEmpty(curEasycaptureTran.TranDef.TranCode))
            //        {
            //            _tlTranSet.TellerVars.SetContextObject("AdTlTcArray", curEasycaptureTran.TranDef.TranCode);
            //            EnableDisableControls(origin);
            //        }
            //    }
            //}
        }

        public void InitializeQuickTranSet()
        {
            if (picTabs.SelectedTab == tabEasyCapture && _quickTranWindow != null)
                _quickTranWindow.InitializeTranSet();
        }

        private void pbAdvancedView_Click(object sender, PActionEventArgs e)
        {
            bool promptHoldBalWarning = false;  //#87767

            if (_quickTranWindow.TranSet != null && _quickTranWindow.TranSet.Transactions.Count > 0)
            {
                foreach(EasyCaptureTran tran in _quickTranWindow.TranSet.Transactions)
                {
                    if (tran.HoldBal > 0)
                    {
                        promptHoldBalWarning = true;
                        break;
                    }
                }

                if (promptHoldBalWarning)
                {
                    //16093 - Switching to advanced view mode will remove hard hold information for all the transactions within the quick transactions panel. Do you want to continue?
                    if (DialogResult.No == PMessageBox.Show(this, 16093, MessageType.Question, MessageBoxButtons.YesNo, string.Empty))
                    {
                        return;
                    }
                    else
                    {
                        foreach (TlTransaction tran in _tlTranSet.Transactions)
                        {
                            if (tran.GbHoldStop != null && tran.GbHoldStop.Count > 0)
                                tran.GbHoldStop.Clear();
                        }
                    }
                }
            }

            try
            {
                //Begin 95645 
                _bIncQuickTCs = true;
                PopulateTranCodeCombo(GlobalVars.Instance.ML.RM, null);
                //End 95645 
                Name0.IsDisabled = false;
                Name1.IsDisabled = false;
                picTabs.SelectedIndex = 1;
                MapEasyCaptureToTranSet(true, false, false);
                tabEasyCapture.IsDisabled = true;
                SetReadOnlyTextboxesColor(Name0, Name1); //Bug #100884
            }
            finally
            {
                if (ctwTranSet.Count > 0)
                {
                    if (!_tlTranSet.IsTellerCaptureTran || ctwTranSet.ContextRow < 0)   //#93834
                        ctwTranSet.SelectRow(0, true);
                    ctwTranSet.Focus();
                }
                //#102717 - Reset Quick Tran AVTC Flags
                if (_tlTranSet.EnableChecksOnlyTran && _tlTranSet.TlCaptureChecksOnlyItems != null && _tlTranSet.TlCaptureChecksOnlyItems.Count > 0)
                    SetTellerCaptureFlagForTranSet(false);
                _tlTranSet.CaptureAllCheckTranItems = true;
                _tlTranSet.RefreshTlCaptureChecksOnlyItems(true);
                _tlTranSet.EnableChecksOnlyTran = false;
                //_tlTranSet.IsTellerCaptureCheckOnlyTran = false;
                //_tlTranSet.TlCaptureChecksOnlyItems.Clear();
                _tlTranSet.CaptureAllCheckTranItems = false;
            }
        }

        //Begin Bug #100884
        private void SetReadOnlyTextboxesColor(params PTabPage[] tabs)
        {
            foreach(var tab in tabs)
            {
                if (tab != null)
                {
                    SetReadOnlyTextboxesColorRecursive(tab);
                }
            }
        }

        void SetReadOnlyTextboxesColorRecursive(Control control)
        {
            var childs = control.Controls;
            if (childs.Count > 0)
            {
                foreach(Control childControl in childs)
                {
                    SetReadOnlyTextboxesColorRecursive(childControl);
                }
            }
            else
            {
                TextBox tb = control as TextBox;
                if (tb != null && tb.ReadOnly)
                {
                    tb.BackColor = ThemeHelper.WindowBgColor;
                }
            }
        }
        //Begin End #100884

        //public void ProcessEasyCaptureTran(EasyCaptureTranSet easyCaptureTranSet)
        //{
        //    try
        //    {
        //        _easyCaptureTranSet = easyCaptureTranSet;
        //        picTabs.SelectedIndex = 1;
        //        MapEasyCaptureToTranSet(false);
        //        dlgInformation.Instance.ShowInfo("Posting transactions...");
        //        OnActionSave(false);
        //    }
        //    finally
        //    {
        //        dlgInformation.Instance.HideInfo();
        //    }

        //}

//        private void CreateEasyCaptureTestTranSet()
//        {
//            if (_quickTranWindow != null)
//                _easyCaptureTranSet = _quickTranWindow.TranSet;

//#if DEBUG
//            //if (_easyCaptureTranSet == null)
//            //{
//            //    EasyCaptureTest easyCaptureTest = new EasyCaptureTest(this);
//            //    easyCaptureTest.CreateTestTran();
//            //    _easyCaptureTranSet = easyCaptureTest.easyCaptureTranSet;
//            //}
//#endif
//        }

        //validates any easy capture tran which has not been validated successfully previously. This can happen when the advance button is clicked and
        //some transactions may not have been successfully validated
        public bool ValidateEasyCaptureTranSet()
        {
            var easyCaptureTranSet = _quickTranWindow.TranSet;

            bool hasErrors = false;
            foreach (var tran in easyCaptureTranSet.Transactions)
            {
                tran.TranResponse.Clear();

                if (tran.IsValidated)
                    continue;

                if (tran.MappedTranIndex >= 0)    // it's an existing tran about to be overwritten
                {
                    //reset the tran
                    _tlTranSet.SelectTransaction(tran.MappedTranIndex, false);
                    _tlTranSet.ValidateAddTransaction(ref focusField, (_tlTranSet.TellerVars.IsTCDConnected && picTCD.Visible));    // - ?

                    if (!ProcessResponses(null, null))
                    {
                        GetControlByXmlTag(focusField, true);
                        hasErrors = true;
                        break;
                    }
                }

                tran.IsValidated = true;
            }

            return (hasErrors == false);
        }

        //#134380
        public object GetCurrentHardHoldBalInfo(string origin)
        {
            if (picTabs.SelectedTab == tabEasyCapture && _quickTranWindow != null && _quickTranWindow.TranSet != null)
            {
                EasyCaptureTran tempTran = null;

                tempTran = _quickTranWindow.GetCurrentEasyCaptureTran(_quickTranWindow.CurTranId);

                if (tempTran == null)
                {
                    if (_quickTranWindow.GetCurrentEasyCaptureTran() != null &&
                    _quickTranWindow.GetCurrentEasyCaptureTran().MappedTranIndex > 0)
                        tempTran = _quickTranWindow.GetCurrentEasyCaptureTran();
                }

                if (tempTran != null)
                    _tlTranSet.SelectTransaction(tempTran.MappedTranIndex, false);

                if (tempTran != null)
                {
                    //#134380 - get multiple holds
                    if (_tlTranSet.CurTran.GbHoldStop != null && _tlTranSet.CurTran.GbHoldStop.Count > 0)
                    {
                        int count = 0;
                        foreach (var item in _tlTranSet.CurTran.GbHoldStop)
                        {
                            GbHoldStop tempStop = item as GbHoldStop;
                            if (tempStop.HoldStopType.Value == origin)
                            {
                                return _tlTranSet.CurTran.GbHoldStop[count] as GbHoldStop;
                            }
                            count++;
                        }
                    }
                    else
                        return new GbHoldStop();
                }
                else
                    return new GbHoldStop();
            }
            return new GbHoldStop();
        }

        public void SetCurrentHoldBalInfo(object hardHoldObj)
        {
            if (picTabs.SelectedTab == tabEasyCapture)
            {
                //#134380 - Add multiple holds
                if (_tlTranSet.CurTran.GbHoldStop != null)
                {
                    if (_tlTranSet.CurTran.GbHoldStop.Count == 0)
                        _tlTranSet.CurTran.GbHoldStop.Add(hardHoldObj as GbHoldStop);

                    if (_tlTranSet.CurTran.GbHoldStop.Count > 0
                        && _tlTranSet.CurTran.GbHoldStop.Count < 2)
                    {
                        foreach (var item in _tlTranSet.CurTran.GbHoldStop.ToArray())
                        {
                            GbHoldStop tempStop = item as GbHoldStop;

                            if (tempStop.HoldStopType.Value != (hardHoldObj as GbHoldStop).HoldStopType.Value)
                            {
                                _tlTranSet.CurTran.GbHoldStop.Add(hardHoldObj as GbHoldStop);
                            }
                        }
                    }
                }

                EasyCaptureTran tempTran = null;

                tempTran = _quickTranWindow.TranSet.Find(_quickTranWindow.CurTranId);

                if (tempTran == null)
                {
                    if (_quickTranWindow.GetCurrentEasyCaptureTran() != null &&
                    _quickTranWindow.GetCurrentEasyCaptureTran().MappedTranIndex > 0)
                        tempTran = _quickTranWindow.GetCurrentEasyCaptureTran();
                }

                if (tempTran != null)
                {
                    //#134380 - calculate the total hold amount.
                    tempTran.HoldBal = 0;
                    foreach (var item in _tlTranSet.CurTran.GbHoldStop)
                    {
                        if (!(item as GbHoldStop).Amt.IsNull && (item as GbHoldStop).Amt.Value > 0)
                            tempTran.HoldBal += (item as GbHoldStop).Amt.Value;
                        else
                            tempTran.HoldBal += 0;
                    }
                }
            }
        }

        public void HandleHardHoldNotice()
        {
            try
            {

                if (_isHardHoldNoticePending)
                {
                    if (picTabs.SelectedTab == tabEasyCapture)
                    {
                        Phoenix.BusObj.Misc.Eforms _eformBusObj;
                        DpAcct _dpAcctBusObj;
                        foreach (TlTransaction tran in _tlTranSet.Transactions)
                        {
                            if (tran.GbHoldStop != null || tran.GbHoldStop.Count > 0)
                            {
                                foreach (GbHoldStop hold in tran.GbHoldStop)
                                {
                                    using (new WaitCursor())
                                    {
                                        _dpAcctBusObj = new DpAcct();
                                        _dpAcctBusObj.ActionType = XmActionType.Select;
                                        _dpAcctBusObj.SelectAllFields = false;
                                        _dpAcctBusObj.AcctNo.Value = hold.AcctNo.Value;
                                        _dpAcctBusObj.AcctType.Value = hold.AcctType.Value;
                                        _dpAcctBusObj.RimNo.Selected = true;
                                        _dpAcctBusObj.ClassCode.Selected = true;
                                        Phoenix.FrameWork.CDS.DataService.Instance.ProcessRequest(_dpAcctBusObj);


                                        if (!hold.HoldNotice.IsNull && hold.HoldNotice.Value == "Y")
                                        {
                                            //Generate555EReport
                                            try
                                            {

                                                //360970 - Generating Deposit Hold Notice. Please wait...
                                                dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(360970));

                                                _eformBusObj = new Phoenix.BusObj.Misc.Eforms();
                                                _eformBusObj.AcctType.Value = hold.AcctType.Value;
                                                _eformBusObj.AcctNo.Value = hold.AcctNo.Value;
                                                _eformBusObj.FormId.Value = 50;
                                                _eformBusObj.EFormTemplateName.Value = "555E.pdf";
                                                _eformBusObj.EFormLocalPath.Value = Environment.CurrentDirectory + @"\forms\";
                                                _eformBusObj.RimNo.Value = _dpAcctBusObj.RimNo.Value;
                                                _eformBusObj.HoldId.Value = hold.HoldId.Value;
                                                _eformBusObj.HoldAmt.Value = hold.Amt.Value;
                                                _eformBusObj.HoldEffectiveDt.Value = hold.EffectiveDt.Value;
                                                //Procedure not using this value
                                                _eformBusObj.ClassCode.Value = _dpAcctBusObj.ClassCode.Value;
                                                _eformBusObj.AcctId.Value = 0;//No SD Accounts
                                                _eformBusObj.CreateAudit.Value = "N";
                                                _eformBusObj.SPProcName.Value = "psp_teller_eforms_dp_hold_not";
                                                _eformBusObj.DataSource.Value = "C";
                                                _eformBusObj.PDFMode.Value = "View";
                                                _eformBusObj.NoCopies.Value = 0;
                                                _eformBusObj.PrintType.Value = "I";
                                                _eformBusObj.GenerateFDF();
                                            }
                                            catch (PhoenixException pe)
                                            {
                                                dlgInformation.Instance.HideInfo();
                                                //Process the errors							
                                                if (pe.MLMessageId == 10223 || pe.MLMessageId == 10224)
                                                {
                                                    //360987 - An error has occurred while trying to print using Adobe Acrobat Reader.  Please verify the Adobe Acrobat Reader application does not have any Update windows open or a problem with the installation.
                                                    PMessageBox.Show(360987, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                                                }
                                                else if (pe.MLMessageId > 0)
                                                {
                                                    //360987 - An error has occurred while trying to print using Adobe Acrobat Reader.  Please verify the Adobe Acrobat Reader application does not have any Update windows open or a problem with the installation.
                                                    PMessageBox.Show(pe.MLMessageId, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                                                }
                                                else
                                                {
                                                    Phoenix.FrameWork.Core.CoreService.LogPublisher.LogDebug(pe.Message + " - " + pe.InnerException);
                                                    PMessageBox.Show(360971, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                                                    //360971 - Failed to print Deposit Hold Notice.
                                                }
                                            }
                                            finally
                                            {
                                                dlgInformation.Instance.HideInfo();
                                            }
                                        }

                                        if (!hold.HoldExceptionNotice.IsNull && hold.HoldExceptionNotice.Value == "Y")
                                        {
                                            //GenerateDpExHldNot
                                            try
                                            {

                                                //360970 - Generating Deposit Hold Notice. Please wait...
                                                dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(360970));

                                                _eformBusObj = new Phoenix.BusObj.Misc.Eforms();
                                                _eformBusObj.AcctType.Value = hold.AcctType.Value;
                                                _eformBusObj.AcctNo.Value = hold.AcctNo.Value;
                                                _eformBusObj.FormId.Value = 51;
                                                _eformBusObj.EFormTemplateName.Value = "dp_ex_hld_not.pdf";
                                                //AppDomain.CurrentDomain.BaseDirectory
                                                _eformBusObj.EFormLocalPath.Value = AppDomain.CurrentDomain.BaseDirectory + @"forms\"; // System.IO.Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "forms");// Environment.CurrentDirectory + @"\forms\";					
                                                _eformBusObj.RimNo.Value = _dpAcctBusObj.RimNo.Value;
                                                //Procedure not using this value
                                                _eformBusObj.ClassCode.Value = _dpAcctBusObj.ClassCode.Value;
                                                _eformBusObj.AcctId.Value = 0;//No SD Accounts
                                                _eformBusObj.Optional1Int.Value = (int)hold.Ptid.Value;

                                                // #79420 - remove reference to psp_eforms_dp_hold_not.
                                                // according to Sue Baron, this form should print the same from 
                                                // online as it does from teller.
                                                _eformBusObj.CreateAudit.Value = "N";
                                                //_eformBusObj.SPProcName.Value = "psp_teller_eforms_dp_hold_not";	// #79420
                                                _eformBusObj.SPProcName.Value = "psp_teller_eforms_dp_hold_not";        // #79420

                                                _eformBusObj.DataSource.Value = "C";
                                                _eformBusObj.PDFMode.Value = "View";
                                                _eformBusObj.NoCopies.Value = 0;
                                                _eformBusObj.PrintType.Value = "I";
                                                _eformBusObj.GenerateFDF();
                                            }
                                            catch (PhoenixException pe)
                                            {
                                                dlgInformation.Instance.HideInfo();
                                                //Process the errors							
                                                if (pe.MLMessageId == 10223 || pe.MLMessageId == 10224)
                                                {
                                                    //360987 - An error has occurred while trying to print using Adobe Acrobat Reader.  Please verify the Adobe Acrobat Reader application does not have any Update windows open or a problem with the installation.
                                                    PMessageBox.Show(360987, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                                                }
                                                else if (pe.MLMessageId > 0)
                                                {
                                                    //360987 - An error has occurred while trying to print using Adobe Acrobat Reader.  Please verify the Adobe Acrobat Reader application does not have any Update windows open or a problem with the installation.
                                                    PMessageBox.Show(pe.MLMessageId, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                                                }
                                                else
                                                {
                                                    Phoenix.FrameWork.Core.CoreService.LogPublisher.LogDebug(pe.Message + " - " + pe.InnerException);
                                                    PMessageBox.Show(360971, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                                                    //360971 - Failed to print Deposit Hold Notice.
                                                }
                                            }
                                            finally
                                            {
                                                dlgInformation.Instance.HideInfo();
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            finally
            {
                _isHardHoldNoticePending = false;
            }
        }

        public void HandleQuickTranStatusText(string quickTranStatusText)   //#90021
        {
            this.SetStatusText(quickTranStatusText);
        }

        public void LoadChecksOnlyItems(bool isChecksOnlyTranEnabled)   //#102719 //#110046 - added isChecksOnlyTranEnabled
        {
            ArrayList sourceList;
            ArrayList targetList;
            decimal makeAvail = 0;  //#122532

            if (picTabs.SelectedTab == tabEasyCapture)
            {
                if (isChecksOnlyTranEnabled)    //#110046
                {
                    if (_quickTranWindow.TranSet.ChecksTran != null && _quickTranWindow.TranSet.ChecksTran.MappedTranIndex > 0)
                    {
                        if (_tlTranSet.EnableChecksOnlyTran && _tlTranSet.CurTran.Items != null && _tlTranSet.CurTran.Items.Count > 0)
                        {
                            if (_quickTranWindow.TranSet.Checks.Count > 0)
                                _quickTranWindow.TranSet.Checks.Clear();
                        }
                    }
                    //else
                    //{
                    //    _quickTranWindow.TranSet.ChecksTran = _quickTranWindow.GetCurrentEasyCaptureTran();
                    //}
                }

                if (_quickTranWindow.TranSet.Checks.Count > 0)
                {
                    targetList = _tlTranSet.CurTran.Items;
                    sourceList = _quickTranWindow.TranSet.Checks;
                }
                else
                {
                    targetList = _quickTranWindow.TranSet.Checks;
                    sourceList = _tlTranSet.CurTran.Items;
                }
                decimal totalCheckAmt = 0;
                targetList.Clear();
                foreach (var denom in sourceList)
                {
                    targetList.Add(denom);
                }

                //Refresh Total
                foreach (TlItemCapture item in _tlTranSet.CurTran.Items)
                {
                    totalCheckAmt += item.Amount.Value;
                }
                _quickTranWindow.TranSet.ChecksIn = totalCheckAmt;
                _quickTranWindow.TranSet.NoItems = (_tlTranSet.CurTran.Items == null ? Convert.ToInt32(0) : _tlTranSet.CurTran.Items.Count);
                //Refresh Float
                makeAvail = Convert.ToDecimal(Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet_MakeAvail"]); //#122532
                if (makeAvail >= 0) //#122532
                    _quickTranWindow.TranSet.ChecksMakeAvail = makeAvail;
            }
        }

        //maps and validates the easy capture transet to _tlTranSet object
        public bool MapEasyCaptureToTranSet(bool populateViewTran,
            bool fromAsyncCall = false,
            bool showErrors = true,
            bool showOnlyFirstErrorMessage = false)
        {
            Dictionary<EasyCaptureTran, TranEditComponent> tranEditComponents = new Dictionary<EasyCaptureTran, TranEditComponent>();

            try
            {
                _semaphoreSlim.Wait();

                if (_tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.Success)
                    return true;


                var easyCaptureTranSet = _quickTranWindow.TranSet;


                if (easyCaptureTranSet.Transactions.Count == 0)
                {
                    easyCaptureTranSet.ChecksMakeAvail = 0;
                    if (_tlTranSet.Transactions.Count > 0)
                    {
                        _tlTranSet.Transactions.Clear();
                    }
                    ctwTranSet.ResetTable();
                }
                else
                {
                    if (fromAsyncCall)  //#92491
                    {
                        Name0.IsDisabled = easyCaptureTranSet.Transactions.Count > 0;
                        Name1.IsDisabled = Name0.IsDisabled;
                        Name2.IsDisabled = Name0.IsDisabled;
                    }
                }

                if (!fromAsyncCall)
                    dlgInformation.Instance.ShowInfo("Validating transaction set...");
                else
                    showErrors = false; // do not show errors when called async, instead move to collection

                decimal cashInToAssign = easyCaptureTranSet.CashIn;
                decimal cashOutToAssign = easyCaptureTranSet.CashOut;
                decimal checksToAssign = easyCaptureTranSet.ChecksIn; //.ForEach(x => checksToAssign += x.Amount);
                bool skipLastTran = false; // fromAsyncCall;
                bool hasErrors = false;

                EasyCaptureTran cashInTran = (easyCaptureTranSet.Transactions.Count == 0? null : easyCaptureTranSet.CashInTran);
                EasyCaptureTran cashOutTran = (easyCaptureTranSet.Transactions.Count == 0 ? null : easyCaptureTranSet.CashOutTran);
                EasyCaptureTran checksTran = (easyCaptureTranSet.Transactions.Count == 0 ? null : easyCaptureTranSet.ChecksTran);

                if (cashInToAssign > 0) // && (cashInTran == null || cashInTran == easyCaptureTranSet.CashInTran))
                {
                    cashInTran = easyCaptureTranSet.Find(EasyCaptureTranType.Deposit);
                    if (cashInTran == null)
                        cashInTran = easyCaptureTranSet.Find(EasyCaptureTranType.Payment);
                    if (cashInTran == null)
                        cashInTran = easyCaptureTranSet.Find("RM");
                    if (cashInTran == null)                                                  //87751
                        cashInTran = easyCaptureTranSet.Find(EasyCaptureTranType.External);  //87751
                    if (cashInTran == null)
                        cashInTran = _quickTranWindow.GetCurrentEasyCaptureTran();
                }


                if (cashOutToAssign > 0) // && (cashOutTran == null || cashOutTran == easyCaptureTranSet.CashOutTran))
                {
                    cashOutTran = easyCaptureTranSet.Find(EasyCaptureTranType.Withdrawal); //93431
                    if (cashOutTran == null)    //#87731
                        cashOutTran = easyCaptureTranSet.Find(EasyCaptureTranType.OnUsCashedCheck);
                    if (cashOutTran == null)
                        cashOutTran = easyCaptureTranSet.Find(EasyCaptureTranType.Advance);
                    if (cashOutTran == null)
                        cashOutTran = easyCaptureTranSet.Find(EasyCaptureTranType.Deposit); // x => x.TranType == EasyCaptureTranType.Deposit);
                    if (cashOutTran == null)
                        cashOutTran = easyCaptureTranSet.Find("RM");
                    if (cashOutTran == null)                                                  //87751
                        cashOutTran = easyCaptureTranSet.Find(EasyCaptureTranType.External);  //87751
                    if (cashOutTran == null)
                        cashOutTran = _quickTranWindow.GetCurrentEasyCaptureTran();
                }

                //Begin 100774: Removed the condition below 
                //if (checksToAssign > 0) // && (checksTran == null || checksTran == easyCaptureTranSet.ChecksTran))
                //{
                checksTran = easyCaptureTranSet.Find(EasyCaptureTranType.Deposit);
                if (checksTran == null)
                    checksTran = easyCaptureTranSet.Find(EasyCaptureTranType.Payment);
                if (checksTran == null)
                    checksTran = easyCaptureTranSet.Find("RM");
                if (checksTran == null)                                                  //87751
                    checksTran = easyCaptureTranSet.Find(EasyCaptureTranType.External);  //87751
                if (checksTran == null)
                    checksTran = _quickTranWindow.GetCurrentEasyCaptureTran();
                //}
                //End 100774

                easyCaptureTranSet.CashInTran = cashInTran;
                easyCaptureTranSet.CashOutTran = cashOutTran;
                easyCaptureTranSet.ChecksTran = checksTran;

                TlTransaction lastCurTran = _tlTranSet.CurTran;
                EasyCaptureTran lastTran = easyCaptureTranSet.Transactions.Count > 0 ? easyCaptureTranSet.Transactions[easyCaptureTranSet.Transactions.Count - 1] : null;

                #region validate already added tran if they need to be revalidated
                foreach (var tran in easyCaptureTranSet.Transactions)
                {
                    var tranEditComponent = new TranEditComponent();
                    tranEditComponents[tran] = tranEditComponent;

                    if (!tran.IsValidated)
                    {
                        //continue;
                    }

                    if (skipLastTran && tran == lastTran)
                        continue;

                    if (tran.MappedTranIndex < 0)  // just in case
                    {
                        tran.IsValidated = false;
                        tranEditComponent.RecreateTran = true;
                        continue;
                    }
                    //#106777
                    decimal totalCashIn = 0;
                    decimal totalTcdCashIn = 0;
                    decimal totalCashIn1 = 0;
                    decimal totalTcdCashIn1 = 0;
                    if (_tlTranSet.CurTran.CashInDenoms != null && _tlTranSet.CurTran.CashInDenoms.Count > 0)
                    {
                        totalCashIn = (_tlTranSet.CurTran.CashInDenoms[0] as TlCashCount).TotalDenomAmt(_tlTranSet.CurTran.CashInDenoms);
                        totalTcdCashIn = (_tlTranSet.CurTran.CashInDenoms[0] as TlCashCount).TotalDeviceDenomAmt(_tlTranSet.CurTran.CashInDenoms);
                    }
                    _tlTranSet.SelectTransaction(tran.MappedTranIndex, false);
                    
                    #region cash in validation
                    if (cashInTran == tran)
                    {
                        if (_tlTranSet.CurTran.CashIn.Value != cashInToAssign)
                        {
                            tranEditComponent.CashInEdited = true;
                            tran.IsValidated = false;
                            //continue;
                        }
                        //#106777
                        if (!tranEditComponent.CashInEdited && _tlTranSet.CurTran.CashInDenoms != null && _tlTranSet.CurTran.CashInDenoms.Count > 0)
                        {
                            totalCashIn1 = (_tlTranSet.CurTran.CashInDenoms[0] as TlCashCount).TotalDenomAmt(_tlTranSet.CurTran.CashInDenoms);
                            totalTcdCashIn1 = (_tlTranSet.CurTran.CashInDenoms[0] as TlCashCount).TotalDeviceDenomAmt(_tlTranSet.CurTran.CashInDenoms);
                        }

                        if ((totalCashIn != totalCashIn1) || (totalTcdCashIn != totalTcdCashIn1))
                            tranEditComponent.CashInEdited = true;
                    }
                    else if (_tlTranSet.CurTran.CashIn.Value > 0) //|| (easyCaptureTranSet.CashIn != (_tlTranSet.CurTran.CashIn == null ? 0 : _tlTranSet.CurTran.CashIn.Value))) //121714-Bug-fix  //#87731-1
                    {
                        tranEditComponent.CashInEdited = true;
                        tran.IsValidated = false;
                        //continue;
                    }
                    #endregion

                    #region cash out validation
                    if (cashOutTran == tran)
                    {
                        if (_tlTranSet.CurTran.CashOut.Value != cashOutToAssign)
                        {
                            tranEditComponent.CashOutEdited = true;
                            tran.IsValidated = false;
                            //continue;
                        }
                    }
                    else if (_tlTranSet.CurTran.CashOut.Value > 0)
                    {
                        tranEditComponent.CashOutEdited = true;
                        tran.IsValidated = false;
                        //continue;
                    }
                    #endregion

                    #region checks reverification
                    if (checksTran == tran)
                    {
                        if (_tlTranSet.CurTran.Items.Count != easyCaptureTranSet.Checks.Count || (_tlTranSet.EnableChecksOnlyTran &&
                            (easyCaptureTranSet.TotalDebits < (easyCaptureTranSet.CashIn + easyCaptureTranSet.ChecksIn))))  //#122532
                        {
                            tranEditComponent.ItemsEdited = true;
                            tran.IsValidated = false;
                            //continue;
                        }
                    }
                    else if (_tlTranSet.CurTran.Items.Count > 0)
                    {
                        tranEditComponent.ItemsEdited = true;
                        tran.IsValidated = false;
                        //continue;
                    }

                    #endregion

                    //#123465
                    if (_tlTranSet.CurTran.AcctType.Value != tran.AcctType.Trim() ||
                                             (!_tlTranSet.CurTran.TranAcct.AcctNo.IsNull && !string.IsNullOrEmpty(_tlTranSet.CurTran.AcctNo.Value) && _tlTranSet.CurTran.AcctNo.Value != tran.AcctNo.Trim())) //#93233 //#108622
                    {
                        tranEditComponent.AccountEdited = true;
                        tran.IsValidated = false;
                        //continue;
                    }

                    if (tran.TranDef == null || tran.TranDef.TranCode != _tlTranSet.CurTran.TlTranCode.Value)                  
                    {
                        tranEditComponent.TranCodeEdited = true;
                        tran.IsValidated = false;
                    }

                    if ((_tlTranSet.CurTran.NetAmt == null ? 0 : _tlTranSet.CurTran.NetAmt.Value) != tran.Amount) //121714-Bug-fix
                    {
                        tranEditComponent.AmtEdited = true;
                        tran.IsValidated = false;
                        //continue;
                    }

                    //Begin 121714-Bug-fix 
                    string checkNo = string.Empty;
                    if (_tlTranSet.CurTran.CheckNo.IsNull)
                        checkNo = string.Empty;
                    else
                        checkNo = _tlTranSet.CurTran.CheckNo.Value.ToString();
                    //End 121714-Bug-fix 

                    if (checkNo != (tran.CheckNo == null ? string.Empty : tran.CheckNo) ||                                                                                                                                   //121714-Bug-fix 
                       (string.IsNullOrEmpty(_tlTranSet.CurTran.Description.Value) ? string.Empty : _tlTranSet.CurTran.Description.Value) != (string.IsNullOrEmpty(tran.Description) ? string.Empty : tran.Description) ||   //121714-Bug-fix 
                       (string.IsNullOrEmpty(_tlTranSet.CurTran.Reference.Value) ? string.Empty : _tlTranSet.CurTran.Reference.Value) != (string.IsNullOrEmpty(tran.Reference) ? string.Empty : tran.Reference) ||           //121714-Bug-fix 
                       (_tlTranSet.CurTran.ProcessAsRegD.Value == "Y") != tran.RegD ||
                       (_tlTranSet.CurTran.UseDescription.Value == "Y") != tran.PassDescriptionToHistory
                       )   //Task #113989
                    {
                        tranEditComponent.MiscInfoEdited = true;
                        tran.IsValidated = false;
                    }

                    if (tranEditComponent.TranCodeEdited || tranEditComponent.AccountEdited)
                        tranEditComponent.RecreateTran = true;

                    if (!string.IsNullOrEmpty(easyCaptureTranSet.WaiveSignature) && _tlTranSet.CurTran.WaiveSignature.Value != easyCaptureTranSet.WaiveSignature)   //#90021
                        tranEditComponent.RecreateTran = true;
                }

                #endregion

                #region sync transet by removing any deleted transactions
                List<int> toDeleteTranIndices = new List<int>();
                foreach (TlTransaction tran in _tlTranSet.Transactions)
                {
                    bool found = false;
                    foreach (var easyTran in easyCaptureTranSet.Transactions)
                    {
                        if (tran.TranIndex.Value == easyTran.MappedTranIndex)
                        {
                            found = true;
                            break;
                        }
                    }
                    if (!found)
                    {
                        toDeleteTranIndices.Add(tran.TranIndex.Value);
                    }
                }

                foreach (var tranIndex in toDeleteTranIndices)
                {
                    bool isCurTran = false;
                    _tlTranSet.RemoveTransaction(tranIndex, ref isCurTran);
                    if (easyCaptureTranSet.CashInTran != null && tranIndex == easyCaptureTranSet.CashInTran.MappedTranIndex)
                        _quickTranWindow.TranSet.CashInTranMappedIndex = -1;
                }
                #endregion


                _tlTranSet.CurTran = lastCurTran;
                bool cleanUpCurTran = true;

                if (_tlTranSet.CurTran.TranIndex.Value >= 0)
                {
                    foreach (var tran in easyCaptureTranSet.Transactions)
                    {
                        if (tran.MappedTranIndex == _tlTranSet.CurTran.TranIndex.Value && tranEditComponents[tran].RecreateTran == false)
                            cleanUpCurTran = false;
                    }
                }

                if (cleanUpCurTran)
                {
                    //Clean up cur tran as it will be resonstucted in loop below
                    if (_tlTranSet.CurTran.CashInDenoms != null && _tlTranSet.CurTran.CashInDenoms.Count > 0 && easyCaptureTranSet.CashIns.Count == 0)
                    {
                        ArrayList targetList = _quickTranWindow.TranSet.CashIns;
                        ArrayList sourceList = _tlTranSet.CurTran.CashInDenoms;
                        foreach (var denom in sourceList)
                        {
                            targetList.Add(denom);
                        }
                    }
                    _tlTranSet.CurTran.CleanUpValues();
                    _tlTranSet.CurTran.TranAcct.CleanUpValues(true);
                    _tlTranSet.CurTran.TfrAcct.CleanUpValues(true);
                    _tlTranSet.CurTran.RefAcct.CleanUpValues(true);
                }

                #region map easy capture transet to phoenix transet
                foreach (var tran in easyCaptureTranSet.Transactions)
                {
                    tran.TranResponse.Clear();

                    bool isLastTran = (tran == lastTran);
                    var tranEditComponent = tranEditComponents[tran];

                    if (tran.IsValidated)
                    {
                        if (cashInTran == tran)
                        {
                            cashInToAssign = 0;
                        }
                        if (cashOutTran == tran)
                        {
                            cashOutToAssign = 0;
                        }
                        if (checksTran == tran)
                        {
                            checksToAssign = 0;
                        }

                        //if (isLastTran && tran.MappedTranIndex > 0)
                        //    _tlTranSet.SelectTransaction(tran.MappedTranIndex, false);  // select the transaction to pouplate CurTran with the last transaction


                        //Begin 121714-Bug-fix 
                        if (_turnOffWaitCursor)
                        {
                            Cursor.Current = Cursors.Default;
                            _turnOffWaitCursor = false;
                        }
                        //End 121714-Bug-fix 

                        continue;
                    }

                    //Begin 121713-#7-121714: Moved code here
                    if (tran.TcDescription == EasyCaptureTranType.Payment.ToString()) //&& (tranEditComponent.RecreateTran || tranEditComponent.TranCodeEdited || tranEditComponent.AccountEdited))
                    {
                        Cursor.Current = Cursors.WaitCursor;
                        _turnOffWaitCursor = true;
                    }
                    //End 121713-#7


                    if (skipLastTran && isLastTran)
                        continue;

                    if (tran.MappedTranIndex >= 0 || cleanUpCurTran)    // it's an existing tran about to be overwritten
                    {
                        //reset the tran
                        if (tran.MappedTranIndex > 0)
                            _tlTranSet.SelectTransaction(tran.MappedTranIndex, false);

                        if (tranEditComponent.RecreateTran)
                        {
                            if (_tlTranSet.CurTran.CashInDenoms != null && _tlTranSet.CurTran.CashInDenoms.Count > 0 && easyCaptureTranSet.CashIns.Count == 0)
                            {
                                ArrayList targetList = _quickTranWindow.TranSet.CashIns;
                                ArrayList sourceList = _tlTranSet.CurTran.CashInDenoms;
                                foreach (var denom in sourceList)
                                {
                                    targetList.Add(denom);
                                }
                            }
                            _tlTranSet.CurTran.CleanUpValues();
                            _tlTranSet.CurTran.TranAcct.CleanUpValues(true);
                            _tlTranSet.CurTran.TfrAcct.CleanUpValues(true);
                            _tlTranSet.CurTran.RefAcct.CleanUpValues(true);
                        }
                    }

                    if (cashInTran == tran)
                    {
                        if (tranEditComponent.RecreateTran || tranEditComponent.CashInEdited)
                        {
                            _tlTranSet.CurTran.CashIn.Value = cashInToAssign;
                            _tlTranSet.CurTran.CashInDenoms.Clear();
                            foreach (TlCashCount denom in easyCaptureTranSet.CashIns)
                            {
                                _tlTranSet.CurTran.CashInDenoms.Add(denom.Clone());
                            }
                        }
                        cashInToAssign = 0;
                    }
                    else if (tranEditComponent.CashInEdited)
                    {
                        _tlTranSet.CurTran.CashIn.Value = 0;
                        _tlTranSet.CurTran.CashInDenoms.Clear();
                    }


                    if (cashOutTran == tran)
                    {
                        if (tranEditComponent.RecreateTran || tranEditComponent.CashOutEdited)
                        {
                            _tlTranSet.CurTran.CashOut.Value = cashOutToAssign;
                            _tlTranSet.CurTran.CashOutDenoms.Clear();
                            foreach (TlCashCount denom in easyCaptureTranSet.CashOuts)
                            {
                                _tlTranSet.CurTran.CashOutDenoms.Add(denom.Clone());
                            }
                        }
                        cashOutToAssign = 0;
                        if (_tlTranSet.TellerVars.IsTCDEnabled && _tlTranSet.TellerVars.IsTCDConnected) //#89998
                           _tlTranSet.CurTran.TcdDenominate.Value = easyCaptureTranSet.Denominate;
                    }
                    else if (tranEditComponent.CashOutEdited)
                    {
                        _tlTranSet.CurTran.CashOut.Value = 0;
                        _tlTranSet.CurTran.CashOutDenoms.Clear();
                    }

                    if (checksTran == tran)
                    {
                        if (tranEditComponent.RecreateTran || tranEditComponent.ItemsEdited)
                        {
                            _tlTranSet.CurTran.Items.Clear();
                            foreach (var check in easyCaptureTranSet.Checks)
                            {
                                _tlTranSet.CurTran.Items.Add(check);
                            }
                        }

                    }
                    else if (tranEditComponent.ItemsEdited)
                    {
                        _tlTranSet.CurTran.Items.Clear();
                    }


                    if (tranEditComponent.RecreateTran || tranEditComponent.AccountEdited)
                    {
                        _tlTranSet.CurTran.TranAcct.AcctNo.Value = tran.AcctNo;
                        _tlTranSet.CurTran.TranAcct.AcctType.Value = tran.AcctType;

                        var acctTypeDetail = _gbHelper.GetAcctTypeDetails(tran.AcctType, null); // - ?

                        if (acctTypeDetail != null)
                            _tlTranSet.CurTran.TranAcct.ApplType.Value = acctTypeDetail.ApplType;
                        else if (isLastTran && fromAsyncCall)
                        {
                            continue;   // just continue without adding trasnsaction since there is no account yet for last transaction
                        }

                        _tlTranSet.CurTran.TranAcct.RimNo.Value = searchRimNo; //Bug#103638 
                        _tlTranSet.CurTran.TranAcct.GetAcctDetails();   // - ?
                        _tlTranSet.CurTran.AcctType.Value = tran.AcctType; //#108622
                        _tlTranSet.CurTran.AcctNo.Value = tran.AcctNo; //#108622
                        _tlTranSet.CurTran.RimNo.Value = searchRimNo; //#108622

                        if (tranEditComponent.RecreateTran && tran.TranDef != null && !string.IsNullOrEmpty(tran.TranDef.TranCode)) //#87755
                            _tlTranSet.CurTran.TlTranCode.Value = tran.TranDef.TranCode;

                        if (!string.IsNullOrEmpty(easyCaptureTranSet.WaiveSignature) && _tlTranSet.CurTran.WaiveSignature.Value != easyCaptureTranSet.WaiveSignature)   //#90021
                            _tlTranSet.CurTran.WaiveSignature.Value = easyCaptureTranSet.WaiveSignature;
                    }

                    _tlTranSet.IsTellerQuickTran = true;  // to turn off default field calculation
                    _tlTranSet.CurTran.NetAmt.Value = tran.Amount;
                    if (tran.Amount <= 0)
                        _tlTranSet.CurTran.NetAmt.SetValueToNull();
                    if (tranEditComponent.RecreateTran || tranEditComponent.TranCodeEdited || (tranEditComponent.AccountEdited && tran.TcDescription == EasyCaptureTranType.Payment.ToString()))
                    {
                        //#87755
                        if (tran.TcDescription == EasyCaptureTranType.Purchase.ToString() && (tran.TranDef.TranCode == EasyCaptureTranCode.CashiersCheck.GetTC() ||
                            tran.TranDef.TranCode == EasyCaptureTranCode.MoneyOrder.GetTC()))
                        {
                            _tlTranSet.IsSqrFormExist();

                            #region Disable dfCheckNo Field is SQRForm
                            if (_tlTranSet.IsSqrFormExisting.Value == "Y")
                            {
                                if (_tlTranSet.TellerVars.AdTlControl.CheckNoRequire.Value == GlobalVars.Instance.ML.Y)
                                {
                                    tran.CheckNo = string.Empty; // Task #113989
                                    _tlTranSet.CurTran.CheckNo.SetValueToNull();
                                }
                            }
                            #endregion

                        }
                        _tlTranSet.ValidateTlTrancode(tran.TranDef != null ? tran.TranDef.TranCode : null); // - ?

                        if (!ProcessResponses(null,focusField, !showErrors ? tran : null))
                        {
                            GetControlByXmlTag(focusField, true);
                            cleanUpCurTran = true;
                            hasErrors = true;
                            tran.MappedTranIndex = _tlTranSet.AddTransaction();
                            continue;
                            //return;
                        }
                        else   
                        {
                            //No error received so handle special TC calculated values here if exists
                            if ((_tlTranSet.CurTran.TranCode.Value == 300 || _tlTranSet.CurTran.TranCode.Value == 301) && tran.Amount == 0)
                            {
                                //Task# 90007
                                if (_tlTranSet.TellerVars.IsAppOnline)
                                {
                                    tran.Amount = _tlTranSet.CurTran.NetAmt.Value;
                                }
                                //tran.MappedTranIndex = _tlTranSet.AddTransaction(); //#92886
                            }
                            if (_tlTranSet.CurTran.TranCodeDesc.IsNull && _tlTranSet.TellerVars.AdTlTc != null && tran.TranDef != null)
                                _tlTranSet.CurTran.TranCodeDesc.Value = string.Format("{0} - {1}", tran.TranDef.TranCode, _tlTranSet.TellerVars.AdTlTc.Description.Value);
                        }
                    }
                    //_tlTranSet.CurTran.NetAmt.Value = tran.Amount;
                    if (_tlTranSet.CurTran.Items.Count > 0)
                    {
                        if (tranEditComponent.RecreateTran || tranEditComponent.ItemsEdited)
                        {
                            try
                            {
                                Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet"] = true;
                                Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet_itemValFailed"] = false;
                                Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet_MakeAvail"] = 0;
                                //CallOtherForms("ItemCapture");    //DO NOT UNCOMMENT
                                //#121627
                                int errorRetCode = 0;
                                _tlTranSet.CalculateFloatForCurTran(true, ref errorRetCode);
                                if (errorRetCode != 0)
                                {
                                    hasErrors = true;
                                    continue;
                                }
                            }
                            finally
                            {
                                Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet"] = false;
                            }
                            if (Convert.ToBoolean(Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet_itemValFailed"]))
                            {
                                WriteToDebugLog("Teller Capture: Failed to execute ItemCapture form launching");
                                cleanUpCurTran = true;
                                hasErrors = true;
                                tran.MappedTranIndex = _tlTranSet.AddTransaction();
                                continue;
                            }
                            _tlTranSet.GetItemTotals();
                            Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet_MakeAvail"] = _tlTranSet.CurTran.MakeAvl.Value; //#121627
                            easyCaptureTranSet.ChecksMakeAvail = Convert.ToDecimal(Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet_MakeAvail"]);
                        }
                        easyCaptureTranSet.NoItems = _tlTranSet.CurTran.Items.Count;
                        checksToAssign = 0;

                    }
                    else if (tranEditComponent.ItemsEdited)
                    {
                        _tlTranSet.GetItemTotals();
                    }

                    if (_tlTranSet.CurTran.CashInDenoms.Count > 0 && (tranEditComponent.RecreateTran || tranEditComponent.CashInEdited))  //#96462
                    {
                        decimal cashInAmt = _tlTranSet.CurTran.CashIn.Value;
                        _tlTranSet.ModifyCashInOutAmt(_tlTranSet.CurTran.CashIn.XmlTag);
                        if (cashInTran == tran)
                        {
                            _tlTranSet.CurTran.CashIn.Value = cashInAmt;
                        }
                    }

                    if (_tlTranSet.CurTran.CashOutDenoms.Count > 0 && (tranEditComponent.RecreateTran || tranEditComponent.CashOutEdited))
                    {
                        _tlTranSet.ModifyCashInOutAmt(_tlTranSet.CurTran.CashOut.XmlTag);
                    }


                    _tlTranSet.CalculateDefaultField(_tlTranSet.CurTran.NetAmt.XmlTag);


                    tran.CcAmt = _tlTranSet.CurTran.CcAmt.IsNull ? 0 : _tlTranSet.CurTran.CcAmt.Value;

                    //_tlTranSet.IsTellerCaptureTran = false;

                    _tlTranSet.IsTcdConnected.Value = (_tlTranSet.TellerVars.IsTCDConnected ? Convert.ToInt32(1) : Convert.ToInt32(0)); //#72916

                    //Begin Task#87747

                    _tlTranSet.CurTran.CheckNo.SetValueToNull();
                    _tlTranSet.CurTran.TfrChkNo.SetValueToNull();

                    if (!string.IsNullOrEmpty(tran.CheckNo)) // Task #113989
                    {
                        int checkNo = 0; //Task #113693
                        if (tran.TranDef.TranType == EasyCaptureTranType.Transfer)
                        {
                            int.TryParse(tran.CheckNo,out checkNo); //Task #113989
                            if (checkNo != 0) // Task #113989
                                _tlTranSet.CurTran.TfrChkNo.Value = checkNo;
                        }
                        else
                        {
                            int.TryParse(tran.CheckNo, out checkNo); //Task #113989
                            if (checkNo != 0) // Task #113989
                                _tlTranSet.CurTran.CheckNo.Value = checkNo;
                        }
                    }
                    //End Task#87747


                    if (!string.IsNullOrEmpty(tran.Description))
                        _tlTranSet.CurTran.Description.Value = tran.Description;
                    else
                        _tlTranSet.CurTran.Description.SetValueToNull();

                    if (!string.IsNullOrEmpty(tran.Reference))
                        _tlTranSet.CurTran.Reference.Value = tran.Reference;
                    else
                        _tlTranSet.CurTran.Reference.SetValueToNull();

                    _tlTranSet.CurTran.ProcessAsRegD.Value = tran.RegD ? "Y" : "N";
                    _tlTranSet.CurTran.UseDescription.Value = tran.PassDescriptionToHistory ? "Y" : "N";

                    //Begin Task#89981
                    if (CrossRefSearchAcct != null && CrossRefSearchMapAcctNo != null && CrossRefSearchMapAcctType != null)
                    {
                        if (tran.AcctNo == CrossRefSearchMapAcctNo && tran.AcctType == CrossRefSearchMapAcctType )
                        {
                            _tlTranSet.CurTran.IncomingAcctNo.Value = CrossRefSearchAcct;
                            _tlTranSet.CurTran.TranAcct.IncomingAcctNo.Value = CrossRefSearchAcct;

                        }
                    }
                    //End Task#89980

                    //Set the modified transfer values to the transet
                    //Begin 87759
                    if (!string.IsNullOrEmpty(tran.TfrAcctType))
                    {
                        _tlTranSet.CurTran.TfrAcct.AcctType.Value = tran.TfrAcctType;

                        string deploan = string.Empty;
                        _quickTranWindow.GetTfrDepLoan(tran.TfrAcctType, ref deploan);
                        if (deploan != string.Empty)
                        {
                            _tlTranSet.CurTran.TfrAcct.DepLoan.Value = deploan;
                        }
                    }
                    else
                    {
                        _tlTranSet.CurTran.TfrAcct.AcctType.SetValueToNull();
                        _tlTranSet.CurTran.TfrAcct.DepLoan.SetValueToNull();
                    }
                    //End 87759

                    //Begin Task# 90007
                    if (!_tlTranSet.TellerVars.IsAppOnline)
                    {
                        //if (_tlTranSet.CurTran.TranAcct.DepLoan.IsNull) Bug# 109868 
                        //{
                        string deploan = string.Empty;

                        if (tran.AcctType == "RIM")
                        {
                            deploan = "RM";
                        }
                        else
                        {
                            _quickTranWindow.GetTfrDepLoan(tran.AcctType, ref deploan);
                        }

                        if (deploan != string.Empty)
                        {
                            _tlTranSet.CurTran.TranAcct.DepLoan.Value = deploan;
                        }
                        //}
                    }
                    //End Task# 90007

                    if (!string.IsNullOrEmpty(tran.TfrAcctNo))
                        _tlTranSet.CurTran.TfrAcct.AcctNo.Value = tran.TfrAcctNo;
                    else
                        _tlTranSet.CurTran.TfrAcct.AcctNo.SetValueToNull();

                    var acctTypeDetail2 = _gbHelper.GetAcctTypeDetails((string.IsNullOrEmpty(tran.TfrAcctType) ? "" : tran.TfrAcctType), null);
                    if (acctTypeDetail2 != null)
                        _tlTranSet.CurTran.TfrAcct.ApplType.Value = acctTypeDetail2.ApplType;           

                    if (_tlTranSet.CurTran.TfrAcctType.Value != _tlTranSet.CurTran.TfrAcct.AcctType.Value ||
                             _tlTranSet.CurTran.TfrAcctNo.Value != _tlTranSet.CurTran.TfrAcct.AcctNo.Value)
                    {
                        //Set the modified transfer values to the journal
                        _tlTranSet.CurTran.TfrAcct.GetAcctDetails();
                        if (!string.IsNullOrEmpty(_tlTranSet.CurTran.TfrAcct.AcctType.Value))
                            _tlTranSet.CurTran.TfrAcctType.Value = _tlTranSet.CurTran.TfrAcct.AcctType.Value;
                        else
                            _tlTranSet.CurTran.TfrAcctType.SetValueToNull();

                        if (!string.IsNullOrEmpty(_tlTranSet.CurTran.TfrAcct.AcctNo.Value))
                            _tlTranSet.CurTran.TfrAcctNo.Value = _tlTranSet.CurTran.TfrAcct.AcctNo.Value;
                        else
                            _tlTranSet.CurTran.TfrAcctNo.SetValueToNull();
                    }

                    if (tran.TfrAmount != 0)
                        _tlTranSet.CurTran.OnUsChks.Value = tran.TfrAmount;
                    //Bug 93234: Commented the code below
                    //else
                    //    _tlTranSet.CurTran.OnUsChks.SetValueToNull();

                    //End 87757

                    if (!string.IsNullOrEmpty(tran.AcctNo))
                    {
                        _tlTranSet.ValidateAddTransaction(ref focusField, (_tlTranSet.TellerVars.IsTCDConnected && picTCD.Visible));    // - ?

                        if (!ProcessResponses(null, focusField, !showErrors ? tran : null, (!hasErrors || !showOnlyFirstErrorMessage))) //Bug #98536
                        {
                            GetControlByXmlTag(focusField, true);
                            cleanUpCurTran = true;
                            tran.MappedTranIndex = _tlTranSet.AddTransaction();
                            hasErrors = true;
                            continue;
                            //return;
                        }
                        tran.MappedTranIndex = _tlTranSet.AddTransaction();
                        tran.IsValidated = true;
                    }
                    else
                        tran.IsValidated = false;
                }
                #endregion

                if (populateViewTran)
                {
                    PopulateTransetTable();
                }


                SetTotalDebitsAndCredits();
                
                easyCaptureTranSet.TotalDebits = _tlTranSet.TotalDebits.Value;

                if (cashInToAssign != 0)
                    easyCaptureTranSet.TotalDebits += cashInToAssign;
                if (checksToAssign != 0)
                    easyCaptureTranSet.TotalDebits += checksToAssign;

                easyCaptureTranSet.TotalCredits = _tlTranSet.TotalCredits.Value;
                if (cashOutToAssign != 0)
                    easyCaptureTranSet.TotalCredits += cashOutToAssign;

                easyCaptureTranSet.TotalDifference = easyCaptureTranSet.TotalDebits - easyCaptureTranSet.TotalCredits;

                return (hasErrors == false);


            }
            finally
            {
                _semaphoreSlim.Release();
                dlgInformation.Instance.HideInfo();
                tranEditComponents.Clear();
                tranEditComponents = null;
                //_tlTranSet.IsTellerCaptureTran = false; // just in case

                //Begin 121713-#7
                if (_turnOffWaitCursor)
                {
                    Cursor.Current = Cursors.Default;
                    _turnOffWaitCursor = false;
                    //ucTransactions1.FocusPanel();
                }
                //End 121713-#7
            }


        }
        //End #87731

        //Begin #TellerWF
        public bool MapInputParamToTranSet(InputParamTranSet inputParamTranSet, 
            bool populateViewTran = true)
        {
            //Dictionary<EasyCaptureTran, TranEditComponent> tranEditComponents = new Dictionary<EasyCaptureTran, TranEditComponent>();

            try
            {
                if (_tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.Success)
                    return true;

                dlgInformation.Instance.ShowInfo("Validating input transaction set...");



                //bool cleanUpCurTran = false;
                bool hasErrors = false;

                #region map easy capture transet to phoenix transet
                foreach (var tran in inputParamTranSet.Transactions)
                {
                    int errorRetCode = 0;
                    string errorText = null;
                    bool tranHasErrors = false;
                    string focusFieldName = null;
                    bool addTranToCollection = true;    // by default always add transaction to transet collection.
                    try
                    {
                        if (true)
                        {
                            _tlTranSet.CurTran.TranAcct.AcctNo.Value = tran.AcctNo;
                            _tlTranSet.CurTran.TranAcct.AcctType.Value = tran.AcctType;

                            var acctTypeDetail = _gbHelper.GetAcctTypeDetails(tran.AcctType, null); // - ?

                            if (acctTypeDetail != null)
                                _tlTranSet.CurTran.TranAcct.ApplType.Value = acctTypeDetail.ApplType;


                            //_tlTranSet.CurTran.TranAcct.RimNo.Value = searchRimNo; //Bug#103638 
                            _tlTranSet.CurTran.TranAcct.GetAcctDetails();   // - ?
                            if (_tlTranSet.CurTran.TranAcct.SuspectAcct.Value == 1)
                            {
                                errorText = "Could not identify transaction account. Transaction cannot be added.";
                                addTranToCollection = false;    // cannot proceed with transaction without a valid transaction account
                                continue;
                            }
                            _tlTranSet.CurTran.AcctType.Value = tran.AcctType; //#108622
                            _tlTranSet.CurTran.AcctNo.Value = tran.AcctNo; //#108622
                            _tlTranSet.CurTran.RimNo.Value = _tlTranSet.CurTran.TranAcct.RimNo.Value; //#108622

                            if (true) //#87755
                                _tlTranSet.CurTran.TlTranCode.Value = tran.TlTranCode;

                            if (!string.IsNullOrEmpty(inputParamTranSet.WaiveSignature) && _tlTranSet.CurTran.WaiveSignature.Value != inputParamTranSet.WaiveSignature)   //#90021
                                _tlTranSet.CurTran.WaiveSignature.Value = inputParamTranSet.WaiveSignature;
                        }

                        _tlTranSet.IsTellerInputParamTran = true;  // to turn off default field calculation

                        _tlTranSet.ValidateTlTrancode(tran.TlTranCode);

                        if (!ProcessResponses(null, focusField))
                        {
                            tranHasErrors = true;
                            continue;
                        }

                        _tlTranSet.CurTran.NetAmt.Value = tran.Amount;
                        if (tran.Amount <= 0)
                            _tlTranSet.CurTran.NetAmt.SetValueToNull();
                        if (true)
                        {
                            //#87755
                            if ( _tlTranSet.AdTlTc.TranCode.Value == 902 || _tlTranSet.AdTlTc.TranCode.Value == 910)
                            {
                                _tlTranSet.IsSqrFormExist();

                                #region Disable dfCheckNo Field is SQRForm
                                if (_tlTranSet.IsSqrFormExisting.Value == "Y")
                                {
                                    if (_tlTranSet.TellerVars.AdTlControl.CheckNoRequire.Value == GlobalVars.Instance.ML.Y)
                                    {
                                        tran.CheckNo = 0; // Task #113989
                                        _tlTranSet.CurTran.CheckNo.SetValueToNull();
                                    }
                                }
                                #endregion

                            }
                            

                            //No error received so handle special TC calculated values here if exists
                            if ((_tlTranSet.CurTran.TranCode.Value == 300 || _tlTranSet.CurTran.TranCode.Value == 301) && tran.Amount == 0)
                            {
                                //Task# 90007
                                if (_tlTranSet.TellerVars.IsAppOnline)
                                {
                                    tran.Amount = _tlTranSet.CurTran.NetAmt.Value;
                                }
                                //tran.MappedTranIndex = _tlTranSet.AddTransaction(); //#92886
                            }
                            if (_tlTranSet.CurTran.TranCodeDesc.IsNull && _tlTranSet.TellerVars.AdTlTc != null && tran.TlTranCode != null)
                                _tlTranSet.CurTran.TranCodeDesc.Value = string.Format("{0} - {1}", tran.TlTranCode, _tlTranSet.TellerVars.AdTlTc.Description.Value);
                        }
                        _tlTranSet.CurTran.NetAmt.Value = tran.Amount;

                        if (tran.Items != null && tran.Items.Count > 0)
                        {
                            if (true)
                            {
                                foreach (var item in tran.Items)
                                {
                                    if (string.IsNullOrEmpty(item.CheckType))
                                        item.CheckType = "T";
                                    TlItemCapture tlItemCapture = new TlItemCapture();
                                    InputParamTranSet.MoveValueFromObjectToBusObject(item, tlItemCapture);
                                    //tlItemCapture.AcctType.SetValue(item.AcctType);
                                    //tlItemCapture.AcctNo.SetValue(item.AcctNo);
                                    //if ( item.CheckType != "O") // ?? TBD - routing # cause the on us to switch back to transit.
                                    //    tlItemCapture.RoutingNo.SetValue(item.RoutingNo);
                                    //tlItemCapture.Amount.SetValue(item.Amount);
                                    //if (!string.IsNullOrEmpty(item.CheckNo))
                                    //    tlItemCapture.CheckNo.SetValue(item.CheckNo);
                                    //tlItemCapture.CheckType.SetValue(item.CheckType);
                                    //if (item.TranCode > 0)
                                    //    tlItemCapture.TranCode.SetValue(item.TranCode);
                                    //tlItemCapture.EffectiveDt.SetValue(_tlTranSet.EffectiveDt.Value);
                                    //tlItemCapture.NoItems.SetValue(item.NoItems);

                                    if (tlItemCapture.CheckType.Value == "O") // ?? TBD - routing # cause the on us to switch back to transit.
                                        tlItemCapture.RoutingNo.SetValue(null);

                                    string editedField = tlItemCapture.AcctType.XmlTag + "~" +
                                        tlItemCapture.AcctNo.XmlTag + "~" +
                                        tlItemCapture.RoutingNo.XmlTag + "~" +
                                        tlItemCapture.CheckNo.XmlTag + "~" +
                                        tlItemCapture.TranCode.XmlTag + "~" +
                                        tlItemCapture.Amount.XmlTag;    

                                    var isValidItem = tlItemCapture.ValidateItem(_tlTranSet.TellerHelper, _gbHelper, _tlTranSet.TellerVars, _tlTranSet.AdTlTc,
                                            editedField, null, null, null, null, -1, ref focusFieldName);
                                    if (!isValidItem) // #79510, #10883 - Passed IsAcquirerTran
                                    {
                                        errorRetCode = tlItemCapture.ActionReturnCode.Value;                                        
                                        continue;
                                    }

                                    if (tlItemCapture.CheckType.Value == "O" && tlItemCapture.RoutingNo.IsNull) // ?? TBD - routing # cause the on us to switch back to transit.
                                        tlItemCapture.RoutingNo.SetValue(item.RoutingNo);

                                    _tlTranSet.CurTran.Items.Add(tlItemCapture);
                                }

                                //dlgInformation.Instance.ShowInfo("Calculating Float...");
                                _tlTranSet.CalculateFloatForCurTran(ref errorRetCode);
                                if (errorRetCode != 0)
                                {
                                    continue;
                                }

                                _tlTranSet.GetItemTotals();
                                //_tlTranSet.CurTran.ItemCount.Value = (short)tran.Items.Count;
                                //inputParamTranSet.ChecksMakeAvail = Convert.ToDecimal(Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet_MakeAvail"]);
                            }
                            //inputParamTranSet.NoItems = _tlTranSet.CurTran.Items.Count;
                            //checksToAssign = 0;

                        }

                        if (tran.SavingsBond != null && tran.SavingsBond.Count > 0)
                        {
                            if (true)
                            {
                                decimal intEarned = 0;
                                decimal redValue = 0;

                                foreach (var bond in tran.SavingsBond)
                                {
                                    GbBondRedemptHistory gbBondRedempt = new GbBondRedemptHistory();

                                    //gbBondRedempt.InstrumentType.Value = bond.InstrumentType;
                                    //gbBondRedempt.FaceValue.Value = bond.FaceValue;
                                    //gbBondRedempt.IssueMonth.Value = bond.IssueMonth;
                                    //gbBondRedempt.IssueYear.Value = bond.IssueYear;
                                    //gbBondRedempt.SerialNo.Value = bond.SerialNo;
                                    //gbBondRedempt.IntEarned.Value = bond.IntEarned;
                                    //gbBondRedempt.RedemptionValue.Value = bond.RedemptionValue;
                                    //gbBondRedempt.EffectiveDt.Value = bond.EffectiveDt;
                                    //gbBondRedempt.RedemptionMonth.Value = bond.RedemptionMonth;
                                    //gbBondRedempt.RedemptionYear.Value = bond.RedemptionYear;
                                    //gbBondRedempt.RimNo.Value = bond.RimNo;


                                    InputParamTranSet.MoveValueFromObjectToBusObject(bond, gbBondRedempt);

                                    intEarned += (gbBondRedempt.IntEarned.IsNull ? 0 : gbBondRedempt.IntEarned.Value);
                                    redValue += (gbBondRedempt.RedemptionValue.IsNull ? 0 : gbBondRedempt.RedemptionValue.Value);

                                    _tlTranSet.CurTran.SavingsBonds.Add(gbBondRedempt);
                                }

                                CallParent("RedemptionOut", tran.SavingsBond.Count, intEarned, redValue);
                                
                            }
                           

                        }
                        if (tran.CashInDenoms != null && tran.CashInDenoms.Count > 0)  //#96462
                        {
                            if ( !MapInputParamCashInCashOut(tran.CashInDenoms, _tlTranSet.CurTran.CashInDenoms,
                                CoreService.Translation.GetListItemX(ListId.DENOMTRANTYPE, "I"), ref errorRetCode, ref errorText))
                            {
                                continue;
                            }

                            _tlTranSet.ModifyCashInOutAmt(_tlTranSet.CurTran.CashIn.XmlTag, true, false);
                            _tlTranSet.CurTran.CashCount.Value = "Y";

                        }
                        else if (tran.CashIn > 0)
                            _tlTranSet.CurTran.CashIn.Value = tran.CashIn;

                        if (tran.CashOutDenoms != null && tran.CashOutDenoms.Count > 0)  //#96462
                        {
                            if (!MapInputParamCashInCashOut(tran.CashOutDenoms, _tlTranSet.CurTran.CashOutDenoms,
                                CoreService.Translation.GetListItemX(ListId.DENOMTRANTYPE, "O"), ref errorRetCode, ref errorText))
                            {
                                continue;
                            }

                            _tlTranSet.ModifyCashInOutAmt(_tlTranSet.CurTran.CashOut.XmlTag, true, false);
                            _tlTranSet.CurTran.CashCount.Value = "Y";
                            bool searchForMatchingDenom = _tlTranSet.CashOutDenoms.Count > 0;

                            foreach (TlCashCount curTranCashOutDenom in _tlTranSet.CurTran.CashOutDenoms)
                            {
                                TlCashCount tranSetCashOutMatchingDenom = null;
                                if (searchForMatchingDenom && curTranCashOutDenom.Quantity.Value > 0 )
                                {
                                    foreach (TlCashCount tranSetCashOutDenom in _tlTranSet.CashOutDenoms)
                                    {
                                        if (curTranCashOutDenom.DenomType.Value == tranSetCashOutDenom.DenomType.Value &&
                                            curTranCashOutDenom.Denom.Value == tranSetCashOutDenom.Denom.Value)
                                        {
                                            tranSetCashOutMatchingDenom = tranSetCashOutDenom;
                                            break;
                                        }
                                    }
                                }
                                if (tranSetCashOutMatchingDenom == null)
                                    _tlTranSet.CashOutDenoms.Add(curTranCashOutDenom);
                                else if (curTranCashOutDenom.Quantity.Value > 0 )
                                {
                                    if (tranSetCashOutMatchingDenom.Quantity.IsNull)
                                        tranSetCashOutMatchingDenom.Quantity.Value = 0;

                                    tranSetCashOutMatchingDenom.Quantity.Value += curTranCashOutDenom.Quantity.Value;
                                    if (!tranSetCashOutMatchingDenom.ValidateDenom(tranSetCashOutMatchingDenom.Quantity.XmlTag))
                                    {
                                        errorRetCode = tranSetCashOutMatchingDenom.ValidationReturnCode.Value;
                                        continue;
                                    }

                                }
                            }

                        }
                        else if (tran.CashOut > 0)
                            _tlTranSet.CurTran.CashOut.Value = tran.CashOut;

                        //if (_tlTranSet.CurTran.CashOutDenoms.Count > 0 && (tranEditComponent.RecreateTran || tranEditComponent.CashOutEdited))
                        //{
                        //    _tlTranSet.ModifyCashInOutAmt(_tlTranSet.CurTran.CashOut.XmlTag);
                        //}

                        if (tran.CashIn > 0)
                            _tlTranSet.CurTran.CashIn.Value = tran.CashIn;
                        

                        _tlTranSet.CalculateDefaultField(_tlTranSet.CurTran.NetAmt.XmlTag);


                        tran.CcAmt = _tlTranSet.CurTran.CcAmt.IsNull ? 0 : _tlTranSet.CurTran.CcAmt.Value;

                        //_tlTranSet.IsTellerCaptureTran = false;

                        _tlTranSet.IsTcdConnected.Value = (_tlTranSet.TellerVars.IsTCDConnected ? Convert.ToInt32(1) : Convert.ToInt32(0)); //#72916

                        //Begin Task#87747

                        //_tlTranSet.CurTran.CheckNo.SetValueToNull();
                        //_tlTranSet.CurTran.TfrChkNo.SetValueToNull();

                        if (tran.CheckNo > 0) // Task #113989
                        {
                            if (tran.IsTranferTran())
                            {
                                _tlTranSet.CurTran.TfrChkNo.Value = tran.CheckNo;
                            }
                            else
                            {
                                _tlTranSet.CurTran.CheckNo.Value = tran.CheckNo;
                            }
                        }
                        //End Task#87747


                        if (!string.IsNullOrEmpty(tran.Description))
                            _tlTranSet.CurTran.Description.Value = tran.Description;
                        else
                            _tlTranSet.CurTran.Description.SetValueToNull();

                        if (!string.IsNullOrEmpty(tran.Reference))
                            _tlTranSet.CurTran.Reference.Value = tran.Reference;
                        else
                            _tlTranSet.CurTran.Reference.SetValueToNull();

                        _tlTranSet.CurTran.ProcessAsRegD.Value = tran.RegD ? "Y" : "N";
                        _tlTranSet.CurTran.UseDescription.Value = tran.PassDescriptionToHistory ? "Y" : "N";

                        //Begin Task#89981
                        if (CrossRefSearchAcct != null && CrossRefSearchMapAcctNo != null && CrossRefSearchMapAcctType != null)
                        {
                            if (tran.AcctNo == CrossRefSearchMapAcctNo && tran.AcctType == CrossRefSearchMapAcctType)
                            {
                                _tlTranSet.CurTran.IncomingAcctNo.Value = CrossRefSearchAcct;
                                _tlTranSet.CurTran.TranAcct.IncomingAcctNo.Value = CrossRefSearchAcct;

                            }
                        }
                        //End Task#89980

                        //Set the modified transfer values to the transet
                        //Begin 87759

                        if (string.IsNullOrEmpty(tran.TfrAcctNo) == false)
                        {
                            if (tran.Items != null && tran.Items.Count > 0 )
                            {
                                errorText = "Tranfer Information cannot be specified when items are present.";
                                continue;
                            }
                            var acctTypeDetail2 = _gbHelper.GetAcctTypeDetails((string.IsNullOrEmpty(tran.TfrAcctType) ? "" : tran.TfrAcctType), null);

                            if (!string.IsNullOrEmpty(tran.TfrAcctType))
                            {
                                _tlTranSet.CurTran.TfrAcct.AcctType.Value = tran.TfrAcctType;
                                if (acctTypeDetail2 != null)
                                {
                                    _tlTranSet.CurTran.TfrAcct.DepLoan.Value = acctTypeDetail2.DepLoan;
                                }
                            }
                            else
                            {
                                _tlTranSet.CurTran.TfrAcct.AcctType.SetValueToNull();
                                _tlTranSet.CurTran.TfrAcct.DepLoan.SetValueToNull();
                            }
                            //End 87759

                            if (!string.IsNullOrEmpty(tran.TfrAcctNo))
                                _tlTranSet.CurTran.TfrAcct.AcctNo.Value = tran.TfrAcctNo;
                            else
                                _tlTranSet.CurTran.TfrAcct.AcctNo.SetValueToNull();


                            if (acctTypeDetail2 != null)
                                _tlTranSet.CurTran.TfrAcct.ApplType.Value = acctTypeDetail2.ApplType;

                            if (_tlTranSet.CurTran.TfrAcctType.Value != _tlTranSet.CurTran.TfrAcct.AcctType.Value ||
                                     _tlTranSet.CurTran.TfrAcctNo.Value != _tlTranSet.CurTran.TfrAcct.AcctNo.Value)
                            {
                                //Set the modified transfer values to the journal
                                _tlTranSet.CurTran.TfrAcct.GetAcctDetails();
                                if (_tlTranSet.CurTran.TfrAcct.SuspectAcct.Value == 1)
                                {
                                    errorText = "Could not identify transfer account.";
                                    continue;
                                }
                                if (!string.IsNullOrEmpty(_tlTranSet.CurTran.TfrAcct.AcctType.Value))
                                    _tlTranSet.CurTran.TfrAcctType.Value = _tlTranSet.CurTran.TfrAcct.AcctType.Value;
                                else
                                    _tlTranSet.CurTran.TfrAcctType.SetValueToNull();

                                if (!string.IsNullOrEmpty(_tlTranSet.CurTran.TfrAcct.AcctNo.Value))
                                    _tlTranSet.CurTran.TfrAcctNo.Value = _tlTranSet.CurTran.TfrAcct.AcctNo.Value;
                                else
                                    _tlTranSet.CurTran.TfrAcctNo.SetValueToNull();
                            }

                            if (tran.TfrAmount != 0)
                                _tlTranSet.CurTran.OnUsChks.Value = tran.TfrAmount;
                            else if ( tran.Amount != 0)
                                _tlTranSet.CurTran.OnUsChks.Value = tran.Amount;
                        }

                        _tlTranSet.ValidateAddTransaction(ref focusField, (_tlTranSet.TellerVars.IsTCDConnected && picTCD.Visible));    // - ?

                        if (!ProcessResponses(null, focusField)) //Bug #98536
                        {
                            tranHasErrors = true;
                            continue;
                        }
                        tran.MappedTranIndex = _tlTranSet.AddTransaction();
                        tran.IsValidated = true;
                    }
                    finally
                    {
                        
                        if ( errorRetCode != 0 || !string.IsNullOrEmpty(errorText) )    // there is error
                        {
                            PMessageCollection messages = new PMessageCollection();
                            if (errorRetCode != 0)
                                messages.AddError(errorRetCode, null, string.Empty);
                            else
                                messages.AddError(null, errorText);

                            tranHasErrors = ProcessResponses(messages, focusField);
                        }
                        if ( tranHasErrors)
                        {
                            GetControlByXmlTag(focusField, true);
                            //cleanUpCurTran = true;
                            if (addTranToCollection )
                                tran.MappedTranIndex = _tlTranSet.AddTransaction();
                            hasErrors = true;
                        }
                    }
                }
                #endregion

                if (populateViewTran)
                {
                    PopulateTransetTable();
                }


                SetTotalDebitsAndCredits();
                return (hasErrors == false);

            }
            finally
            {
                dlgInformation.Instance.HideInfo();
                inputParamTranSet.IsTranLoaded = true;
                //_tlTranSet.IsTellerQuickTran = false;
            }


        }
        public bool MapInputParamCashInCashOut( List<InputParamTranDenom> cashDenoms, ArrayList curTranDenoms, string type, 
            ref  int errorRetCode, ref string errorText )
        {
            if (cashDenoms != null && cashDenoms.Count > 0)  //#96462
            {
                var _busTlCashCount = new TlCashCount();
                _busTlCashCount.BranchNo.Value = _tlTranSet.BranchNo.Value;
                _busTlCashCount.DrawerNo.Value = _tlTranSet.DrawerNo.Value;
                _busTlCashCount.EffectiveDt.Value = _tlTranSet.EffectiveDt.Value;                
                _busTlCashCount.LoadCashCountDenom(curTranDenoms, type); //#71893

                foreach (var cashdenom in cashDenoms)
                {
                    if (string.IsNullOrEmpty(cashdenom.DenomType))
                        cashdenom.DenomType = CoreService.Translation.GetListItemX(ListId.DENOMTYPES, "LB");

                    foreach (TlCashCount tlCashCount in curTranDenoms)
                    {
                        if (cashdenom.DenomType == tlCashCount.DenomType.Value && cashdenom.Denom == tlCashCount.Denom.Value)
                        {
                            //if (cashdenom.Quantity > 0)
                            //    tlCashCount.Quantity.SetValue(cashdenom.Quantity);
                            //if (cashdenom.Amount > 0)
                            //    tlCashCount.Amt.SetValue(cashdenom.Amount);

                            InputParamTranSet.MoveValueFromObjectToBusObject(cashdenom, tlCashCount);

                            if (!tlCashCount.CountValue.IsNull && tlCashCount.DenomType.Value != CoreService.Translation.GetListItemX(ListId.DENOMTYPES, "BC"))
                            {
                                if (!tlCashCount.DenomType.IsNull && !(tlCashCount.DenomType.Value == CoreService.Translation.GetListItemX(ListId.DENOMTYPES, "SB") ||
                                    tlCashCount.DenomType.Value == CoreService.Translation.GetListItemX(ListId.DENOMTYPES, "RC") ||
                                    tlCashCount.DenomType.Value == CoreService.Translation.GetListItemX(ListId.DENOMTYPES, "OC")))
                                {
                                    // Count Value can be specified only for strapped bills ,rolled coins and bulk coins.
                                    //ValidationReturnCode.Value = 360457;
                                    tlCashCount.CountValue.SetValue(null);   // Validation throwing error if count value is not null
                                    //return false;
                                }
                            }

                            if (!tlCashCount.ValidateDenom(null))
                            {
                                errorRetCode = tlCashCount.ValidationReturnCode.Value;
                                return false;
                            }
                            cashdenom.IsValidated = true;
                        }
                    }
                }

                var inValidDenom = cashDenoms.Find(x => x.IsValidated == false);
                if (inValidDenom != null)
                {
                    errorText = string.Format("Could not identify/validate {0} denom value '{1}' of type '{2}'", 
                        (type == CoreService.Translation.GetListItemX(ListId.DENOMTRANTYPE, "I") ? "cash in" : "cash out"), 
                        inValidDenom.Denom, inValidDenom.DenomType);
                    return false;
                }

                

            }
            return true;
        }
        public bool ValidateInputParamTranSet()
        {
            var inputParamTranSet = _inputParamTranSet;

            bool hasErrors = false;
            foreach (var tran in inputParamTranSet.Transactions)
            {
                if (tran.IsValidated)
                    continue;

                if (tran.MappedTranIndex >= 0)    // it's an existing tran about to be overwritten
                {
                    //reset the tran
                    _tlTranSet.SelectTransaction(tran.MappedTranIndex, false);
                    _tlTranSet.ValidateAddTransaction(ref focusField, (_tlTranSet.TellerVars.IsTCDConnected && picTCD.Visible));    // - ?

                    if (!ProcessResponses(null, null))
                    {
                        GetControlByXmlTag(focusField, true);
                        hasErrors = true;
                        break;
                    }
                }

                tran.IsValidated = true;
            }

            return (hasErrors == false);
        }
        //End #TellerWF

        #endregion

        private void ManipulateAcctTrackList(string psMode, int pnRimNo)
        {
            try
            {
                if (psMode == "Acct")
                {
                    acctsTrackHash.Add(dfAcctNo.Text.Trim(), cmbAcctType.Text.Trim());

                    if (pnRimNo > 0)
                        acctsTrackHash.Add(pnRimNo.ToString(), "RIM");
                }
                else
                {
                    acctsTrackHash.Add(pnRimNo.ToString(), "RIM");

                    if (searchAcctType != null && searchAcctNo != null)
                        acctsTrackHash.Add(searchAcctNo.Trim(), searchAcctType.Trim());
                }
            }
            catch (System.ArgumentException earg)
            {
                //This exception will happen if we try to add the same key twice. So ignore and continue.
                System.Diagnostics.Trace.WriteLine(earg.Message);
                return;
            }

            return;
        }
        //End Enh# 69248

        #endregion

        #region ProcessCmdKey F9 Item capture window 71227
        protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
        {
            if (cmbTranCode.CodeValue != null && keyData == Keys.F9) //#140798
            {
                //#29211
                //if ((cmbTranCode.CodeValue.ToString() == "912" || cmbTranCode.CodeValue.ToString() == "921")) //#140798
                //{
                //    CallOtherForms("SavingsBond");
                //    return true;
                //}
                if (pbItemCapture.Enabled &&
                    (cmbTranCode.CodeValue.ToString() != "912" && cmbTranCode.CodeValue.ToString() != "921"))
                {
                    pbItemCapture_Click(pbItemCapture, null);
                    return true;
                }
            }
            //Begin #72916
            if ((picTCD.Visible || picDrawer.Visible) && keyData == (System.Windows.Forms.Keys.Control | System.Windows.Forms.Keys.D))
            {
                TcdDrawerIconClick(picTCD, picDrawer);
                Workspace.ActionPanel.UpdateView();
                return true;
            }
            if (picTCD.Visible && cmbTranCode.CodeValue != null &&
                (cmbTranCode.CodeValue.ToString() == "VLS" || (cmbTranCode.CodeValue.ToString() != "VLT" && dfCashIn.Visible)) &&
                keyData == (System.Windows.Forms.Keys.Control | System.Windows.Forms.Keys.T))   //#79574
            {
                if (_tlTranSet.IsTellerCaptureTran && dfCashIn.UnFormattedValue != null) //#43402
                    DeviceDeposit(TlTransactionSet.UcmInterface.DeviceDeposit, false, Convert.ToDecimal(dfCashIn.UnFormattedValue));
                else
                DeviceDeposit(TlTransactionSet.UcmInterface.DeviceDeposit);
                Workspace.ActionPanel.UpdateView();
                return true;
            }
            //Begin #140895-ReadOnly
            #region sample code for debug purpose only when there is no device avaialable
            #if DEBUG
            if ((_tellerCapture == null || !_tellerCapture.IsXpediteRunning) && keyData == _tlCaptureNoDeviceDebugKey &&
                _tlTranSet.AdTlControl.TellerCapture.Value == "Y")
            {
                string transaction = null;
                DialogResult msgRes = System.Windows.Forms.DialogResult.None;
                bool afterPost = _tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.Success;
                string xmlDir = "C:\\pbsus\\2013_140895_TellerCaptureIntegration_638\\docs\\test_xml";

                _tlTranSet.TellerVars.IsTellerCaptureEnabled = true;

                _tlCaptureNoDeviceDebugMode = true;
                bool showBulkOption = true;

                if (DialogResult.No == MessageBox.Show("Process Transaction", "Transaction/Validate Mode", MessageBoxButtons.YesNo))
                {
                    string infile = xmlDir + "\\OnValidate.xml";
                    string itemData = null;

                    showBulkOption = false; 

                    if (File.Exists(infile))
                    {
                        using (StreamReader temp = new StreamReader(infile))
                            itemData = temp.ReadToEnd();
                        int errorId = 0;
                        string errorText = null;
                        string customerData = null;
                        errorText = _tlTranSet.ProcessOnValidateItem(itemData, string.Empty, string.Empty, out errorId, out errorText, out customerData);
                        using (Form form = new Form())
                        {
                            form.Controls.Add(new TextBox() { Multiline = true, ScrollBars = ScrollBars.Both, Dock = DockStyle.Fill, Text = "Customer Data:\n" + customerData });
                            form.Text = string.Format("Validate Result: Error = {0}-{1}", errorId, errorText);
                            form.ShowDialog();
                        }
                    }
                    return base.ProcessCmdKey(ref msg, keyData);
                }

                if (IsPhxTranInProgress() || _tlTranSet.IsTellerCaptureTranLoadFailed)
                {
                    if (afterPost)
                        msgRes = System.Windows.Forms.DialogResult.Yes;
                    else if (_tlTranSet.IsTellerCaptureTranLoadFailed)
                        msgRes = MessageBox.Show("Resend failed loading AVTC transaction ?", "Processing Mode", MessageBoxButtons.YesNo);
                    else
                        msgRes = MessageBox.Show("Capture Current Phoenix Transaction?", "Processing Mode", MessageBoxButtons.YesNo);

                    showBulkOption = false;

                    if (msgRes == System.Windows.Forms.DialogResult.Yes)
                    {
                        //this.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "ActionTlrCapSingleRelatedClick", new object[] { transaction });
                        CollectCheckInfoForChkPrinting(true);
                        if (!_tlTranSet.PrepareTlCaptureInputFromPhxTranSet())
                        {
                            ProcessResponses(null);
                            WriteToDebugLog("Teller Capture: Failed to execute PrepareTlCaptureInputFromPhxTranSet ");
                            return false;
                        }
                        //if (picTabs.SelectedIndex != (int)TAB.QuickTran)    //#102717
                        //{
                        //    _tlTranSet.IsTellerCaptureCheckOnlyTran = false;
                        //    _tlTranSet.TlCaptureChecksOnlyItems.Clear();
                        //}
                        #region generate the custom xml
                        //transaction = _tlTranSet.TlCaptureInputItems.ToXML(false, false);
                        string outFile = xmlDir + "\\resubmit.xml";
                        StringBuilder outXML = new StringBuilder();
                        outXML.AppendLine("<Transaction>");
                        string newISNFixed = _tlTranSet.TellerVars.LastJrnlSequenceNo.ToString().PadLeft(4, '0') + DateTime.Now.Second.ToString();
                        for (int i = 0; i < _tlTranSet.TlCaptureInputItems.Count; i++)
                        {
                            TlCaptureScanItem item = _tlTranSet.TlCaptureInputItems[i];
                            string xmL = item.ToXML(false, false);
                            string newISN = newISNFixed + i.ToString().PadLeft(4, '0');
                            bool origItem = !string.IsNullOrEmpty(item.ScanISN);
                            if (origItem)
                            {
                                xmL = xmL.Replace("<ISN>" + item.ScanISN + "</ISN>", "<ISN>" + newISN + "</ISN>");
                            }
                            else
                            {
                                if (xmL.IndexOf("<DoNotDelete>1</DoNotDelete>") >= 0)
                                {
                                    xmL = xmL.Replace("<DoNotDelete>1</DoNotDelete>", @"<DoNotDelete>1</DoNotDelete>
<TranNumber>1</TranNumber>
<AdjType></AdjType>
<Disposition></Disposition>
<ItemInserted></ItemInserted>
" + "<ISN>" + newISN + "</ISN>");

                                }
                                else
                                {
                                    xmL = xmL.Replace("<DoNotDelete></DoNotDelete>", @"<DoNotDelete></DoNotDelete>
<TranNumber>1</TranNumber>
<AdjType></AdjType>
<Disposition></Disposition>
<ItemInserted></ItemInserted>
" + "<ISN>" + newISN + "</ISN>");
                                }

                                if (xmL.IndexOf("</RdrAmount>") >= 2)
                                {
                                    xmL = xmL.Insert(xmL.IndexOf("</RdrAmount>") - 2, ".");
                                }
                                xmL = xmL.Replace("<RdrAmount>", "<FormattedAmount>");
                                xmL = xmL.Replace("</RdrAmount>", "</FormattedAmount>");
                                xmL = xmL.Replace("RdrAccountNbr", "AccountNbr");
                                xmL = xmL.Replace("RdrRT", "RT");
                                if (!item.IsCheckItem() || item.CheckItemIsTranForAVTC())
                                {
                                    xmL = xmL.Replace("RdrTranCode", "TranCode");
                                }
                            }
                            outXML.Append(xmL);
                        }
                        outXML.AppendLine();
                        outXML.AppendLine("</Transaction>");
                        transaction = outXML.ToString();

                        if (File.Exists(outFile))
                        {
                            File.WriteAllText(outFile, transaction);
                        }
                        else
                        {
                            using (Form form = new Form())
                            {
                                form.Controls.Add(new TextBox() { Multiline = true, ScrollBars = ScrollBars.Both, Dock = DockStyle.Fill, Text = transaction });
                                form.Text = "AVTC External Transaction XML";
                                form.ShowDialog();
                            }
                        }
                        #endregion


                    }
                }

                if (_tlTranSet.IsTellerCaptureTran && msgRes != System.Windows.Forms.DialogResult.Yes)
                {
                    SetTellerCaptureFlagForTranSet(false);
                    //SetTellerCaptureCheckOnlyFlagForTranSet(false); //#102719 #102717
                    EnableDisableTellerCaptureTran("SwitchToPhoenixTran");
                    BringAppToFront();
                    return base.ProcessCmdKey(ref msg, keyData);

                }

                if (showBulkOption)
                {
                    if (DialogResult.No == MessageBox.Show("Single Tran Mode", "Single Tran Mode", MessageBoxButtons.YesNo))
                    {
                        _tlCaptureBulkOptionClicked = true;
                    }
                }

                #region transaction
                if (!afterPost)
                {
                    transaction = GetTellerCaptureXMLForDebug(msgRes == System.Windows.Forms.DialogResult.Yes ? "Select the output XML for PHOENIX transaction" :
                        "Select the output XML for AVTC transaction");

                    if (string.IsNullOrEmpty(transaction))
                    {

                        bool cancelTran = true;
                        if (cancelTran)
                        {
                            this.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "CancelTransaction", new object[] { transaction });
                            return base.ProcessCmdKey(ref msg, keyData);
                        }

                        #region sample transaction
                        transaction = @"<Transaction>
  <Item>
<DeviceNumber>1</DeviceNumber>
<CaptureDate>20131016</CaptureDate>
<BusinessDate>20120710</BusinessDate>
<Outputdate>07/10/2012</Outputdate>
<TranNumber>1</TranNumber>
<RemittingRT></RemittingRT>
<ProcessingRT>0</ProcessingRT>
<ProcessingSubBranch>0</ProcessingSubBranch>
<RemittingSubBranch>0</RemittingSubBranch>
<TillNumber>1</TillNumber>
<RdrRT></RdrRT>
<RdrRTLen>0</RdrRTLen>
<RdrAmount></RdrAmount>
<RdrAmountLen>0</RdrAmountLen>
<RdrAux></RdrAux>
<RdrAuxLen>0</RdrAuxLen>
<RdrAccountNbr></RdrAccountNbr>
<RdrAccountNbrLen>0</RdrAccountNbrLen>
<RdrTranCode></RdrTranCode>
<RdrTranCodeLen>0</RdrTranCodeLen>
<RdrFld4></RdrFld4>
<RdrFld4Len>0</RdrFld4Len>
<Amount>0000004000</Amount>
<AmountLen>10</AmountLen>
<AMAmend>3</AMAmend>
<TC>000101</TC>
<TranCode>000101</TranCode>
<TranCodeLen>3</TranCodeLen>
<TCAmend>1</TCAmend>
<AccountNbr>000000000000010021</AccountNbr>
<AccountNbrLen>10</AccountNbrLen>
<ANAmend>3</ANAmend>
<RT>555555101</RT>
<RTLen>9</RTLen>
<RTAmend>1</RTAmend>
<RIC>0</RIC>
<RICLen>0</RICLen>
<Aux>000000000000000</Aux>
<AuxLen>0</AuxLen>
<AUXAmend>1</AUXAmend>
<wAux>00000000</wAux>
<wAuxExtract></wAuxExtract>
<wAuxLen>0</wAuxLen>
<ScannedCardNbr></ScannedCardNbr>
<ActualCardNbr></ActualCardNbr>
<ReversalFlag>0</ReversalFlag>
<OriginalISN></OriginalISN>
<ISN>000001001360</ISN>
<Disposition>1</Disposition>
<Gender>1</Gender>
<HouseIndicator>1</HouseIndicator>
<Deleted>0</Deleted>
<Moved>0</Moved>
<ReadOnlyItem>0</ReadOnlyItem>
<DoNotDelete>0</DoNotDelete>
<AdjCode>12</AdjCode>
<ClaimedAmount>0000000000</ClaimedAmount>
<TimeRead>142246</TimeRead>
<TimePosted>142347</TimePosted>
<CurrencyCode>N/A</CurrencyCode>
<Pocket>0</Pocket>
<Image_Device>LKM-LT-MANICK7</Image_Device>
<Image_Location>\\\\LKM-LT-MANICK7\\Alogent821\\XMLData\\20120710\\</Image_Location>
<Image_Share>Alogent821</Image_Share>
<Image_Name>000001_LKM-LT-MANICK7~F_0039_0001</Image_Name>
<Image_DIN>1</Image_DIN>
<MissCnt>0</MissCnt>
<AdjType>0</AdjType>
<ItemRelSeqNbr>1</ItemRelSeqNbr>
<LastCaptureBatch>0</LastCaptureBatch>
<PostDay>0</PostDay>
<UserName>1 - Phoenix-1</UserName>
<RemittingOutletName></RemittingOutletName>
<SessionStartTime>41563.7651865625</SessionStartTime>
<SessionEndTime></SessionEndTime>
<SessionIdleTime>0.000586967589065068</SessionIdleTime>
<SentToCAR>0</SentToCAR>
<PassedCAR>0</PassedCAR>
<CARAmount>0000000000</CARAmount>
<CARConfidence>0</CARConfidence>
<CARSetID>1</CARSetID>
<SentToICR>0</SentToICR>
<AutoCorrected>0</AutoCorrected>
<CustomFieldsRead>0</CustomFieldsRead>
<CustomFieldsDiscarded>0</CustomFieldsDiscarded>
<OperCorrected>1</OperCorrected>
<CaptureDevice>Panini MVX</CaptureDevice>
<FrontCounter>1</FrontCounter>
<ReaderType></ReaderType>
<CantReadCount>0</CantReadCount>
<ItemJammed>0</ItemJammed>
<ItemRejected>0</ItemRejected>
<ItemAccepted>0</ItemAccepted>
<ItemInserted>1</ItemInserted>
<LogicalEntry>0</LogicalEntry>
<TransactionType>ScanItems</TransactionType>
<SubstImage>1</SubstImage>
<ImageAnalysisStatus>0</ImageAnalysisStatus>
<IAResults></IAResults>
<RescanStatus>0</RescanStatus>
<Stub>0</Stub>
<CorpID></CorpID>
<FormattedAmount>40.00</FormattedAmount>
<DuplicateOverridden>0</DuplicateOverridden>
<AllowDuplicateOverride>1</AllowDuplicateOverride>
<RearImagePresent>0</RearImagePresent>
<DepositID>000001001360</DepositID>
<Comment></Comment>
<ItemFinancialInstID></ItemFinancialInstID>
<DeferredTransaction>0</DeferredTransaction>
<ItemSourceLocationID></ItemSourceLocationID>
<ACHIndicator>0</ACHIndicator>
<ACHOptOutStatus>0</ACHOptOutStatus>
<ACHAccountNumber></ACHAccountNumber>
<ACHRoutingTransit></ACHRoutingTransit>
<ACHOptOutOverridden>0</ACHOptOutOverridden>
<IsACHEligible>0</IsACHEligible>
<BranchID>1</BranchID>
<BranchName>Lake Mary Main</BranchName>
<WorkstationName>LKM-LT-MANICK7</WorkstationName>
<BatchID>39</BatchID>
<BatchNumber>39</BatchNumber>
<DupDetectionStatus>0</DupDetectionStatus>
<ScannerAction>0</ScannerAction>
<PODOrderSequenceNbr>2</PODOrderSequenceNbr>
<NonMICRItem>0</NonMICRItem>
<VirtuallyEndorsed>1</VirtuallyEndorsed>
<RescanCLMismatch>0</RescanCLMismatch>
<ItemInformation></ItemInformation>
<BatchWorkstation>LKM-LT-MANICK7</BatchWorkstation>
<OriginalPocket>0</OriginalPocket>
<ImageOrientation>0</ImageOrientation>
<InBranchFreePool>0</InBranchFreePool>
<DeleteReason>0</DeleteReason>
<CustomItemInfo>00000000000000000000000000000000000000000000004534</CustomItemInfo>
<BondSerialNumber></BondSerialNumber>
<BondType></BondType>
<BondValue>0000000000</BondValue>
<BondIssueDate></BondIssueDate>
<EDDMessage></EDDMessage>
<EDDStatus>0</EDDStatus>
<ItemType>Deposit</ItemType>
<SelectorNumber>7100</SelectorNumber>
<BranchTellerID>998</BranchTellerID>
<ProdType></ProdType>
<ReceiptNumber></ReceiptNumber>
<TellerSequence></TellerSequence>
<BranchSelector>7100</BranchSelector>
<xPriority type=""customfield"">00</xPriority>
<xCustomerSession type=""customfield"">000039</xCustomerSession>
<xTransSqNmbr type=""customfield"">000001</xTransSqNmbr>
<xAFC_01 type=""customfield"">2</xAFC_01>
<xAFC_02 type=""customfield""></xAFC_02>
<xAFC_03 type=""customfield""></xAFC_03>
<xAFC_04 type=""customfield""></xAFC_04>
<xAFC_05 type=""customfield""></xAFC_05>
<xAFC_06 type=""customfield""></xAFC_06>
<xAFC_07 type=""customfield""></xAFC_07>
  </Item>
  <Item>
<DeviceNumber>1</DeviceNumber>
<CaptureDate>20131016</CaptureDate>
<BusinessDate>20120710</BusinessDate>
<Outputdate>07/10/2012</Outputdate>
<TranNumber>1</TranNumber>
<RemittingRT></RemittingRT>
<ProcessingRT>0</ProcessingRT>
<ProcessingSubBranch>0</ProcessingSubBranch>
<RemittingSubBranch>0</RemittingSubBranch>
<TillNumber>1</TillNumber>
<RdrRT>063100277</RdrRT>
<RdrRTLen>9</RdrRTLen>
<RdrAmount></RdrAmount>
<RdrAmountLen>0</RdrAmountLen>
<RdrAux></RdrAux>
<RdrAuxLen>0</RdrAuxLen>
<RdrAccountNbr>3433429242</RdrAccountNbr>
<RdrAccountNbrLen>10</RdrAccountNbrLen>
<RdrTranCode>0117</RdrTranCode>
<RdrTranCodeLen>4</RdrTranCodeLen>
<RdrFld4></RdrFld4>
<RdrFld4Len>0</RdrFld4Len>
<Amount>0000004000</Amount>
<AmountLen>10</AmountLen>
<AMAmend>3</AMAmend>
<TC>000171</TC>
<TranCode>000171</TranCode>
<TranCodeLen>3</TranCodeLen>
<TCAmend>3</TCAmend>
<AccountNbr>000000000100000025</AccountNbr>
<AccountNbrLen>10</AccountNbrLen>
<ANAmend>3</ANAmend>
<RT>063100277</RT>
<RTLen>9</RTLen>
<RTAmend>1</RTAmend>
<RIC>0</RIC>
<RICLen>0</RICLen>
<Aux>000000000000000</Aux>
<AuxLen>0</AuxLen>
<AUXAmend>1</AUXAmend>
<wAux>00000000</wAux>
<wAuxExtract></wAuxExtract>
<wAuxLen>0</wAuxLen>
<ScannedCardNbr></ScannedCardNbr>
<ActualCardNbr></ActualCardNbr>
<ReversalFlag>0</ReversalFlag>
<OriginalISN></OriginalISN>
<ISN>000001001357</ISN>
<Disposition>1</Disposition>
<Gender>0</Gender>
<HouseIndicator>0</HouseIndicator>
<Deleted>0</Deleted>
<Moved>0</Moved>
<ReadOnlyItem>0</ReadOnlyItem>
<DoNotDelete>0</DoNotDelete>
<AdjCode>00</AdjCode>
<ClaimedAmount>0000000000</ClaimedAmount>
<TimeRead>142155</TimeRead>
<TimePosted>142347</TimePosted>
<CurrencyCode>USD</CurrencyCode>
<Pocket>0</Pocket>
<Image_Device>LKM-LT-MANICK7</Image_Device>
<Image_Location>\\\\LKM-LT-MANICK7\\Alogent821\\XMLData\\20120710\\</Image_Location>
<Image_Share>Alogent821</Image_Share>
<Image_Name>000001_LKM-LT-MANICK7~F_0039_0001</Image_Name>
<Image_DIN>2</Image_DIN>
<MissCnt>0</MissCnt>
<AdjType>0</AdjType>
<ItemRelSeqNbr>2</ItemRelSeqNbr>
<LastCaptureBatch>0</LastCaptureBatch>
<PostDay>0</PostDay>
<UserName>1 - Phoenix-1</UserName>
<RemittingOutletName></RemittingOutletName>
<SessionStartTime>41563.7651865625</SessionStartTime>
<SessionEndTime></SessionEndTime>
<SessionIdleTime>0.000586967589065068</SessionIdleTime>
<SentToCAR>1</SentToCAR>
<PassedCAR>1</PassedCAR>
<CARAmount>0000004000</CARAmount>
<CARConfidence>963</CARConfidence>
<CARSetID>1</CARSetID>
<SentToICR>1</SentToICR>
<AutoCorrected>0</AutoCorrected>
<CustomFieldsRead>0</CustomFieldsRead>
<CustomFieldsDiscarded>1</CustomFieldsDiscarded>
<OperCorrected>1</OperCorrected>
<CaptureDevice>Panini MVX</CaptureDevice>
<FrontCounter>1</FrontCounter>
<ReaderType>MICR</ReaderType>
<CantReadCount>0</CantReadCount>
<ItemJammed>0</ItemJammed>
<ItemRejected>0</ItemRejected>
<ItemAccepted>0</ItemAccepted>
<ItemInserted>0</ItemInserted>
<LogicalEntry>0</LogicalEntry>
<TransactionType>ScanItems</TransactionType>
<SubstImage>0</SubstImage>
<ImageAnalysisStatus>0</ImageAnalysisStatus>
<IAResults>101001010000000000000000011000</IAResults>
<RescanStatus>0</RescanStatus>
<Stub>0</Stub>
<CorpID></CorpID>
<FormattedAmount>40.00</FormattedAmount>
<DuplicateOverridden>0</DuplicateOverridden>
<AllowDuplicateOverride>1</AllowDuplicateOverride>
<RearImagePresent>0</RearImagePresent>
<DepositID>000001001360</DepositID>
<Comment></Comment>
<ItemFinancialInstID></ItemFinancialInstID>
<DeferredTransaction>0</DeferredTransaction>
<ItemSourceLocationID></ItemSourceLocationID>
<ACHIndicator>0</ACHIndicator>
<ACHOptOutStatus>0</ACHOptOutStatus>
<ACHAccountNumber></ACHAccountNumber>
<ACHRoutingTransit></ACHRoutingTransit>
<ACHOptOutOverridden>0</ACHOptOutOverridden>
<IsACHEligible>0</IsACHEligible>
<BranchID>1</BranchID>
<BranchName>Lake Mary Main</BranchName>
<WorkstationName>LKM-LT-MANICK7</WorkstationName>
<BatchID>39</BatchID>
<BatchNumber>39</BatchNumber>
<DupDetectionStatus>0</DupDetectionStatus>
<ScannerAction>0</ScannerAction>
<PODOrderSequenceNbr>5000</PODOrderSequenceNbr>
<NonMICRItem>0</NonMICRItem>
<VirtuallyEndorsed>1</VirtuallyEndorsed>
<RescanCLMismatch>0</RescanCLMismatch>
<ItemInformation></ItemInformation>
<BatchWorkstation>LKM-LT-MANICK7</BatchWorkstation>
<OriginalPocket>0</OriginalPocket>
<ImageOrientation>0</ImageOrientation>
<InBranchFreePool>0</InBranchFreePool>
<DeleteReason>0</DeleteReason>
<CustomItemInfo>00000000000000000000000000000000000000000000004534</CustomItemInfo>
<BondSerialNumber></BondSerialNumber>
<BondType></BondType>
<BondValue>0000000000</BondValue>
<BondIssueDate></BondIssueDate>
<EDDMessage></EDDMessage>
<EDDStatus>0</EDDStatus>
<ItemType>Transit</ItemType>
<SelectorNumber>8000</SelectorNumber>
<BranchTellerID>998</BranchTellerID>
<ProdType>TRND</ProdType>
<ReceiptNumber></ReceiptNumber>
<TellerSequence></TellerSequence>
<BranchSelector>8000</BranchSelector>
<xPriority type=""customfield"">19</xPriority>
<xCustomerSession type=""customfield"">000039</xCustomerSession>
<xTransSqNmbr type=""customfield"">000001</xTransSqNmbr>
<xAFC_01 type=""customfield"">0</xAFC_01>
<xAFC_02 type=""customfield""></xAFC_02>
<xAFC_03 type=""customfield""></xAFC_03>
<xAFC_04 type=""customfield""></xAFC_04>
<xAFC_05 type=""customfield""></xAFC_05>
<xAFC_06 type=""customfield""></xAFC_06>
<xAFC_07 type=""customfield""></xAFC_07>
  </Item>
</Transaction>";
                        #endregion
                    }
                }



                #endregion
                //if (!_tlTranSet.TlCaptureOnValidateItems.LoadFromXML(transaction))
                //{
                //    WriteToDebugLog("Teller Capture: Failed to load the XML data  into TlCaptureOnValidateItems");
                //    return false;
                //}
                this.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "OnTransmitForPost", new object[] { transaction });
                if (_tlTranSet.IsTellerCaptureTranLoadFailed && _tlTranSet.TlCaptureScanItems.Count == 0)
                {
                    for (int i = 0; i < _tlTranSet.TlCaptureOnValidateItems.Count; i++)
                    {
                        _tlTranSet.TlCaptureScanItems.Add(_tlTranSet.TlCaptureOnValidateItems[i]);
                    }
                }
                //Phoenix.Windows.Client.Helper.ShowInfoInDialogMode("Dilaog Mode", Keys.Control | Keys.T );
            }
            #endif
            #endregion
            //End #140895-ReadOnly

            return base.ProcessCmdKey(ref msg, keyData);
        }
        #endregion ProcessCmdKey

        #region frmTlTranCode_PMdiPrintEvent
        private void frmTlTranCode_PMdiPrintEvent(object sender, EventArgs e)
        {
            if (picTabs.SelectedIndex == 3 && frmGloAccountListRim != null && frmGloAccountListRim.Visible)
            {
                frmGloAccountListRim.GenerateReport();
            }
            else if (_tlTranSet != null && _tlTranSet.CurTran != null) //#140798 #24607
            {
                if (picTabs.SelectedIndex == 0 && _tlTranSet.CurTran.SavingsBonds != null && _tlTranSet.CurTran.SavingsBonds.Count > 0 &&
                    (_tlTranSet.CurTran.TranCode.Value == 912 || _tlTranSet.CurTran.TranCode.Value == 921))
                {
                    GenerateReport();
                }
                else if (_tlTranSet.CurTran.SavingsBonds == null || (_tlTranSet.CurTran.SavingsBonds != null &&
                _tlTranSet.CurTran.SavingsBonds.Count <= 0) && sender != null && (sender as string[])[0] == "BondRedemption")
                {
                    //14367 - Make sure the savings bond transaction code and details are entered before trying to print the savings bond report.
                    PMessageBox.Show(this, 14367, MessageType.Warning, MessageBoxButtons.OK, String.Empty);
                    return;
                }
                else
                {
                    PMessageBox.Show(1430, MessageType.Warning, string.Empty);  //Task #60774
            }
        }
            else
            {
                PMessageBox.Show(1430, MessageType.Warning, string.Empty);      //Task #60774
            }
        }
        #endregion frmTlTranCode_PMdiPrintEvent

		private void tempDlg_Closed(object sender, EventArgs e)    //Selva-ChkPrintFix
        {

            //Begin #86464. After Closgin the child window if tab is teller Trnasaction then reset the Decimal Config
            if (GlobalVars.UserType == "Teller" || picTabs.SelectedIndex == (int)TAB.InputTran || picTabs.SelectedIndex == (int)TAB.ViewTran || picTabs.SelectedIndex == (int)TAB.QuickTran)    //#87731
            {
                #region config
                PdfCurrency.ApplicationAssumeDecimal = (_tlTranSet.TellerVars.AdTlControl.AssumeDecimals.Value == GlobalVars.Instance.ML.Y);
                CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                #endregion
            }
            else
            {
                #region config
                PdfCurrency.ApplicationAssumeDecimal = false;
                CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                #endregion
            }
            //end  #86464
            Form form = sender as Form;
			if (form.Name == "dlgCheckInfo")
            {
                if (!_tlTranSet.IsAcquirerTran)     // #79510
                {
                    _tlTranSet.LoadTlChkForm(printInfoForm);
                }
            }
            else if (form.Name == "dlgTlWaivePostOdCC")
            {
                if (dialogResultOdCc == DialogResult.Yes)
                    _tlTranSet.OdCcAction.Value = (short)TranOdCcAction.Post;
                else if (dialogResultOdCc == DialogResult.No)
                    _tlTranSet.OdCcAction.Value = (short)TranOdCcAction.Waive;
                else if (dialogResultOdCc == DialogResult.Cancel)
                {
                    ctwTranSet.ContextRow = failedTran;
                    SelectTran(-1);
                    GetControlByXmlTag(focusField, true);
                    return;
                }
                _tlJournalOvrd = new TlJournalOvrd();

                if (_tlTranSet.OdCcAction.Value == 1 || (_tlTranSet.OdCcAction.Value == 2 && !_tlJournalOvrd.RequireMiscOvrs(OverrideID.Charge, _tlTranSet.AdGbRsm)))
                {
                    _tlTranSet.DeleteOdCcOvrd();
                }
                if (!_tlTranSet.TranSetHasOverrides())
                {
                    WriteToDebugLog("Called PostTransactions from tempDlg_Closed event");
                    PostTransactions();
                }

            }
            //Begin 60668. Refredh the Selected account
            if (picTabs.SelectedIndex == (int)TAB.CustSummary && frmGloAccountListRim != null && frmGloAccountListRim.colAcctNo != null && frmGloAccountListRim.colAcctType != null)
            {
                frmGloAccountListRim.CallParent("HighLightAcct", frmGloAccountListRim.colAcctType.UnFormattedValue, frmGloAccountListRim.colAcctNo.UnFormattedValue);
                EnableDisableControls("AccountListSumClick");
            }
            //End 60668
            ResetFormForSupViewOnlyMode(string.Empty);  //#79314

        }

        private void tempWin_Closed(object sender, EventArgs e)
        {
            //#87731
            try
            {
                Form form = sender as Form;
                string callType = null;
                //Begin #75604. After Closgin the child window if tab is teller Trnasaction then reset the Decimal Config
                if (GlobalVars.UserType == "Teller" || picTabs.SelectedIndex == (int)TAB.InputTran || picTabs.SelectedIndex == (int)TAB.ViewTran || picTabs.SelectedIndex == (int)TAB.QuickTran)    //#87731
                {
                    #region config
                    PdfCurrency.ApplicationAssumeDecimal = (_tlTranSet.TellerVars.AdTlControl.AssumeDecimals.Value == GlobalVars.Instance.ML.Y);
                    CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                    #endregion
                }
                else
                {
                    #region config
                    PdfCurrency.ApplicationAssumeDecimal = false;
                    CurrencyHelper.AssumeDecimal = PdfCurrency.ApplicationAssumeDecimal; //#6588
                    #endregion
                }
                //end  #75604
                //Begin #140895-ReadOnly
                if (form == null) //Task #65456
                {
                    return;
                }
                if (_tlTranSet.IsTellerCaptureTran && form != null && (form.Name == "frmGbBondPurchaseList" || form.Name == "frmInventoryItemPurchaseReturnDetail" ||
                    form.Name == "frmDpRedempCalc"))
                    return;
                //End #140895-ReadOnly

                if (form.Name == "dlgTlSupervisorOverride")
                {
                    #region dlgTlSupervisorOverride

                    if (!cTRDeferred)
                    {
                        //Begin #79510
                        if (dialogResult == DialogResult.Cancel)
                        {
                            if (_tlTranSet.CheckTcdVaultSellOverride()) //#9867
                                ReverseDeviceDeposit(true);
                        }
                        if (_tlTranSet.IsAcquirerTran)
                        {
                            ProcessAcquirerTranSet("dlgTlSupervisorOverride");
                        }
                        //End #79510
                        else
                        {
                            WriteToDebugLog("Called PostTransactions from tempWin_Closed event");
                            PostTransactions();
                        }
                    }
                    else
                    {
                        if (dialogResult == DialogResult.Cancel)
                        {
                            cTRDeferred = false;
                            CallOtherForms("CTRTransactions");
                        }
                        ActionAfterPost();
                    }
                    //
                    //#9447
                    //if (_tlTranSet.CheckTcdVaultSellOverride())
                    //    ReverseDeviceDeposit(true);
                    #endregion
                }
                else if (form.Name == "dlgTlCashCount")
                {
                    #region dlgTlCashCount
                    ArrayList targetList;
                    ArrayList sourceList;

                    if (picTabs.SelectedTab == tabEasyCapture)
                        dialogResult = DialogResult.OK;         // #87731

                    if (dialogResult == DialogResult.OK && (cashDenomCallType == "CashInDenom" || cashDenomCallType == "CashOutDenom"))
                    {
                        if (cashDenomCallType == "CashInDenom")
                            callType = _tlTranSet.CurTran.CashIn.XmlTag;
                        else
                            callType = _tlTranSet.CurTran.CashOut.XmlTag;

                        //Begin #87731
                        if (picTabs.SelectedTab == tabEasyCapture)
                        {
                            if (_quickTranWindow.TranSet.CashInTran == null && cashDenomCallType == "CashInDenom")
                                _quickTranWindow.TranSet.CashInTran = _quickTranWindow.GetCurrentEasyCaptureTran(); //#92491

                            targetList = cashDenomCallType == "CashInDenom" ? _tlTranSet.CurTran.CashInDenoms : _tlTranSet.CurTran.CashOutDenoms;
                            sourceList = cashDenomCallType == "CashInDenom" ? _quickTranWindow.TranSet.CashIns : _quickTranWindow.TranSet.CashOuts;
                            var targetTran = cashDenomCallType == "CashInDenom" ? _quickTranWindow.TranSet.CashInTran : _quickTranWindow.TranSet.CashOutTran;

                            targetList.Clear();

                            foreach (var denom in sourceList)
                            {
                                targetList.Add(denom);
                            }

                            _tlTranSet.ModifyCashInOutAmt(callType);

                            if (cashDenomCallType == "CashInDenom" && _tlTranSet.CurTran.CashIn.Value > 0)
                                _quickTranWindow.TranSet.CashIn = _tlTranSet.CurTran.CashIn.Value;
                            else if (cashDenomCallType == "CashOutDenom" && _tlTranSet.CurTran.CashOut.Value > 0)
                                _quickTranWindow.TranSet.CashOut = _tlTranSet.CurTran.CashOut.Value;

                            //if (_tlTranSet.CurTran.CashInDenoms != null && _tlTranSet.CurTran.CashInDenoms.Count > 0)
                            //    _quickTranWindow.TranSet.CashInTranMappedIndex = _tlTranSet.CurTran.TranIndex.Value;

                            if (targetTran != null &&
                                targetTran.MappedTranIndex > 0)
                            {

                            }
                            else
                            {
                                sourceList.Clear();
                                _tlTranSet.CurTran.CashIn.Value = 0;
                                _tlTranSet.CurTran.CashOut.Value = 0;
                            }

                            if (lastActiveControl != null)
                                lastActiveControl.Focus();
                            return;
                        }
                        //End #87731


                        if (!_tlTranSet.IsAcquirerTran)     // #79510 - Added check
                        {
                            _tlTranSet.ModifyCashInOutAmt(callType);
                            MoveAmtObjectsToScreen();
                        }
                        //Begin #79510
                        else
                        {
                            acquirerCashInTranIndex++;
                        }
                        //End #79510
                    }
                    if (cashDenomCallType == "PostCashOutDenom")
                    {
                        WriteToDebugLog("Called PostTransactions from tempWin_Closed event for dlgTlCashCount form");
                        //set the variable once gain as it is critcal to the PostTransaction logic not being executed gaian.
                        postCashOutTriggered = true;    // #140895, #28965
                        PostTransactions();
                    }
                    else if (cashDenomCallType == "CashInDenom" && addNextCashInTriggered)
                        OnActionSave(saveActionType);
                    //Begin #140895
                    else if (cashDenomCallType == "CashInDenom" && _triggeredCashInOnPostTlCapture)
                        OnActionSave(saveActionType);
                    //End #140895
                    //Begin #79510
                    else if (cashDenomCallType == "CashInDenom" && _tlTranSet.IsAcquirerTran)
                    {
                        ProcessAcquirerTranSet("CashInDenom");
                    }
                    //End #79510
                    //				else if ( cashDenomCallType == "CashInDenom" && postCashInTriggered )
                    //					OnActionSave( false );
                    #endregion
                }
                else if (form.Name == "frmGlAccountSearch")
                {
                    #region frmGlAccountSearch
                    if (gLSearchAcctNo != null && gLSearchAcctNo != String.Empty)
                    {
                        if (focusAcctField == cmbTfrAcctType)
                        {
                            SetAcctFields(GlobalVars.Instance.ML.GL, gLSearchAcctNo, dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct, dfTfrCheckNo);
                        }
                        else
                        {
                            SetAcctFields(GlobalVars.Instance.ML.GL, gLSearchAcctNo, dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct, dfQuickTranCode);
                        }

                        //Begin #21733
                        if ((dfAcctNo.Value == null ? "" : dfAcctNo.Value.ToString().Trim()) != "")
                        {// check whether the GL account status is closed
                            if (cmbAcctType.Value != null && cmbAcctType.Value.ToString().Trim() == "GL")
                            {
                                if (_gbHelper.GetAcctStatus(cmbAcctType.Value.ToString(), dfAcctNo.Value.ToString()).Trim() == "Closed")
                                {
                                    //14279 : Invalid status. Transactions cannot be posted against a general ledger account with a status of "Closed"
                                    PMessageBox.Show(14279, MessageType.Warning, MessageBoxButtons.OK, String.Empty);
                                    dfAcctNo.Value = "";
                                    dfTitle1.Text = "";
                                    _tlTranSet.CurTran.TranAcct.AcctNo.Value = null;
                                    dfAcctNo.Focus();
                                }
                            }
                        }
                        //End #21733
                    }
                    else
                    {
                        if (focusAcctField == cmbTfrAcctType)
                            dfTfrAcctNo.Focus();
                        else
                            dfAcctNo.Focus();
                    }
                    #endregion
                }
                else if (form.Name == "frmGloAccountList")  // #17047
                {
                    #region frmGloAccountList

                    if (!string.IsNullOrEmpty(getAcctSearchAcctType) && !string.IsNullOrEmpty(getAcctSearchAcctNo))
                    {
                        if (focusAcctField == cmbTfrAcctType)
                        {
                            SetAcctFields(getAcctSearchAcctType, getAcctSearchAcctNo, dfTfrAcctNo, cmbTfrAcctType, _tlTranSet.CurTran.TfrAcct, dfTfrCheckNo);
                        }
                        //Begin 117726
                        else if (focusAcctField == cmbRefAcctType) 
                        {
                            SetAcctFields(getAcctSearchAcctType, getAcctSearchAcctNo, dfRefAcctNo, cmbRefAcctType, _tlTranSet.CurTran.RefAcct, dfRefAcctNo);
                        }
                        //End 117726
                        else
                        {
                            SetAcctFields(getAcctSearchAcctType, getAcctSearchAcctNo, dfAcctNo, cmbAcctType, _tlTranSet.CurTran.TranAcct, dfQuickTranCode,
                                        Convert.ToInt32(this.Workspace.Variables["RimNo"].ToString()));    //#180274

                            //Begin #38602
                            setTitleBarName(Convert.ToInt32(this.Workspace.Variables["RimNo"].ToString()), true);

                            if (_tlTranSet.TellerVars.IsAppOnline)
                                dfAcctNickname.UnFormattedValue = _tlTranSet.CurTran.TranAcct.AcctNickname.Value;

                            if (!_tlTranSet.TellerVars.AdTlCls.TlTranCode.IsNull && !_tlTranSet.CurTran.TlTranCode.IsNull)
                            {
                                if (!_tlTranSet.CurTran.TranAcct.DepLoan.IsNull && _tlTranSet.ValidateDefaultTc(_tlTranSet.CurTran.TranAcct.DepLoan.Value, _tlTranSet.TellerVars.AdTlCls.TlTranCode.Value))
                                {
                                    Control field = SetTabOrder("TranCodeSelect");
                                    if (field != null && !processingSelectTran)
                                        field.Focus();
                                }
                            }
                            //End #38602
                        }
                    }
                    //else
                    //{
                    //    if (focusAcctField == cmbTfrAcctType)
                    //        dfTfrAcctNo.Focus();
                    //    else
                    //        dfAcctNo.Focus();
                    //}
                    #endregion
                }
                else if (form.Name == "frmDpLnSigners") //71490
                {
                    #region frmDpLnSigners
                    //WI#18923
                    if (lastActiveControl != null)
                    {
                        if (lastActiveControl.Name == dfAcctNo.Name)
                        {
                            dfQuickTranCode.Focus();

                        }
                        else if (lastActiveControl.Name == dfTfrAcctNo.Name) //#75648
                        {
                            dfTfrCheckNo.Focus();
                        }
                        else//#75208
                        {
                            dfQuickTranCode.Focus(); //#75208
                        }
                    }//end WI#18923

                    #endregion
                }
                else if (form.Name == "frmDpLnTCHistory") //#71235
                {
                    _refreshPassbook = 1;
                }
                else if (form.Name == "frmGbBondPurchaseList")
                {
                    this.dfAmt.UnFormattedValue = this._tlTranSet.CurTran.GetBondsTotalAmt();
                }
                else if (form.Name == "frmLnPmtRecalcHist")    //#76425
                {
                    _isFormRecalcPmtHistoryClosed = true;
                    HandlePrinting();
                }
                else if (form.Name == "frmInstitutionCheckSearch") // #9544
                {
                    frmTBarSearch.HighLightTheSearchField();
                }
                else if (form.Name == "frmInventoryItemPurchaseReturnDetail")   //#140772
                {
                    #region frmInventoryItemPurchaseReturnDetail

                    dfCheckNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.DisableShowText);
                    this.dfCheckNo.ObjectToScreen();
                    if (dfInvSerialNo.Visible)
                        dfInvSerialNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.DisableShowText);
                    GetInventoryItemsByCount(true); //#140772-#19537
                    if (lastActiveControl != null)
                    {
                        lastActiveControl.Focus();
                    }

                    #endregion
                }
                else if (form.Name == "frmInventoryVerificationRequired")   //#140772
                {
                    PostTransactions();
                }
                else if (form.Name == "frmDpRedempCalc")   //#140782-3, #20962
                {
                    #region frmDpRedempCalc

                    if (_fromDpRedempCalc && !_tlTranSet.CurTran.XmlDpRedempCalc.IsNull)
                    {
                        _dpRedempCalc = new DpRedempCalc();
                        BusObjSerializer.LoadFromXml(_dpRedempCalc, _tlTranSet.CurTran.XmlDpRedempCalc.Value);

                        decimal penaltyAmt = _dpRedempCalc.PenaltyTranAmt.Value;
                        decimal tranNetAmt = _dpRedempCalc.InclTaxTranAmt.Value;
                        decimal withholdingAmt = _dpRedempCalc.WithholdingAmt.Value;
                        decimal fedWh = _dpRedempCalc.FedWhTranAmt.Value;
                        decimal stateWh = _dpRedempCalc.StateWhTranAmt.Value;
                        decimal otherWh = _dpRedempCalc.OtherWhTranAmt.Value;
                        string acctType = _dpRedempCalc.AcctType.Value;
                        string acctNo = _dpRedempCalc.AcctNo.Value;
                        Int16 umbCode = _dpRedempCalc.UmbCode.Value;
                        Int16 tranCode = _dpRedempCalc.TranCode.Value;
                        int calcPtid = (_dpRedempCalc.Ptid.Value > 0) ? Convert.ToInt32(_dpRedempCalc.Ptid.Value) : int.MinValue;

                        _tlTranSet.CurTran.CalcPtid.Value = calcPtid;   // Calc record was saved to DB (Save Quote)

                        if (acctType != "" && acctType != cmbAcctType.Text)
                        {
                            cmbAcctType.SetValue(acctType);
                            _tlTranSet.CurTran.AcctType.Value = acctType;
                            picTabs.SelectedIndex = 0;
                        }
                        if (acctNo != "" && acctNo != dfAcctNo.Text)
                        {
                            dfAcctNo.SetValue(Convert.ToString(acctNo));
                            dfAcctNo_PhoenixUIValidateEvent(null, null);
                            _tlTranSet.CurTran.AcctNo.Value = acctNo;
                        }
                        //#37585
                        //if (tranCode != Int16.MinValue && tranCode.ToString() != dfQuickTranCode.Text)
                        if ((_dpRedempCalc.TlTranCode.IsNull && tranCode != Int16.MinValue && tranCode.ToString() != dfQuickTranCode.Text) ||
                            (!_dpRedempCalc.TlTranCode.IsNull && _dpRedempCalc.TlTranCode.Value != dfQuickTranCode.Text))
                        {
                            string xmlCopy = _tlTranSet.CurTran.XmlDpRedempCalc.Value;  // Need to copy because changing TranCode clears everything in CurTran.

                            //dfQuickTranCode.Text = tranCode.ToString();    //#37585
                            if (!_dpRedempCalc.TlTranCode.IsNull)       //#37585
                                dfQuickTranCode.Text = _dpRedempCalc.TlTranCode.Value;
                            else
                                dfQuickTranCode.Text = tranCode.ToString();

                            dfQuickTranCode_KeyUp(null, null);

                            _tlTranSet.CurTran.TranCode.Value = tranCode;
                            _tlTranSet.CurTran.XmlDpRedempCalc.Value = xmlCopy;

                        }
                        if (penaltyAmt != decimal.MinValue && penaltyAmt != _tlTranSet.CurTran.PenaltyAmt.Value)
                        {
                            dfPenaltyAmt.SetValue(penaltyAmt);

                            _tlTranSet.CurTran.PenaltyAmt.Value = penaltyAmt;
                            // Store default penalty to avoid override message. Penalty is null if Tran details entered in Calc window.
                            _tlTranSet.CurTran.TranAcct.PenaltyAmt.Value = _dpRedempCalc.DefPenaltyAmt.Value; //22350

                            _calcPen = penaltyAmt;
                        }
                        if (withholdingAmt != decimal.MinValue)
                        {
                            dfWithholdingAmt.SetValue(withholdingAmt);
                            lblCalcWh.Visible = true;
                            dfWithholdingAmt.Visible = true;
                            dfWithholdingAmt.SetObjectStatus(NullabilityState.Default, VisibilityState.Show, EnableState.Disable);
                        }
                        if (fedWh != decimal.MinValue)
                        {
                            _tlTranSet.CurTran.FedWhAmt.Value = fedWh;
                        }
                        if (stateWh != decimal.MinValue)
                        {
                            _tlTranSet.CurTran.StateWhAmt.Value = stateWh;
                        }
                        if (otherWh != decimal.MinValue)
                        {
                            _tlTranSet.CurTran.OtherWhAmt.Value = otherWh;
                        }
                        if (umbCode != Int16.MinValue && umbCode != _tlTranSet.CurTran.UmbCode.Value)
                        {
                            cmbUmbCode.CodeValue = umbCode;
                            dfUMBCode.UnFormattedValue = cmbUmbCode.Text;
                            _tlTranSet.CurTran.TranAcct.UmbCode.Value = _dpRedempCalc.UmbCode.Value; /*#38374*/
            }

                        // Set the Amount last so that the triggered calculation includes the new Penalty, WH etc.
            if (tranNetAmt != decimal.MinValue && tranNetAmt != _tlTranSet.CurTran.NetAmt.Value)
                        {
                            // Do not use SetValue or trigger anything that pushes value in to BO...otherwise Validate wont work.
                            dfAmt.Text = tranNetAmt.ToString();
                            //21049 CalcDefaultField(dfAmt);

                            _calcAmt = tranNetAmt;
                        }

                        CalcDefaultField(dfAmt, true);       // true = hack to force recalc //21049
                    }

                    _fromDpRedempCalc = false;

                    #endregion frmDpRedempCalc
                }
                //Begin WI#19027
                else if (form.Name == "frmTlCapturedItems")
                {
                    //Begin #87743
                    if (picTabs.SelectedTab == tabEasyCapture)
                    {
                        _quickTranWindow.TranSet.Checks.Clear();
                        decimal totalCheckAmt = 0;
                        foreach (TlItemCapture item in _tlTranSet.CurTran.Items)
                        {
                            totalCheckAmt += item.Amount.Value;
                            _quickTranWindow.TranSet.Checks.Add(item);
                        }

                        _quickTranWindow.TranSet.ChecksIn = totalCheckAmt;
                        _quickTranWindow.TranSet.NoItems = (_tlTranSet.CurTran.Items == null ? Convert.ToInt32(0) : _tlTranSet.CurTran.Items.Count);
                        _quickTranWindow.TranSet.ChecksMakeAvail = Convert.ToDecimal(Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet_MakeAvail"]);

                        if (_quickTranWindow.TranSet != null && _quickTranWindow.TranSet.ChecksTran != null &&
                            _quickTranWindow.TranSet.ChecksTran.MappedTranIndex > 0)
                        {

                        }
                        else
                        {
                            _tlTranSet.CurTran.Items.Clear();
                        }

                        return;
                    }
                    //End #87743
                    //reprocess Capture Items after the frmTlCapturedItems is closed
                    processCaptureItems();
                }
                //End WI#19027
                //Begin #134375
                else if (form.Name == "frmGbStopHoldEdit")
                {
                    SetCurrentExceptionHoldBalInfo(_tempExceptionHoldInfo);
                }
                //End #134375
                //Begin 60647.
                else if (picTabs.SelectedIndex == (int)TAB.CustSummary && form.Name == "frmSdAcct" && frmGloAccountListRim != null)
                {
                    frmGloAccountListRim.CallParent(Phoenix.Shared.Constants.ScreenId.SdBoxNewEdit, frmGloAccountListRim.colAcctNo.UnFormattedValue, frmGloAccountListRim.colAcctType.UnFormattedValue);
                    EnableDisableControls("AccountListSumClick");
                }
                if (picTabs.SelectedIndex == (int)TAB.CustSummary && frmGloAccountListRim != null && form.Name != "frmSdAcct" && frmGloAccountListRim.colAcctNo != null && frmGloAccountListRim.colAcctType != null)
                {
                    //Begin #82866
                    if (isCreateDisplayWindow == true)
                    {
                        isCreateDisplayWindow = false;
                    }
                    //End #82866
                    //#83279 PCI Enabled the colDecrypt else colAcctNO
                    if (GlobalVars.EncryptPanEnabled == "N")
                    {
                        frmGloAccountListRim.CallParent("HighLightAcct", frmGloAccountListRim.colAcctType.UnFormattedValue, frmGloAccountListRim.colAcctNo.UnFormattedValue);
                    }
                    else
                    {
                        frmGloAccountListRim.CallParent("HighLightAcct", frmGloAccountListRim.colAcctType.UnFormattedValue, frmGloAccountListRim.colDecryptedAcctNo.UnFormattedValue);
                    }
                    EnableDisableControls("AccountListSumClick");
                }
                //End 60647.
                ResetFormForSupViewOnlyMode(string.Empty);  //#79314
            }
            finally     // #87731
            {
                if (picTabs.SelectedTab == tabEasyCapture && _quickTranWindow != null)
                    _quickTranWindow.ChildWindowClosedNotify(sender as Form);
            }
        }

        private void pbMakeBreakStrap_Click(object sender, PActionEventArgs e)
        {
            if (_tlTranSet.TellerVars.ClosedOut) //#71893
            {
                PMessageBox.Show(311337, MessageType.Warning, MessageBoxButtons.OK, String.Empty);
                return;
            }
            CallOtherForms("MakeBreakStraps");
        }

        #region #140782
        void pbCDRedemp_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("CDRedemp");
        }
        #endregion

        //Begin #79225
        public void pbIrsRpt_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("IrsReporting");
        }
        //End #79225


        //Begin #72916
        private void InitializeCashDispense()
        {
            if (cashDisp == null)
                cashDisp = CashDispenser.Instance;
        }

        private bool TcdDrawerIconClick(PictureBox picTempTCD, PictureBox picTempDrawer)
        {
            //#72916 - Phase II
            if (picTempDrawer.Visible)
            {
                if (_tlTranSet.TellerVars.AllowTcdTcrNonMonetaryOnly)   //#79574
                {
                    PMessageBox.Show(this, 13196, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                    return false;
                }

                if (_tlTranSet.CurTran.TlTranCode.Value != "VLT" &&
                    _tlTranSet.CurTran.TlTranCode.Value != "VLS" &&
                    _tlTranSet.TellerVars.IsVaultDrawer)    //#79574
                {
                    PMessageBox.Show(this, 11653, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                    return false;
                }

                if (_tlTranSet.CurTran.TlTranCode.Value != "VLT" &&
                    _tlTranSet.CurTran.TlTranCode.Value != "VLS" &&
                    !_tlTranSet.CurTran.TranCode.IsNull && (_tlTranSet.CurTran.TranCode.Value == 505 ||
                    _tlTranSet.CurTran.TranCode.Value == 555)) //ML #79574 - added VLS
                {
                    PMessageBox.Show(this, 361083, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                    return false;
                }

                if (_tlTranSet.CurTran.TlTranCode.Value != "VLT" &&
                    _tlTranSet.CurTran.TlTranCode.Value != "VLS" &&
                    _tlTranSet.TellerVars.TcdStationId.Trim() == "C")   //#79574
                {
                    PMessageBox.Show(this, 13184, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                    return false;
                }
            }
            //
            if (picTempTCD.Visible)
            {
                if (picTabs.SelectedTab == tabEasyCapture)  //#89998
                {

                    var sourceTran = _quickTranWindow.TranSet.CashInTran;

                    if (sourceTran != null && sourceTran.MappedTranIndex > 0)
                    {
                        _tlTranSet.SelectTransaction(sourceTran.MappedTranIndex, false);
                    }
                    else
                    {
                        if (_tlTranSet.CurTran == null)
                            _tlTranSet.CurTran = new TlTransaction();
                    }

                    if (_tlTranSet.CurTran.CashInDenoms == null || _tlTranSet.CurTran.CashInDenoms.Count == 0)
                    {
                        ArrayList targetList = _tlTranSet.CurTran.CashInDenoms;
                        ArrayList sourceList = _quickTranWindow.TranSet.CashIns;

                        targetList.Clear();

                        foreach (var denom in sourceList)
                        {
                            targetList.Add(denom);
                        }
                    }
                }

                if (!_tlTranSet.CurTran.TlTranCode.IsNull && _tlTranSet.CurTran.TlTranCode.Value == "VLT") //ML
                {
                    PMessageBox.Show(this, 361082, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                    return false;
                }

                if (!_tlTranSet.CurTran.TlTranCode.IsNull && _tlTranSet.CurTran.TlTranCode.Value == "VLS") //#79574
                {
                    PMessageBox.Show(this, 11654, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                    return false;
                }

                if (_tlTranSet.TellerVars.IsRecycler && (_tlTranSet.IsTcrCashDeposited(_tlTranSet.CurTran) || _tlTranSet.IsTcrCashDeposited()))  //#79574
                {
                    PMessageBox.Show(this, 11652, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                    return false;
                }
            }
            //
            if (_tlTranSet.Transactions.Count > 0 && !_isTcdToggleWarningShown) //transaction set
            {
                if (DialogResult.No == PMessageBox.Show(this, 361056, MessageType.Question, MessageBoxButtons.YesNo, string.Empty))
                {
                    _isTcdToggleWarningShown = true;
                    return false;
                }
            }
            //
            if (picTempDrawer.Visible)
            {
                bool isTCDConnAvailable = true;
                if (_tlTranSet.TellerVars.IsTCDEnabled)
                {
                    //#79574 - Removed 24/7 limitation
                    //if (Phoenix.FrameWork.CDS.DataService.Instance.XmDbStatus != XmDbStatus.Day)
                    //{
                    //    PMessageBox.Show(this, 361069, MessageType.Message, MessageBoxButtons.OK, string.Empty);
                    //    return false;
                    //}
                    using (new WaitCursor())
                    {
                        try
                        {
                            dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(361049));
                            InitializeCashDispense();
                            //
                            if (cashDisp.GetStatus(_tlTranSet.TellerVars.DrawerNo.ToString()))
                            {
                                _tlTranSet.TellerVars.IsTCDConnected = true;
                                picTempTCD.Visible = _tlTranSet.TellerVars.IsTCDConnected;
                                picTempDrawer.Visible = (!picTempTCD.Visible);
                                //#74665 - always enable if TCD connection allows, do not depend on picTCD
                                //pbChkTCDStatus.Visible = picTempTCD.Visible;
                                #region get machine id
                                string tempValue = "";
                                cashDisp.GetIniFileSettings("General", "Machine ID", string.Empty, ref tempValue, string.Empty);
                                if (tempValue != string.Empty)
                                    _tlTranSet.TellerVars.TcdMachineId = Convert.ToInt32(tempValue);
                                #endregion
                                //
                                #region get station id
                                tempValue = "";
                                cashDisp.GetIniFileSettings("General", "Station ID", string.Empty, ref tempValue, string.Empty);
                                _tlTranSet.TellerVars.TcdStationId = tempValue;
                                #endregion
                            }
                            else
                                isTCDConnAvailable = false;
                        }
                        finally
                        {
                            //cashDisp.Close();
                            dlgInformation.Instance.HideInfo();
                        }
                    }
                }
                else
                {
                    picTempTCD.Visible = false;
                    _tlTranSet.TellerVars.IsTCDConnected = false;
                    return false;
                }
                //
                if (!isTCDConnAvailable)
                {
                    dlgInformation.Instance.HideInfo();
                    //Attempt to connect to the TCD failed due to the reason given below:%1!.%2!
                    PMessageBox.Show(this, 317441, MessageType.Warning, MessageBoxButtons.OK,
                        new string[] { cashDisp.ReturnCode.ToString(), cashDisp.GetErrorString(cashDisp.ReturnCode) });
                    _tlTranSet.TellerVars.IsTCDConnected = false;
                    picTempTCD.Visible = false;
                    picTempDrawer.Visible = (_tlTranSet.TellerVars.IsTCDEnabled);
                    //#74665 - always enable if TCD connection allows, do not depend on picTCD
                    //pbChkTCDStatus.Visible = (picTempTCD.Visible);
                    cbDenominate.Visible = (picTempTCD.Visible);
                    return false;
                }
            }
            else if (picTempTCD.Visible)
            {
                picTempDrawer.Visible = (_tlTranSet.TellerVars.IsTCDEnabled);
                _tlTranSet.TellerVars.IsTCDConnected = false;
                picTempTCD.Visible = _tlTranSet.TellerVars.IsTCDConnected;
            }
            //
            //#74665 - always enable if TCD connection allows, do not depend on picTCD
            //pbChkTCDStatus.Visible = (picTempTCD.Visible);
            cbDenominate.Visible = (picTempTCD.Visible && _tlTranSet.CurTran.TlTranCode.Value != "VLS");
            SetWaiveSignatureLocation(); //#76033
            return true;
        }

        protected override void OnHelpRequested(HelpEventArgs hevent)
        {
            if (_isOkToBlockF1Key)
                hevent.Handled = true;
            else
                base.OnHelpRequested(hevent);
        }

        private void frmTlTranCode_Load(object sender, EventArgs e)
        {

        }
        //End #72916

        //Begin #76048
        private void setTitles()
        {
            string depLoan = _tlTranSet.CurTran.TranAcct.DepLoan.Value;

            if (depLoan == GlobalVars.Instance.ML.DP || depLoan == GlobalVars.Instance.ML.LN ||
                depLoan == GlobalVars.Instance.ML.SD || depLoan == GlobalVars.Instance.ML.CM ||
                depLoan == GlobalVars.Instance.ML.GL || depLoan == GlobalVars.Instance.ML.RM ||
                depLoan == GlobalVars.Instance.ML.EX || depLoan == GlobalVars.Instance.ML.Ext) //#76458 - added EX //#2677
            {
                if (depLoan == GlobalVars.Instance.ML.GL)   //#3757
                {
                    this.lblPbTitle1.Text = lblTitle1.Text = _mlTitle1Label;
                    this.lblPbTitle2.Text = lblTitle2.Text = _mlTitle2Label;
                }
                else
                {
                    if (lblTitle1.Text == lblTitle1.MLInfo.Label)   //#3757
                        setLabels();
                }
                this.UpdateView();
                //
                if (_tlTranSet.TellerVars.AdTlCls.ShowTitles.Value == GlobalVars.Instance.ML.Y &&
                    depLoan == GlobalVars.Instance.ML.GL) //#3757 - put back the deleted code
                {
                    this.dfTitle1.UnFormattedValue = _tlTranSet.CurTran.TranAcct.Title1.Value;
                    this.dfTitle2.UnFormattedValue = String.Empty;
                }
                else
                {
                    if (_adGbBankControl.InstitutionType.Value.ToUpper() == "CU" || _tlTranSet.TellerVars.AdTlCls.MapRimCust.Value == GlobalVars.Instance.ML.Y)
                    {
                        //this.dfTitle1.UnFormattedValue = _tlTranSet.CurTran.TranAcct.GetNameRim(true);    
                        this.dfTitle1.UnFormattedValue = _tlTranSet.CurTran.TranAcct.GetNameRimPrimary(true);  //#34401
                        this.dfTitle2.UnFormattedValue = _tlTranSet.CurTran.TranAcct.GetNameRimJoint(true);
                    }
                    else
                    {
                        //this.dfTitle1.UnFormattedValue = _tlTranSet.CurTran.TranAcct.Title1.Value;
                        //this.dfTitle2.UnFormattedValue = _tlTranSet.CurTran.TranAcct.Title2.Value;
                        //this.dfTitle1.UnFormattedValue = _tlTranSet.CurTran.TranAcct.GetNameTitle();
                        this.dfTitle1.UnFormattedValue = _tlTranSet.CurTran.TranAcct.GetNameTitlePrimary(); //#34401
                        this.dfTitle2.UnFormattedValue = _tlTranSet.CurTran.TranAcct.GetNameTitleJoint();
                    }
                }
            }
            else
            {
                this.dfTitle1.SetDefaultValue();
                this.dfTitle2.SetDefaultValue();
            }
        }
        private void setPassbookTitles()
        {
            string depLoan = passbookAcctDetails.DepLoan.Value;

            if (depLoan == GlobalVars.Instance.ML.DP || depLoan == GlobalVars.Instance.ML.LN ||
                depLoan == GlobalVars.Instance.ML.SD || depLoan == GlobalVars.Instance.ML.CM ||
                depLoan == GlobalVars.Instance.ML.GL || depLoan == GlobalVars.Instance.ML.RM)
            {
                if (_adGbBankControl.InstitutionType.Value.ToUpper() == "CU" || _tlTranSet.TellerVars.AdTlCls.MapRimCust.Value == GlobalVars.Instance.ML.Y)
                {
                    this.dfPbTitle1.UnFormattedValue = passbookAcctDetails.GetNameRim(true);
                    this.dfPbTitle2.UnFormattedValue = passbookAcctDetails.GetNameRimJoint(true);
                }
                else
                {
                    this.dfPbTitle1.UnFormattedValue = passbookAcctDetails.GetNameTitle();
                    this.dfPbTitle2.UnFormattedValue = passbookAcctDetails.GetNameTitleJoint();
                }
            }
            else
            {
                this.dfPbTitle1.SetDefaultValue();
                this.dfPbTitle2.SetDefaultValue();
            }
        }
        private void setOnUsTitles()
        {
            string depLoan = _tlTranSet.CurTran.TfrAcct.DepLoan.Value;

            if (depLoan == GlobalVars.Instance.ML.DP || depLoan == GlobalVars.Instance.ML.LN ||
                depLoan == GlobalVars.Instance.ML.SD || depLoan == GlobalVars.Instance.ML.CM ||
                depLoan == GlobalVars.Instance.ML.GL || depLoan == GlobalVars.Instance.ML.EX ||
                depLoan == GlobalVars.Instance.ML.Ext) //#76458 - added EX //#2677
            {
                if (_adGbBankControl.InstitutionType.Value.ToUpper() == "CU" || _tlTranSet.TellerVars.AdTlCls.MapRimCust.Value == GlobalVars.Instance.ML.Y)
                {
                    this.dfOnUsTitle1.UnFormattedValue = _tlTranSet.CurTran.TfrAcct.GetNameRim(true);
                    this.dfOnUsTitle2.UnFormattedValue = _tlTranSet.CurTran.TfrAcct.GetNameRimJoint(true);
                }
                else
                {
                    this.dfOnUsTitle1.UnFormattedValue = _tlTranSet.CurTran.TfrAcct.GetNameTitle();
                    this.dfOnUsTitle2.UnFormattedValue = _tlTranSet.CurTran.TfrAcct.GetNameTitleJoint();
                }
            }
            else
            {
                this.dfOnUsTitle1.SetDefaultValue();
                this.dfOnUsTitle2.SetDefaultValue();
            }
        }

        public void setTitleBarName(int rimNo, bool pushRimIntoTran)
        {   // 8497 - added parameter, added Get Customer Info

            //8497 string rimName = string.Empty;
            //8497 rimName = _tlTranSet.CurTran.TranAcct.GetNameRim(false);

            #region Get Customer Information
            TlAcctDetails tlAcctDetails = new TlAcctDetails();
            if (_tlTranSet.CurTran.TranAcct.RimNo.Value != rimNo)   // #19415 - added if test/ else part
            {
                tlAcctDetails.AcctNo.Value = rimNo.ToString();
                tlAcctDetails.RimNo.Value = rimNo;
                tlAcctDetails.ApplType.Value = GlobalVars.Instance.ML.RIM;
                tlAcctDetails.DepLoan.Value = GlobalVars.Instance.ML.RM;
                tlAcctDetails.AcctType.Value = GlobalVars.Instance.ML.RIM;
                try
                {
                    using (new WaitCursor())
                    {
                        tlAcctDetails.GetAcctDetails();
                    }
                }
                catch (PhoenixException pe)
                {
                    PMessageBox.Show(pe, MessageBoxButtons.OK);
                }
            }
            else
            {
                tlAcctDetails = _tlTranSet.CurTran.TranAcct;
            }

            #endregion

            #region  Format name and set title bar

            if (rimNo <= 0)    //#124152
            {
                this.Workspace.Variables["RimNo"] = 0;
                this.Workspace.Variables["_customerDisplayName"] = string.Empty;
                if (this.Workspace != null)
                {
                    PfwStandard formWin = this as PfwStandard;
                    PwksWindowDx wkspaceWin1 = this.Workspace as PwksWindowDx;
                    wkspaceWin1.CurrentCustomerName = string.Empty;
                    if (formWin != null)
                    {
                        formWin.RefreshTrackServerHitsByFormCount();
                    }
                }
            }

            string rimName = tlAcctDetails.GetNameRim(false);
            if (!string.IsNullOrEmpty(rimName)) //#124152
            {
                rimName = rimName.Replace("  -", " -");
                string custNo = Convert.ToString(rimNo);
                string custName = rimName.Replace(" - " + custNo, string.Empty);

                if (this.Workspace != null)
                {
                    PfwStandard formWin = this as PfwStandard;
                    this.Workspace.Variables["_customerDisplayName"] = custName;
                    if (!string.IsNullOrEmpty(custNo) && Convert.ToInt32(custNo) > 0)
                    {
                        if (string.IsNullOrEmpty(custName) == false && string.IsNullOrEmpty(custNo) == false)
                        {
                            PwksWindowDx wkspaceWin1 = this.Workspace as PwksWindowDx;
                            wkspaceWin1.CurrentCustomerName = ($"{custName} - {custNo}");
                        }
                        if (formWin != null)
                        {
                            formWin.RefreshTrackServerHitsByFormCount();
                        }
                    }
                }
            }
            setTitleBar(rimName); //Task#87765
            #region Commented out code
            //if (rimName != string.Empty && rimName != this.TitleText)
            //{
            //    if (picTabs.SelectedIndex == 3) // rel summary tab
            //        this.TitleText = ("Relationship Management Summary " + rimName);
            //    else
            //        this.TitleText = (this.EditRecordTitle + " " + rimName);

            //    this.UpdateView();  // Force refresh
            //}
            //else
            //{
            //    if (picTabs.SelectedIndex == 3) // rel summary tab
            //        this.TitleText = ("Relationship Management Summary ");
            //    else
            //        this.TitleText = (this.EditRecordTitle);

            //    this.UpdateView();  // Force refresh
            //}
            #endregion

            #endregion

            #region Push Customer Name into transaction

            if (pushRimIntoTran == true)
            {
                //Begin #13182/#13183 //16278 removing this check for the populategridwith saved rim flag and adding title1 to this mix
                /*if (!populateGridWithSavedRim)
                {
                    _tlTranSet.CurTran.TranAcct.RimNo.Value = rimNo;
                    _tlTranSet.CurTran.TranAcct.RimFirstName.Value = tlAcctDetails.RimFirstName.Value;
                    _tlTranSet.CurTran.TranAcct.RimLastName.Value = tlAcctDetails.RimLastName.Value;
                    _tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = tlAcctDetails.RimMiddleInitial.Value;
               }
               End */
                //#13182/#13183

                _tlTranSet.CurTran.TranAcct.RimNo.Value = rimNo;
                _tlTranSet.CurTran.TranAcct.RimFirstName.Value = tlAcctDetails.RimFirstName.Value;
                _tlTranSet.CurTran.TranAcct.RimLastName.Value = tlAcctDetails.RimLastName.Value;
                _tlTranSet.CurTran.TranAcct.RimMiddleInitial.Value = tlAcctDetails.RimMiddleInitial.Value;
                _tlTranSet.CurTran.TranAcct.RimType.Value = tlAcctDetails.RimType.Value; // WI#30733/30734
                // _tlTranSet.CurTran.TranAcct.Title1.Value = tlAcctDetails.Title1.Value;//16278
                _tlTranSet.CurTran.TranAcct.ReceiptDelMethod.Value = tlAcctDetails.ReceiptDelMethod.Value; //#41417
                _tlTranSet.CurTran.TranAcct.Email1.Value = tlAcctDetails.Email1.Value; //#41417
                _tlTranSet.CurTran.TranAcct.EmailList.Value = tlAcctDetails.EmailList.Value; //#41417
                _tlTranSet.CurTran.TranAcct.PrimaryEmail.Value = tlAcctDetails.PrimaryEmail.Value; //#41417
				/* Begin - 84704 */
                _tlTranSet.CurTran.TranAcct.PrimaryRimTitle.Value = tlAcctDetails.PrimaryRimTitle.Value;
                _tlTranSet.CurTran.TranAcct.PrimaryRimSuffix.Value = tlAcctDetails.PrimaryRimSuffix.Value;
                /* End - 84704 */
            }

            #endregion

        }

        //Begin Task#87765
        public void setTitleBar(string rimName)
        {
            if (rimName != string.Empty && rimName != this.TitleText)
            {
                if (picTabs.SelectedIndex == 3) // rel summary tab
                {
                    this.TitleText = ("Relationship Management Summary " + rimName);
                    //begin #102195. frmGloaccountListRim is already reset with new name though call parent. so we can assign the same text here also.
                    if (frmGloAccountListRim != null && GlobalVars.UserType !="Teller") /*We dont want any change in Teller Functionality*/
                    {
                        this.TitleText = frmGloAccountListRim.TitleTextShort;
                    }
                    //End #102195
                }
                else
                    this.TitleText = (this.EditRecordTitle + " " + rimName);

                this.UpdateView();  // Force refresh
            }
            else
            {
                if (picTabs.SelectedIndex == 3) // rel summary tab
                    this.TitleText = ("Relationship Management Summary ");
                else
                    this.TitleText = (this.EditRecordTitle);

                this.UpdateView();  // Force refresh
            }
        }
        //End Task#87765


        //
        private void setTitleBar()
        {
            this.TitleText = this.EditRecordTitle;
            this.UpdateView();  // Force refresh
        }
        private void setLabels()
        {
            //#3757 - copy the ML info value
            _mlTitle1Label = lblTitle1.MLInfo.Label;
            _mlTitle2Label = lblTitle2.MLInfo.Label;

            if (_adGbBankControl.InstitutionType.Value.ToUpper() == "CU")
            {
                this.lblPbTitle1.Text = this.lblTitle1.Text = "Member 1:";
                this.lblPbTitle2.Text = this.lblTitle2.Text = "Member 2:";
                this.lblOnUsTitle1.Text = "On Us Member 1:";
                this.lblOnUsTitle2.Text = "On Us Member 2:";
            }
            else if (_tlTranSet.TellerVars.AdTlCls.MapRimCust.Value == GlobalVars.Instance.ML.Y)
            {
                this.lblPbTitle1.Text = this.lblTitle1.Text = "Customer 1:";
                this.lblPbTitle2.Text = this.lblTitle2.Text = "Customer 2:";
                this.lblOnUsTitle1.Text = "On Us Customer 1:";
                this.lblOnUsTitle2.Text = "On Us Customer 2:";
            }
        }
        //End #76048

        // Begin #76041
        private bool isDisplayNicknameAllowed()
        {


            if (_tlTranSet.TellerVars.IsAppOnline && (_tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.DP
                                                        || _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.LN ||
                                                        _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.EX ||
                                                        _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.Ext))   //#2677
            {
                return true;
            }
            return false;
        }

        private void dfAcctNo_Enter(object sender, EventArgs e)
        {
            if (isDisplayNicknameAllowed())
            {
                if (!gotAccts)
                {
                    if (_tlTranSet.CurTran.TranAcct.RimNo.Value > 0)
                    {
                        _tlTranSet.CurTran.TranAcct.AcctType.Value = this.cmbAcctType.Text;
                        CallOtherForms("ShowAcctNicknamesList");
                        gotAccts = true;
                    }
                }
                else
                {
                    gotAccts = false;
                    SetFocusOnControl(dfQuickTranCode);
                }
            }
        }
        // End #76041

        //Begin #76047
        private void pbBondPurchase_Click(object sender, PActionEventArgs e)
        {
            this.CallOtherForms("GbBondPurchase");  //#3401
        }

        private bool CheckBondTranCode()
        {
            // Uses the current trancode to overload if no param is passed
            if (this._tlTranSet.CurTran.TranAcct.TranCode.Value > 0)
                return CheckBondTranCode(this._tlTranSet.CurTran.TranAcct.TranCode.Value);
            else
                return false;
        }

        private bool CheckBondTranCode(int TranCode)
        {
            // overloaded to recieve the trancode as an int
            return (TranCode == this.GetBondTranCode(EnumBondTranCodes.SeriesEE)
                        || TranCode == this.GetBondTranCode(EnumBondTranCodes.SeriesI));
        }

        private bool CheckBondTranCode(string TranCode)
        {
            // overloaded to recieve the trancode as a string
            return (this.CheckBondTranCode(Convert.ToInt32(TranCode)));
        }

        private int GetBondTranCode(EnumBondTranCodes BondType)
        {
            // This looks complicated but it just returns the underlying
            // value of the bond type enum, which is our corresponding trancode.
            return (Convert.ToInt32(Enum.Parse(typeof(EnumBondTranCodes), BondType.ToString())));
        }

        // End #76047
        //Begin 60647. Same as Customer RMS
        private void RepaintButton(PImageButton p1)
        {
            /* this pice of code is to make sure the button text reflects correctly on the window right away */
            p1.Invalidate();
            p1.Size = new System.Drawing.Size(p1.Size.Width - 1, p1.Size.Height);
            p1.Size = new System.Drawing.Size(p1.Size.Width + 1, p1.Size.Height);
        }

        //End 60647

        //Begin Bug #104269
        public void SaveButtonStateVibisiblity()
        {
            _previousActionPanelsButtonsValue = new Dictionary<PAction, bool>()
            {
                {pbRestrictions,pbRestrictions.Visible },
                {pbACHFut,pbACHFut.Visible },
                {pbIrsRpt,pbIrsRpt.Visible },
                {pbPendingCC,pbPendingCC.Visible },
                {pbVod,pbVod.Visible },
                {pbeReceipt,pbeReceipt.Visible },
                {pbNOCHistory,pbNOCHistory.Visible },
                {pbPrintMailer,pbPrintMailer.Visible },
                {pbGetGLAcct,pbGetGLAcct.Visible },
                {pbGetAcct,pbGetAcct.Visible },
                {pbFees,pbFees.Visible },
                {pbCashOut,pbCashOut.Visible },
            };
        }

        public void RestoreButtonStateVisibility()
        {
            if (_previousActionPanelsButtonsValue != null)
            {
                foreach(var pair in _previousActionPanelsButtonsValue)
                {
                    pair.Key.Visible = pair.Value;
                }
                _previousActionPanelsButtonsValue = null;
            }
        }
        //End Bug #104269

        //Begin #76425
        public void PopulateRecalcPmtDt()
        {
            string tmpDates = "";
            string[] pmtDate = null;
            DateTime defaultDt = DateTime.MinValue;
            defaultDt = _tlTranSet.GetRecalcPmtDate(ref tmpDates);
			//_tlTranSet.CurTran.RecalcPmtDefDt.Value = defaultDt.ToShortDateString();		//#79183
            EnumValueCollection evCollection = new EnumValueCollection();
            cmbRecalcPmtDt.PhoenixUIControl.BusObjectProperty = _tlTranSet.CurTran.RecalcPmtDt;
            //
            if (tmpDates != "")
            {
                pmtDate = tmpDates.Split(',');
                //
                foreach (string pmtDt in pmtDate)
                {
                    evCollection.Add(new EnumValue(Convert.ToDateTime(pmtDt).ToShortDateString(), Convert.ToDateTime(pmtDt).ToShortDateString()));
                    //_tlTranSet.CurTran.RecalcPmtDt.EnumValues.Add(new EnumValue(Convert.ToDateTime(pmtDt).ToShortDateString(), Convert.ToDateTime(pmtDt).ToShortDateString()));
                    //cmbRecalcPmtDt.PhoenixUIControl.BusObjectProperty.EnumValues.Add(new EnumValue(Convert.ToDateTime(pmtDt).ToShortDateString(), Convert.ToDateTime(pmtDt).ToShortDateString()));
                }
                //
                if (evCollection.EnumValues.Count > 0)
                {
                    cmbRecalcPmtDt.Populate(evCollection.EnumValues);
                    cmbRecalcPmtDt.CodeValue = defaultDt.ToShortDateString();
                    cmbRecalcPmtDt.DefaultCodeValue = defaultDt.ToShortDateString();
                    cmbRecalcPmtDt.InitialDisplayType = UIComboInitialDisplayType.DisplayDefault;
                    cmbRecalcPmtDt.SetDefaultValue();
                }
                //
                MoveMiscScreensToObject(miscTCFields);
            }
            //
            //test
            //if (_tlJournal == null)
            //    _tlJournal = new TlJournal();
            //_tlJournal.EffectiveDt.Value = (_tlTranSet.CurTran.TranEffectiveDt.IsNull ? _tlTranSet.TellerVars.PostingDt : _tlTranSet.CurTran.TranEffectiveDt.Value);
            //_tlJournal.AcctType.Value = _tlTranSet.CurTran.TranAcct.AcctType.Value;
            //_tlJournal.AcctNo.Value = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
            //_tlJournal.TranCode.Value = _tlTranSet.CurTran.TranAcct.TranCode.Value;
            //Phoenix.FrameWork.CDS.DataService.Instance.EnumValues(_tlJournal, _tlJournal.RecalcPmtDt);
            ////
            //cmbRecalcPmtDt.CodeValue = _tlJournal.DefaultDt.Value;
            //cmbRecalcPmtDt.DefaultCodeValue = _tlJournal.DefaultDt.Value;
            //cmbRecalcPmtDt.InitialDisplayType = UIComboInitialDisplayType.DisplayDefault;
            //cmbRecalcPmtDt.SetDefaultValue();
            //cmbRecalcPmtDt.Populate(_tlJournal.RecalcPmtDt.EnumValues);
            ////
            //MoveMiscScreensToObject(miscTCFields);
        }
		//End #76425

		#region #79370 - New Methods

        /// <summary>
        /// Populate the new OnUsTc combo if allowed
        /// </summary>
        /// <param name="depLoan"></param>
        /// <param name="acctType"></param>
        private void PopulateOnUsCombo(string depLoan, string acctType, string applType)		// #79370 #10272 - added new param #39025
        {
            PopulateOnUsCombo(depLoan, acctType, applType, string.Empty);
        }

		/// <summary>
		/// Populate the new OnUsTc combo if allowed
		/// </summary>
		/// <param name="depLoan"></param>
		/// <param name="acctType"></param>
        private void PopulateOnUsCombo(string depLoan, string acctType, string applType, string onusTC)     // #79370 #10272 - added new param #39027 - added trancode
		{
			string TranCodes = null;
			string[] Items = null;
			ArrayList Constraint = new ArrayList();
			TlItemCapture ItemCapture = new TlItemCapture();
			EnumValue EValue = null;

            if (IsOnUsTCEnabled) //8837(_EnableOnUsTc)
			{

                if (string.IsNullOrEmpty(cmbTfrAcctType.Text)) // 8806
                {
                    this.cmbOnUsTc.Items.Clear();
                }
                else
                {

                    TranCodes = ItemCapture.GetTCComboList(depLoan);

                    if (!string.IsNullOrEmpty(TranCodes))
                    {
                        Items = TranCodes.Split(new string[] { "^" }, StringSplitOptions.RemoveEmptyEntries);

                        foreach (string TranCode in Items)
                        {
                            EValue = new EnumValue(int.Parse(TranCode), TranCode);
                            Constraint.Add(EValue);
                        }

                        // Begin #80621
                        if (_bRegDOnUsAcct == true)
                        {
                            EValue = new EnumValue("189", "189");
                            Constraint.Add(EValue);
                        }
                        // End #80621

                        // Add the <none> option ...
                        EValue = new EnumValue("<none>", "<none>");
                        Constraint.Add(EValue);
                    }

                    if (Constraint.Count > 0)
                    {
                        this.cmbOnUsTc.Populate(Constraint);
                        //#10272 - pass in appl type instead to default the trancode
                        //SetDefaultOnUsComboTranCode(depLoan);
                        if (string.IsNullOrEmpty(onusTC))    //#39025
                            SetDefaultOnUsComboTranCode(depLoan, applType);
                        else
                            cmbOnUsTc.CodeValue = onusTC;
                    }
                }
			}
		}

		/// <summary>
		/// Set the default trancode for cmbOnUsTc
		/// </summary>
		/// <param name="depLoan"></param>
        private void SetDefaultOnUsComboTranCode(string depLoan, string applType)    //#10272 - added new param to pass in applType
		{
            switch (depLoan)    //#10272 - modified the trancode default logic based on deploan and appltype values
			{
                case "DP":
                    if (applType == "CD" || applType == "SV")
                    {
                        cmbOnUsTc.CodeValue = "152";
                    }
                    else if (applType == "CK")
                    {
                        /* Begin #36684 */
                        //if (dfTfrCheckNo.Text == null || dfTfrCheckNo.Text == "")
                        //{
                        //    cmbOnUsTc.CodeValue = "152";
                        //}
                        //else
                        //{
                        //    cmbOnUsTc.CodeValue = "154";
                        //}
                        if (_adGbBankControl.InstitutionType.Value.ToUpper() == "CU")
                        {
                            if (dfTfrCheckNo.Text == null || dfTfrCheckNo.Text == "")
                            {
                                cmbOnUsTc.CodeValue = "152";
                            }
                            else
                            {
                                cmbOnUsTc.CodeValue = "154";
                            }
                        }
                        else
                            cmbOnUsTc.CodeValue = "171";
                        /* End #36684 */
                    }
                   //WI#11305
			   	  //	else
			   	 //	{
			   	//		cmbOnUsTc.CodeValue = "171";
				//	}
                    break;

                case "LN":
                    cmbOnUsTc.CodeValue = "350";
                    break;
			}
		}

		private void dfTfrCheckNo_PhoenixUIValidateEvent(object sender, PCancelEventArgs e)
		{
            //SetDefaultOnUsComboTranCode(_tlTranSet.CurTran.TfrAcct.DepLoan.Value);        //#10272 - do not default trancode based on check# change
		}
		//WI#11305
		private void dfTfrCheckNo_PhoenixUILeaveEvent(object sender, PEventArgs e)
		{
		  string applType = "", depLoan = "", fmt = "";
		  GetAcctTypeDetails(cmbTfrAcctType, ref applType, ref depLoan, ref fmt);
          if (IsOnUsTCEnabled) //#12811
          {
              SetDefaultOnUsComboTranCode(_tlTranSet.CurTran.TfrAcct.DepLoan.Value, applType);
          }
        }

		#endregion

        #region #79574
        private void DeviceDeposit(TlTransactionSet.UcmInterface deviceAction)
        {
            DeviceDeposit(deviceAction, false, 0);  //#43402
        }

        private void DeviceDeposit(TlTransactionSet.UcmInterface deviceAction, bool isFormClose)
        {
            DeviceDeposit(deviceAction, false, 0);  //#43402
        }

        private void DeviceDeposit(TlTransactionSet.UcmInterface deviceAction, bool isFormClose, decimal expectedCashIn)    //#8977 #43402 - added expectedCashIn
        {
            bool saveCashDenom = false;
            decimal devDeposit = _tlTranSet.GetTotalTcrCashDeposited(_tlTranSet.CurTran);
            _tcdDeviceResp = new ArrayList();
            decimal reqDispAmt = 0;
            int curTranIndex = -1;
            decimal manDepositAmt = 0;
            var sourceTran = (picTabs.SelectedTab == tabEasyCapture ? _quickTranWindow.TranSet.CashInTran : null);
            //decimal expDepositAmt = (_tlTranSet.CurTran.CashIn.IsNull ? 0 :
            //    (devDeposit > 0 ? (devDeposit - _tlTranSet.CurTran.CashIn.Value) :
            //    _tlTranSet.CurTran.CashIn.Value));    //#9309
            decimal expDepositAmt = 0;  //#9309
                                        //
                                        //if (devDeposit > 0 && expDepositAmt <= 0)
                                        //{
                                        //    PMessageBox.Show(11681, MessageType.Warning, MessageBoxButtons.OK, String.Empty);
                                        //    dfCashIn.Focus();
                                        //    return;
                                        //}
                                        //

            //#89998
            if (picTabs.SelectedTab == tabEasyCapture)
            {
                if (sourceTran != null && sourceTran.MappedTranIndex > 0)
                {
                    _tlTranSet.SelectTransaction(sourceTran.MappedTranIndex, false);
                }
                else
                {
                    if (_tlTranSet.CurTran == null)
                        _tlTranSet.CurTran = new TlTransaction();
                }
            }

            if (!_tlTranSet.TellerVars.ValidateExpectedDepAmt)
                expDepositAmt = 0;

            try
            {
                if (deviceAction == TlTransactionSet.UcmInterface.DeviceDeposit)
                    dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(11633));
                else
                    dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(13169));
                //
                using (new WaitCursor())
                {
                    InitializeCashDispense();
                    //
                    cashDisp.ReturnCode = 0;
                    cashDisp.IgnoreReturnString = true;
                    //block the F1 key
                    _isOkToBlockF1Key = true;
                    tcdAction.Shortcut = Keys.F1;
                    //
                    if (deviceAction == TlTransactionSet.UcmInterface.DeviceReverseDeposit)
                    {
                        if (cashDisp.WindowTitle != _tlTranSet.TellerVars.DeviceRevDepWindowTitle)
                        {
                            //cashDisp.Close();
                            //cashDisp.WindowTitle = _tlTranSet.TellerVars.DeviceRevDepWindowTitle;
                            //cashDisp.Open();
                            cashDisp.IsConnOpen = false;
                            cashDisp.WindowTitle = _tlTranSet.TellerVars.DeviceRevDepWindowTitle;
                        }
                        if (isFormClose)
                            _tlTranSet.LoadDenomForReverseDeposit(_tcdDeviceResp, false);   //#8977
                        else
                            _tlTranSet.LoadDenomForReverseDeposit(_tcdDeviceResp, _tlTranSet.CurTran, ref reqDispAmt, false);   //#8977
                        if ((isFormClose && _tlTranSet.TranSetTotalDevDeposit.Value > 0) || (!isFormClose && reqDispAmt > 0))   //#8977
                        {
                            if (_revDueToAmtMismatch)
                            {
                                //14568 - The deposit amount does not match the cash in amount so required the reversal of the amount deposited to the TCR.
                                PMessageBox.Show(this, 14568, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                                _revDueToAmtMismatch = false;
                            }
                            else
                                PMessageBox.Show(this, 13242, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                            if (cashDisp.Dispense(_tlTranSet.TellerVars.DrawerNo.ToString(), (double)(isFormClose ? _tlTranSet.TranSetTotalDevDeposit.Value : reqDispAmt),
                                _tcdDeviceResp))
                            {
                                _isRevDepositPerformed = isFormClose;
                                _tlTranSet.TranSetTotalDevDeposit.Value = _tlTranSet.TranSetTotalDevDeposit.Value - (isFormClose ? _tlTranSet.TranSetTotalDevDeposit.Value : reqDispAmt);

                                if (sourceTran == null && picTabs.SelectedTab == tabEasyCapture)
                                    _quickTranWindow.TranSet.CashInTran = _quickTranWindow.GetCurrentEasyCaptureTran();

                                if (isFormClose)
                                    _tlTranSet.LoadDenomForReverseDeposit(_tcdDeviceResp, true);   //#8977
                                else
                                {
                                    if (!_tlTranSet.CurTran.TranIndex.IsNull && _tlTranSet.CurTran.TranIndex.Value >= 1)
                                    {
                                        curTranIndex = _tlTranSet.CurTran.TranIndex.Value;
                                        curTranIndex = curTranIndex - 1;
                                    }
                                    if (curTranIndex >= 0 && _tlTranSet.Transactions != null && _tlTranSet.Transactions.Count > 0)  //#89998
                                        _tlTranSet.LoadDenomForReverseDeposit(_tcdDeviceResp, (_tlTranSet.Transactions[curTranIndex] as TlTransaction), ref reqDispAmt, true);   //#8977
                                    else
                                        _tlTranSet.LoadDenomForReverseDeposit(_tcdDeviceResp, _tlTranSet.CurTran, ref reqDispAmt, true);   //#8977
                                }
                                //if (!isFormClose && !_tlTranSet.IsTellerCaptureTran)
                                if (!isFormClose)   //#8977 #140895 - added teller capture condition  #43402 - removed !_tlTranSet.IsTellerCaptureTran
                                {
                                    _tlTranSet.ModifyCashInOutAmt((_tlTranSet.CurTran.TlTranCode.Value == "VLS" ? _tlTranSet.CurTran.CashOut.XmlTag : _tlTranSet.CurTran.CashIn.XmlTag), true, (_tlTranSet.CurTran.TlTranCode.Value == "VLS" ? true : false));
                                    MoveAmtObjectsToScreen();

                                    if (picTabs.SelectedTab == tabEasyCapture)  //#89998
                                    {
                                        _quickTranWindow.TranSet.CashIn = _tlTranSet.CurTran.CashIn.Value;
                                    }
                                }

                                if (saveCashDenom)
                                {
                                    _tlTranSet.LoadTCDCashOutDenom(_tcdDeviceResp, deviceAction);
                                }
                            }
                            else
                            {
                                if (isFormClose && _isForceDeviceReset)
                                {
                                    _isForceDeviceReset = false;
                                    if (ResetTcdTcrDevice(isFormClose))
                                        ReverseDeviceDeposit(isFormClose);
                                }
                            }
                        }
                    }
                    else if (deviceAction == TlTransactionSet.UcmInterface.DeviceDeposit)
                    {
                        if (cashDisp.WindowTitle != _tlTranSet.TellerVars.DeviceDepWindowTitle)
                        {
                            //cashDisp.Close();
                            //cashDisp.WindowTitle = _tlTranSet.TellerVars.DeviceDepWindowTitle;
                            //cashDisp.Open();
                            cashDisp.IsConnOpen = false;
                            cashDisp.WindowTitle = _tlTranSet.TellerVars.DeviceDepWindowTitle;
                        }
                        if (cashDisp.Deposit(_tlTranSet.TellerVars.DrawerNo.ToString(),
                            (double)expDepositAmt,
                            false,
                            _tcdDeviceResp))
                        {
                            if (!_tlTranSet.TranSetTotalDevDeposit.IsNull && _tlTranSet.GetTotalTcrCashDeposited(_tlTranSet.CurTran) > 0)
                                _tlTranSet.TranSetTotalDevDeposit.Value = _tlTranSet.TranSetTotalDevDeposit.Value - _tlTranSet.GetTotalTcrCashDeposited(_tlTranSet.CurTran);
                            _tlTranSet.LoadTCDCashOutDenom(_tcdDeviceResp, deviceAction);
                            //if (!_tlTranSet.IsAcquirerTran && !_tlTranSet.IsTellerCaptureTran) // #79510, #09614 - added the if #140895 - added teller capture condition

                            if (sourceTran == null && picTabs.SelectedTab == tabEasyCapture)    //#89998
                            {
                                _quickTranWindow.TranSet.CashInTran = _quickTranWindow.GetCurrentEasyCaptureTran();
                                ArrayList sourceList = _tlTranSet.CurTran.CashInDenoms;
                                ArrayList targetList = _quickTranWindow.TranSet.CashIns;

                                targetList.Clear();

                                foreach (var denom in sourceList)
                                {
                                    targetList.Add(denom);
                                }
                            }

                            if (!_tlTranSet.IsAcquirerTran) // #79510, #09614 - added the if #140895 - added teller capture condition   #43402 - removed  !_tlTranSet.IsTellerCaptureTran
                                _tlTranSet.ModifyCashInOutAmt((_tlTranSet.CurTran.TlTranCode.Value == "VLS" ? _tlTranSet.CurTran.CashOut.XmlTag : _tlTranSet.CurTran.CashIn.XmlTag), true, (_tlTranSet.CurTran.TlTranCode.Value == "VLS" ? true : false));

                            devDeposit = _tlTranSet.GetTotalTcrCashDeposited(_tlTranSet.CurTran);
                            _tlTranSet.TranSetTotalDevDeposit.Value = (_tlTranSet.TranSetTotalDevDeposit.IsNull ? 0 : _tlTranSet.TranSetTotalDevDeposit.Value) + devDeposit;
                            if (_tlTranSet.TellerVars.ValidateExpectedDepAmt)
                                _tlTranSet.CurTran.TcrExpectedAmt.Value = (devDeposit > _tlTranSet.CurTran.CashIn.Value ? devDeposit : _tlTranSet.CurTran.CashIn.Value);
                            //_tlTranSet.CurTran.TcrRevDeposit.Value = (devDeposit <= 0 ? GlobalVars.Instance.ML.Y : GlobalVars.Instance.ML.N);
                            if (!_tlTranSet.IsAcquirerTran)
                                manDepositAmt = _tlTranSet.GetManualDepositAmt(_tcdDeviceResp);
                            if (!_tlTranSet.IsAcquirerTran && !_tlTranSet.IsTellerCaptureTran) // #79510, #09614 - added the if #140895 - added teller capture condition
                            {
                                MoveAmtObjectsToScreen();
                                //#9309
                                //manDepositAmt = _tlTranSet.GetManualDepositAmt(_tcdDeviceResp);    //#140895
                                if (manDepositAmt > 0 && _tlTranSet.CurTran.TlTranCode.Value != "VLS")
                                {
                                    dfCashIn.UnFormattedValue = Convert.ToDecimal(dfCashIn.UnFormattedValue) + manDepositAmt;
                                    CalcDefaultField(dfCashIn);
                                }

                                //#89998
                                if (picTabs.SelectedTab == tabEasyCapture)
                                {
                                    _quickTranWindow.TranSet.CashIn = _tlTranSet.CurTran.CashIn.Value;
                                    if (manDepositAmt > 0 && _tlTranSet.CurTran.TlTranCode.Value != "VLS")
                                    {
                                        _quickTranWindow.TranSet.CashIn = _quickTranWindow.TranSet.CashIn + manDepositAmt;
                                        _tlTranSet.CurTran.CashIn.Value = _quickTranWindow.TranSet.CashIn;
                                    }
                                    MapEasyCaptureToTranSet(false, false, false);
                                }
                            }
                        }
                        else
                        {
                            _tlTranSet.CurTran.TcrRevDeposit.Value = GlobalVars.Instance.ML.Y;
                        }

                    }
                }

            }
            catch (PhoenixException)
            {
                if (cashDisp.ReturnCode != 0)
                {
                    _isOkToBlockF1Key = false;
                    tcdAction.Visible = false;
                    if (deviceAction == TlTransactionSet.UcmInterface.DeviceReverseDeposit)
                        _isRevDepositPerformed = false;
                    PMessageBox.Show(317446, MessageType.Warning, MessageBoxButtons.OK,
                    new string[] { cashDisp.GetErrorString(cashDisp.ReturnCode) });
                    _isForceDeviceReset = false;
                }
            }
            finally
            {
                dlgInformation.Instance.HideInfo();
                _isForceDeviceReset = false;
                _isOkToBlockF1Key = false;
                tcdAction.Shortcut = Keys.None; //#72916TBD
                if (cashDisp.ReturnCode != 0)
                {
                    if (cashDisp.ReturnCode != 0 && cashDisp.ReturnCode != -1)
                    {
                        PMessageBox.Show(317446, MessageType.Warning, MessageBoxButtons.OK,
                        new string[] { cashDisp.GetErrorString(cashDisp.ReturnCode) });
                    }
                }
                else
                {
                    //#140895 #43402
                    //if (deviceAction == TlTransactionSet.UcmInterface.DeviceDeposit &&
                    //    _tlTranSet.IsTellerCaptureTran &&
                    //    ((devDeposit + manDepositAmt) != _tlTranSet.CurTran.CashIn.Value))
                    //{
                    //    deviceAction = TlTransactionSet.UcmInterface.DeviceReverseDeposit;
                    //    _revDueToAmtMismatch = true;
                    //    DeviceDeposit(deviceAction, false);
                    //}

                    if (_tlTranSet.IsTellerCaptureTran)
                    {
                        _tlTranSet.CurTran.CashIn.Value = expectedCashIn;   //#43810
                        if (deviceAction == TlTransactionSet.UcmInterface.DeviceDeposit)
                        {
                            if ((devDeposit + manDepositAmt) != expectedCashIn)
                            {
                                deviceAction = TlTransactionSet.UcmInterface.DeviceReverseDeposit;
                                _revDueToAmtMismatch = true;
                                DeviceDeposit(deviceAction, false, expectedCashIn);
                            }
                        }
                        MoveAmtObjectsToScreen();
                    }
                }

            }
        }
        #endregion

        //Begin #79510
        private void GetAcquirerTranSet()
        {
            this.Enabled = false; // disable the whole form
            //this.Visible = false;
            this.Name0.IsDisabled = true;
            this.Name1.IsDisabled = true;
            this.Name2.IsDisabled = true;
            this.Name3.IsDisabled = true;
            this.Name4.IsDisabled = true;
            this.tabEasyCapture.IsDisabled = true;  //Task#87717
            foreach (PAction action in ActionManager.Actions)
            {
                action.Enabled = false;
            }

            if (this.Workspace != null)
            {
                foreach (Control control in (Workspace as Form).Controls)
                {
                    if (control is PCookieCrumb)
                    {
                        control.Enabled = false;
                        break;
                    }

                }
            }

            try
            {
                if (!_tlTranSet.FormAcquirerTranSet(acquirerResponseXml, _tlTranSet.TellerVars.IsTCDConnected, ref cTRRequired, ref triggerOwnBehalf))
                {
                    if (_tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.Failure)
                    {
                        PMessageBox.Show(360188, MessageType.Warning, MessageBoxButtons.OK,
                            new string[] { "The transactions could not be posted by Interpro due to the following error: \r\n" + _tlTranSet.ErrorString.Value });
                    }
                    else
                    {
                        ProcessResponses(null);
                    }
                    //this.OnActionClose();   // to set the _isClosing of PfwStandard
                    acquirerWinOkToClose = true;
                    closeFormOnComplete = true;
                    //this.Close();
                    return;
                }

                sharePrimaryCheck = true;   // skip the share primary check
                //_tlTranSet.TellerVars.IsTCDEnabled = true;  // to remove
                //_tlTranSet.TellerVars.IsRecycler = true;    // to remove
                //_tlTranSet.TellerVars.TcdStationId = "D";   // to remove
                //PostTransactions();
            }
            catch (PhoenixException pe)
            {
                PMessageBox.Show(pe);
            }
            finally
            {

            }

        }
        private void ProcessAcquirerTranSet(string origin)
        {
            try
            {
                acquirerWinOkToClose = false;    // #79510

                #region process overrides
                if (_tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.HasOverrides)
                {
                    if (origin != "dlgTlSupervisorOverride")
                    {
                        CallOtherForms("Override");
                        return;
                    }
                    else
                    {
                        try
                        {
                            dlgInformation.Instance.ShowInfo("Verifying the overrides...");
                            //called from override dialog. Verify for the overrides captured.
                            if (!_tlTranSet.VerifyTranOvrdsForAcquirer())
                            {
                                ProcessResponses(null);
                                // call itself once again to invoke the override dialog again.
                                ProcessAcquirerTranSet("ProcessAcquirerTranSet");
                                return;
                            }
                        }
                        finally
                        {
                            dlgInformation.Instance.HideInfo();
                        }
                    }
                }
                #endregion

                #region cash -in denomination
                if (acquirerCashInTranIndex < _tlTranSet.Transactions.Count)
                {
                    for (int i = acquirerCashInTranIndex; i < _tlTranSet.Transactions.Count; i++)
                    {
                        _tlTranSet.CurTran = _tlTranSet.Transactions[i] as TlTransaction;
                        if (_tlTranSet.TriggerCashInOut(_tlTranSet.CurTran.CashIn.XmlTag, !_tlTranSet.IsTellerCaptureTran)) // #140895 - passed  IsTellerCaptureTran
                        {
                            HandleCashInOutDenom("CashInDenom");
                            return;
                        }
                        acquirerCashInTranIndex = i + 1;    // #79510, #09614 - Added 1
                    }


                }
                if (acquirerCashInTranIndex == _tlTranSet.Transactions.Count)
                {
                    //Save the collected denominations
                    _tlTranSet.SaveCashInDenom();
                    acquirerCashInTranIndex++;
                }
                #endregion

                //printing/ctr etc.
                PostTransactions();
            }
            catch (PhoenixException pe)
            {
                PMessageBox.Show(pe);
            }
        }

        void Application_ThreadException(object sender, ThreadExceptionEventArgs e)
        {
            acquirerWinOkToClose = true;
        }
        private void AfterDialogClosed(string origin)
        {
            if (origin == "CheckInfo")
            {
                if (_tlTranSet.IsAcquirerTran)
                {
                    try
                    {
                        dlgInformation.Instance.ShowInfo("Verifying check info...");
                        _tlTranSet.LoadTlChkForm(printInfoForm);
                        ProcessResponses(null);
                        Application.DoEvents();
                        return;
                    }
                    finally
                    {
                        dlgInformation.Instance.HideInfo();
                    }
                }
            }
            else if (origin == "PrintBalPrompt") // #79502
            {
                if (dialogResult == DialogResult.None || dialogResult == DialogResult.Cancel)
                {
                    _printBalOption = "N";
                    _printBalances = false;
                }
                else if (dialogResult == DialogResult.OK)
                {
                    _printBalOption = "A";
                    _printBalances = true;

                }
                else
                {
                    _printBalOption = "S";
                    _printBalances = true;
                }
            }
            //end   #194535
        }
        private void HandleAcquirerWindowClosing(CancelEventArgs e)
        {
            if (!acquirerWinOkToClose && (Control.ModifierKeys & Keys.Control) == Keys.Control)
            {
                //You are attempting to close the window without completing the full sequence of posting. You may have to do manual adjustments for the acquirer transaction posted. Press Ok if you want to proceed.
                if (PMessageBox.Show(13229, MessageType.Question, MessageBoxButtons.OKCancel, MessageBoxDefaultButton.Button2, String.Empty) == DialogResult.OK)
                {
                    acquirerWinOkToClose = true;
                }
            }
            e.Cancel = !acquirerWinOkToClose;
            if (acquirerWinOkToClose)
            {
                closedWkspace = true;   //#6656
                //base.OnClosing(e);
                base.OnFormClosing(new FormClosingEventArgs(CloseReason.UserClosing, e.Cancel));     //#32833

            }
        }
        //End #79510

        private bool IsLoadCustSummary()
        {
            if (_tlTranSet.TellerVars.IsAppOnline &&
                !_tlTranSet.TellerVars.AdTlControl.TellerTabDefault.IsNull &&
                _tlTranSet.TellerVars.AdTlControl.TellerTabDefault.Value == "S")
                return true;
            else
                return false;
        }

        private void ReverseDeviceDeposit(bool isFormClose)
        {
            bool isTCRCashDeposited = false;
            if (_tlTranSet != null && _tlTranSet.TellerVars.IsRecycler)  //Task #124027 - Added Null Check for _tlTranset for Workflow
            {
                if (picTabs.SelectedTab == tabEasyCapture)
                {

                    var sourceTran = _quickTranWindow.TranSet.CashInTran;

                    if (sourceTran != null && sourceTran.MappedTranIndex > 0)
                    {
                        _tlTranSet.SelectTransaction(sourceTran.MappedTranIndex, false);
                    }
                    else
                    {
                        if (_tlTranSet.CurTran == null)
                            _tlTranSet.CurTran = new TlTransaction();
                    }

                    if (_tlTranSet.CurTran.CashInDenoms == null || _tlTranSet.CurTran.CashInDenoms.Count == 0)
                    {
                        ArrayList targetList = _tlTranSet.CurTran.CashInDenoms;
                        ArrayList sourceList = _quickTranWindow.TranSet.CashIns;

                        targetList.Clear();

                        foreach (var denom in sourceList)
                        {
                            targetList.Add(denom);
                        }
                    }
                }

                if (isFormClose)
                {
                    isTCRCashDeposited = (_tlTranSet.IsTcrCashDeposited() && !_isRevDepositPerformed);
                    if (!isTCRCashDeposited && !_isRevDepositPerformed)
                        isTCRCashDeposited = _tlTranSet.IsTcrCashDeposited(_tlTranSet.CurTran);
                }
                else
                    isTCRCashDeposited = _tlTranSet.IsTcrCashDeposited(_tlTranSet.CurTran);

                if (isTCRCashDeposited)
                {
                    if (isFormClose)
                        DeviceDeposit(TlTransactionSet.UcmInterface.DeviceReverseDeposit, true);
                    else
                        DeviceDeposit(TlTransactionSet.UcmInterface.DeviceReverseDeposit);
                }
            }
        }

        private bool ResetTcdTcrDevice(bool isSilent)
        {
            bool isSuccess = false;
            try
            {
                if (!isSilent)
                    dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(11593));

                InitializeCashDispense();
                isSuccess = cashDisp.Reset(_tlTranSet.TellerVars.DrawerNo.ToString());
            }
            finally
            {
                dlgInformation.Instance.HideInfo();
            }
            //
            return isSuccess;

        }

        private void dfTransactionInformation_Enter(object sender, EventArgs e)
        {

        }

        private void ResetFormForSupViewOnlyMode(string origin) //#79314
        {
            if (_isSupervisorViewOnlyMode)
            {
                //if (origin == "FormCreate" || origin == "InitializeTran" || origin == "TabClicked" || origin == "TranCodeCleanUp" || origin == string.Empty)
                //{
                if (origin == "FormCreate" || origin == "InitializeTran")
                {
                    this.Name0.IsDisabled = false;
                    this.Name1.IsDisabled = (_transForOverride == null || _transForOverride.Count <= 1);
                    this.Name2.IsDisabled = true;
                    this.Name3.IsDisabled = !_loadCustSummary && !_isSupervisorViewOnlyMode;
                    this.Name4.IsDisabled = true;
                    this.tabEasyCapture.IsDisabled = true;  //Task#87717
                }
                if (picTabs.SelectedIndex == 0 || picTabs.SelectedIndex == 1 || picTabs.SelectedIndex == 3)
                {
                    //gbAccountInformation.Enabled = false;
                    //dfTransactionInformation.Enabled = false;
                    MakeReadOnly(false);
                    if (picTabs.SelectedIndex == 0)
                    {
                        foreach (PAction action in ActionManager.Actions)
                        {
                            if (!(action == pbFees || action == pbItemCapture || action == pbCashIn || action == pbCashOut ||
                                action == pbMakeBreakStrap || action == pbDisplay || action == pbHistory ||
                                action == pbRestrictions || action == pbBondPurchase || action == ActionClose ||
                                action == pbInventory)) //#21274 - added pbInventory
                            {
                                action.Enabled = false;
                                pbInventoryMisc.Enabled = pbInventory.Enabled; //#60578
                            }
                        }
                    }
                }
                //Reset save and addNext actions
                ActionSave.Enabled = !_isSupervisorViewOnlyMode && ActionSave.Enabled;
                ActionAddNext.Enabled = !_isSupervisorViewOnlyMode && ActionAddNext.Enabled;
                //}
                //Reset view transactions tab actions
                if ((origin == "TranSetClick" || origin == string.Empty) && picTabs.SelectedIndex == 1)
                    pbRemoveTran.Enabled = !_isSupervisorViewOnlyMode && pbRemoveTran.Enabled;
                //Reset customer summary actions
                if ((origin == "AccountListSumClick" || origin == "TabClicked" || origin == string.Empty) && picTabs.SelectedIndex == 3)
                {
                    pbSelectAcct.Enabled = !_isSupervisorViewOnlyMode && pbSelectAcct.Enabled && GlobalVars.UserType != "AcProc"; //#75588
                    pbSelectRIM.Enabled = !_isSupervisorViewOnlyMode && pbSelectRIM.Enabled && GlobalVars.UserType != "AcProc"; //#75588
                    pbVod.Enabled = !_isSupervisorViewOnlyMode && pbVod.Enabled; //WI#28556 //WI#140785
                }
            }
        }

        private void LoadAcctDetails(TlAcctDetails acctDetails, string acctType, string acctNo) //#79314
        {
            AcctTypeDetail acctTypeDetail = null;
            if (_tlTranSet.TellerVars.IsAppOnline && !isNonCust())
            {
                if (!acctDetails.AcctNo.IsNull)
                    acctDetails.CleanUpValues(true);

                acctDetails.AcctType.Value = acctType;
                acctDetails.AcctNo.Value = acctNo;
                acctDetails.SwapAcct.Value = 0;
                //
                if (!string.IsNullOrEmpty(acctType))
                {
                    acctTypeDetail = _gbHelper.GetAcctTypeDetails(acctType, string.Empty);
                    acctDetails.ApplType.Value = acctTypeDetail.ApplType;
                    acctDetails.DepLoan.Value = acctTypeDetail.DepLoan;
                }
                //
                if (acctDetails == _tlTranSet.CurTran.TranAcct)
                    acctDetails.GetAcctNoNicknameDetails();
                //
                acctDetails.GetAcctDetails();
                if (acctDetails.TranCode.IsNull)
                    acctDetails.TranCode.Value = _tlTranSet.CurTran.TranCode.Value;
                acctDetails.SuspectAcct.Value = 0;
            }
        }

        //Begin #13797
        private void WriteToDebugLog(string logInput)
        {
            if (CoreService.LogPublisher.IsLogEnabled)
            {
                if (!string.IsNullOrEmpty(logInput))
                {
                    logInput = logInput.Replace("<", "");
                    logInput = logInput.Replace(">", "");
                    logInput = logInput.Replace("&", "");
                    logInput = logInput.Replace(".", "");
                    logInput = logInput.Replace("/", "");
                }
                CoreService.LogPublisher.LogDebug(logInput);
                System.Diagnostics.Trace.WriteLine(logInput);
            }
        }
        //End #13797


        //Begin #17178
        public override bool IsWkspaceActionEnabled(int globalActionId, ref bool isEnabled)
        {
            EnableDisableControls(EnumEnableDisable.ActionSavingsBond);
            return base.IsWkspaceActionEnabled(globalActionId, ref isEnabled);
        }
        //End #17178

        //Begin #17047
        private void pbGetAcct_Click(object sender, PActionEventArgs e)
        {
            //Begin 87757-2
            if (picTabs.SelectedTab == tabEasyCapture && RmAcctPtid <= 0)
            {
                return;
            }
            //End 87757-2

            getAcctSearchAcctType = null;
            getAcctSearchAcctNo = null;
            CallOtherForms("GetAcct");
        }
        //End #17047

        //Begin #19415
        private bool PopulateDepositObjUsingAcctDetails(BusObjectBase depositObj, bool isTfrAcct)
        {
            string acctType = isTfrAcct ? _tlTranSet.CurTran.TfrAcct.AcctType.Value : _tlTranSet.CurTran.TranAcct.AcctType.Value;
            string acctNo = isTfrAcct ? _tlTranSet.CurTran.TfrAcct.AcctNo.Value : _tlTranSet.CurTran.TranAcct.AcctNo.Value;
            string mmdaAcct = null;
            string svRegdAcct = null;

            if (acctType != null)
                acctType = acctType.Trim();
            if (acctNo != null)
                acctNo = acctNo.Trim();

            if (isTfrAcct)
            {
                if (acctType == cmbTfrAcctType.Text.Trim() && acctNo == dfTfrAcctNo.Text.Trim() &&
                    !_tlTranSet.CurTran.TfrAcct.MmdaAcct.IsNull && !_tlTranSet.CurTran.TfrAcct.SvRegdAcct.IsNull)
                {
                    mmdaAcct = _tlTranSet.CurTran.TfrAcct.MmdaAcct.Value;
                    svRegdAcct = _tlTranSet.CurTran.TfrAcct.SvRegdAcct.Value;
                }
            }
            else
            {
                if (acctType == cmbAcctType.Text.Trim() && acctNo == dfAcctNo.Text.Trim() &&
                    !_tlTranSet.CurTran.TranAcct.MmdaAcct.IsNull && !_tlTranSet.CurTran.TranAcct.SvRegdAcct.IsNull)
                {
                    mmdaAcct = _tlTranSet.CurTran.TranAcct.MmdaAcct.Value;
                    svRegdAcct = _tlTranSet.CurTran.TranAcct.SvRegdAcct.Value;
                }
            }

            if (mmdaAcct != null && svRegdAcct != null)
            {
                if (depositObj is DpAcct)
                {
                    (depositObj as DpAcct).Mmda.Value = mmdaAcct;
                    (depositObj as DpAcct).SvRegd.Value = svRegdAcct;
                }
                else if (depositObj is DpDisplay)
                {
                    (depositObj as DpDisplay).MMDA.Value = mmdaAcct;
                    (depositObj as DpDisplay).SvRegd.Value = svRegdAcct;
                }

                return true;
            }

            return false;
        }

        public override bool VerifyConfAcctAccess(object sender, string confAcctType, string confAcctNo)
        {
            if (sender == ActionSave)   // see if we can provide the conf flag value to avoid database trip
            {
                string isConf = null;
                if (confAcctType == _tlTranSet.CurTran.TranAcct.AcctType.Value &&
                    confAcctNo == _tlTranSet.CurTran.TranAcct.AcctNo.Value)
                    isConf = _tlTranSet.CurTran.TranAcct.Confidential.Value;
                if (isConf != null) // if conf flag is found then call the extension( which the fwk is also doing )
                    return Extension.VerifyConfAcctAccess(sender, confAcctType, confAcctNo, isConf);
            }

            return base.VerifyConfAcctAccess(sender, confAcctType, confAcctNo);
        }
        //End #19415

        private string GetCustomerName(int rimNo, bool isNonCustomer)   //#140772
        {
            string custName = string.Empty;

            if (isNonCustomer)
                custName = GetNonCustName(rimNo);
            else
            {
                #region Get Customer Information
                TlAcctDetails tlAcctDetails = new TlAcctDetails();
                tlAcctDetails.AcctNo.Value = rimNo.ToString();
                tlAcctDetails.RimNo.Value = rimNo;
                tlAcctDetails.ApplType.Value = GlobalVars.Instance.ML.RIM;
                tlAcctDetails.DepLoan.Value = GlobalVars.Instance.ML.RM;
                tlAcctDetails.AcctType.Value = GlobalVars.Instance.ML.RIM;
                try
                {
                    using (new WaitCursor())
                    {
                        tlAcctDetails.GetAcctDetails();
                    }
                }
                catch (PhoenixException pe)
                {
                    PMessageBox.Show(pe, MessageBoxButtons.OK);
                }
                #endregion

                custName = tlAcctDetails.GetNameRim(false);
            }

            return custName;
        }

        private void GetInventoryItemsByCount()     //#140772-19537
        {
            GetInventoryItemsByCount(false);
        }

        private void GetInventoryItemsByCount(bool isPurchDetailsInfoSaved)     //#140772-19537
        {
            if (!isPurchDetailsInfoSaved)
            {
                _tlTranSet.GetInventoryItems(_tlTranSet.CurTran.TranCode.Value,
                    (cmbInventoryType.CodeValue == null ? -1 : Convert.ToDecimal(cmbInventoryType.CodeValue)),
                    (cmbInventoryPacket.CodeValue == null ? -2 : Convert.ToDecimal(cmbInventoryPacket.CodeValue)), // #23981: was defaulting to -1
                    _tlTranSet.TellerVars.BranchNo,
                    _tlTranSet.TellerVars.DrawerNo,
                    searchRimNo,
                    (dfCheckNo.UnFormattedValue == null ? -1 : Convert.ToInt32(dfCheckNo.UnFormattedValue)),
                    (dfInvSerialNo.UnFormattedValue == null ? -1 : Convert.ToDecimal(dfInvSerialNo.UnFormattedValue)),
                    (!_tlTranSet.CurTran.NonCust.IsNull && _tlTranSet.CurTran.NonCust.Value == "Y" ? true : false),
                    ref _totalInventoryItems,
                    _adGbInventoryType,
                    _tlTranSet.CurTran);    //#21274
            }
            //_totalInventoryItems = _tlTranSet.CurTran.NoInvAvailable.Value;
            dfNoInvAvailable.UnFormattedValue = _totalInventoryItems - Convert.ToInt32(dfCheckNo.UnFormattedValue);
            dfNoInvAvailable.ScreenToObject();

            if (_tlTranSet.CurTran.InvItemAmt.Value > _tlTranSet.CurTran.NetAmt.Value)
                dfAmt.UnFormattedValue = _tlTranSet.CurTran.InvItemAmt.Value;
            else
            {
                if (_prevInvItemAmt > 0 && dfAmt.UnFormattedValue != null && Convert.ToDecimal(dfAmt.UnFormattedValue) == _prevInvItemAmt)
                    dfAmt.UnFormattedValue = _tlTranSet.CurTran.InvItemAmt.Value;
            }
            _prevInvItemAmt = _tlTranSet.CurTran.InvItemAmt.Value;
            CalcDefaultField(dfAmt);
        }

        private void ClearInventoryItems()
        {
            _prevInvItemAmt = 0;
            if (_tlTranSet != null && _tlTranSet.CurTran != null)
            {
                if (_tlTranSet.CurTran.InventoryItems != null)
                    _tlTranSet.CurTran.InventoryItems.Clear();
                if (_tlTranSet.CurTran.InventoryItemsAvailable != null)
                    _tlTranSet.CurTran.InventoryItemsAvailable.Clear();
                if (_tempInventoryItems != null && _tempInventoryItems.Count > 0)
                    _tempInventoryItems.Clear();
                _tlTranSet.CurTran.InvDiscountOvrd.SetValueToNull();
                if (_tlTranSet.CurTran.InvItemAmt.Value >= _tlTranSet.CurTran.NetAmt.Value)
                    dfAmt.UnFormattedValue = Convert.ToDecimal(dfAmt.UnFormattedValue) - _tlTranSet.CurTran.InvItemAmt.Value;
                else
                    dfAmt.UnFormattedValue = 0;
                CalcDefaultField(dfAmt);
                _tlTranSet.CurTran.InvItemAmt.SetValueToNull();
                _tlTranSet.CurTran.InvItemValue.SetValueToNull();
                _tlTranSet.CurTran.InvLocalTaxAcctNo.SetValueToNull();
                _tlTranSet.CurTran.InvLocalTaxAcctType.SetValueToNull();
                _tlTranSet.CurTran.InvPacketDesc.SetValueToNull();
                _tlTranSet.CurTran.InvSerialNo.SetValueToNull();
                _tlTranSet.CurTran.InvStateTaxAcctNo.SetValueToNull();
                _tlTranSet.CurTran.InvStateTaxAcctType.SetValueToNull();
                _tlTranSet.CurTran.InvTaxTranCode.SetValueToNull();
                _tlTranSet.CurTran.InvUpchargeAcctNo.SetValueToNull();
                _tlTranSet.CurTran.InvUpchargeAcctType.SetValueToNull();
                _tlTranSet.CurTran.InvUpchargeAmt.SetValueToNull();
                _tlTranSet.CurTran.InvUpchargeTranCode.SetValueToNull();
            }
        }

        private void SetInventoryTypeField()
        {
            if (processingSelectTran)
            {
                EnableDisableControls("InventoryItem");
                if (_adGbInventoryType.Class.Value == CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Packet"))
                {
                    //cmbInventoryPacket.ScreenToObject();
                    PopulateInventoryPacketCombo();                 
                }

                SetTabOrder("FormCreate");
                SetTabOrder("TranCodeSelect");
                if (!_tlTranSet.CurTran.TypeId.IsNull && _tlTranSet.CurTran.InvItemAmt.Value > 0)
                    _prevInvItemAmt = _tlTranSet.CurTran.InvItemAmt.Value;
                else
                    _prevInvItemAmt = 0;
            }
            else
            {
                cmbInventoryType.ScreenToObject();
                cmbInventoryPacket.CodeValue = null;
                cmbInventoryPacket.Text = null;
                cmbInventoryPacket.ScreenToObject();
                dfCheckNo.UnFormattedValue = null;
                dfCheckNo.ScreenToObject();
                dfInvSerialNo.UnFormattedValue = null;
                dfInvSerialNo.ScreenToObject();
                _totalInventoryItems = 0;
                _tlTranSet.CurTran.PacketId.SetValueToNull();
                ClearInventoryItems();
                dfNoInvAvailable.UnFormattedValue = null;
                dfNoInvAvailable.ScreenToObject();
                //
                if (cmbInventoryType.CodeValue != null)
                {
                    _adGbInventoryType.TypeId.Value = Convert.ToDecimal(cmbInventoryType.CodeValue);
                    CoreService.DataService.ProcessRequest(XmActionType.Select, _adGbInventoryType);

                    if (_adGbInventoryType.Class.Value == CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Packet"))
                    {
                        cmbInventoryPacket.ScreenToObject();
                        PopulateInventoryPacketCombo();
                    }

                    //Begin #140772
                    if (_tlTranSet.CurTran.TranCode.Value == 938 || _tlTranSet.CurTran.TranCode.Value == 939)
                    {
                        _tlTranSet.GetInventoryItems(_tlTranSet.CurTran.TranCode.Value,
                            (cmbInventoryType.CodeValue == null ? -1 : Convert.ToDecimal(cmbInventoryType.CodeValue)),
                            -2,  //23981: was defaulting to -1, we now pass -1 for 'All Packets'
                            _tlTranSet.TellerVars.BranchNo,
                            _tlTranSet.TellerVars.DrawerNo,
                            searchRimNo,
                            -1,
                            -1,
                            (!_tlTranSet.CurTran.NonCust.IsNull && _tlTranSet.CurTran.NonCust.Value == "Y" ? true : false),
                            ref _totalInventoryItems,
                            _adGbInventoryType,
                            _tlTranSet.CurTran);

                        dfNoInvAvailable.UnFormattedValue = _totalInventoryItems;
                        dfNoInvAvailable.ScreenToObject();

                        if (_adGbInventoryType.Class.Value != CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Serial"))  //#21274
                        {
                            if (_tlTranSet.TellerVars.AdTlTc.EnableNumberItems.Value == GlobalVars.Instance.ML.Y)
                            {
                                //#21085 - moved the following check# default code inside to validate EnableNumberItems value
                                if (_adGbInventoryType.Class.Value == CoreService.Translation.GetListItemX(ListId.ML_InventoryClass, "Quantity") &&
                                    _totalInventoryItems > 0)
                                {
                                    dfCheckNo.UnFormattedValue = 1;
                                    dfCheckNo.ScreenToObject();
                                    GetInventoryItemsByCount(); //#140772-#19537
                                }
                            }
                        }
                    }
                }
                //End #140772

                EnableDisableControls("InventoryItem");
                SetTabOrder("FormCreate");
                SetTabOrder("TranCodeSelect");
            }
        }

        //#140798
        private void GenerateReport()
        {
            if (picTabs.SelectedIndex == 0 && _tlTranSet != null && _tlTranSet.CurTran != null &&
                (_tlTranSet.CurTran.TranCode.Value == 912 || _tlTranSet.CurTran.TranCode.Value == 921) &&
                _tlTranSet.CurTran.SavingsBonds != null && _tlTranSet.CurTran.SavingsBonds.Count > 0) //#140798
            {
                //bondHistObj.GenerateReport(_tlTranSet.CurTran.SavingsBonds);
                Phoenix.Windows.Client.WindowHelper winHelper = new WindowHelper();
                winHelper.GenerateReport(_tlTranSet.CurTran.SavingsBonds);
            }
        }
        #region Teller Capture
        //Begin #140895

        private bool CommitTellerCaptureTran(string origin = null)    // #40977
        {
            string deviceResponse = "Pending";
            string imageCommitFlag = "N";
            if (origin == null) //#43809
                CoreService.LogPublisher.LogError("CommitTellerCaptureTran: We are here for the first time ");
            else
                CoreService.LogPublisher.LogError("CommitTellerCaptureTran: We are here for the second time ");

            if (_tlTranSet != null && _tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.Success)
            {
                //_tlTranSet.TellerVars.LastJrnlSequenceNo = _tlTranSet.SequenceNo.Value;

                if (_tlTranSet.IsTellerCaptureTran)
                {
                    //string deviceResponse = "Success";
                    //string imageCommitFlag = "Y";
                    try
                    {
                        _tlCaptureTranXML = null;
                        if (_tlTranSet.RecreateTlCaptureTran())
                        {
                            _tlCaptureAVTCSilentMode = true;
                            if (_tellerCapture != null && _tellerCapture.IsTransactionInProgress)
                            {
                                try
                                {
                                    _tellerCapture.LastTranCommitPending = false;   // since we are recapturing the tran we turn it to false and finally make it true
                                    this.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "ActionTlrCapSingleRelatedClick", new object[] { string.Empty });
                                }
                                finally
                                {
                                    _tellerCapture.LastTranCommitPending = true;
                                }
                            }
                            else if (_tlCaptureNoDeviceDebugMode)
                            {
                                Message msg = new Message();
                                this.ProcessCmdKey(ref msg, _tlCaptureNoDeviceDebugKey);
                            }
                        }



                        if (_tellerCapture != null) // #40977
                        {
                            CoreService.LogPublisher.LogError("CommitTellerCaptureTran: Sending Post Results to Teller Capture ");  //#43810
                            if (!_tellerCapture.IsTransactionInProgress)    //#43810
                                CoreService.LogPublisher.LogError("CommitTellerCaptureTran: Teller Capture Transaction NOT IN PROGRESS");
                            //_tellerCapture.SendPostResults(PostResultsStatusCode.Accepted, string.Empty);
                            if (_tellerCapture.SendPostResults(PostResultsStatusCode.Accepted, string.Empty))
                            {
                                deviceResponse = "Success{0}";
                                imageCommitFlag = "Y";
                                CoreService.LogPublisher.LogError("CommitTellerCaptureTran: Teller Capture Commit Tran Success");
                            }
                            else
                            {
                                imageCommitFlag = "F";
                                deviceResponse = "Error{0}:" + _tellerCapture.PhxErrorMessage;
                                _tellerCapture.PhxErrorMessage = String.Empty;
                                CoreService.LogPublisher.LogError("CommitTellerCaptureTran: Teller Capture Commit Tran Failed " + deviceResponse);
                            }
                        }
                    }
                    catch (Exception e)
                    {
                        deviceResponse = "Error{0}: " + "Exception";
                        imageCommitFlag = "E";
                        PMessageBox.Show(e);
                        CoreService.LogPublisher.LogError("CommitTellerCaptureTran: Teller Capture Commit Tran Failed " + deviceResponse);
                    }
                    finally
                    {
                        if (imageCommitFlag != "Y")
                            PMessageBox.Show(MessageType.Error, @"The transaction could not be committed on AVTC and needs to be reversed/manually adjusted.");
                        try
                        {
                            if (origin != null)
                                origin = "/" + origin;

                            _tlTranSet.UpdateTlCaptureImageCommitFlag(_tlCaptureTranXML, string.Format(deviceResponse, origin), imageCommitFlag);
                        }
                        catch (PhoenixException)
                        {
                            //make second attempt in case there is any database error
                            origin += "/SA";
                            _tlTranSet.UpdateTlCaptureImageCommitFlag(_tlCaptureTranXML, string.Format(deviceResponse, origin), imageCommitFlag);
                        }

                        _tellerCapture.LastTranCommitPending = false;
                        CoreService.LogPublisher.LogError("CommitTellerCaptureTran: Teller Capture Image Commit Flag Updated ");
                        if (_tellerCapture.LastTranLogInfo != null) //OOB-Fix , #40977
                            CoreService.LogPublisher.LogInfo("\n CommitTellerCaptureTran:Teller Transaction : \n *** AVTC CALL SEQUENCE *** \n " + _tellerCapture.LastTranLogInfo.ToString());
                    }
                }
            }
            return (imageCommitFlag == "Y");
        }
        public override bool ProcessMessage(int messageId, object sender, CancelEventArgs eArg, params object[] paramList)
        {
            string _sHouseHoldMember = "N"; //60698           

            #region initialization
            string errorText = string.Empty;
            int errorId = 0;
            string customerData = string.Empty;
            string itemData = string.Empty;
            string transactionData = string.Empty;
            string postResults = string.Empty;
            object objItemData = null;
            string frontImage = string.Empty;
            string rearImage = string.Empty;
            string messageType = null;
            //bool showAVTCWaitDialog = false;  //#129853
            bool fromBulkPostingWindow = false;
            int bulkTranSeqNo = -1;
            bool doNOTAllowAVTCScan = false; //#50964
            #endregion

            #region Teller Capture
            if (messageId == (int)GlobalActions.TellerCapture)
            {
                try
                {
                    #region resolve paramlist
                    if (paramList.Length > 0)
                    {
                        messageType = Convert.ToString(paramList[0]);

                        //Begin #40977
                        if (AVTCGlobals.TransactionType == TellerCaptureTransactionTypes.ViewImages && (messageType == "OnTransmitForPost" || messageType == "CancelTransaction"))
                        {
                            CoreService.LogPublisher.LogError("Teller Capture: ProcessMessage: Received message for ViewImages. Quitting", true);
                            return true;
                        }
                        //End #40977

                        objItemData = paramList[1];
                        if (objItemData != null)
                        {
                            if (messageType == "OnValidateItem" || messageType == "OnValidateItemWithImages")
                            {
                                if (messageType == "OnValidateItem")
                                {
                                    itemData = Convert.ToString((objItemData as object[])[0]);
                                }
                                if (messageType == "OnValidateItemWithImages")
                                {
                                    itemData = Convert.ToString((objItemData as object[])[0]);
                                    frontImage = Convert.ToString((objItemData as object[])[1]);
                                    rearImage = Convert.ToString((objItemData as object[])[2]);
                                }
                            }
                            if (messageType == "OnTransmitForPost")
                            {
                                transactionData = Convert.ToString((objItemData as object[])[0]);
                                if ((objItemData as object[]).Length > 1)
                                    fromBulkPostingWindow = Convert.ToBoolean((objItemData as object[])[1]);   // coming from window frmTlCaptureBulkTran
                                if ((objItemData as object[]).Length > 2)
                                    bulkTranSeqNo = Convert.ToInt32((objItemData as object[])[2]);
                            }
                        }
                        //Begin Bug #92877
                        if (messageType == "HasCustomUserPrefs")
                        {
                            return picTabs.SelectedIndex == (int)TAB.QuickTran;
                        }
                        //End Bug #92877
                    }
                    #endregion

                    WriteToDebugLog("*** Teller Capture: ProcessMessage : messageType = " + messageType);

                    if (_tlTranSet == null)
                        _tlTranSet = new TlTransactionSet();

                    #region handling of different messages
                    #region messageType == "OnValidateItem" || messageType == "OnValidateItemWithImages"
                    if (messageType == "OnValidateItem" || messageType == "OnValidateItemWithImages")
                    {
                        try
                        {
                            if (_tellerCapture != null)
                            {
                                //Send Item Response back to AVTC
                                //if (!_tellerCapture.IsAutoPost) //Selva-added auto post flag
                                errorText = _tlTranSet.ProcessOnValidateItem(itemData, frontImage, rearImage, out errorId, out errorText, out customerData);
                                //Handle AVTC User Error Message
                                _tellerCapture.SendItemResponse(errorText, customerData);
                            }
                        }
                        catch
                        {
                            _tellerCapture.SendItemResponse("Failed to validate teller capture item.", customerData);
                        }
                    }
                    #endregion

                    #region messageType == "OnTransmitForPost"
                    if (messageType == "OnTransmitForPost")
                    {
                        try
                        {
                            if (picTabs.SelectedIndex != (int)TAB.QuickTran && _tlTranSet.IsTellerCaptureCheckOnlyTran) //#102717
                            {
                                _tlTranSet.IsCheckOnlyTranAdvView = true;
                                _tlTranSet.IsTellerCaptureCheckOnlyTran = false;
                            }

                            if (_tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.Success)
                            {
                                _tlCaptureTranXML = transactionData;
                                BringAppToFront();
                                return true;
                            }
                            if (_tlCaptureBulkOptionClicked)    // message got triggered after clicking of submit transaction for the bulk mode
                            {
                                BringAppToFront();
                                _tlCaptureTranXML = transactionData; // to be used in init parameters for frmTlCaptureBulkTran
                                HandleCancelAVTCTransaction(false);
                                _tlCaptureBulkOptionClicked = false;
                                CallOtherForms("frmTlCaptureBulkTran");
                                _tlCaptureTranXML = null;
                                return true;
                            }
                            if (_tlTranSet.EnableChecksOnlyTran && !_tlTranSet.CaptureAllCheckTranItems)    // #102719 - message got triggered after clicking of submit transaction for the check only tran
                            {
                                BringAppToFront();
                                _tlCaptureTranXML = transactionData; // to be used in init parameters for frmTlCaptureBulkTran
                                HandleCancelAVTCTransaction(false);
                                _tlTranSet.TlCaptureChecksOnlyItems.LoadFromXML(_tlCaptureTranXML);
                                if (picTabs.SelectedTab == tabEasyCapture)
                                {
                                    var sourceTran = _quickTranWindow.TranSet.ChecksTran;
                                    if (sourceTran != null && sourceTran.MappedTranIndex > 0)
                                        _tlTranSet.SelectTransaction(sourceTran.MappedTranIndex, false);
                                    else
                                    {
                                        if (_tlTranSet.CurTran == null)
                                            _tlTranSet.CurTran = new TlTransaction();
                                    }

                                    if (_tlTranSet.CurTran.Items != null && _tlTranSet.CurTran.Items.Count > 0)
                                        _tlTranSet.CurTran.Items.Clear();
                                }
                                _tlTranSet.LinkTlCaptureChecksOnlyItems();
                                SetTellerCaptureCheckOnlyFlagForTranSet(true);
                                LoadChecksOnlyItems(true);   //#110046
                                if (_quickTranWindow.TranSet != null && _quickTranWindow.TranSet.ChecksTran != null &&
                                    _quickTranWindow.TranSet.ChecksTran.MappedTranIndex > 0)
                                {
                                    //PopulateTransetTable();
                                    //SetTotalDebitsAndCredits();
                                    _quickTranWindow.RefreshQuickTran("ChecksIn");
                                }
                                return true;
                            }
                            else if (_tlTranSet.EnableChecksOnlyTran && _tlTranSet.CaptureAllCheckTranItems)    // #102719
                            {
                                _tlTranSet.LinkTlCaptureChecksOnlyItems();
                            }
                            if (fromBulkPostingWindow)      // the bulk transaction window fired ProcessMessage to process the transaction set.
                            {
                                //if (this._tellerCapture.IsTransactionInProgress)  //#140895-Selva: Commented out this code because the initiate external tran will cancel the transaction.
                                //{
                                //    //TODO: Raise error that a transaction is already in progress...
                                //    return true;
                                //}

                                //Begin #180277
                                #region debug only code for bulk
                                #if DEBUG
                                if (_tellerCapture == null)
                                {
                                    _tlCaptureNoDeviceDebugMode = true;
                                    _tlCaptureBulkModePosting = true;                                    
                                    this.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "OnTransmitForPost", new object[] { transactionData });
                                    return true;
                                }
                                #endif
                                #endregion
                                //End #180277

                                _tlCaptureBulkModePosting = true;
                                this._tellerCapture.CurForm = this;
                                _tlTranSet.TlCaptureInputItems.LoadFromXML(transactionData);
                                _tlTranSet.SetTlCaptureSkipReconcile(true);
                                if (!_tellerCapture.IsTransactionInProgress)
                                {
                                    AVTCGlobals.TransactionType = TellerCaptureTransactionTypes.ScanItems;
                                    _tellerCapture.TransProofLimit = "0";
                                    //_tellerCapture.TransProofLimit = "99999999999";
                                    dlgInformation.Instance.ShowInfo(string.Format("*** Teller Capture: Processing Bulk TransactionSet SeqNo: {0}...", bulkTranSeqNo));
                                    System.Threading.Thread.Sleep(500);
                                    this._tellerCapture.PhxExternalTransaction = _tlTranSet.TlCaptureInputItems.ToXML(false, true); //Pass readonly as false to allow edits for bulk posting.
                                    if (!_tlTranSet.TlCaptureInputItems.IsTransactionInBalance() || IsTellerCaptureTranOutOfBalance())
                                        this._tellerCapture.InitiateExternalTransaction(false);  // silent mode
                                    else
                                        this._tellerCapture.InitiateExternalTransaction(true);  // silent mode
                                }
                                return true;
                            }

                            try
                            {
                                BringAppToFront();
                                if (picTabs.SelectedIndex != (int)TAB.QuickTran)      //#102719
                                    picTabs.SelectedIndex = (int)TAB.ViewTran;
                                //if ( _tellerCapture != null  )
                                //    _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "DisableTellerCaptureIcon", string.Empty);
                                CreateTlCaptureTranSet(transactionData, true);
                                if (IsTellerCaptureTranOutOfBalance())
                                    _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                            }
                            finally
                            {
                                this.Focus();
                            }
                        }
                        finally
                        {
                            dlgInformation.Instance.HideInfo();
                        }
                    }
                    #endregion

                    #region messageType == "AfterAVTCTranPost" || messageType == "CancelTransaction" || messageType == "EndBatch"
                    if (messageType == "AfterAVTCTranPost" || messageType == "CancelTransaction" || messageType == "EndBatch")
                    {
                        BringAppToFront();
                        //if (_tlCaptureBulkOptionClicked && messageType == "CancelTransaction")
                        //    return true;
                        if (_tlCaptureBulkModePosting && messageType == "CancelTransaction")    //#27391
                            return true;

                        if (messageType == "CancelTransaction" || messageType == "EndBatch")
                        {
                            bool tranReset = false;
                            if (messageType == "CancelTransaction") //#140895 - Cancel phoenix tran if transaction once submitted in AVTC
                            {
                                bool afterPost = _tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.Success;
                                //if (_tlTranSet.IsTellerCaptureTran && !_tlCaptureResendingAVTCTran && !afterPost)
                                if (_tlTranSet.IsTellerCaptureTran && !afterPost)
                                {
                                    ResetFlagsAndInitializeTranSet("ClearAllClicked");
                                    tranReset = true;
                                }
                            }

                            if (!_tlCaptureResendingAVTCTran && !tranReset)
                            {
                                SetTellerCaptureFlagForTranSet(false);
                                //SetTellerCaptureCheckOnlyFlagForTranSet(false); //#102719  #102717
                                EnableDisableTellerCaptureTran("SwitchToPhoenixTran");
                            }

                            //if (!_tlCaptureResendingAVTCTran)
                            //{
                            //    SetTellerCaptureFlagForTranSet(false);
                            //    EnableDisableTellerCaptureTran("SwitchToPhoenixTran");
                            //}
                        }
                        if (_tellerCapture != null)
                            _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                        this.UpdateView();
                        this.Focus();
                    }
                    #endregion

                    #region messageType == messageType == "ActionTlrCapSingleRelatedClick" when Phx Tran is in progress
                    if (messageType == "ActionTlrCapSingleRelatedClick" && (IsPhxTranInProgress() || _tlTranSet.IsTellerCaptureTranLoadFailed || _tlTranSet.EnableChecksOnlyTran))  //#102719
                    {
                        string extTransaction = string.Empty;
                        bool suspectTran = false;

                        //#49466
                        if (_tlTranSet != null && _tlTranSet.CurTran != null &&
                            (_tlTranSet.CurTran.TranCode.Value == 500 || _tlTranSet.CurTran.TranCode.Value == 505 || _tlTranSet.CurTran.TranCode.Value == 512 ||
                            _tlTranSet.CurTran.TranCode.Value == 550 || _tlTranSet.CurTran.TranCode.Value == 555)
                           )//#37561
                        {
                            if ((_tlTranSet.CurTran.NetAmt.IsNull) || (_tlTranSet.CurTran.NetAmt != null && _tlTranSet.CurTran.NetAmt.Value == 0))
                            {
                                // 15523 - The transaction amount canot be blank
                                PMessageBox.Show(this, 15523, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                                _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                                return false;
                            }

                        }


                        if (!_tlTranSet.ValidateItemAVTC()) //#50972
                        {
                            PMessageBox.Show(this, 15575, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                            _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                            return false;
                        }

                        if (!_tlTranSet.ValidateItemAVTC((cmbOnUsTc.CodeValue != null && !string.IsNullOrEmpty(cmbOnUsTc.Text)) ? Convert.ToInt16(cmbOnUsTc.CodeValue) : Convert.ToInt16(0))) //#50972   //TC900Fix
                        {
                            PMessageBox.Show(this, 15575, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                            _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                            return false;
                        }                      


                        if (IsPhxTranInProgress() && _tlTranSet != null) //#37561
                        {
                            if (_tlTranSet.CurTran != null)
                            {
                                if (_tlTranSet.CurTran.TranAcct != null && _tlTranSet.CurTran.TranAcct.SuspectAcct.Value == 1)
                                    suspectTran = true;

                                if (tellerCaptureMemo && !_tlTranSet.CurTran.PostRealTime.IsNull && _tlTranSet.CurTran.PostRealTime.Value == 1) //#50964
                                    doNOTAllowAVTCScan = true;     
                            }
                            if (!suspectTran && _tlTranSet.Transactions != null)
                            {
                                foreach (TlTransaction tran in _tlTranSet.Transactions)
                                {
                                    if (tran.TranAcct != null && tran.TranAcct.SuspectAcct.Value == 1)
                                    {
                                        suspectTran = true;
                                        //break;    #50964
                                    }

                                    if (tellerCaptureMemo && !tran.PostRealTime.IsNull && tran.PostRealTime.Value == 1) //#50964
                                        doNOTAllowAVTCScan = true;
                                }
                            }
                            if (suspectTran)
                            {
                                //15272 - Please resolve the invalid account(s) prior to starting the teller capture transaction.
                                PMessageBox.Show(this, 15272, MessageType.Error, MessageBoxButtons.OK, string.Empty);
                                _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                                return false;
                            }

                            if (doNOTAllowAVTCScan)       //#50964
                            {
                                //15576 - The current Teller Capture process mode will not allow one or more real-time enabled transactions in the transaction set.
                                PMessageBox.Show(this, 15576, MessageType.Error, MessageBoxButtons.OK, string.Empty);
                                _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                                return false;
                            }
                        }

                        if (_tellerCapture.IsTransactionInProgress || IsPhxTranInProgress() || _tlTranSet.IsTellerCaptureTranLoadFailed || _tlTranSet.EnableChecksOnlyTran) //#102719
                        {
                            if (_tellerCapture != null)
                            {
                                using (new WaitCursor())
                                {
                                    if (_tellerCapture.ForceEOBPending) //#29457-2
                                    {
                                        //14761 - Please close your AVTC batch by manually completing an \'EOB\' before you proceed.
                                        PMessageBox.Show(this, 14761, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                                        _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                                        return false;
                                    }
                                    _tlCaptureBulkOptionClicked = false;
                                    //if (this._tellerCapture.IsTransactionInProgress)
                                    //{
                                    //    try
                                    //    {
                                    //        _tlCaptureResendingAVTCTran = true;
                                    //        //bool isTellerCaptureTranPrevValue = _tlTranSet.IsTellerCaptureTran;
                                    //        if (!IsTellerCaptureTranOutOfBalance() || _tlTranSet.IsTellerCaptureTranLoadFailed)
                                    //            HandleCancelAVTCTransaction(true);
                                    //        else
                                    //            HandleCancelAVTCTransaction(false);
                                    //        //SetTellerCaptureFlagForTranSet(isTellerCaptureTranPrevValue);
                                    //        //_tlTranSet.IsTellerCaptureTran = isTellerCaptureTranPrevValue;
                                    //    }
                                    //    finally
                                    //    {
                                    //        _tlCaptureResendingAVTCTran = false;
                                    //    }
                                    //    System.Threading.Thread.Sleep(500);
                                    //}
                                    try
                                    {
                                        bool afterPost = _tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.Success;

                                        if (!afterPost)
                                            CollectCheckInfoForChkPrinting(true);
                                        //for bulk case turn off reconcling if we are going for the first time

                                        if (_tlTranSet.EnableChecksOnlyTran && !_tlTranSet.IsTellerCaptureCheckOnlyTran)    //#109176
                                        {
                                            if (_quickTranWindow != null && _quickTranWindow.TranSet.Checks.Count > 0)
                                            {
                                                //16211 - Transit Checks/Checks As Cash/On-Us Checks must be captured using teller capture.
                                                PMessageBox.Show(this, 16211, MessageType.Error, MessageBoxButtons.OK, string.Empty);

                                                dlgInformation.Instance.HideInfo();
                                                _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                                                this.UpdateView();
                                                this.Focus();
                                                return true;
                                            }
                                        }

                                        if (!_tlTranSet.PrepareTlCaptureInputFromPhxTranSet())
                                        {
                                            ProcessResponses(null);
                                            WriteToDebugLog("Teller Capture: Failed to execute PrepareTlCaptureInputFromPhxTranSet ");
                                            return false;
                                        }
                                        this._tellerCapture.CurForm = this;
                                        //if (picTabs.SelectedIndex != (int)TAB.QuickTran)    //#102717
                                        //{
                                        //    _tlTranSet.IsTellerCaptureCheckOnlyTran = false;
                                        //    _tlTranSet.TlCaptureChecksOnlyItems.Clear();
                                        //}

                                        //TODO - set the silent mode based on  _tlCaptureAVTCSilentMode
                                        //_tlCaptureAVTCSilentMode = true && _tlCaptureAVTCSilentMode;

                                        if (this._tellerCapture.IsTransactionInProgress)
                                        {
                                            try
                                            {
                                                _tlCaptureResendingAVTCTran = true;
                                                if (_tlTranSet.EnableChecksOnlyTran && !_tlTranSet.CaptureAllCheckTranItems)   //#102717
                                                    _tlCaptureResendingAVTCTran = false;
                                                //bool isTellerCaptureTranPrevValue = _tlTranSet.IsTellerCaptureTran;
                                                if (_tlTranSet.EnableChecksOnlyTran && !_tlTranSet.CaptureAllCheckTranItems)   //#102717
                                                    HandleCancelAVTCTransaction(false, !afterPost);
                                                else
                                                {
                                                    if ((!IsTellerCaptureTranOutOfBalance() || _tlTranSet.IsTellerCaptureTranLoadFailed) && !afterPost)
                                                    {
                                                        bool revisitTran = HandleCancelAVTCTransaction(true, true);
                                                        if (revisitTran)
                                                        {
                                                            return true;
                                                        }
                                                    }
                                                    else
                                                        HandleCancelAVTCTransaction(false, true);
                                                }
                                                //SetTellerCaptureFlagForTranSet(isTellerCaptureTranPrevValue);
                                                //_tlTranSet.IsTellerCaptureTran = isTellerCaptureTranPrevValue;
                                            }
                                            finally
                                            {
                                                _tlCaptureResendingAVTCTran = false;
                                            }
                                            System.Threading.Thread.Sleep(500);
                                        }
                                        if (_tlTranSet.EnableChecksOnlyTran && !_tlTranSet.CaptureAllCheckTranItems)
                                        {
                                            AVTCGlobals.TransactionType = TellerCaptureTransactionTypes.ChecksOnly;
                                            _tellerCapture.TransProofLimit = "99999999999";
                                            if (_tlTranSet.TlCaptureOnValidateItems != null && _tlTranSet.TlCaptureOnValidateItems.Count > 0)
                                                _tlTranSet.TlCaptureOnValidateItems.Clear();
                                        }
                                        this._tellerCapture.PhxExternalTransaction = _tlTranSet.TlCaptureInputItems.ToXML(false, false);
                                        if (!_tellerCapture.IsTransactionInProgress)
                                        {
                                            //Start New External Transaction
                                            dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(14390));
                                            AVTCGlobals.TransactionType = TellerCaptureTransactionTypes.ScanItems;
                                            _tellerCapture.TransProofLimit = "0";
                                            if (_tlTranSet.EnableChecksOnlyTran && !_tlTranSet.CaptureAllCheckTranItems)
                                            {
                                                AVTCGlobals.TransactionType = TellerCaptureTransactionTypes.ChecksOnly;
                                                _tellerCapture.TransProofLimit = "99999999999";
                                                if (_tlTranSet.TlCaptureOnValidateItems != null && _tlTranSet.TlCaptureOnValidateItems.Count > 0)
                                                    _tlTranSet.TlCaptureOnValidateItems.Clear();
                                            }
                                            string errorTextExt = this._tellerCapture.InitiateExternalTransaction(_tlCaptureAVTCSilentMode);
                                            if (!string.IsNullOrEmpty(errorTextExt))
                                            {
                                                MessageBox.Show("Cannot start AVTC transaction, please try again..."); //#56225 - Fixed typo on the message text
                                            }
                                            //showAVTCWaitDialog = true;    //#129853
                                        }
                                        return true;
                                    }
                                    catch
                                    {
                                        //14436 - Unable to initiate teller capture external transaction.
                                        PMessageBox.Show(this, 14436, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                                        return false;
                                    }
                                    finally
                                    {
                                        if (this._tellerCapture.IsTransactionInProgress)
                                        {
                                            this.UpdateView();
                                        }
                                        dlgInformation.Instance.HideInfo();
                                    }
                                }
                            }
                        }
                        else
                        {
                            //14387 - The AVTC transaction is not in progress. Please select a scan option from the flyout menu.
                            PMessageBox.Show(this, 14387, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                            return false;
                        }
                    }
                    #endregion

                    #region messageType == "ActionTlrCapSingleRelatedClick"  when Phx Tran is NOT in progress
                    if (messageType == "ActionTlrCapSingleRelatedClick" && !IsPhxTranInProgress())
                    {
                        AVTCGlobals.TransactionType = TellerCaptureTransactionTypes.ScanItems;
                        _tellerCapture.TransProofLimit = "0";

                        if (picTabs.SelectedIndex == (int)TAB.QuickTran)   //#102719
                        {
                            if (_tlTranSet == null || !_tlTranSet.EnableChecksOnlyTran)
                            {
                                if (_tlTranSet.TellerVars.IsAppOnline && _tlTranSet.TellerVars.IsTellerCaptureEnabled)
                                {
                                    //#16195 - Please complete customer search prior to invoking Teller Capture Checks Only transaction.
                                    PMessageBox.Show(this, 16195, MessageType.Message, MessageBoxButtons.OK, string.Empty);
                                }
                                dlgInformation.Instance.HideInfo();
                                _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                                this.UpdateView();
                                this.Focus();
                                return true;
                            }
                            if (_tlTranSet.EnableChecksOnlyTran && !_tlTranSet.CaptureAllCheckTranItems)
                            {
                                AVTCGlobals.TransactionType = TellerCaptureTransactionTypes.ChecksOnly;
                                _tellerCapture.TransProofLimit = "99999999999";
                                //if (_tlTranSet.TlCaptureOnValidateItems != null && _tlTranSet.TlCaptureOnValidateItems.Count > 0)
                                //    _tlTranSet.TlCaptureOnValidateItems.Clear();
                            }
                        }

                        StartTellerCaptureTran();
                        _tlCaptureBulkOptionClicked = false;
                        //showAVTCWaitDialog = true;    //#129853

                    }
                    #endregion

                    #region messageType == "ActionTlrCapBulkClick"
                    if (messageType == "ActionTlrCapBulkClick")
                    {
                        if (_tlTranSet.IsTellerQuickTran || picTabs.SelectedIndex == (int)TAB.QuickTran)    //#102719
                        {
                            //#16194 - The Bulk Unrelated teller capture transaction type is not supported on the Quick Transaction tab.
                            PMessageBox.Show(this, 16194, MessageType.Message, MessageBoxButtons.OK, string.Empty);
                            dlgInformation.Instance.HideInfo();
                            _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                            this.UpdateView();
                            this.Focus();
                            return true;
                        }

                        AVTCGlobals.TransactionType = TellerCaptureTransactionTypes.Bulk;
                        //AVTCGlobals.TransactionType = TellerCaptureTransactionTypes.ScanItems;   //hack
                        _tellerCapture.TransProofLimit = "99999999999";
                        //_tellerCapture.TransProofLimit = string.Empty;
                        _tlCaptureBulkOptionClicked = true;
                        //AVTCGlobals.TransactionType = TellerCaptureTransactionTypes.ScanItems;
                        StartTellerCaptureTran();
                        //showAVTCWaitDialog = true;    //#129853
                    }
                    #endregion

                    #region messageType == "LockHostApp"
                    if (messageType == "LockHostApp")
                    {
                        Phoenix.Windows.Client.Helper.ShowInfoInDialogMode("Waiting for AVTC...", Keys.Control | Keys.K, (S) => { _tellerCapture.MakeAVTCVisible(true); }); //#129853
                    }
                    #endregion

                    #endregion
                }

                finally
                {
                    if (!_tlCaptureResendingAVTCTran)
                        _tlCaptureAVTCSilentMode = false;
                    //#129853
                    //showAVTCWaitDialog = false; // wait for "LockHostApp"
                    //if (showAVTCWaitDialog)
                    //    Phoenix.Windows.Client.Helper.ShowInfoInDialogMode("Waiting for AVTC...", Keys.Control | Keys.K);
                }

                return true;
            }
            #endregion

            #region Savings Bond
            if (messageId == (int)bondAction.GlobalActionId) //#29211
            {
                if (paramList.Length > 0)
                {
                    messageType = Convert.ToString(paramList[0]);
                }
                WriteToDebugLog("*** ChildAction: ProcessMessage : messageType = " + messageType);

                if (messageType == "SavingsBondRedemption")
                {
                    if ((cmbTranCode.CodeValue.ToString() == "912" || cmbTranCode.CodeValue.ToString() == "921"))
                    {
                        CallOtherForms("SavingsBond");
                        return true;
                    }
                    else
                        return false;
                }
            }
            #endregion

            #region OnlinePost
            /*begin #60716*/
            if (messageId == (int)GlobalActions.Transaction)
            {
                try
                {
                    CallOtherForms("TransactionPost");
                }
                catch
                {
                }
            }
            /*End #60716*/
            #endregion
            #region AutoTranfer
            /*begin #60713*/
            if (messageId == (int)GlobalActions.AutoTransfers)
            {
                try
                {
                    CallOtherForms("AutoTransfers");
                }
                catch
                {
                }
            }
            /*End #60713*/
            /*begin #63426*/
            if (messageId == (int)GlobalActions.Images)
            {
                try
                {
                    CallOtherForms("Images");
                }
                catch
                {
                }
            }
            /*End #63426*/
            #endregion
            //Begin #60722
            #region Define Relation of MDI
            if (messageId == (int)GlobalActions.Relations)
            {
                try
                {
                    CallOtherForms("Relations");
                }
                catch
                {
                }
            }
            #endregion Define Relation
            //End #60722        
            //Begin 60698
            else if ((int)GlobalActions.Household == messageId)
            {
                _sHouseHoldMember = Convert.ToString(this.Workspace.Variables["HouseholdMember"]);
                if (_sHouseHoldMember == "Y")
                {
                    if (CoreService.UIAccessProvider.HasWriteAccess(Shared.Constants.ScreenId.NewEditHousehold))
                    {
                        CallOtherForms("HouseholdMember");
                    }
                    else
                    {
                        CallOtherForms("HouseholdSearch");
                    }
                }
                else
                {
                    CallOtherForms("HouseholdSearch");
                }
                return true; // 7916
            }
            //End 60698         

            return base.ProcessMessage(messageId, sender, eArg, paramList);
        }

        private bool IsTellerCaptureTranOutOfBalance()
        {
            if (this.dfDifference.UnFormattedValue != null && Convert.ToDecimal(this.dfDifference.UnFormattedValue) != 0 && _tellerCapture != null)
                return true;
            else
                return false;
        }

        private bool HandleCancelAVTCTransaction(bool revisitTran)
        {
            return HandleCancelAVTCTransaction(revisitTran, false);
        }

        private bool HandleCancelAVTCTransaction(bool revisitTran, bool skipSendMsg)
        {
            WriteToDebugLogDetailed("Inside HandleCancelAVTCTransaction.", true);
            if (_tellerCapture == null)
                return revisitTran;

            //Begin #40977
            if (!TellerVars.Instance.IsTellerCaptureEnabled)
                return revisitTran;
            //End #40977

            if (!_tellerCapture.IsTransactionInProgress)
                return revisitTran;

            if (_tellerCapture.IsTransactionInProgress && AVTCGlobals.TransactionType == TellerCaptureTransactionTypes.ViewImages)
                return revisitTran;

            decimal chargeAmt = 0;

            if (revisitTran && _tlTranSet.TlCaptureInputItems.GetChargesCount(null, ref chargeAmt) > 0)
                revisitTran = false;

            using (new WaitCursor())
            {
                //Cancel Current Transaction
                if (!revisitTran)
                    dlgInformation.Instance.ShowInfo(CoreService.Translation.GetUserMessageX(14389));
                try
                {

                    if (revisitTran)
                    {
                        WriteToDebugLogDetailed("_tellerCapture.SendPostResults : Failed", true);
                        this._tellerCapture.SendPostResults(PostResultsStatusCode.Failed, "Revisit");
                        WriteToDebugLogDetailed("Waiting for AVTC...", true);
                        Phoenix.Windows.Client.Helper.ShowInfoInDialogMode("Waiting for AVTC...", Keys.Control | Keys.K);
                    }
                    else
                    {
                        try
                        {
                            _tellerCapture.SkipSendMessage = skipSendMsg;
                            WriteToDebugLogDetailed("_tellerCapture.SendPostResults : CancelTran", true);
                            this._tellerCapture.SendPostResults(PostResultsStatusCode.CancelTran, string.Empty);
                        }
                        finally
                        {
                            _tellerCapture.SkipSendMessage = false;
                        }
                    }
                }
                catch
                {
                    //14435 - Unable to cancel current teller capture transaction.
                    PMessageBox.Show(this, 14435, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                }
                finally
                {
                    dlgInformation.Instance.HideInfo();
                    WriteToDebugLogDetailed("Quitting HandleCancelAVTCTransaction.", true);
                }
            }
            return revisitTran;
        }


        private string FormatErrorMessageForAVTC(int errorCode, string errorText)
        {
            if (errorCode == Int32.MinValue)
                return string.Empty;
            if (string.IsNullOrEmpty(errorText))
                return string.Empty;
            //return string.Format(@":{0}: '{0}: {1}'", errorCode.ToString(), errorText);
            return string.Format(@"{0}: {1}", errorCode.ToString(), errorText);
        }

        private void StartTellerCaptureTran()   //ALT+F2
        {
            if (_tellerCapture != null)
            {
                if (_tellerCapture.ForceEOBPending) //#29457
                {
                    //14761 - Please close your AVTC batch by manually completing an \'EOB\' before you proceed.
                    PMessageBox.Show(this, 14761, MessageType.Warning, MessageBoxButtons.OK, string.Empty);
                    _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                    return;
                }

                if (_tellerCapture.IsTransactionInProgress && _tlTranSet != null && !_tlTranSet.IsTellerCaptureTran)
                {
                    dlgInformation.Instance.ShowInfo("Cancelling current AVTC transaction...");
                    WriteToDebugLog("Teller Capture:StartTellerCaptureTran:Cancelling existing transaction..");
                    HandleCancelAVTCTransaction(false);

                }

                using (new WaitCursor())
                {
                    try
                    {
                        dlgInformation.Instance.ShowInfo("Start new AVTC transaction...");
                        this._tellerCapture.CurForm = this;
                        string errorText = this._tellerCapture.StartTransaction();
                        if (!string.IsNullOrEmpty(errorText))
                        {
                            MessageBox.Show("Cannot start AVTC transaction, please try again..."); //#56225 - Fixed typo on the message text
                        }

                    }
                    finally
                    {
                        //#129853 - made unconditional
                        //if (this._tellerCapture.IsTransactionInProgress)
                        //{
                        this.UpdateView();
                        //}
                        dlgInformation.Instance.HideInfo();
                        this.Focus();
                    }
                }
            }
        }

        private void BringAppToFront()
        {
            Phoenix.Windows.Client.Helper.ShowInfoInDialogMode(null);

            //picTabs.SelectedIndex = 1;

            this.Enabled = true;
            this.TopMost = true;
            if (PApplication.Instance.MdiMain is Control)
                (PApplication.Instance.MdiMain as Control).Focus();
            this.Focus();
            this.BringToFront();
            SetFocusOnForm();
        }
        //End #140895
        #endregion

        //Begin #140895-ReadOnly
        private void SetTellerCaptureReadOnlyFields()
        {
            if (_tellerCaptureReadOnlyFields == null)
            {
                _tellerCaptureReadOnlyFields = new ArrayList();
                _tellerCaptureReadOnlyFields.Add(cmbAcctType);
                _tellerCaptureReadOnlyFields.Add(dfAcctNo);

                _tellerCaptureReadOnlyFields.Add(dfQuickTranCode);
                _tellerCaptureReadOnlyFields.Add(cmbTranCode);
                _tellerCaptureReadOnlyFields.Add(lblItems);    //#126128
                _tellerCaptureReadOnlyFields.Add(dfCheckNo);    //#126128

                _tellerCaptureReadOnlyFields.Add(cmbTfrAcctType);
                _tellerCaptureReadOnlyFields.Add(dfTfrAcctNo);
                _tellerCaptureReadOnlyFields.Add(cbTfrPbPresent);
                _tellerCaptureReadOnlyFields.Add(lblCheck);
                _tellerCaptureReadOnlyFields.Add(dfTfrCheckNo);
                _tellerCaptureReadOnlyFields.Add(lblOnUsTc);
                _tellerCaptureReadOnlyFields.Add(cmbOnUsTc);

                _tellerCaptureReadOnlyFields.Add(lblTlItemAcctNo);
                _tellerCaptureReadOnlyFields.Add(dfTlItemAcctNo);
                _tellerCaptureReadOnlyFields.Add(lblTlItemRoutingNo);
                _tellerCaptureReadOnlyFields.Add(dfTlItemRoutingNo);
                _tellerCaptureReadOnlyFields.Add(lblTlItemCheckNo);
                _tellerCaptureReadOnlyFields.Add(dfTlItemCheckNo);

                foreach (Control amtField in amtFields)
                {
                    _tellerCaptureReadOnlyFields.Add(amtField);
                }

            }
        }

        private void EnableDisableTellerCaptureTran(string origin)
        {
            if (!TellerVars.Instance.IsTellerCaptureEnabled)
                return;

            WriteToDebugLog("Teller Capture: EnableDisableTellerCaptureTran - origin =" + origin);

            if (!_tlTranSet.IsTellerCaptureTran)
            {
                int defaultTab = IsLoadCustSummary() ? 2 : 0;

                defaultTab = ((_tlTranSet.EnableChecksOnlyTran || _tlTranSet.IsTellerQuickTran) ? (int)TAB.QuickTran : defaultTab);  //#102719

                if (origin == "SwitchToPhoenixTran" || origin == "FormCreate")
                {
                    if (origin == "SwitchToPhoenixTran")
                    {

                        Name2.IsDisabled = false;
                        if (!IsPhxTranInProgress())
                        {
                            picTabs.SelectedIndex = defaultTab;
                            if (!_tlTranSet.CurTran.TranAcct.AcctNo.IsNull || !_tlTranSet.CurTran.TranCode.IsNull)
                                ResetFlagsAndInitializeTranSet("ClearAllClicked");
                        }
                        else if (!_tlTranSet.IsTellerCaptureCheckOnlyTran)  //#102717
                        {
                            if (_tlTranSet.CurTran.TranIndex.Value < 0)   // unsaved tran
                            {
                                picTabs.SelectedIndex = 0;
                            }
                            else if (ctwTranSet.Count > 0)
                            {
                                //ctwTranSet.ContextRow = 0;
                                SelectTran(-1);
                            }
                            else
                            {
                                picTabs.SelectedIndex = 0;
                            }
                        }
                    }
                    if (picTabs.SelectedIndex == 0 || origin == "FormCreate" || origin == "ClearAllClicked")
                    {
                        ActionAddNext.Enabled = true;
                        if (_clearAllActionLabel != null)
                            pbClearAll.MLInfo.Label = _clearAllActionLabel;

                        cmbAcctType.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Enable);
                        dfAcctNo.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Enable);
                        dfQuickTranCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Enable);
                        cmbTranCode.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.Enable);
                        if (origin == "ClearAllClicked")
                        {
                            picTabs.SelectedIndex = defaultTab;
                        }
                    }

                }
                return;
            }

            if (origin == "SelectTran" || origin == "TabClicked" ||
                origin == "CreateTranSet" || origin == "TabSelectingInputTransaction")
            {
                if (picTabs.SelectedIndex == 0 || origin == "CreateTranSet" || origin == "TabSelectingInputTransaction")
                {
                    if (origin == "TabClicked" || origin == "TabSelectingInputTransaction")
                    {
                        if (dfAmt.PhoenixUIControl.BusObjectProperty != _tlTranSet.CurTran.NetAmt)  // pointing to different tran or empty tran
                        {
                            try
                            {
                                dlgInformation.Instance.ShowInfo("Loading Transaction...");
                                pbSelectTran_Click(null, null);
                            }
                            finally
                            {
                                dlgInformation.Instance.HideInfo();
                            }
                        }
                    }

                    SetTellerCaptureReadOnlyFields();
                    for (int i = 0; i < _tellerCaptureReadOnlyFields.Count; i++)
                    {
                        IPhoenixUI tempUIControl = _tellerCaptureReadOnlyFields[i] as IPhoenixUI;
                        if (tempUIControl != null)
                            tempUIControl.SetObjectStatus(NullabilityState.Default, VisibilityState.Default, EnableState.DisableShowText);

                    }
                    //MakeReadOnly(false);

                }
                else if (prevTabSelection == 0 && origin == "TabClicked")
                {
                    if (!_creatingTlCaptureTranSet)
                    {
                        //OnActionAddNext();
                        //ctwTranSet_SelectedIndexChanged(null, null); // set the focus corrcetly to selected tran in the view tran tab since the add next could have messed up
                        MoveMiscScreensToObject(miscTCFields);
                        MoveMiscScreensToObject(miscAcctFields);
                        int prevContexRow = ctwTranSet.ContextRow;
                        PopulateTransetTable();
                        if (prevContexRow >= 0)
                        {
                            ctwTranSet.SelectRow(prevContexRow);
                            ctwTranSet.ContextRow = prevContexRow;
                            ctwTranSet_SelectedIndexChanged(null, null);
                        }
                    }
                }
            }
            if (picTabs.SelectedIndex == 0)
            {
                ActionAddNext.Enabled = false;
                pbCashIn.Enabled = _tlTranSet.CurTran.CashIn.Value > 0;
                pbCashOut.Enabled = _tlTranSet.CurTran.CashOut.Value > 0;
                pbItemCapture.Enabled = _tlTranSet.CurTran.ItemCount.Value > 0;
                pbGetAcct.Enabled = false;
            }
            else if (picTabs.SelectedIndex == 1)
            {
                pbRemoveTran.Enabled = false;

                pbItemCapture.Visible = true;
                pbItemCapture.Enabled = _tlTranSet.CurTran.ItemCount.Value > 0;
                pbFees.Visible = true;
                //pbFees.Enabled = _tlTranSet.CurTran.CcAmt.Value > 0;
                pbFees.Enabled = _tlTranSet.IsCompVisible(_tlTranSet.CurTran.CcAmt.XmlTag);
                pbCashIn.Visible = true;
                pbCashIn.Enabled = _tlTranSet.CurTran.CashIn.Value > 0;
                pbCashOut.Visible = true;
                pbCashOut.Enabled = _tlTranSet.CurTran.CashOut.Value > 0;

                pbClearAll.Visible = true;



                ctwTranSet.Enabled = true;

            }
            else if (picTabs.SelectedIndex == 3)
            {
                pbSelectAcct.Enabled = false;
                pbSelectRIM.Enabled = false;
            }

            Name2.IsDisabled = true;
            if (_clearAllActionLabel == null)
            {
                _clearAllActionLabel = pbClearAll.MLInfo.Label;
            }
            pbClearAll.MLInfo.Label = "Canc&el";
            //pbClearAll.ImageButton.Text =


        }
        //End #140895-ReadOnly

        //Begin #140895 - RP
        private void CreateTlCaptureTranSet(string transactionData, bool firstTimeCall)
        {
            ctwTranSet.ResetTable();

            if (firstTimeCall)
            {
                if (CoreService.LogPublisher.IsLogEnabled)
                {
                    CoreService.LogPublisher.LogInfo(transactionData);
                }
            }

            int retStatus = IdentifyAndValidateTlCaptureTranSet(transactionData, firstTimeCall);

            if (retStatus == 0)     //Success
            {
                PopulateTransetTable();
                //ctwTranSet.SelectedItems.Clear();
                //ctwTranSet.SelectedIndicies.Clear();
                if (ctwTranSet.Count > 0)
                {
                    ctwTranSet.SelectRow(0);
                    ctwTranSet.ContextRow = 0;
                    ctwTranSet_SelectedIndexChanged(null, null);
                }
                //picTabs.SelectedIndex = 1;
                EnableDisableTellerCaptureTran("CreateTranSet");
                if (IsTellerCaptureTranOutOfBalance()) //#140895
                    _tellerCapture.MdiForm.ProcessMessage((int)GlobalActions.TellerCapture, this, null, "EnableTellerCaptureIcon", string.Empty);
                _tlCaptureTranXML = null;
                _tlTranSet.IsTellerCaptureTranLoadFailed = false;
                if (PApplication.Instance.MdiMain is Control)
                    (PApplication.Instance.MdiMain as Control).Focus();
                this.Focus();

                if (picTabs.SelectedIndex != (int)TAB.ViewTran && !_tlTranSet.EnableChecksOnlyTran) //#102719
                    picTabs.SelectedIndex = 1;

                SetFocusOnForm();

                if (_tlCaptureBulkModePosting)
                {
                    OnActionSave(false);
                    return;
                }
            }
            else if (retStatus == 1)  // Failed
            {
                cmbAcctType.CodeValue = null;
                SetAcctNoField(null, dfAcctNo, cmbAcctType,
                    _tlTranSet.CurTran.TranAcct);
                SetQuickTranCodeField(null, null);
                _tlTranSet.Transactions.Clear();
                _tlTranSet.CurTran.CleanUpValues();
                _tlTranSet.CurTran.TranAcct.CleanUpValues(true);
                MoveAmtObjectsToScreen();
                EnableDisableTellerCaptureTran("CreateTranSet");
                _tlCaptureTranXML = null;
                _tlTranSet.IsTellerCaptureTranLoadFailed = true;

                SetFocusOnForm();

                string addlErrorInfo = string.Empty;
                if (_tlCaptureErrorItem != null)
                {
                    addlErrorInfo = _tlTranSet.GetTlCaptureScanItemErrorText(_tlCaptureErrorItem, 0, null);
                    if (!string.IsNullOrEmpty(addlErrorInfo))
                    {
                        addlErrorInfo = @"Please check the following teller capture item(s) for possible errors:
" + addlErrorInfo;

                    }
                }
                //14718 - Failed creating teller transaction set. %1!
                PMessageBox.Show(14718, MessageType.Warning, new string[] { addlErrorInfo });
            }
        }
        private int IdentifyAndValidateTlCaptureTranSet(string transactionData, bool firstTimeCall)
        {

            try
            {
                _creatingTlCaptureTranSet = true;
                Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet"] = _creatingTlCaptureTranSet;
                _triggeredCashInOnPostTlCapture = false;

                bool copyFromOnValidateItems = false;
                bool bulkMode = false;
                string machineName = TellerVars.Instance.TlCaptureWorkstation;  //#111431
                bool reconcile = _tlTranSet.ReconcileTlCaptureTranSet();

                if (machineName != null && machineName.Length > 60)
                    machineName = machineName.Substring(0, 60);

                SetTellerCaptureFlagForTranSet(true);

                if (firstTimeCall)
                {

                    dlgInformation.Instance.ShowInfo("Loading Transaction Data from AVTC...");
                    WriteToDebugLogDetailed("Loading Transaction Data from AVTC...", true);

                    _curCreateTlCaptureTranIndex = -1;
                    _tlCaptureErrorItem = null;
                    if (_popUpWindows != null)
                        _popUpWindows.Clear();

                    if (!reconcile)
                    {
                        if (_tlTranSet.TlCaptureOnValidateItems.Count == 0)
                        {
                            try
                            {
                                WriteToDebugLogDetailed("Calling TlCaptureOnValidateItems.LoadFromXML...", true);
                                if (!_tlTranSet.TlCaptureOnValidateItems.LoadFromXML(transactionData))
                                {
                                    WriteToDebugLog("Teller Capture: Failed to load the XML data  into TlCaptureOnValidateItems");
                                    return 1;   // Failed
                                }
                            }
                            catch (PhoenixException pe)
                            {
                                PMessageBox.Show(pe);
                                WriteToDebugLog("Teller Capture: Failed to load the XML data into TlCaptureOnValidateItems ");
                                return 1;   // Failed
                            }


                            dlgInformation.Instance.ShowInfo("Validating Transaction Data from AVTC...");
                            WriteToDebugLogDetailed("Validating Transaction Data from AVTC...", true);
                            if (!_tlTranSet.ValidateTlCaptureOnValidateItems())
                            {
                                ProcessResponses(null);
                                WriteToDebugLog("Teller Capture: Failed to execute ValidateTlCaptureOnValidateItems");
                                return 1;   //Failed
                            }

                            copyFromOnValidateItems = bulkMode;

                        }
                    }

                    if (!copyFromOnValidateItems)
                    {
                        try
                        {
                            WriteToDebugLogDetailed("Calling TlCaptureScanItems.LoadFromXML...", true);
                            if (!_tlTranSet.TlCaptureScanItems.LoadFromXML(transactionData, true))
                            {
                                WriteToDebugLog("Teller Capture: Failed to load the XML data into TlCaptureScanItems.");
                                return 1;  //Failed
                            }
                        }
                        catch (PhoenixException pe)
                        {
                            PMessageBox.Show(pe);
                            WriteToDebugLog("Teller Capture: Failed to load the XML data into TlCaptureScanItems");
                            return 1;   // Failed
                        }
                    }

                    bool clearExistingTrans = false;
                    dlgInformation.Instance.ShowInfo("Identifying Phoenix Transaction Set...");
                    WriteToDebugLogDetailed("Identifying Phoenix Transaction Set...", true);
                    WriteToDebugLogDetailed("Calling _tlTranSet.LinkTlCaptureScanItems", true);

                    if (CoreService.LogPublisher.DebugLevel == LogLevel.MoreDetailed)
                    {
                        WriteToDebugLogDetailed("_tlTranSet.TlCaptureScanItems Details", true);
                        WriteToDebugLogDetailed(_tlTranSet.TlCaptureScanItems.GetDebugInfo(true), true);
                        // WriteToDebugLogDetailed(_tlTranSet.TlCaptureScanItems.ToXML(false, false ), true);
                        WriteToDebugLogDetailed("_tlTranSet.TlCaptureOnValidateItems Details", true);
                        WriteToDebugLogDetailed(_tlTranSet.TlCaptureOnValidateItems.GetDebugInfo(true), true);
                        //WriteToDebugLogDetailed(_tlTranSet.TlCaptureOnValidateItems.ToXML(false, false), true);
                        WriteToDebugLogDetailed("_tlTranSet.TlCaptureInputItems Details", true);
                        WriteToDebugLogDetailed(_tlTranSet.TlCaptureInputItems.GetDebugInfo(true), true);
                        //WriteToDebugLogDetailed(_tlTranSet.TlCaptureInputItems.ToXML(false, false), true);
                    }

                    if (!_tlTranSet.LinkTlCaptureScanItems(copyFromOnValidateItems, ref clearExistingTrans, _tlTranSet.EnableChecksOnlyTran))   //#102719
                    {
                        ProcessResponses(null);
                        WriteToDebugLog("Teller Capture: Failed to execute LinkTlCaptureScanItems");
                        return 1;   // Failed
                    }

                    WriteToDebugLogDetailed("Called _tlTranSet.LinkTlCaptureScanItems", true);

                    if (CoreService.LogPublisher.DebugLevel == LogLevel.MoreDetailed)
                    {
                        WriteToDebugLogDetailed("_tlTranSet.TlCaptureScanItems Details", true);
                        WriteToDebugLogDetailed(_tlTranSet.TlCaptureScanItems.GetDebugInfo(true), true);
                        WriteToDebugLogDetailed("_tlTranSet.TlCaptureOnValidateItems Details", true);
                        WriteToDebugLogDetailed(_tlTranSet.TlCaptureOnValidateItems.GetDebugInfo(true), true);
                        WriteToDebugLogDetailed("_tlTranSet.TlCaptureInputItems Details", true);
                        WriteToDebugLogDetailed(_tlTranSet.TlCaptureInputItems.GetDebugInfo(true), true);
                    }


                    if (reconcile && _tlTranSet.IncludeCurTranInTlCaptureInput() && _tlTranSet.Transactions.IndexOf(_tlTranSet.CurTran) < 0 &&
                        _tlTranSet.CurTran.TranIndex.Value < 0 && !clearExistingTrans)
                    {
                        _tlTranSet.CurTran.AcctType.Value = _tlTranSet.CurTran.TranAcct.AcctType.Value;
                        _tlTranSet.CurTran.AcctNo.Value = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
                        _tlTranSet.CurTran.AcctNickname.Value = _tlTranSet.CurTran.TranAcct.AcctNickname.Value;
                        _tlTranSet.CurTran.RimNo.Value = _tlTranSet.CurTran.TranAcct.RimNo.Value;

                        WriteToDebugLogDetailed("Including current transaction.", true);
                        MoveAmtScreensToObject();
                        MoveMiscScreensToObject(miscTCFields);
                        MoveMiscScreensToObject(miscAcctFields);
                        curTranIndex = _tlTranSet.AddTransaction();    // add the current transaction so that it is not lost while other transactions are getting selected/validated and added again
                        _tlCaptureForceAddNextForLastTran = true;
                    }
                    else
                        _tlCaptureForceAddNextForLastTran = false;

                    if (clearExistingTrans)
                    {
                        WriteToDebugLogDetailed("Clearing existing transaction.", true);
                        //clean-up the existing form by cleaning up the acct field
                        cmbAcctType.CodeValue = null;
                        cmbAcctType_Validating(this, new CancelEventArgs());
                        //map the new cur tran to the fields.
                        MapFieldToObject();
                    }

                    _tlCaptureTranXML = transactionData;
                }



                for (int tranIndex = 0; tranIndex < _tlTranSet.TlCaptureScanItems.TellerTranCount; tranIndex++)
                {
                    if (tranIndex < _curCreateTlCaptureTranIndex)
                        continue;


                    bool doSelectTran = reconcile && tranIndex < _tlTranSet.Transactions.Count;
                    bool doAddNext = !doSelectTran;

                    _curCreateTlCaptureTranIndex = tranIndex;

                    dlgInformation.Instance.ShowInfo(string.Format("Creating and Validating Transaction {0}...", tranIndex + 1));
                    WriteToDebugLogDetailed(string.Format("Creating and Validating Transaction {0}...", tranIndex + 1), true);

                    for (int i = 0; i < _tlTranSet.TlCaptureScanItems.Count; i++)
                    {
                        #region create transaction
                        TlCaptureScanItem tlCaptureItem = _tlTranSet.TlCaptureScanItems[i];
                        if (tlCaptureItem.TranIndex == tranIndex)
                        {
                            decimal transitItemTotal = 0;
                            decimal onUsChkTotal = 0;
                            decimal cashInTotal = 0;
                            decimal cashOutTotal = 0;
                            decimal chksAsCashItemTotal = 0;

                            _tlCaptureErrorItem = tlCaptureItem;

                            if (true)    //(_tlTranSet.TlCaptureScanItems.ItemTran == tranIndex)
                            {
                                _tlTranSet.TlCaptureScanItems.GetTransitChecksCount(tlCaptureItem.ScanISN, ref transitItemTotal);
                                _tlTranSet.TlCaptureScanItems.GetOnUsChecksCount(tlCaptureItem.ScanISN, ref onUsChkTotal);
                                _tlTranSet.TlCaptureScanItems.GetChksAsCashCount(tlCaptureItem.ScanISN, ref chksAsCashItemTotal);
                            }
                            if (true)  // (_tlTranSet.TlCaptureScanItems.CashInTran == tranIndex)
                            {
                                _tlTranSet.TlCaptureScanItems.GetCashInCount(tlCaptureItem.ScanISN, ref cashInTotal);
                            }
                            if (true) // (_tlTranSet.TlCaptureScanItems.CashOutTran == tranIndex)
                            {
                                _tlTranSet.TlCaptureScanItems.GetCashOutCount(tlCaptureItem.ScanISN, ref cashOutTotal);
                            }

                            CancelEventArgs e = new CancelEventArgs();
                            int selectTranTranIndex = -1;
                            FieldBase tranNetAmtProperty = null;

                            if (tranIndex < _tlTranSet.Transactions.Count)
                                selectTranTranIndex = (_tlTranSet.Transactions[tranIndex] as TlTransaction).TranIndex.Value;

                            if (selectTranTranIndex == _tlTranSet.CurTran.TranIndex.Value)
                                tranNetAmtProperty = _tlTranSet.CurTran.NetAmt;

                            if (_tlCaptureForceAddNextForLastTran && tranIndex == _tlTranSet.Transactions.Count - 1)
                            {
                                WriteToDebugLogDetailed("Doing _tlCaptureForceAddNextForLastTran block", true);
                                _tlCaptureForceAddNextForLastTran = false;
                                doSelectTran = false;
                                if (dfAmt.PhoenixUIControl.BusObjectProperty != tranNetAmtProperty && selectTranTranIndex >= 0)
                                    SelectTran(selectTranTranIndex);
                                doAddNext = true;
                            }

                            if (doSelectTran && dfAmt.PhoenixUIControl.BusObjectProperty == tranNetAmtProperty)
                            {
                                doSelectTran = false;   // transaction is already selected
                                doAddNext = true;
                            }

                            if (doSelectTran && selectTranTranIndex < 0)
                            {
                                doSelectTran = false;
                                doAddNext = true;
                            }

                            if (!tlCaptureItem.UICompValidated.AcctValidated)
                            {
                                if (doSelectTran)
                                {
                                    doSelectTran = false;
                                    WriteToDebugLogDetailed("Doing select tran due to doSelectTran. Location 1", true);
                                    SelectTran(selectTranTranIndex);
                                    doAddNext = true;
                                }

                                _tlTranSet.CurTran.TranAcct.CachedAcctDetails = tlCaptureItem.TlAcctDetails;

                                //tlCaptureItem.TlAcctDetails = null; //Strictly for testing purpose only
                                cmbAcctType.CodeValue = tlCaptureItem.TlAcctDetails.AcctType.Value;
                                WriteToDebugLogDetailed("Calling cmbAcctType_Validating.", true);
                                cmbAcctType_Validating(this, e);
                                if (e.Cancel)
                                {
                                    WriteToDebugLog("Teller Capture: Failed to execute cmbAcctType_Validating");
                                    return 1;   //Failed
                                }


                                dfAcctNo.Text = tlCaptureItem.TlAcctDetails.AcctNo.Value;
                                WriteToDebugLogDetailed("Calling dfAcctNo_PhoenixUIValidateEvent.", true);
                                dfAcctNo_PhoenixUIValidateEvent(this, new PCancelEventArgs(e));
                                if (e.Cancel)
                                {
                                    WriteToDebugLog("Teller Capture: Failed to execute dfAcctNo_PhoenixUIValidateEvent");
                                    return 1;  //Failed
                                }

                                _tlTranSet.CurTran.TranAcct.CachedAcctDetails = null;
                                tlCaptureItem.UICompValidated.AcctValidated = true;
                                if (!CheckForPopUpWindows())
                                {
                                    WriteToDebugLog("Teller Capture: Quitting due to CheckForPopUpWindows in AcctValidated ");
                                    return 2;  //In Progress
                                }
                            }

                            if (!tlCaptureItem.UICompValidated.TranCodeValidated)
                            {
                                if (doSelectTran)
                                {
                                    doSelectTran = false;
                                    WriteToDebugLogDetailed("Doing select tran due to doSelectTran. Location 2", true);
                                    SelectTran(selectTranTranIndex);
                                    doAddNext = true;
                                }


                                dfQuickTranCode.Text = tlCaptureItem.AdTlTc.TlTranCode.Value;
                                WriteToDebugLogDetailed("Calling SetQuickTranCodeField.", true);
                                if (!SetQuickTranCodeField(dfQuickTranCode.Text, null))
                                {
                                    WriteToDebugLog("Teller Capture: Failed to execute SetQuickTranCodeField");
                                    return 1;  //Failed
                                }

                                tlCaptureItem.UICompValidated.TranCodeValidated = true;
                                if (!CheckForPopUpWindows())
                                {
                                    WriteToDebugLog("Teller Capture: Quitting due to CheckForPopUpWindows in TranCodeValidated ");
                                    return 2;  //In Progress
                                }
                            }

                            bool forceItemCheck = reconcile; //&& (tranIndex == 0); // in case of reconcile the items could be deleted making total 0
                            bool forceRecalcItemTotals = forceItemCheck;

                            if (transitItemTotal > 0 || onUsChkTotal > 0 || chksAsCashItemTotal > 0 || forceItemCheck)
                            {
                                if (tlCaptureItem.UICompValidated.ItemsValidated)   //#38280
                                {
                                    if (_tlTranSet.CurTran.Items.Count > 0 && _tlTranSet.TlCaptureScanItems.Count > 0)
                                    {
                                        for (int j = 0; j < _tlTranSet.TlCaptureScanItems.Count; j++)
                                        {
                                            if (_tlTranSet.TlCaptureScanItems[j].IsCheckItem() && _tlTranSet.TlCaptureScanItems[j].ParentISN == tlCaptureItem.ScanISN)
                                            {
                                                TlCaptureScanItem checkItem = _tlTranSet.TlCaptureScanItems[j];

                                                foreach (TlItemCapture item in _tlTranSet.CurTran.Items)
                                                {
                                                    if (item.PhxISN.Value == checkItem.PhxISN)
                                                    {
                                                        item.TlCaptureISN.Value = checkItem.ScanISN;
                                                        item.TlCaptureParentISN.Value = checkItem.ScanFirstCRItemISN;
                                                        break;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                                
                                if (!tlCaptureItem.UICompValidated.ItemsValidated)
                                {
                                    if (doSelectTran)
                                    {
                                        doSelectTran = false;
                                        WriteToDebugLogDetailed("Doing select tran due to doSelectTran. Location 3", true);
                                        SelectTran(selectTranTranIndex);
                                        doAddNext = true;
                                    }

                                    _tlTranSet.CurTran.Items.Clear();

                                    for (int j = 0; j < _tlTranSet.TlCaptureScanItems.Count; j++)
                                    {
                                        if (_tlTranSet.TlCaptureScanItems[j].IsCheckItem() && _tlTranSet.TlCaptureScanItems[j].ParentISN == tlCaptureItem.ScanISN)
                                        {
                                            TlCaptureScanItem checkItem = _tlTranSet.TlCaptureScanItems[j];

                                            _tlCaptureErrorItem = checkItem;

                                            if (checkItem.IsOnUsOffset)
                                            {
                                                forceRecalcItemTotals = false;  // do not recalc item totals since standalone os us items should not get totals from the Items collcetion
                                                if (!tlCaptureItem.UICompValidated.OnUsVallidated)
                                                {
                                                    dfOnUsChks.Text = checkItem.Amt.ToString();
                                                    WriteToDebugLogDetailed("Calling dfOnUsChks_PhoenixUIValidateEvent.", true);
                                                    dfOnUsChks_PhoenixUIValidateEvent(this, new PCancelEventArgs(e));
                                                    if (e.Cancel)
                                                    {
                                                        WriteToDebugLog("Teller Capture: Failed to execute dfOnUsChks_PhoenixUIValidateEvent");
                                                        return 1;  //Failed
                                                    }

                                                    if (checkItem.TlAcctDetails.AcctNo.Value != _tlTranSet.CurTran.TfrAcct.AcctNo.Value)
                                                    {
                                                        _tlTranSet.CurTran.TfrAcct.CachedAcctDetails = checkItem.TlAcctDetails;

                                                        cmbTfrAcctType.CodeValue = checkItem.TlAcctDetails.AcctType.Value;
                                                        WriteToDebugLogDetailed("Calling cmbTfrAcctType_Validating.", true);
                                                        cmbTfrAcctType_Validating(this, e);
                                                        if (e.Cancel)
                                                        {
                                                            WriteToDebugLog("Teller Capture: Failed to execute cmbTfrAcctType_Validating");
                                                            return 1;  //Failed
                                                        }


                                                        dfTfrAcctNo.Text = checkItem.TlAcctDetails.AcctNo.Value;
                                                        WriteToDebugLogDetailed("Calling dfTfrAcctNo_PhoenixUIValidateEvent.", true);
                                                        dfTfrAcctNo_PhoenixUIValidateEvent(this, new PCancelEventArgs(e));
                                                        if (e.Cancel)
                                                        {
                                                            WriteToDebugLog("Teller Capture: Failed to execute dfTfrAcctNo_PhoenixUIValidateEvent");
                                                            return 1;  //Failed
                                                        }

                                                        _tlTranSet.CurTran.TfrAcct.CachedAcctDetails = null;
                                                    }

                                                    tlCaptureItem.UICompValidated.OnUsVallidated = true;
                                                }
                                                _tlTranSet.CurTran.TlCaptureTfrISN.Value = checkItem.ScanISN;
                                                _tlTranSet.CurTran.TlCaptureTfrParentISN.Value = checkItem.ScanFirstCRItemISN;
                                            }
                                            else if (checkItem.IsTransitOffset)
                                            {
                                                forceRecalcItemTotals = false;  // do not recalc item totals since standalone transit items should not get totals from the Items collcetion
                                                if (!tlCaptureItem.UICompValidated.TransitValidated)
                                                {

                                                    dfTransitChks.Text = checkItem.Amt.ToString();
                                                    WriteToDebugLogDetailed("Calling dfTransitChks_PhoenixUIValidateEvent.", true);

                                                    dfTransitChks_PhoenixUIValidateEvent(this, new PCancelEventArgs(e));
                                                    if (e.Cancel)
                                                    {
                                                        WriteToDebugLog("Teller Capture: Failed to execute dfTransitChks_PhoenixUIValidateEvent");
                                                        return 1;  //Failed
                                                    }

                                                    dfTlItemAcctNo.SetValue(checkItem.ScanAcctNo);
                                                    dfTlItemRoutingNo.SetValue(checkItem.ScanRoutingNo);
                                                    dfTlItemCheckNo.SetValue(checkItem.ScanCheckNo);

                                                    tlCaptureItem.UICompValidated.TransitValidated = false;
                                                }
                                                _tlTranSet.CurTran.TlCaptureTfrISN.Value = checkItem.ScanISN;
                                                _tlTranSet.CurTran.TlCaptureTfrParentISN.Value = checkItem.ScanFirstCRItemISN;

                                            }
                                            //TlCaptureScanItem checkItem = _tlTranSet.TlCaptureScanItems[j];
                                            else if (checkItem.TlItemCapture != null)
                                            {
                                                checkItem.TlItemCapture.ActionType = XmActionType.None;   // sometimes action type is left as custom causing problem in cloning
                                                checkItem.TlItemCapture.TlCaptureISN.Value = checkItem.ScanISN;
                                                checkItem.TlItemCapture.TlCaptureParentISN.Value = checkItem.ScanFirstCRItemISN;
                                                checkItem.TlItemCapture.TlCaptureAux.Value = checkItem.ScanAux;
                                                if (string.IsNullOrEmpty(checkItem.PhxISN)) //#48926
                                                    checkItem.SetPhxISN();
                                                checkItem.TlItemCapture.PhxISN.Value = checkItem.PhxISN;    //#38280
                                                _tlTranSet.CurTran.Items.Add(checkItem.TlItemCapture.Clone());
                                            }
                                            //if (checkItem.IsOnUsOffset || checkItem.IsTransitOffset)
                                            //{

                                            //    if (_tlTranSet.CurTran.CheckNo.StringValue != tlCaptureItem.ScanCheckNo && !string.IsNullOrEmpty(tlCaptureItem.ScanCheckNo))
                                            //    {
                                            //        dfCheckNo.SetValue(tlCaptureItem.ScanCheckNo);
                                            //    }
                                            //}

                                            //Begin 113334 #126128 - Commented out
                                            //if (_tlTranSet.CurTran.TranCode.Value == 101 && _tlTranSet.CurTran.TranAcct.AcctRecon.Value == GlobalVars.Instance.ML.Y)
                                            //{
                                            //    if (_tlTranSet.CurTran.CheckNo.IsNull && !string.IsNullOrEmpty(checkItem.ScanCheckNo))
                                            //    {
                                            //        _tlTranSet.CurTran.CheckNo.Value = Convert.ToInt32(checkItem.ScanCheckNo);
                                            //        dfCheckNo.ObjectToScreen();
                                            //    }
                                            //}
                                            //End 113334
                                        }
                                    }

                                    _tlCaptureErrorItem = tlCaptureItem;

                                    if (_tlTranSet.CurTran.Items.Count > 0)
                                    {
                                        // calculate float , next day availibilty etc. by silently invoking the item capture window.
                                        Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet_itemValFailed"] = false;
                                        WriteToDebugLogDetailed("Calling ItemCapture form.", true);

                                        CallOtherForms("ItemCapture");
                                        if (Convert.ToBoolean(Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet_itemValFailed"]))
                                        {
                                            WriteToDebugLog("Teller Capture: Failed to execute ItemCapture form launching");
                                            _tlCaptureErrorItem = null; // the item capture window is supposed to display the item.
                                            return 1;  //Failed
                                        }
                                        _tlTranSet.GetItemTotals();
                                        MoveAmtObjectsToScreen();
                                    }
                                    else if (forceRecalcItemTotals)
                                    {
                                        _tlTranSet.GetItemTotals();
                                        MoveAmtObjectsToScreen();
                                    }

                                    tlCaptureItem.UICompValidated.ItemsValidated = true;
                                    if (!CheckForPopUpWindows())
                                    {
                                        WriteToDebugLog("Teller Capture: Quitting due to CheckForPopUpWindows in item validation ");
                                        return 2;  //In Progress
                                    }
                                }
                            }

                            _tlCaptureErrorItem = tlCaptureItem;

                            if (cashInTotal > 0 || reconcile)
                            {

                                if (!tlCaptureItem.UICompValidated.CashInValidated)
                                {
                                    if (doSelectTran)
                                    {
                                        doSelectTran = false;
                                        WriteToDebugLogDetailed("Doing select tran due to doSelectTran. Location 4", true);
                                        SelectTran(selectTranTranIndex);
                                        doAddNext = true;
                                    }

                                    dfCashIn.Text = cashInTotal.ToString();
                                    WriteToDebugLogDetailed("Calling dfCashIn_PhoenixUIValidateEvent.", true);
                                    dfCashIn_PhoenixUIValidateEvent(this, new PCancelEventArgs(e));
                                    if (e.Cancel)
                                    {
                                        WriteToDebugLog("Teller Capture: Failed to execute dfCashIn_PhoenixUIValidateEvent");
                                        return 1;  //Failed
                                    }
                                    tlCaptureItem.UICompValidated.CashInValidated = true;
                                    if (!CheckForPopUpWindows())
                                    {
                                        WriteToDebugLog("Teller Capture: Quitting due to CheckForPopUpWindows in cashInTotal ");
                                        return 2;  //In Progress
                                    }
                                }
                            }

                            if (cashOutTotal > 0 || reconcile)
                            {
                                if (!tlCaptureItem.UICompValidated.CashOutValidated)
                                {
                                    if (doSelectTran)
                                    {
                                        doSelectTran = false;
                                        WriteToDebugLogDetailed("Doing select tran due to doSelectTran. Location 5", true);
                                        SelectTran(selectTranTranIndex);
                                        doAddNext = true;
                                    }

                                    dfCashOut.Text = cashOutTotal.ToString();
                                    WriteToDebugLogDetailed("Calling dfCashOut_PhoenixUIValidateEvent.", true);
                                    dfCashOut_PhoenixUIValidateEvent(this, new PCancelEventArgs(e));
                                    if (e.Cancel)
                                    {
                                        WriteToDebugLog("Teller Capture: Failed to execute dfCashOut_PhoenixUIValidateEvent");
                                        return 1;  //Failed
                                    }

                                    tlCaptureItem.UICompValidated.CashOutValidated = true;
                                    if (!CheckForPopUpWindows())
                                    {
                                        WriteToDebugLog("Teller Capture: Quitting due to CheckForPopUpWindows in cashOutTotal ");
                                        return 2;  //In Progress
                                    }
                                }
                            }

                            if (!tlCaptureItem.UICompValidated.AmtValidated)
                            {
                                if (doSelectTran)
                                {
                                    doSelectTran = false;
                                    WriteToDebugLogDetailed("Doing select tran due to doSelectTran. Location 6", true);
                                    SelectTran(selectTranTranIndex);
                                    doAddNext = true;
                                }

                                dfAmt.Text = tlCaptureItem.Amt.ToString();
                                WriteToDebugLogDetailed("Calling dfAmt_PhoenixUIValidateEvent.", true);
                                dfAmt_PhoenixUIValidateEvent(this, new PCancelEventArgs(e));
                                if (e.Cancel)
                                {
                                    WriteToDebugLog("Teller Capture: Failed to execute dfAmt_PhoenixUIValidateEvent");
                                    return 1;  //Failed
                                }

                                tlCaptureItem.UICompValidated.AmtValidated = true;
                                if (!CheckForPopUpWindows())
                                {
                                    WriteToDebugLog("Teller Capture: Quitting due to CheckForPopUpWindows in AmtValidated ");
                                    return 2;  //In Progress
                                }
                            }
                            //picTabs.SelectedIndex = 0;
                            //return true;
                            if (_tlTranSet.CurTran.TranCode.Value == 900)
                            {
                                //#56734
                                //_tlTranSet.ReCalcNetAmt(_tlTranSet.CurTran);
                                _tlTranSet.CurTran.NetAmt.Value = _tlTranSet.ReCalcNetAmt(_tlTranSet.CurTran);
                                dfAmt.ObjectToScreen();
                            }

                            if (_tlTranSet.CurTran.TranCode.Value == 154 || _tlTranSet.CurTran.TranCode.Value == 350 || _tlTranSet.CurTran.TranCode.Value == 101)    //#28497 //#126128 - added TC101
                            {
                                if (_tlTranSet.CurTran.CheckNo.StringValue != tlCaptureItem.ScanCheckNo && !string.IsNullOrEmpty(tlCaptureItem.ScanCheckNo))
                                {
                                    if ((_tlTranSet.CurTran.TranCode.Value == 101 && _tlTranSet.CurTran.TranAcct.AcctRecon.Value == GlobalVars.Instance.ML.Y) ||
                                        _tlTranSet.CurTran.TranCode.Value == 154 || _tlTranSet.CurTran.TranCode.Value == 350) //#126128
                                        dfCheckNo.SetValue(tlCaptureItem.ScanCheckNo);
                                }
                            }

                            WriteToDebugLogDetailed("Setting the ISN #s.", true);

                            _tlTranSet.CurTran.TlCaptureISN.Value = tlCaptureItem.ScanISN;
                            _tlTranSet.CurTran.TlCaptureParentISN.Value = tlCaptureItem.ScanFirstCRItemISN;
                            if (!string.IsNullOrEmpty(tlCaptureItem.ScanTranNo))
                                _tlTranSet.CurTran.TlCaptureTranNo.Value = Convert.ToInt32(tlCaptureItem.ScanTranNo);
                            if (!string.IsNullOrEmpty(tlCaptureItem.ScanBatchId))
                                _tlTranSet.CurTran.TlCaptureBatchId.Value = Convert.ToInt32(tlCaptureItem.ScanBatchId);

                            if (_tlTranSet.CurTran.TranCode.Value == 900)
                            {
                                if (string.IsNullOrEmpty(tlCaptureItem.ScanTranNo) || string.IsNullOrEmpty(tlCaptureItem.ScanBatchId))
                                {
                                    for (int j = 0; j < _tlTranSet.TlCaptureScanItems.Count; j++)
                                    {
                                        if (_tlTranSet.TlCaptureScanItems[j].ScanItemType == ScanItemTypes.CashOut.ToString())
                                        {
                                            TlCaptureScanItem subItem = _tlTranSet.TlCaptureScanItems[j];
                                            _tlTranSet.CurTran.TlCaptureISN.Value = subItem.ScanISN;
                                            if (!string.IsNullOrEmpty(subItem.ScanTranNo))
                                                _tlTranSet.CurTran.TlCaptureTranNo.Value = Convert.ToInt32(subItem.ScanTranNo);
                                            if (!string.IsNullOrEmpty(subItem.ScanBatchId))
                                                _tlTranSet.CurTran.TlCaptureBatchId.Value = Convert.ToInt32(subItem.ScanBatchId);
                                            if (!string.IsNullOrEmpty(subItem.ScanFirstCRItemISN))
                                                _tlTranSet.CurTran.TlCaptureParentISN.Value = subItem.ScanFirstCRItemISN;
                                            break;
                                        }
                                    }
                                }
                            }

                            _tlTranSet.CurTran.TlCaptureImageCommited.Value = GlobalVars.Instance.ML.N;
                            _tlTranSet.CurTran.TlCaptureWorkstation.Value = machineName;
                            _tlTranSet.CurTran.TlCaptureNoItems.Value = _tlTranSet.TlCaptureScanItems.GetItemCountByParentISN(tlCaptureItem.ScanISN);
                            _tlTranSet.CurTran.TlCaptureOptionType.Value = _tlTranSet.IsTellerCaptureBulkTran ? "B" : "S";
                            if (tranIndex == 0)
                            {
                                _tlTranSet.CurTran.TlCaptureTransetInfo.Value = !string.IsNullOrEmpty(transactionData) ? transactionData : _tlCaptureTranXML;
                            }
                            if (_tlTranSet.CaptureAllCheckTranItems)    //#102719
                            {
                                if (_tlTranSet.CurTran.TlTranCode.IsNull && !tlCaptureItem.AdTlTc.TlTranCode.IsNull)
                                    _tlTranSet.CurTran.TlTranCode.Value = tlCaptureItem.AdTlTc.TlTranCode.Value;
                                if ((_tlTranSet.CurTran.TranCodeDesc.IsNull || string.IsNullOrEmpty(_tlTranSet.CurTran.TranCodeDesc.Value)) && !tlCaptureItem.AdTlTc.Description.IsNull)
                                    _tlTranSet.CurTran.TranCodeDesc.Value = string.Format("{0} - {1}", tlCaptureItem.AdTlTc.TlTranCode.Value, tlCaptureItem.AdTlTc.Description.Value);
                            }

                        }

                        #endregion
                    }

                    if (doAddNext)
                        WriteToDebugLogDetailed("Performing OnActionAddNext", true);

                    if (doAddNext && !OnActionAddNext())
                    {
                        WriteToDebugLog("Teller Capture: Failed to execute OnActionAddNext");
                        return 1;  //Failed
                    }
                    if (!CheckForPopUpWindows())
                    {
                        WriteToDebugLog("Teller Capture: Quitting due to CheckForPopUpWindows after AddNext ");
                        return 2;  //In Progress
                    }
                }
            }
            catch (PhoenixException pe)
            {
                PMessageBox.Show(pe);
                return 1;   //Failed
            }
            catch (Exception ex)
            {
                try
                {
                    CoreService.LogPublisher.LogError("Teller Capture:Execption in IdentifyAndValidateTlCaptureTranSet:" + ex.ToString());
                    PMessageBox.Show(ex);
                    return 1;   //Failed
                }
                finally
                {
                    //throw ex;
                }
            }
            finally
            {
                _creatingTlCaptureTranSet = false;
                Workspace.Variables["frmTlTranCode_creatingTlCaptureTranSet"] = _creatingTlCaptureTranSet;
                dlgInformation.Instance.HideInfo();
            }

            return 0;  //Success
        }

        private void SetTellerCaptureFlagForTranSet(bool flagValue)
        {
            if (_tlTranSet != null)
            {
                _tlTranSet.IsTellerCaptureTran = flagValue;
                if (_tlTranSet.IsTellerCaptureTran)
                {
                    _tlTranSet.IsTellerCaptureBulkTran = _tlCaptureBulkModePosting;
                }
                else
                {
                    _tlTranSet.IsTellerCaptureBulkTran = false;
                }
            }
            if (Workspace != null)
            {
                Workspace.Variables["IsTellerCaptureTran"] = flagValue;
            }
        }

        private void SetTellerCaptureCheckOnlyFlagForTranSet(bool flagValue) //#102719
        {
            if (_tlTranSet != null)
            {
                _tlTranSet.IsTellerCaptureCheckOnlyTran = flagValue;
            }
            if (Workspace != null)
            {
                Workspace.Variables["IsTellerCaptureCheckOnlyTran"] = flagValue;
            }
        }

        private void ResetFlagsAndInitializeTranSet(string origin)
        {
            if (_invokedByWorkflow && Workspace != null)    // #TellerWF
            {
                Workspace.Variables[InputParamTranSet.WFTranStatusWkspaceVar] = WFTranStatus.Posted.ToString();
            }
            bool tmpIsTellerQuickTran = (_tlTranSet.IsTellerQuickTran || origin == "QuickTranClearAllClicked") && !_isOvRunning;   //#87731 //#122532
            // #40977
            if (_tlTranSet != null && _tlTranSet.IsTellerCaptureTran &&
                _tlTranSet.TranPostedStatus.Value == (short)TranPostStatus.Success &&
                _tellerCapture != null && _tellerCapture.LastTranCommitPending)
            {
                if (!CommitTellerCaptureTran("RT"))
                {
                    PMessageBox.Show(this, 999999, MessageType.Error, MessageBoxButtons.OK, string.Empty);
                }
            }

            _tlTranSet = new TlTransactionSet();
            frmTBarSearch = null; //#75874  #79156 - moved here from after ActionAfterAddNext();
            _acctSearchBusObj = new CustomerSearch();   //#132711
            _tranPostingAttempted = false;  //#10003
            InitializeTranSet();
            _isFormRecalcPmtHistoryClosed = true; //#76425
            _isFormRecalcPmtHistoryInvoked = false; //#76425
            _isTcdToggleWarningShown = false; //#72916
            cTRTranNo = -1;
            passbookTranNo = -1;
            processingPrint = false;
            tcdDispenseTriggered = false; //#75743
            isTcdDispenseFailed = false; //#75743
            postCashOutTriggered = false; //#6747
            postTcdCashOutTriggered = false; //#6747
            _isInventoryPurchaseVerified = true;    //#140772
            _jointRimsShownForTellerCapture = false;	//#34401
            MailerForm = new ArrayList();
            MailerStatus = null;
            if (tmpIsTellerQuickTran)   //#87731
            {
                //Begin 95645 
                _bIncQuickTCs = false;
                cmbAcctType.CodeValue = null;
                dfQuickTranCode.UnFormattedValue = null;
                PopulateTranCodeCombo(GlobalVars.Instance.ML.RM, null);
                //End 95645 

                //InitializeQuickTranSet();
                picTabs.SelectedIndex = (int)TAB.QuickTran;
                picTabs_SelectedIndexChanged(null, null);
                InitializeQuickTranSet();
                _quickTranWindow.TranSet.CashInTranMappedIndex = -1;
            }
            else
            {
                if (picTabs.SelectedIndex != 0)
                {
                    if (!(IsLoadCustSummary() && picTabs.SelectedIndex == 2))   // #140895 - check for current tab if already on search
                        picTabs.SelectedIndex = 0;
                }
            }
            if (origin == "ClearAllClicked" || origin == "QuickTranClearAllClicked")   //#122532
            {
                frmTlTranCode_PInitCompleteEvent();
                SetTotalDebitsAndCredits();
                curTranIndex = -1;
                ctwTranSet.ResetTable();
            }
            else
            {
                ActionAfterAddNext();
            }
            _creatingTlCaptureTranSet = false;     // #140895
            _tlCaptureAVTCSilentMode = false;      // #140895
            _tlCaptureResendingAVTCTran = false;   // #140895
            // Begin #140895 - Bulk Mode
            if (_tlCaptureBulkModePosting)
            {
                _tlCaptureBulkModePosting = false;
                PfwStandard parentForm = this.Workspace.ContentWindow.PreviousWindow as PfwStandard;
                _skipDisposeCleanUp = true; // #40977
                if (parentForm != null)
                    parentForm.CallParent(ScreenId, _tlCaptureBulkPostStatus);
                _tlCaptureBulkPostStatus = -1;
            }
            // End #140895 - Bulk Mode
            Helper.SendMessageToMDI((int)GlobalActions.ChildAction, this, "TranCompleted");     //#195669, #35513
            _isHardHoldNoticePending = true;
        }
        private string GetTellerCaptureXMLForDebug(string title)
        {
            string transaction = null;

            OpenFileDialog openFileDialog = new OpenFileDialog();
            openFileDialog.Filter = "XML Files (*.xml)|*.xml";
            openFileDialog.FilterIndex = 2;
            openFileDialog.Title = title;
            if (openFileDialog.ShowDialog() == System.Windows.Forms.DialogResult.OK)
            {
                using (StreamReader temp = new StreamReader(openFileDialog.FileName))
                    transaction = temp.ReadToEnd();
            }
            return transaction;
        }

        private bool TlCaptureValidateOnPost()
        {
            for (int i = 0; i < _tlTranSet.Transactions.Count; i++)
            {
                TlTransaction tran = _tlTranSet.Transactions[i] as TlTransaction;
                if (tran != null && tran.CashIn.Value > 0)
                {
                    _tlTranSet.CurTran = tran;
                    if (_tlTranSet.TriggerCashInOut(_tlTranSet.CurTran.CashIn.XmlTag, true))
                    {
                        _triggeredCashInOnPostTlCapture = true;
                        HandleCashInOutDenom("CashInDenom");
                        return false;
                    }
                }
            }

            return true;

        }

        private bool CheckForPopUpWindows()
        {
            if (_popUpWindows == null)
                _popUpWindows = new ArrayList();
            if (Workspace.CurrentWindow != this)
            {
                IPhoenixForm popUpWindow = Workspace.CurrentWindow;
                do
                {
                    if (_popUpWindows.IndexOf(popUpWindow) < 0)
                    {
                        _popUpWindows.Add(popUpWindow);
                        (popUpWindow as Form).FormClosed += new FormClosedEventHandler(popUpWindow_FormClosed);
                    }

                    popUpWindow = Workspace.GetPrevWindow(popUpWindow as Form);

                    if (popUpWindow == this)
                        break;

                } while (true);
            }

            WriteToDebugLogDetailed(string.Format("CheckForPopUpWindows Ret Value: {0}", (_popUpWindows.Count == 0)), true);

            return _popUpWindows.Count == 0;
        }

        void popUpWindow_FormClosed(object sender, FormClosedEventArgs e)
        {
            if (sender is Form)
            {
                WriteToDebugLogDetailed(string.Format("popUpWindow_FormClosed Sender: {0}", (sender as Form).Name), true);
            }

            if (_popUpWindows.IndexOf(sender) >= 0)
            {
                WriteToDebugLogDetailed("popUpWindow_FormClosed: Removed Form", true);
                _popUpWindows.Remove(sender);
            }

            CheckForPopUpWindows(); // check for any new windows...

            if (_popUpWindows.Count == 0)
            {
                CreateTlCaptureTranSet(null, false);
            }
        }

        private bool IsPhxTranInProgress()
        {
            return _tlTranSet.Transactions.Count > 0 || _tlTranSet.IncludeCurTranInTlCaptureInput() || (tellerCaptureMemo &&
                _tlTranSet.CurTran != null && !_tlTranSet.CurTran.TranCode.IsNull && (_tlTranSet.CurTran.TranCode.Value == 505 || _tlTranSet.CurTran.TranCode.Value == 555)); //#50964 - added teller memo check
        }

        [System.Runtime.InteropServices.DllImport("User32.dll")]
        public static extern int PostMessage(IntPtr hWnd, int msg, int wParam, ref int lParam);

        private void SetFocusOnForm()
        {
            int WM_SETFOCUS = 0x0007;
            int lParam = 0;
            PostMessage(this.Handle, WM_SETFOCUS, 0, ref lParam);     // WM_SETFOCUS = 0x0007
        }

        private void WriteToDebugLogDetailed(string logInput, bool isTellerCapture)
        {
            if (isTellerCapture)
                logInput = "Teller Capture:" + logInput;
            if (CoreService.LogPublisher.DebugLevel == LogLevel.MoreDetailed)
            {
                WriteToDebugLog(logInput);
            }
        }

       
        //End #140895 - RP

        // Begin #180277
        private bool VerifyLnOverPayment()
        {
            

            if (_tlTranSet.AdTlControl.OverpmtOverride.Value != GlobalVars.Instance.ML.Y ||
                _tlTranSet.CurTran.TranAcct.LnClassExcludeOverPay.Value == GlobalVars.Instance.ML.Y ||
                _tlTranSet.CurTran.PostRealTime.Value != 1 ||
                _tlTranSet.TellerVars.PostingDt != BusGlobalVars.SystemDate ||
                _tlTranSet.TellerVars.IsAppOnline == false ||
                _tlTranSet.CurTran.TranAcct.DepLoan.Value == GlobalVars.Instance.ML.CM)    // #38024
            {
                return true;
            }

            Phoenix.BusObj.Loan.LnAcct lnAcct = new Phoenix.BusObj.Loan.LnAcct();
            lnAcct.AcctType.Value = _tlTranSet.CurTran.TranAcct.AcctType.Value;
            lnAcct.AcctNo.Value = _tlTranSet.CurTran.TranAcct.AcctNo.Value;
            int retCode = 0;
            if (!lnAcct.GetNxtPmtInfo(_tlTranSet.CurTran.LnAcctPrepaySetup, _tlTranSet.CurTran.NetAmt.Value, ref retCode))
            {
                if (retCode < 0)
                    PMessageBox.Show(MessageType.Error, _gbHelper.GetSPMessageText(retCode));
                return false;

            }

            if (_tlTranSet.CurTran.LnAcctPrepaySetup.RemainingAmount > 0)
            {
                CallOtherForms("ShowLnOverPmtOptions");
                if (dialogResult != System.Windows.Forms.DialogResult.OK)
                    return false;
            }
            else
            {
                _tlTranSet.CurTran.LnPrePayOption.SetValueToNull();
                _tlTranSet.CurTran.LnMaxNoPrepay.SetValueToNull();
                _tlTranSet.CurTran.LnPartialPriority.SetValueToNull();
            }
            return true;

        }
        // End #180277
        #region Merged Application Code
        //Begin #60578
        /// <summary>
        /// Misc Click. New flyout for Teller Grouping
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        void pbMisc_Click(object sender, PActionEventArgs e)
        {
            pbMisc.ImageButton.DropDownMenu.Show(pbMisc.ImageButton as Control, new Point(0, pbMisc.ImageButton.Height));
        }
        /// <summary>
        /// Create Teller Fly out Menu
        /// </summary>
        private void CreateTellerMiscMenu()
        {
            pbOnUs.Visible = false;
            pbInventory.Visible = false;
            pbeReceipt.Visible = false;

            cmTellerMiscMenu.MenuItems.Clear();

            /*Add buttons as a fly out*/
            cmTellerMiscMenu.MenuItems.Add(pbOnUsMisc.MenuItem);
            cmTellerMiscMenu.MenuItems.Add(pbInventoryMisc.MenuItem);
            cmTellerMiscMenu.MenuItems.Add(pbeReceiptMisc.MenuItem);
            cmTellerMiscMenu.MenuItems.Add(pbPrintMailerMisc.MenuItem);
            cmTellerMiscMenu.MenuItems.Add(pbNOCHistoryMisc.MenuItem);

            pbOnUsMisc.MenuItem.Select += new EventHandler(MenuItem_Select);
            pbInventoryMisc.MenuItem.Select += new EventHandler(MenuItem_Select);
            pbeReceiptMisc.MenuItem.Select += new EventHandler(MenuItem_Select);
            pbPrintMailerMisc.MenuItem.Select += new EventHandler(MenuItem_Select);
            pbNOCHistoryMisc.MenuItem.Select += new EventHandler(MenuItem_Select);

            // TellerMiscMenuCreated = true;
            this.pbMisc.ImageButton.DropDownMenu = cmTellerMiscMenu;

            /*Create nested Flyouts for OnUs and Inventory*/
            AddSubMenu(pbOnUsMisc.MenuItem, cmOnUs);
            AddSubMenu(pbInventoryMisc.MenuItem, cmInventory);
            return;
        }
        /// <summary>
        /// Sub Menu inside Main Menu
        /// </summary>
        /// <param name="item"></param>
        /// <param name="menu"></param>
        private void AddSubMenu(MenuItem item, ContextMenu menu)
        {
            item.MenuItems.Clear(); //Fix For Repeatinhg Bug in nested flyoutMenu
            item.MergeMenu(menu);
        }

        void MenuItem_Select(object sender, EventArgs e)
        {
            Phoenix.Windows.Forms.PMenuItem a1 = (Phoenix.Windows.Forms.PMenuItem)sender;
            SetStatusText(a1.Action.StatusText);
        }
        //End #60578
        //Begin #60647
        #region Account Action Grp
        void pbEdit_Click(object sender, PActionEventArgs e)
        {
            string depLoan = frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString();
            string cardExists = "N";
            string supportMembers = "N";
            //   atmMemberNo = 0;      37844
            parentAcctNo = "";
            parentAcctType = "";
            parentRimNo = 0;

            depLoan = depLoan.TrimX();

            if (depLoan == GlobalVars.Instance.ML.DP)
            {
                CallOtherForms("EditDP");
            }
            else if (depLoan == GlobalVars.Instance.ML.SD)
            {
                //   bForceRefresh = true;
                CallOtherForms("EditSD");
            }
            else if (depLoan == GlobalVars.Instance.ML.LN)
            {
                if (Convert.ToInt32(frmGloAccountListRim.colPartCount.UnFormattedValue) == -2)
                {
                    _acctSearchBusObj.GetLoanParentInfo(frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), ref parentAcctNo, ref parentAcctType, ref parentRimNo);
                    CallOtherForms("EditPartLn");
                }
                else
                    CallOtherForms("EditLN");
            }
            else if (depLoan == GlobalVars.Instance.ML.Atm)
            {
                _acctSearchBusObj.GetAtmInfo(frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), ref cardExists, ref supportMembers, ref atmMemberNo);

                if (cardExists != "Y" && supportMembers != "Y")
                {
                    CallOtherForms("AtmAcctEdit");  //atmacctedit_new
                }
                else
                {
                    if (supportMembers == "Y")
                    {
                        CallOtherForms("AtmCard");  //atmcard
                    }
                    else
                    {
                        CallOtherForms("AtmCardEdit");   // atmcardedit
                    }
                }

            }
            else if (depLoan == GlobalVars.Instance.ML.Ext)
            {
                if (frmGloAccountListRim.colAdapter.UnFormattedValue != null && frmGloAccountListRim.colAdapter.UnFormattedValue.ToString() != "Y")
                {
                    CallOtherForms("EditEXT");
                }
                else
                {
                    CallOtherForms("ExtXaml");
                }

            }
            else if (depLoan == GlobalVars.Instance.ML.CM)
            {
                CallOtherForms("EditCM");
            }
        }
        void pbArchive_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("ArchivedAccts");
        }
        void pbUmbrella_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("Umbrella");
        }
        void pbDirectAcct_Click(object sender, PActionEventArgs e)
        {
            // this is a dummy click to make sure tabstop works for the button with dropdown menu. framework hack
            //34643 - accelerator keys would call click event. 
            if (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString() == GlobalVars.Instance.ML.DP || frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString() == GlobalVars.Instance.ML.LN || frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString() == GlobalVars.Instance.ML.Atm)
            {
                pbDirectAcct.ImageButton.DropDownMenu.Show(pbDirectAcct.ImageButton as Control, new Point(0, pbDirectAcct.ImageButton.Height));
            }

        }
        void pbNewAcct_Click(object sender, PActionEventArgs e)
        {
            // this is a dummy click to make sure tabstop works for the button with dropdown menu. framework hack
            //34643 - accelerator keys would call click event. 
            pbNewAcct.ImageButton.DropDownMenu.Show(pbNewAcct.ImageButton as Control, new Point(0, pbNewAcct.ImageButton.Height));

        }
        #region ExHistoryMenu
        void miTcLog_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("TcLog");
        }

        void miExHistory_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("ExHistory");
        }
        #endregion
        #endregion
        void pbServicing_Click(object sender, PActionEventArgs e)
        {
            // this is a dummy click to make sure tabstop works for the button with dropdown menu. framework hack
            //34643 - accelerator keys would call click event. 
            pbServicing.ImageButton.DropDownMenu.Show(pbServicing.ImageButton as Control, new Point(0, pbServicing.ImageButton.Height));
        }
        //End #60647



        //Begin 61240
        /// <summary>
        /// The Sales Button Redirects the call to three windows according to the ServiceID
        /// Service ID = +ve number , frmXpRmSvcsEdit window
        /// Service ID = -1 to -13 , frmSalesServiceRSM window
        /// Service ID = 0 , frmLnThirdPartyPassThruEdit window
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void pbSales_Click(object sender, PActionEventArgs e)
        {
            /*Begin 37354*/
            System.Collections.Generic.List<int> nServiceId = new System.Collections.Generic.List<int>() { -1, -12, -8, -10, -13, -2, -14 }; //37466
            /*End 37354*/

            if (frmGloAccountListRim.gridServListSum.Count > 0 && frmGloAccountListRim.colSvcsServiceId.UnFormattedValue != null &&
                Convert.ToInt32(frmGloAccountListRim.colSvcsServiceId.UnFormattedValue) > 0)
            {
                CallOtherForms("XpRmSvcsEditClick");
            }
            //else if (gridServListSum.Count > 0 && GetServiceId(colSvcsDescription.UnFormattedValue.ToString().Trim()) <= 0)
            else if (frmGloAccountListRim.gridServListSum.Count > 0 && Convert.ToInt32(frmGloAccountListRim.colSvcsServiceId.UnFormattedValue) <= 0)
            {
                /*Begin 34705*/
                if (nServiceId.Contains(Convert.ToInt32(frmGloAccountListRim.colSvcsServiceId.UnFormattedValue.ToString())))
                {
                    CallOtherForms("SalesServiceRSMDetails");
                }
                else
                {
                    CallOtherForms("SalesClick");
                }
                /*End 34705*/
            }
        }

        void pbEditService_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("EditViewServices");

        }
        
        void gridServListSum_SelectedIndexChanged(object source, GridClickEventArgs e) //WI28477
        {
            EnableDisableServiceButton(frmGloAccountListRim.colSvcsDescription.Text);
        }

        void picTabCustSummary_SelectedIndexChanged(object sender, EventArgs e) //WI28477
        {
            int newTabIndex = frmGloAccountListRim.picTabCustSummary.SelectedIndex;

            if (newTabIndex == (int)Phoenix.Client.RimAccounts.frmGloAccountListRim.TAB.Services)
            {
                this.pbActionSeperator4.Visible = true;
                this.pbEditService.Visible = true;
                this.pbEdit.Visible = false;
                this.pbDisplay.Visible = false;
                this.pbHistory.Visible = false;
                this.pbDirectAcct.Visible = false;
                this.pbUmbrella.Visible = false;
                this.pbNewAcct.Visible = false;
                this.pbArchive.Visible = false;
                this.pbServicing.Visible = false;
                // this.pbEditTemp.Visible = false;
                this.pbSeperatorServ.Visible = false;
                this.pbSeperatorAcct.Visible = false;
                //  this.pbActionSeperator3.Visible = false;
                this.pbSales.Visible = true; // 174691
                EnableDisableServiceButton(frmGloAccountListRim.colSvcsDescription.Text);
                /*Disable Teller Specific button if tab other than Services*/
                this.pbSelectAcct.Enabled = false;
                this.pbMisc.Enabled = false;
                this.pbRelationship.Enabled = false;
                this.UpdateView();
            }
            else
            {
                this.pbActionSeperator4.Visible = false;
                this.pbEditService.Visible = false;
                this.pbSales.Visible = false; // 174691
                this.pbEdit.Visible = true;
                this.pbDisplay.Visible = true;
                this.pbHistory.Visible = true;
                this.pbDirectAcct.Visible = true;
                this.pbUmbrella.Visible = true;
                this.pbNewAcct.Visible = true;
                this.pbArchive.Visible = true;
                this.pbServicing.Visible = true;
                this.pbSeperatorServ.Visible = true;
                this.pbSeperatorAcct.Visible = true;
                /*Enable Teller Specific button if tab other than Services*/
                this.pbMisc.Enabled = true && GlobalVars.UserType != "AcProc"; //#75588
                int ownerCount = 0;
                if (frmGloAccountListRim.gridAccountListSum.Count > 0)
                {
                    int.TryParse(frmGloAccountListRim.colOwnerCount.UnFormattedValue.ToString(), out ownerCount);
                    this.pbSelectAcct.Enabled = true && GlobalVars.UserType != "AcProc"; //#75588
                }
                pbRelationship.Enabled = (ownerCount > 1) && GlobalVars.UserType != "AcProc"; //#75588
                this.UpdateView();

            }
        }
        //End 61240
        //Begin #60722
        void ptabResults_SelectedIndexChanged(object sender, EventArgs e)
        {
            EnableDisableSelectSearch();//92056.Moved logic in this new method

        }
        //End #60722
        //Begin 92056.Recent lookup Selected index Changed
        private void grdCustLookup_SelectedIndexChanged(object source, GridClickEventArgs e)
        {
            if (frmTBarSearch.ptabResults.SelectedTab == frmTBarSearch.tabRecentCustLookup)
            {
                EnableDisableSelectSearch();
            }
        }
        //End 92056
        //Begin #60620
        #region Customer Action Groups Click

        void pbRimDisplay_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("RimDisplay");
        }

        void pbRim_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("EditRim");
        }

        void pbRimHistory_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("RimHistory");
        }
        void pbRimAchFuture_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("AchFuture");
        }

        void pbPortfolio_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("RimPortfolio");
        }
        void pbRimDirect_Click(object sender, PActionEventArgs e)
        {
            pbRimDirect.ImageButton.DropDownMenu.Show(pbRimDirect.ImageButton as Control, new Point(0, pbRimDirect.ImageButton.Height));
        }
        //Begin #134375
        void pbExceptionHold_Click(object sender, PActionEventArgs e)
        {
            CallOtherForms("ExceptionHold");

        }
        //End #134375
        #endregion

        private void CreateRimDirectMenu()
        {
            if (frmGloAccountListRim != null)
            {
                cmRimDirectMenu.MenuItems.Clear();

                cmRimDirectMenu.MenuItems.Add(frmGloAccountListRim.pbMenuRimFinancial.MenuItem);
                cmRimDirectMenu.MenuItems.Add(frmGloAccountListRim.miStatements.MenuItem);
                cmRimDirectMenu.MenuItems.Add(frmGloAccountListRim.miAtm.MenuItem);
                cmRimDirectMenu.MenuItems.Add(frmGloAccountListRim.miPerNonPer.MenuItem);
                cmRimDirectMenu.MenuItems.Add(frmGloAccountListRim.miAdditional.MenuItem);
                cmRimDirectMenu.MenuItems.Add(frmGloAccountListRim.miLegal.MenuItem);
                cmRimDirectMenu.MenuItems.Add(pbPortfolio.MenuItem);  //61726
                cmRimDirectMenu.MenuItems.Add(pbRimAchFuture.MenuItem);  //61726

                frmGloAccountListRim.pbMenuRimFinancial.MenuItem.Select += new EventHandler(MenuItem_Select);
                frmGloAccountListRim.miStatements.MenuItem.Select += new EventHandler(MenuItem_Select);
                frmGloAccountListRim.miAtm.MenuItem.Select += new EventHandler(MenuItem_Select);
                frmGloAccountListRim.miPerNonPer.MenuItem.Select += new EventHandler(MenuItem_Select);
                frmGloAccountListRim.miAdditional.MenuItem.Select += new EventHandler(MenuItem_Select);
                frmGloAccountListRim.miLegal.MenuItem.Select += new EventHandler(MenuItem_Select);
                pbPortfolio.MenuItem.Select += new EventHandler(MenuItem_Select);   //61726
                pbRimAchFuture.MenuItem.Select += new EventHandler(MenuItem_Select);  //61726
                this.pbRimDirect.ImageButton.DropDownMenu = cmRimDirectMenu;

            }

        }
        //End #60620
        //Begin  #60647
        private void CreateNewAcctMenu()
        {
            cmNewAcctMenu.MenuItems.Clear();

            cmNewAcctMenu.MenuItems.Add(frmGloAccountListRim.miNewAcctDp.MenuItem);
            cmNewAcctMenu.MenuItems.Add(frmGloAccountListRim.miNewAcctLn.MenuItem);
            cmNewAcctMenu.MenuItems.Add(frmGloAccountListRim.miNewAcctSd.MenuItem);
            cmNewAcctMenu.MenuItems.Add(frmGloAccountListRim.miNewAcctAtm.MenuItem);
            cmNewAcctMenu.MenuItems.Add(frmGloAccountListRim.miNewAcctUmb.MenuItem);
            cmNewAcctMenu.MenuItems.Add(frmGloAccountListRim.miNewAcctExt.MenuItem);
            cmNewAcctMenu.MenuItems.Add(frmGloAccountListRim.miNewAcctOrig.MenuItem); /* 37300 */

            frmGloAccountListRim.miNewAcctDp.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miNewAcctLn.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miNewAcctSd.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miNewAcctAtm.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miNewAcctUmb.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miNewAcctExt.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miNewAcctOrig.MenuItem.Select += new EventHandler(MenuItem_Select); /* 37300 */
            cmNewAcctMenu.Popup += new EventHandler(cmNewAcctMenu_Popup);

            this.pbNewAcct.ImageButton.DropDownMenu = cmNewAcctMenu;
        }
        void cmNewAcctMenu_Popup(object sender, EventArgs e)
        {
            /* Begin 37300 */
            frmGloAccountListRim.miNewAcctOrig.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled ||
                (CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OnOriginationWizard)
                    && PcCustomOptions.Instance.CheckCustomOptions(PcCustomOptions.CO_Constants.CO_DepositOrigination)))
                && LocHandleEnableDisableAccounts();
            ///* End 37300 */
            ///
            //frmGloAccountListRim.miNewAcctOrig.Enabled = true; //Quick EDO/Wizard Testing 
            frmGloAccountListRim.miNewAcctDp.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.DpEdit)) && LocHandleEnableDisableAccounts();
            frmGloAccountListRim.miNewAcctLn.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.LnEdit)) && LocHandleEnableDisableAccounts();
            frmGloAccountListRim.miNewAcctSd.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.SdBoxNewEdit)) && LocHandleEnableDisableAccounts();
            frmGloAccountListRim.miNewAcctAtm.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || (CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.OnATMCardEdit) || CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.OnATMAcctEdit))) && LocHandleEnableDisableAccounts();
            frmGloAccountListRim.miNewAcctUmb.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.IraUmbrella)) && LocHandleEnableDisableAccounts();
            frmGloAccountListRim.miNewAcctExt.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled ||
                                    CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.InsExAccountEdit) ||
                                    CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.BrkExAccountEdit) ||
                                    CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountEdit) ||
                                    CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.StuLnExAccountEdit) ||
                                    CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.OtherExAccountEdit) ||
                                    CoreService.UIAccessProvider.HasNewAccess(Phoenix.Shared.Constants.ScreenId.ExAcctEdit)) && LocHandleEnableDisableAccounts();

        }
        private bool LocHandleEnableDisableAccounts()
        {
            if (frmGloAccountListRim.dfStatus.Text.Trim() != GlobalVars.Instance.ML.Active)
                return false;
            if (frmGloAccountListRim.sProhibNewAcct == "Y")
                return false;
            if (!Convert.ToBoolean(Workspace.Variables["RimEditAccess"]))
                return false;

            return true;
        }
        private bool LocSetUmbrellaStatus()
        {
            if (frmGloAccountListRim.nDpUmbCount == 0 && frmGloAccountListRim.nLnUmbCount == 0 && frmGloAccountListRim.nLnUmbOelpCount == 0)
                return false;
            return true;
        }
        private void CreateDpDirectMenu()
        {
            //if (DpDirectMenuCreated)
            //    return;

            cmDpDirectMenu.MenuItems.Clear();
            if (GlobalVars.InstitutionType == "CU")
            {
                cmDpDirectMenu.MenuItems.Add(frmGloAccountListRim.miDpCuCrInt.MenuItem);
                cmDpDirectMenu.MenuItems.Add(frmGloAccountListRim.miDpCuDrInt.MenuItem);
            }
            else
            {
                cmDpDirectMenu.MenuItems.Add(frmGloAccountListRim.miDpCrInt.MenuItem);
                cmDpDirectMenu.MenuItems.Add(frmGloAccountListRim.miDpDrInt.MenuItem);
            }
            cmDpDirectMenu.MenuItems.Add(frmGloAccountListRim.miDpStatements.MenuItem);
            cmDpDirectMenu.MenuItems.Add(frmGloAccountListRim.miOdpAcct.MenuItem);
            cmDpDirectMenu.MenuItems.Add(frmGloAccountListRim.miDpAdditional.MenuItem);
            cmDpDirectMenu.MenuItems.Add(frmGloAccountListRim.miDpCharges.MenuItem);

            frmGloAccountListRim.miDpCuCrInt.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miDpCuDrInt.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miDpCrInt.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miDpDrInt.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miDpStatements.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miOdpAcct.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miDpAdditional.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miDpCharges.MenuItem.Select += new EventHandler(MenuItem_Select);
            cmDpDirectMenu.Popup += new EventHandler(cmDpDirectMenu_Popup);


            //  DpDirectMenuCreated = true;

            this.pbDirectAcct.ImageButton.DropDownMenu = cmDpDirectMenu;


        }

        void cmDpDirectMenu_Popup(object sender, EventArgs e)
        {
            if (acctChanged)
            {
                if (_acctSearchBusObj.GetDpAcctInfo(frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), ref DpAllowMultiInt, ref DpIbaCr, ref DpAcctRowVersion, ref DpOdpEnabled, ref DpcheckId))
                {
                    acctChanged = false;
                }
            }
            if (GlobalVars.InstitutionType == "CU")
            {
                frmGloAccountListRim.miDpCuCrInt.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpInterestOptionsCr);
                frmGloAccountListRim.miDpCuDrInt.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpInterestOptionsDr)) && frmGloAccountListRim.colDepType.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Tran;
            }
            else
            {
                frmGloAccountListRim.miDpCrInt.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpInterestOptionsCr);
                frmGloAccountListRim.miDpDrInt.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpInterestOptionsDr)) && frmGloAccountListRim.colDepType.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Tran;
            }
            frmGloAccountListRim.miDpStatements.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.GbStatement);
            frmGloAccountListRim.miOdpAcct.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpLocOverdraftAcct)) && DpOdpEnabled;
            frmGloAccountListRim.miDpAdditional.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpUserDefFldValuesEdit);
            frmGloAccountListRim.miDpCharges.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpCC);

        }

        private void CreateLnDirectMenu()
        {
            //if (LnDirectMenuCreated)
            //    return;
            cmLnDirectMenu.MenuItems.Clear();
            cmLnDirectMenu.MenuItems.Add(frmGloAccountListRim.miLnInterest.MenuItem);
            cmLnDirectMenu.MenuItems.Add(frmGloAccountListRim.miLn3rdParty.MenuItem);
            cmLnDirectMenu.MenuItems.Add(frmGloAccountListRim.miLnPayment.MenuItem);
            cmLnDirectMenu.MenuItems.Add(frmGloAccountListRim.miLnCollateral.MenuItem);
            cmLnDirectMenu.MenuItems.Add(frmGloAccountListRim.miLnAdditional.MenuItem);
            cmLnDirectMenu.MenuItems.Add(frmGloAccountListRim.miLnStatements.MenuItem);
            cmLnDirectMenu.MenuItems.Add(frmGloAccountListRim.miLnCharges.MenuItem);
            cmLnDirectMenu.MenuItems.Add(frmGloAccountListRim.miLnRisk.MenuItem);
            cmLnDirectMenu.MenuItems.Add(frmGloAccountListRim.miLnOrigAcct.MenuItem); /* 113992 - 114236 */
            frmGloAccountListRim.miLnInterest.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miLn3rdParty.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miLnPayment.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miLnCollateral.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miLnAdditional.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miLnStatements.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miLnCharges.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miLnRisk.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miLnOrigAcct.MenuItem.Select += new EventHandler(MenuItem_Select); /* 113992 - 114236 */
            cmLnDirectMenu.Popup += new EventHandler(cmLnDirectMenu_Popup);

            // LnDirectMenuCreated = true;
            this.pbDirectAcct.ImageButton.DropDownMenu = cmLnDirectMenu;


        }

        void cmLnDirectMenu_Popup(object sender, EventArgs e)
        {
            if (acctChanged)
            {
                //113992 - 114236
                if (_acctSearchBusObj.GetLoanInfo(frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString(), frmGloAccountListRim.colAcctType.UnFormattedValue.ToString(), ref LnAllowMultiInt, ref LnAcctRowVersion, ref LaserproTransNumber))
                {
                    frmGloAccountListRim.LnAcctRowVersion = this.LnAcctRowVersion;
                    frmGloAccountListRim.LnAllowMultiInt = this.LnAllowMultiInt;
                    frmGloAccountListRim.LaserproTransNumber = this.LaserproTransNumber;
                    acctChanged = false;
                }
            }
            frmGloAccountListRim.miLnInterest.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnInterestOptions);
            frmGloAccountListRim.miLn3rdParty.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnThirdParty);
            frmGloAccountListRim.miLnPayment.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnPaymentSchedule);
            frmGloAccountListRim.miLnCollateral.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnCollateral);
            frmGloAccountListRim.miLnAdditional.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnUserDefFldValuesEdit);
            frmGloAccountListRim.miLnStatements.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.GbStatement);
            frmGloAccountListRim.miLnCharges.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnCC);
            frmGloAccountListRim.miLnRisk.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnRisk);
            /* Begin 113992 - 114236,126864 - 126863 - removed custom option check*/
            frmGloAccountListRim.miLnOrigAcct.Enabled = ((!CoreService.UIAccessProvider.IsSecurityEnabled ||
                (CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnOriginationWizard)))
                    && ((frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.Incomplete &&
                    frmGloAccountListRim.LaserproTransNumber.Trim() != "" )))
                && LocHandleEnableDisableAccounts();
            /* End 113992 - 114236 */

        }
        private void CreateAtmDirectMenu()
        {

            //if (AtmDirectMenuCreated)
            //    return;
            cmAtmDirectMenu.MenuItems.Clear();
            cmAtmDirectMenu.MenuItems.Add(frmGloAccountListRim.miAtmCards.MenuItem);
            cmAtmDirectMenu.MenuItems.Add(frmGloAccountListRim.miAtmRelated.MenuItem);
            cmAtmDirectMenu.MenuItems.Add(frmGloAccountListRim.miAtmAdditional.MenuItem);
            cmAtmDirectMenu.MenuItems.Add(frmGloAccountListRim.miAtmAddlCards.MenuItem);

            frmGloAccountListRim.miAtmCards.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miAtmRelated.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miAtmAdditional.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miAtmAddlCards.MenuItem.Select += new EventHandler(MenuItem_Select);
            // cmAtmDirectMenu.Popup += new EventHandler(cmAtmDirectMenu_Popup);

            // AtmDirectMenuCreated = true;

            this.pbDirectAcct.ImageButton.DropDownMenu = cmAtmDirectMenu;


        }
        private void CreateExHistoryMenu()
        {
            //if (ExHistoryMenuCreated)
            //    return;
            cmExHistoryMenu.MenuItems.Clear();
            cmExHistoryMenu.MenuItems.Add(miExHistory.MenuItem);
            cmExHistoryMenu.MenuItems.Add(miTcLog.MenuItem);

            miExHistory.MenuItem.Select += new EventHandler(MenuItem_Select);
            miTcLog.MenuItem.Select += new EventHandler(MenuItem_Select);
            cmExHistoryMenu.Popup += new EventHandler(cmExHistoryMenu_Popup);

            //ExHistoryMenuCreated = true;
            this.pbHistory.ImageButton.DropDownMenu = cmExHistoryMenu;


        }
        void cmExHistoryMenu_Popup(object sender, EventArgs e)
        {
            //Begin Bug#92189
            miExHistory.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || (colHistorySupport == "Y" && ((colAdapterType == "Insurance" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InsExAccountHistory)) ||
                                (colAdapterType == "Brokerage" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.BrkExAccountHistory)) ||
                                (colAdapterType == "Credit Card" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountHistory)) ||
                                (colAdapterType == "Student Loan" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.StuLnExAccountHistory)) ||
                                (colAdapterType == "Other" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OtherExAccountHistory))
                                ));

            miTcLog.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || ((colCrTcSupport == "Y" ||colDrTcSupport == "Y") && ((colAdapterType == "Insurance" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InsExAccountTCLog)) ||
                                (colAdapterType == "Brokerage" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.BrkExAccountTCLog)) ||
                                (colAdapterType == "Credit Card" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountTCLog)) ||
                                (colAdapterType == "Student Loan" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.StuLnExAccountTCLog)) ||
                                (colAdapterType == "Other" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OtherExAccountTCLog))
                                ));



            #region Commented out code
            //miExHistory.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || (frmGloAccountListRim.colHistorySupport.UnFormattedValue.ToString().Trim() == "Y" && ((frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Insurance" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InsExAccountHistory)) ||
            //                    (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Brokerage" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.BrkExAccountHistory)) ||
            //                    (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Credit Card" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountHistory)) ||
            //                    (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Student Loan" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.StuLnExAccountHistory)) ||
            //                    (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Other" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OtherExAccountHistory))
            //                    ));

            //miTcLog.Enabled = !CoreService.UIAccessProvider.IsSecurityEnabled || ((frmGloAccountListRim.colCrTcSupport.UnFormattedValue.ToString().Trim() == "Y" || frmGloAccountListRim.colDrTcSupport.UnFormattedValue.ToString().Trim() == "Y") && ((frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Insurance" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.InsExAccountTCLog)) ||
            //                    (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Brokerage" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.BrkExAccountTCLog)) ||
            //                    (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Credit Card" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CrdCardExAccountTCLog)) ||
            //                    (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Student Loan" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.StuLnExAccountTCLog)) ||
            //                    (frmGloAccountListRim.colAdapterType.UnFormattedValue.ToString().Trim() == "Other" && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.OtherExAccountTCLog))
            //                    ));
            #endregion
            //End Bug#92189

        }

        private void CreateServicingMenu()
        {
            //if (ServicingMenuCreated)
            //    return;
            cmServicingMenu.MenuItems.Clear();

            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miCheckOrder.MenuItem);
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miStarterChecks.MenuItem);    //48236
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miAcctForms.MenuItem);
            if (GlobalVars.InstitutionType == "CU")
            {
                cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miMemberForms.MenuItem);
            }
            else
            {
                cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miCustomerForms.MenuItem);
            }
            /*begin #130474*/
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miIraForms.MenuItem);
            /*130474*/
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miLoanPayoff.MenuItem);
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miRenewal.MenuItem);
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miRestrictions.MenuItem);
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miSDBVisit.MenuItem);
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miIrsReporting.MenuItem);
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miReferrals.MenuItem);
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miRequest.MenuItem);
            if (GlobalVars.InstitutionType == "CU")
            {
                cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miEmailMember.MenuItem);
            }
            else
            {
                cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miEmailCustomer.MenuItem);
            }
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miSchedAppt.MenuItem);
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miDormEsch.MenuItem);
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miVOD.MenuItem);
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miDLScan.MenuItem);
            /*Begin #133851*/
            cmServicingMenu.MenuItems.Add(frmGloAccountListRim.miCashReward.MenuItem);
            /*End #133851*/

            frmGloAccountListRim.miCheckOrder.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miStarterChecks.MenuItem.Select += new EventHandler(MenuItem_Select);   //48236
            frmGloAccountListRim.miAcctForms.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miMemberForms.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miCustomerForms.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miIraForms.MenuItem.Select += new EventHandler(MenuItem_Select); //Task #130474
            frmGloAccountListRim.miLoanPayoff.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miRenewal.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miRestrictions.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miSDBVisit.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miIrsReporting.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miReferrals.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miRequest.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miEmailMember.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miEmailCustomer.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miSchedAppt.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miDormEsch.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miVOD.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miDLScan.MenuItem.Select += new EventHandler(MenuItem_Select);
            frmGloAccountListRim.miCashReward.MenuItem.Select += new EventHandler(MenuItem_Select); //Task #133851

            cmServicingMenu.Popup += new EventHandler(cmServicingMenu_Popup);
            //ServicingMenuCreated = true;

            this.pbServicing.ImageButton.DropDownMenu = cmServicingMenu;
        }

        void cmServicingMenu_Popup(object sender, EventArgs e)
        {
            //#94537. Screen Id Of CheckOrder corrected. Earlier it was referring GbHoldStop Window
            frmGloAccountListRim.miCheckOrder.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CheckOrderAccess)) &&
                                       ((frmGloAccountListRim.colDepLoan.Text != "") && (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP || (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN && frmGloAccountListRim.colAdvance.UnFormattedValue.ToString().Trim() == "Revolving"))) &&
                                       (frmGloAccountListRim.gridAccountListSum.RowCount > 0 && frmGloAccountListRim.gridAccountListSum.SelectedRows.Count >= 1);
            //48236
            //95472. Added Screen Id for StarterChecks. Earlier it was referring GbHoldStop Window
            frmGloAccountListRim.miStarterChecks.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.StarterCheck)) &&
                                       ((frmGloAccountListRim.colDepLoan.Text != "") && (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP || (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN && frmGloAccountListRim.colAdvance.UnFormattedValue.ToString().Trim() == "Revolving"))) &&
                                       (frmGloAccountListRim.gridAccountListSum.RowCount > 0 && frmGloAccountListRim.gridAccountListSum.SelectedRows.Count >= 1);
            frmGloAccountListRim.miAcctForms.Enabled = ((!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.GbAcctForms)) && (frmGloAccountListRim.colDepLoan.Text != "" && frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP)) ||
                                   ((!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.GbLNAcctForms)) && (frmGloAccountListRim.colDepLoan.Text != "" && frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN)) ||
                                   ((!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.GbSDAcctForms)) && (frmGloAccountListRim.colDepLoan.Text != "" && frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.SD));

            /*Begin #130474*/
            frmGloAccountListRim.miIraForms.Enabled = ((!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.GbIRAForms)) && (frmGloAccountListRim.colDepLoan.Text != "" && frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP)) &&
                                                       (frmGloAccountListRim.colPlanNo.Text != ""); //Task #130831- Changed to GbIraforms

            /*End   #130474*/
            /*Begin #133851*/
            frmGloAccountListRim.miCashReward.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CashRwdInquiry));

            /*End   #133851*/
            frmGloAccountListRim.miLoanPayoff.Enabled = ((frmGloAccountListRim.gridAccountListSum.RowCount > 0 && frmGloAccountListRim.gridAccountListSum.SelectedRows.Count == 1 && frmGloAccountListRim.colDepLoan.Text != "" && (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN)) &&
                                  (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LnPayoffDetail))
                                  ||
                                  (frmGloAccountListRim.gridAccountListSum.RowCount > 0 && frmGloAccountListRim.gridAccountListSum.SelectedRows.Count == 1 && frmGloAccountListRim.colDepLoan.Text != "" && (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.CM && frmGloAccountListRim.colProduceSingleBill.UnFormattedValue.ToString() == "Y")) && //71598
                                  (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.CmtPayoffDetail)));                                                                                                    //71598
            

            frmGloAccountListRim.miRenewal.Enabled = (frmGloAccountListRim.gridAccountListSum.RowCount > 0 && frmGloAccountListRim.gridAccountListSum.SelectedRows.Count == 1 && (frmGloAccountListRim.colDepLoan.Text != "" && (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN || frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP))) && bRenewal;

            frmGloAccountListRim.miRestrictions.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.GbStopHold)) &&
                                     (frmGloAccountListRim.gridAccountListSum.RowCount > 0 && frmGloAccountListRim.gridAccountListSum.SelectedRows.Count == 1) && (frmGloAccountListRim.colDepLoan.Text != "" &&
                                     (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.DP ||
                                     (frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.LN && (frmGloAccountListRim.colAdvance.UnFormattedValue.ToString().Trim() == "Revolving" || frmGloAccountListRim.colAdvance.UnFormattedValue.ToString().Trim() == "Multiple"))
                                     ));

            frmGloAccountListRim.miSDBVisit.Enabled = (frmGloAccountListRim.gridAccountListSum.RowCount > 0 && frmGloAccountListRim.gridAccountListSum.SelectedRows.Count == 1) && frmGloAccountListRim.colDepLoan.Text != "" &&
                                 frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString().Trim() == GlobalVars.Instance.ML.SD && bSdVisit;

            frmGloAccountListRim.miIrsReporting.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.TaxRepAggregation));

            frmGloAccountListRim.miReferrals.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.ReferralEdit)) &&
                                (_pcCustomOptions.CheckCustomOptions(PcCustomOptions.CO_Constants.CO_SalesAndService));//63225. ScreenId should be ReferralEdit.

            frmGloAccountListRim.miRequest.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.RequestEdit)) &&
                                (_pcCustomOptions.CheckCustomOptions(PcCustomOptions.CO_Constants.CO_SalesAndService));
            if (GlobalVars.InstitutionType == "CU")
            {
                frmGloAccountListRim.miEmailMember.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LaunchEmail));
                frmGloAccountListRim.miMemberForms.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.GbRMAcctForms));
            }
            else
            {
                frmGloAccountListRim.miCustomerForms.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.GbRMAcctForms));
                frmGloAccountListRim.miEmailCustomer.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.LaunchEmail));
            }

            frmGloAccountListRim.miSchedAppt.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.Appointment)) && frmGloAccountListRim.POIInstalled;
            frmGloAccountListRim.miDormEsch.Enabled = frmGloAccountListRim.bAllowDormEscheat;
            frmGloAccountListRim.miVOD.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || (Phoenix.FrameWork.CDS.DataService.Instance.XmDbStatus == XmDbStatus.Day && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.VerificationOfDeposit)));
            //38817
            //Ad_rm_control. ENABLE_DL_SCAN = ‘N’ or Ad_rm_control. DL_STORAGE_LOCATION = “Do Not Save” or Phoenix.Shared.Constants.ScreenId.DlScan does not have View security access
            //73409. We already have object of AdRmControl BO. So no need of new instance we can use existing one
            //_adRmControlBusObj = GlobalObjects.Instance[Phoenix.FrameWork.Shared.Variables.GlobalObjectNames.AdRmControl] as Phoenix.BusObj.Admin.RIM.AdRmControl;

            //if (_adRmControlBusObj == null) //73409. We already have object of AdRmControl BO. So no need of new instance we can use existing one
            //{
            //    this.CallCDSProcess(_adRmControlBusObj);
            //}
            if (this._adRmControl.EnableDlScan.Value == "N" || this._adRmControl.DlStorageLocation.Value == "DoNotSave")
            {
                frmGloAccountListRim.miDLScan.Enabled = false;
            }
            else
            {
                frmGloAccountListRim.miDLScan.Enabled = (!CoreService.UIAccessProvider.IsSecurityEnabled || (Phoenix.FrameWork.CDS.DataService.Instance.XmDbStatus == XmDbStatus.Day && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DlScan)));
            }
        }

        //End 60647

        //Begin 60671
        /// <summary>
        /// Display window Stop at summay is unchecked
        /// </summary>
        /// <returns></returns>
        private bool launchDisplay()
        {
            isCreateDisplayWindow = false;
            
           string _psAcctType = searchAcctType;
           string _psAcctNo = searchAcctNo;
            //60674. If Direct Access is checked no need to launch display window because it should laod Direct Access Window
            //#75074.Added showDisplayWindow flag in below condition. If call comes from Search click then only show the display wondow.
            if (showDisplayWindow && !isDirectWindowAccess && this.Workspace.Variables.Contains("StopAtSummary") && frmGloAccountListRim.colAcctNo.Text != "" && frmGloAccountListRim.colAcctType.Text != "" && !string.IsNullOrEmpty(_psAcctType) && !string.IsNullOrEmpty(_psAcctNo))
            {
                // 37947 launch display only if the searched acct matches the highlighted acct
                //WI#37960
                if ((GlobalVars.EncryptPanEnabled == "N" && Convert.ToString(frmGloAccountListRim.colAcctNo.UnFormattedValue).Trim() == _psAcctNo.Trim() && Convert.ToString(frmGloAccountListRim.colAcctType.UnFormattedValue).Trim() == _psAcctType.Trim()) ||
                    (GlobalVars.EncryptPanEnabled == "Y" && Convert.ToString(frmGloAccountListRim.colDecryptedAcctNo.UnFormattedValue).Trim() == _psAcctNo.Trim() && Convert.ToString(frmGloAccountListRim.colAcctType.UnFormattedValue).Trim() == _psAcctType.Trim())
                     ||(Convert.ToString(frmGloAccountListRim.colAcctDesc.UnFormattedValue).Trim() == _psAcctNo.Trim() && _psAcctType == "PAN") 
                    ) //#83279 PCI Enabled the colDecrypt else colAcctNO
                {
                    if (this._adGbRsm.DormantAccess.Value == "N" || this._adGbRsm.EscheatedAccess.Value == "N")
                    {
                        if (!((frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == "Dormant" && this._adGbRsm.AllowViewDormant.Value == "N") || (frmGloAccountListRim.colStatus.UnFormattedValue.ToString().Trim() == "Escheated" && this._adGbRsm.AllowViewEscheat.Value == "N")))
                        {
                            if (!Convert.ToBoolean(this.Workspace.Variables["StopAtSummary"]) && _psAcctType != "" && _psAcctNo != "" && _psAcctType != "RIM")      //34152
                            {
                                isCreateDisplayWindow = true;
                                pbDisplay_Click(this, null);
                                return true;
                            }
                        }
                    }
                    else
                    {
                        if (!Convert.ToBoolean(this.Workspace.Variables["StopAtSummary"]) && _psAcctType != "" && _psAcctNo != "" && _psAcctType != "RIM")      //34152
                        {
                            isCreateDisplayWindow = true; //WI#37960
                            pbDisplay_Click(this, null);
                            return true;
                        }
                    }
                }
            }          
            return false;
        }
        //End 60671
        //Begin 61240

        ///// <summary>
        ///// Determine pbService Disable/Enable state, text and status text 
        ///// </summary>
        ///// <param name="svcsDesc"></param>
        void EnableDisableServiceButton(string sSvcsDesc)
        {
            if (_pcCustomOptions.CheckCustomOptions(PcCustomOptions.CO_Constants.CO_SalesAndService))
            {
                pbSales.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
            }
            else
            {
                pbSales.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
            }
            if (sSvcsDesc == "Account Analysis")
            {
                if (!CoreService.UIAccessProvider.IsSecurityEnabled || (CoreService.UIAccessProvider.IsSecurityEnabled && CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpAcctAnalysis)))
                {
                    if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.DpAcctAnalysis))
                    {
                        pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 22);
                        pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 21);

                    }
                    else
                    {
                        pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 23);
                        pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 20);
                    }
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                }
                else
                {
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                }

            }
            else if (sSvcsDesc == "ACH Company Charge Back Processing" ||
                    sSvcsDesc == "ACH Company Other ACH Payment Files" ||
                    sSvcsDesc == "ACH Company Payroll Files" ||
                    sSvcsDesc == "ACH Company Tax Files")
            {
                //CTD:If gbDebugSecurity OR maSecurity[ ID_OnRmACHCompanyList ].bViewAccess
                if (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.RmACHCompanyList))
                {
                    if (CoreService.UIAccessProvider.IsSecurityEnabled)
                    {
                        //CTD:If maSecurity[ ID_OnRmACHCompanyList ].bEditAccess
                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.RmACHCompanyList))
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 22 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 22);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 21);
                        }
                        //CTD:Else
                        else
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 23 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 23);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 20);
                        }
                    }
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                }
                //CTD:Else
                else
                {
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                }


            }
            else if (sSvcsDesc == "ACH Company Paper Payroll Files")
            {
                if (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.RmPaperPayrollList))
                {
                    if (CoreService.UIAccessProvider.IsSecurityEnabled)
                    {
                        //CTD:If maSecurity[ ID_OnRmACHCompanyList ].bEditAccess
                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.RmPaperPayrollList))
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 22 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 22);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 21);
                        }
                        //CTD:Else
                        else
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 23 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 23);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 20);
                        }
                    }
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Enable);

                }
                //CTD:Else
                else
                {
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                }

            }
            else if (sSvcsDesc == "Bill Payment" || sSvcsDesc == "ACH Direct Deposit")
            {
                if (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpTCHistoryDisplay))
                {
                    if (CoreService.UIAccessProvider.IsSecurityEnabled)
                    {
                        //CTD:If maSecurity[ ID_OnRmACHCompanyList ].bEditAccess
                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.DpTCHistoryDisplay))
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 22 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 22);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 21);
                        }
                        //CTD:Else
                        else
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 23 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 23);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 20);
                        }
                    }
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                }
                //CTD:Else
                else
                {
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                }
            }
            else if (sSvcsDesc == "E Statements")
            {
                if (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.GbStatement))
                {
                    if (CoreService.UIAccessProvider.IsSecurityEnabled)
                    {
                        //CTD:If maSecurity[ ID_OnRmACHCompanyList ].bEditAccess
                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.GbStatement))
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 22 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 22);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 21);
                        }
                        //CTD:Else
                        else
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 23 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 23);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 20);
                        }
                    }
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                }
                //CTD:Else
                else
                {
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                }

            }
            else if (sSvcsDesc == "Payroll Distributions")
            {
                if (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.RmPayrollDistSetList))
                {
                    if (CoreService.UIAccessProvider.IsSecurityEnabled)
                    {
                        //CTD:If maSecurity[ ID_OnRmACHCompanyList ].bEditAccess
                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.RmPayrollDistSetList))
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 22 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 22);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 21);
                        }
                        //CTD:Else
                        else
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 23 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 23);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 20);
                        }
                    }
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                }
                //CTD:Else
                else
                {
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                }
            }
            else if (sSvcsDesc == "Positive Pay" || sSvcsDesc == "Account Reconciliation")
            {
                if (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.DpEdit))
                {
                    if (CoreService.UIAccessProvider.IsSecurityEnabled)
                    {
                        //CTD:If maSecurity[ ID_OnRmACHCompanyList ].bEditAccess
                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.DpEdit))
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 22 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 22);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 21);
                        }
                        //CTD:Else
                        else
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 23 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 23);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 20);
                        }
                    }
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                }
                //CTD:Else
                else
                {
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                }

            }
            else if (sSvcsDesc == "Sweep Family")
            {
                if (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.RmSweepFamilyList))
                {
                    if (CoreService.UIAccessProvider.IsSecurityEnabled)
                    {
                        //CTD:If maSecurity[ ID_OnRmACHCompanyList ].bEditAccess
                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.RmSweepFamilyList))
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 22 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 22);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 21);
                        }
                        //CTD:Else
                        else
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 23 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 23);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 20);
                        }
                    }
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                }
                //CTD:Else
                else
                {
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                }
            }
            else
            {
                if (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.GbRmSvcsList))
                {
                    if (CoreService.UIAccessProvider.IsSecurityEnabled)
                    {
                        //CTD:If maSecurity[ ID_OnRmACHCompanyList ].bEditAccess
                        if (CoreService.UIAccessProvider.HasWriteAccess(Phoenix.Shared.Constants.ScreenId.GbRmSvcsList))
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 22 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 22);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 21);
                        }
                        //CTD:Else
                        else
                        {
                            //CTD:Call SalSetWindowText(pbEditService, IntMLTranslateX( ID_OnAccountListRim, 23 ))
                            pbEditService.ImageButton.Text = CoreService.Translation.GetTranslateX(889, 23);
                            pbEditService.StatusText = CoreService.Translation.GetTranslateX(889, 20);
                        }
                    }
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
                }
                //CTD:Else
                else
                {
                    pbEditService.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
                }
            }

            //Begin #35486
            if (pbEditService.ImageButton.Text == CoreService.Translation.GetTranslateX(889, 23))    // View
                pbEditService.ImageButton.Text = "View Se&rvice.";
            //End #35486

            pbEditService.MLInfo.Label = pbEditService.ImageButton.Text;        //34423

            #region 174961
            /* 35778 - Changed the condition to compare security to || */
            if (frmGloAccountListRim.gridServListSum.RowCount > 0 && (!CoreService.UIAccessProvider.IsSecurityEnabled || CoreService.UIAccessProvider.HasReadAcces(Phoenix.Shared.Constants.ScreenId.GbDataSvcs)))
            {
                pbSales.SetObjectStatus(VisibilityState.Default, EnableState.Enable);
            }
            else
            {
                pbSales.SetObjectStatus(VisibilityState.Default, EnableState.Disable);
            }
            #endregion

            RepaintButton(pbEditService.ImageButton);
        }
        //End 61240
        /// <summary>
        /// Set Workspace Varibale for Selected Account. This is basically called on MDI window close.
        /// some of the Window is not calling the "CallParent" method and henece Workspace variable is not getting set on MDI window Close.        
        /// </summary>
        public void SetWorkSpaceVariable()
        {
            if (frmGloAccountListRim != null && frmGloAccountListRim.gridAccountListSum.RowCount > 0)
            {
                this.Workspace.Variables["CurAcctNo"] = frmGloAccountListRim.colAcctNo.UnFormattedValue.ToString();
                this.Workspace.Variables["CurAcctType"] = frmGloAccountListRim.colAcctType.UnFormattedValue.ToString();
                this.Workspace.Variables["DepLoan"] = frmGloAccountListRim.colDepLoan.UnFormattedValue.ToString();
                this.Workspace.Variables["CurAcctId"] = Convert.ToString(frmGloAccountListRim.colAcctId.UnFormattedValue == null ? 0 : frmGloAccountListRim.colAcctId.UnFormattedValue); //103714 
                EnableDisableControls("AccountListSumClick");//92711.When MDI window is closed then we need to invoke this method to ENable Disable MDI button. right now it is not doing this.
            }
            UpdateToolBar(); //Bug #95957
        }

        public void SetWorkspaceVariables(string acctType, string acctNo, string depLoan = null)
        {
             // #60668.
        }

        //Begin Bug#92482/Bug#92483/Bug#92484
        public void SetQuickWorkSpaceVariable()
        {
            string colDepLoan = "";
            string colAcctType = "";
            string colAcctNo = "";
            string colRimNo = "";
            int colAnalysisID = 0;
            int colAnalysisRimNo = 0;
            int colSweeps = 0;
            string colAcctId = "";  //103714

            if (QuickAccountSelectedRow != null)
            {
                colDepLoan = (!string.IsNullOrEmpty(QuickAccountSelectedRow.GetStringValue("DepLoan")) ? QuickAccountSelectedRow.GetStringValue("DepLoan").Trim() : "");
                colRimNo = (!string.IsNullOrEmpty(QuickAccountSelectedRow.GetStringValue("RimNo")) ? QuickAccountSelectedRow.GetStringValue("RimNo") : "");
                colAcctType = (!string.IsNullOrEmpty(QuickAccountSelectedRow.GetStringValue("AcctType")) ? QuickAccountSelectedRow.GetStringValue("AcctType") : "");
                colAcctNo = (!string.IsNullOrEmpty(QuickAccountSelectedRow.GetStringValue("AcctNo")) ? QuickAccountSelectedRow.GetStringValue("AcctNo") : "");
                colAnalysisID = (!string.IsNullOrEmpty(QuickAccountSelectedRow.GetStringValue("AnalysisID")) ? QuickAccountSelectedRow.GetIntValue("AnalysisID") : 0);
                colAnalysisRimNo = (!string.IsNullOrEmpty(QuickAccountSelectedRow.GetStringValue("AnalysisRimNo")) ? QuickAccountSelectedRow.GetIntValue("AnalysisRimNo") : 0);
                colSweeps = (!string.IsNullOrEmpty(QuickAccountSelectedRow.GetStringValue("Sweeps"))  && QuickAccountSelectedRow.GetStringValue("Sweeps") != "N"? QuickAccountSelectedRow.GetIntValue("Sweeps") : 0);
                colAcctId = (!string.IsNullOrEmpty(QuickAccountSelectedRow.GetStringValue("AcctId")) ? QuickAccountSelectedRow.GetStringValue("AcctId") : "");  //103714
                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "DepLoan", colDepLoan);
                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "CurAnalId", colAnalysisID);
                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "AnalysisRimNo", colAnalysisRimNo);
                Phoenix.Windows.Client.Helper.SetWorkSpaceVarValue(this, "SweepPtid", colSweeps);
                SetWorkspaceAccountVariables(colAcctType, colAcctNo, colRimNo, colDepLoan, colAcctId); //Bug#95957 //103714: Added colAcctId
            }
        }

        //End Bug#92482/Bug#92483/Bug#92484

        // Begin Task#115610 - Handle Setting External Account Adapter Fields Based on Tab Selected
        public void SetAdapterFields()
        {
            if (picTabs.SelectedIndex == (int)TAB.CustSummary)
            {
                colHistorySupport = Convert.ToString(frmGloAccountListRim.colHistorySupport.UnFormattedValue).Trim(); //Bug #112463
                colAdapterType = Convert.ToString(frmGloAccountListRim.colAdapterType.UnFormattedValue).Trim(); //Bug #112463
                colCrTcSupport = Convert.ToString(frmGloAccountListRim.colCrTcSupport.UnFormattedValue).Trim(); //Bug #112463
                colDrTcSupport = Convert.ToString(frmGloAccountListRim.colDrTcSupport.UnFormattedValue).Trim(); //Bug #112463
            }
            else if (picTabs.SelectedIndex == (int)TAB.QuickTran)
            {
                colHistorySupport = QuickAccountSelectedRow.GetStringValue("HistorySupport").Trim();
                colAdapterType = QuickAccountSelectedRow.GetStringValue("AdapterType").Trim();
                colCrTcSupport = QuickAccountSelectedRow.GetStringValue("CrTcSupport").Trim();
                colDrTcSupport = QuickAccountSelectedRow.GetStringValue("DrTcSupport").Trim();
            }
        }
        // End Task#115610
        #endregion

        //Begin Bug#115682
        public void CreateAuditViews()
        {
            if (_adGbBankControl.ViewAudit.Value == "Y")
            {
                if (picTabs.SelectedIndex == (int)TAB.CustSummary && viewTimeIn != DateTime.MinValue)
                {

                    PNotes note = new PNotes();
                    note.ScreenId = Phoenix.Shared.Constants.ScreenId.TlTranCode;
                    note.RimNo = frmGloAccountListRim._rmAcctPtid;
                    if (checkTimeIn != viewTimeIn)
                    {
                        _gbHelper.CreateViewAudit(note, GlobalVars.UserType, viewTimeIn, DateTime.Now);
                    }
                    checkTimeIn = viewTimeIn;
                }
            }
        }
        //End Bug#115682
        //Begin #134375
        public object GetCurrentExceptionHoldBalInfo()
        {
            if (_tlTranSet.CurTran.GbHoldStop != null && _tlTranSet.CurTran.GbHoldStop.Count == 1)
                return _tlTranSet.CurTran.GbHoldStop[0] as GbHoldStop;

            else
                return new GbHoldStop();
        }

        public void SetCurrentExceptionHoldBalInfo(object exceptionHoldObj)
        {
            if (_tlTranSet.CurTran.GbHoldStop != null && _tlTranSet.CurTran.GbHoldStop.Count > 0)
                _tlTranSet.CurTran.GbHoldStop.Clear();
            // Bug #134756 - Add stop obj if excep rsn is selected.
            GbHoldStop _gbholdStopObj = exceptionHoldObj as GbHoldStop;
            if (_gbholdStopObj != null && !_gbholdStopObj.ExceptRsnCode.IsNull)
            {
                _tlTranSet.CurTran.GbHoldStop.Add(exceptionHoldObj as GbHoldStop);
            }
        }
        //End #134375
    }

    //Begin #76047
    #region Enums
    enum EnumCallOtherForms
    {
        BondPurchase
    }
    enum EnumEnableDisable
    {
        EnableBondPurchase,
        DisableBondPurchase,
        EnableOnUsTc,           // #79370
		DisableOnUsTc,			// #79370
        ActionSavingsBond,      // #17178
        EnableGetAcct,           // #17047
        DisableGetAcct,           // #17047
        CDRedemp                // 21033
    }
    enum EnumBondTranCodes : int
    {
        SeriesEE = 913,
        SeriesI = 922
    }
    #endregion

    //End #76047
}
